ob.fb={};var FBCPN={},FBCPNROW={},is_guest,bet_types={}
function fbmsg(msg_type){if(msg_type=='CPN'){fb_got_CPN.apply(this,arguments)}else if(msg_type=='CPNROW'){fb_got_CPNROW.apply(this,arguments)}else if(msg_type=='CPNENDROWS'){fb_got_CPNENDROWS.apply(this,arguments)}else if(msg_type=='CPNMBS'){fb_got_CPNMBS.apply(this,arguments)}else if(msg_type=='CPNROWMBS'){fb_got_CPNROWMBS.apply(this,arguments)}else if(msg_type=='CPNEND'){fb_got_CPNEND.apply(this,arguments)}else if(msg_type=='CPNAG'){fb_got_CPNAG.apply(this,arguments)}else if(msg_type=='CPNEVAG'){fb_got_CPNEVAG.apply(this,arguments)}else if(msg_type=='CPNOCAG'){fb_got_CPNOCAG.apply(this,arguments)}else if(msg_type=='CPNENDAG'){fb_got_CPNENDAG.apply(this,arguments)}else if(msg_type=='CPNAB'){fb_got_CPNAB.apply(this,arguments)}else if(msg_type=='CPNABROW'){fb_got_CPNABROW.apply(this,arguments)}else if(msg_type=='CPNABOC'){fb_got_CPNABOC.apply(this,arguments)}else throw('Unexpected msg_type "'+msg_type+'"')}
function fb_got_CPN(junk,fbcpn_id,category,disp_cat_id,more_feat_avail,showing_all,has_hcaps,coupon_sort,min_matches,max_matches,banker_acc_max,is_builder,builder_acc_max,builder_default_stake,col_keys,col_names){var cpn={category:category,disp_cat_id:disp_cat_id,more_feat_avail:parseInt(more_feat_avail),showing_all:parseInt(showing_all),has_hcaps:parseInt(has_hcaps),col_keys:col_keys,col_names:col_names,coupon_sort:coupon_sort,min_matches:min_matches,max_matches:max_matches,banker_acc_max:parseInt(banker_acc_max),builder_acc_max:parseInt(builder_acc_max),is_builder:is_builder,builder_default_stake:builder_default_stake};FBCPN[fbcpn_id]=cpn;if(is_builder=='Y'){cpn.builder_highlights={};cpn.builder_shown={};cpn.builder_counter=0;cpn.builders=[]};if(min_matches!="")cpn.min_matches=parseInt(cpn.min_matche);if(max_matches!="")cpn.max_matches=parseInt(cpn.max_matches);cpn.sort_dirs={};cpn.sort_dirs['TIME']=1;cpn.date_sort_dir=1;for(var i=0;i<col_keys.length;i++)cpn.sort_dirs[col_keys[i]]=0;cpn.row_ids=[];cpn.mb_names={};cpn.prev_row_date='';cpn.prev_type_name='';cpn.checkbox_values=new Array();var table_el=fbcpn_make_empty_table(fbcpn_id);cpn.first_table_el=table_el;cpn.sections=[];cpn.holder_el=document.getElementById(fbcpn_id+'_holder')}
function fbcpn_make_empty_table(div_id){var div_el=document.createElement('div');div_el.id=div_id;div_el.className='fb_day_type_wrapper';return div_el}
function fb_got_CPNROW(junk,fbcpn_id,fbcpnrow_id,ev_id,ev_name,srt_date,srt_time,date_fmt,time_fmt,class_id,type_id,type_name,touchline,touchline_view_all,has_mbs,has_br_flag,stations,tv_icon,stream,coupon_sort,bet_in_run,live_now,more_bets,meets_banker_criteria,bankers_default,meets_builder_criteria,url){var vargs_offset=27,cpn=FBCPN[fbcpn_id],cpnrow={id:fbcpnrow_id,fbcpn_id:fbcpn_id,ev_id:ev_id,ev_name:ev_name,srt_date:srt_date,srt_time:srt_time,date_fmt:date_fmt,time_fmt:time_fmt,class_id:class_id,type_id:type_id,type_name:type_name,touchline:touchline,has_mbs:parseInt(has_mbs),has_br_flag:parseInt(has_br_flag),stations:stations,tv_icon:tv_icon,stream:stream,bet_in_run:bet_in_run,live_now:live_now,meets_banker_criteria:meets_banker_criteria,bankers_default:bankers_default,meets_builder_criteria:meets_builder_criteria,touchline_view_all:touchline_view_all},coupon_id=fbcpn_id.slice(5,fbcpn_id.length);FBCPNROW[fbcpnrow_id]=cpnrow;cpnrow.more_bets=[];cpnrow.more_bets_el=document.createElement("td");cpnrow.srt_odds={};cpnrow.banker={};cpnrow.builder={};if(srt_date!=cpn.prev_row_date){fbcpn_section_changed(fbcpn_id,date_fmt);cpn.prev_row_date=srt_date};var col_keys=cpn.col_keys,sel_data_for={};for(var i=vargs_offset;i<=arguments.length-2;i+=2){var col_key=arguments[i];sel_data_for[col_key]=arguments[i+1]};var ev_holder_el=document.createElement('div');ev_holder_el.className='pp_fb_event';ev_holder_el.id=fbcpnrow_id;var div_el,link_el,span_el,p_el,anch_el,filter_array=new Array('of','st','nd','rd','th');div_el=document.createElement('div');if(live_now=="N"){div_el.className='fb_event_time';div_el.appendChild(document.createTextNode("<p>"+time_fmt+"</p>"))}else if(live_now=="Y"){ev_holder_el.className+=' live';div_el.className='live_now';a_link_el=document.createElement('a');a_link_el.href=url;var span_el=document.createElement('span');span_el.className='tooltip';span_el.appendChild(document.createTextNode(fb_data.xl_bankers_lb+" "+time_fmt));a_link_el.appendChild(span_el);a_link_el.appendChild(document.createTextNode(fb_data.xl_bankers_live_now));div_el.appendChild(a_link_el)};ev_holder_el.appendChild(div_el);div_el=document.createElement('div');div_el.className='fb_event_name';p_el=document.createElement('p');link_el=document.createElement('a');link_el.href=url;if(cpnrow.tv_icon=='live_betting')link_el.href=tld_football+'?action=go_betlive_event&ev_id='+cpnrow.ev_id;link_el.appendChild(document.createTextNode(ev_name));p_el.appendChild(link_el);div_el.appendChild(p_el);ev_holder_el.appendChild(div_el);div_el=document.createElement('div');div_el.className='fb_tools';if(cpnrow.has_mbs){var link_el=document.createElement('a');link_el.className='fb_money-back-special';mbs_tooltip_el=document.createElement('span');mbs_tooltip_el.className="tooltip";mbs_tooltip_el.appendChild(document.createTextNode(fb_data.xl_mbs));if(cpnrow.tv_icon!=''){var txt=fb_data['xl_'+cpnrow.tv_icon];if(cpnrow.tv_icon=='live_on_tv')if(cpnrow.stations!=''){txt+=' '+cpnrow.stations}else txt+=' TV';mbs_tooltip_el.appendChild(document.createTextNode('<br/>'+txt))};if(cpnrow.stream=='1')mbs_tooltip_el.appendChild(document.createTextNode('<br/>'+fb_data.xl_bir_str_vid_title));link_el.appendChild(mbs_tooltip_el);div_el.appendChild(link_el)}else{if(cpnrow.tv_icon!=''){var img_src=fb_data['img_'+cpnrow.tv_icon],txt=fb_data['xl_'+cpnrow.tv_icon];if(cpnrow.tv_icon=='live_on_tv')if(cpnrow.stations!=''){txt+=' '+cpnrow.stations}else txt+=' TV';var tvlink_el=document.createElement('a');tvlink_el.className='fb_tv';var span_el=document.createElement('span');span_el.className='tooltip';span_el.appendChild(document.createTextNode(txt));tvlink_el.appendChild(span_el);div_el.appendChild(tvlink_el)};if(cpnrow.stream=='1'){var anch_el=document.createElement('a'),span_el=document.createElement('span');anch_el.className='fb_streaming';span_el.className='tooltip';span_el.appendChild(document.createTextNode(fb_data.xl_bir_str_vid_title));anch_el.appendChild(span_el);div_el.appendChild(anch_el)}};ev_holder_el.appendChild(div_el);div_el=document.createElement('div');div_el.className='fb_statistics';if(cpnrow.touchline!=''){a_link_el=document.createElement('a');a_link_el.href="javascript:void(0);";a_link_el.onclick=function(){openInlineStats(this,cpnrow.touchline,ev_id,cpnrow.touchline_view_all);return false};var span_el=document.createElement('span');span_el.className='tooltip';span_el.appendChild(document.createTextNode(fb_data.xl_view_stats+" "+ev_name));a_link_el.appendChild(span_el);div_el.appendChild(a_link_el)};ev_holder_el.appendChild(div_el);div_el=document.createElement('div');div_el.className="fb_odds item";for(var i=0;i<cpn.col_keys.length;i++){var col_key=cpn.col_keys[i],col_name=cpn.col_names[i],sel_data=sel_data_for[col_key],odd_div_el=document.createElement('div');odd_div_el.className='odds_selection';odd_div_el.id=fbcpnrow_id+"_"+i;var odd_span_el=document.createElement('span');odd_span_el.className='odd';if(sel_data==null){odd_div_el.className='';odd_span_el.className='oddsuspended';link_el=document.createElement('a');link_el.innerHTML='';link_el.href='javascript:void(0)';odd_span_el.appendChild(link_el)}else{var ev_oc_id=sel_data[0],prc_str=sel_data[1],lp_num=sel_data[2],lp_den=sel_data[3],hcap_str=sel_data[4],hcap_val=sel_data[5],tooltip=sel_data[6],mult_key=sel_data[7],banker=sel_data[8],builder=sel_data[9];cpnrow.srt_odds[col_key]=[lp_num,lp_den];if(hcap_str!=''){var span_el=document.createElement('span');span_el.className='hcap_str';span_el.appendChild(document.createTextNode(hcap_str+' '));odd_span_el.appendChild(span_el)};link_el=document.createElement('a');link_el.href='javascript:void(0)';var price_type="L",placebet="BS_set_leg('price_type','"+price_type+"');BS_set_leg('lp_num','"+lp_num+"');BS_set_leg('lp_den','"+lp_den+"');BS_set_leg('selections','"+ev_oc_id+"');BS_set_leg('hcap_value','"+hcap_val+"');BS_set_leg('bet_origin','"+coupon_sort+"_"+coupon_id+"');BS_go_bet();",placebet_bankers="bankers_set_leg('"+ev_oc_id+"','"+price_type+"','"+lp_num+"','"+lp_den+"','"+hcap_val+"',legs,stake,'"+coupon_sort+"_"+coupon_id+"');",placebet_builders="builders_set_leg('"+ev_oc_id+"','"+price_type+"','"+lp_num+"','"+lp_den+"','"+hcap_val+"',legs,stake,'"+coupon_sort+"_"+coupon_id+"');",toggle_builders_selection="toggle_builders_selection('"+fbcpnrow_id+"','"+i+"','"+ev_oc_id+"');";if(cpn.is_builder=='Y'){odd_div_el.onclick=new Function(toggle_builders_selection)}else odd_div_el.onclick=new Function(placebet);if(cpn.is_builder=='Y'){if(builder==1){odd_div_el.className+=' fbselected';cpn.builder_counter++;cpn.builder_highlights[fbcpnrow_id]=i;cpnrow.srt_odds["BUILDER"]=[lp_num,lp_den]};cpnrow.builder[i]={};cpnrow.builder[i].price_dec=lp_num/lp_den+1;cpnrow.builder[i].prc_str=prc_str;cpnrow.builder.ev_name=ev_name;cpnrow.builder[i].pb_func=placebet_builders;cpnrow.builder[i].col_key=col_key;cpnrow.builder[i].col_name=col_name;cpnrow.builder[i].mult_key=mult_key;cpnrow.builder[i].ev_oc_id=ev_oc_id}else odd_div_el.className+=' ';link_el.innerHTML=prc_str;if(hcap_str!=''){var span_el=document.createElement('span');span_el.className='hcap_prc';span_el.appendChild(link_el);odd_span_el.appendChild(span_el)}else odd_span_el.appendChild(link_el)};odd_div_el.appendChild(odd_span_el);div_el.appendChild(odd_div_el)};ev_holder_el.appendChild(div_el);if(coupon_sort!='SC'&&coupon_sort!='SB'){div_el=document.createElement('div');div_el.className='fb_more_event_bets';ev_holder_el.appendChild(div_el);cpnrow.more_bets_el=div_el;var a_el=document.createElement('a');a_el.href=url;a_el.appendChild(document.createTextNode("+ "+more_bets));var span_el=document.createElement('span');span_el.className="tooltip";span_el.appendChild(document.createTextNode(fb_data.xl_more_bets));var span2_el=document.createElement('span');span2_el.className="text";span2_el.appendChild(document.createTextNode(fb_data.xl_more_bets));a_el.appendChild(span_el);a_el.appendChild(document.createElement('br'));a_el.appendChild(span2_el);div_el.appendChild(a_el);cpnrow.more_bets_el.appendChild(a_el)};div_el=document.createElement('div');div_el.className='inline-stats';div_el.setAttribute("style","display:none;");if(cpnrow.touchline!='')div_el.innerHTML+='<div class="fb-inlinestats-footer"><div class="button_container"><a class="graysmallbutton viewall" href="javascript:void(0)" onclick="javascript:popWin=open(\''+touchline_view_all+'\',\'Stats2\',\'scrollbars=1,height=721 width=730,left=10,top=10,titlebar=0,status=0,toolbar=0,menubar=0,location=0\')"><div class="button-text">View All Stats<span class="tooltip">View All</span></div><div class="icon"></div></a><a style="" class="graysmallbutton graysmallbutton_right collapse-inline-stats" href="javascript:void(0)" onclick="javascript:openInlineStats(this, \''+touchline+'\');return false;"><span class="tooltip">Click here to collapse the section</span><div class="button-text">Collapse</div><div class="icon collapse"></div></a></div></div>';ev_holder_el.appendChild(div_el);cpn.sections[cpn.sections.length-1].appendChild(ev_holder_el);cpn.row_ids.push(fbcpnrow_id)}
function fbcpn_section_changed(fbcpn_id,section_str){var cpn=FBCPN[fbcpn_id],div_sec_id=fbcpn_id+'d'+cpn.sections.length,div_sec_el=fbcpn_make_empty_table(div_sec_id),div_el=document.createElement('div'),h2_el=document.createElement('h2'),ul_el=document.createElement('ul'),li1_el=document.createElement('li'),li2_el=document.createElement('li'),li3_el=document.createElement('li');div_el.className="fb_hdr";ul_el.className="list_header_odds";h2_el.appendChild(document.createTextNode(section_str));li1_el.appendChild(document.createTextNode(fb_data.xl_oc_home));li2_el.appendChild(document.createTextNode(fb_data.xl_oc_draw));li3_el.appendChild(document.createTextNode(fb_data.xl_oc_away));ul_el.appendChild(li1_el);ul_el.appendChild(li2_el);ul_el.appendChild(li3_el);div_el.appendChild(h2_el);div_el.appendChild(ul_el);var tbody_el=document.createElement('tbody');cpn.tbody_el=tbody_el;div_sec_el.appendChild(div_el);cpn.holder_el.appendChild(div_sec_el);cpn.sections.push(div_sec_el)}
function fb_got_CPNENDROWS(junk,fbcpn_id){var cpn=FBCPN[fbcpn_id]}
function fb_set_cpn_ccy(fbcpn_id,ccy_symbol){var cpn=FBCPN[fbcpn_id];cpn.ccy_symbol=ccy_symbol}
function fb_set_builder_cpn_ccy(fbcpn_id,ccy_symbol){var cpn=ABCPN[fbcpn_id];cpn.ccy_symbol=ccy_symbol}
function fb_got_CPNEND(junk,fbcpn_id){var cpn=FBCPN[fbcpn_id];fbcpn_upd_sort_indicators(fbcpn_id);if(cpn.sections.length==0){var tbody=document.createElement('tbody'),tr=document.createElement('tr'),td=document.createElement('td'),h3=document.createElement('h3'),editlink=document.createElement('a');td.colSpan=cpn.total_cols;td.className="no-mkts-msg";h3.appendChild(document.createTextNode(fb_data.xl_cpn_no_mkts_hdr));td.appendChild(h3);td.appendChild(document.createTextNode(fb_data.xl_cpn_no_mkts_msg1));editlink.appendChild(document.createTextNode(fb_data.xl_cpn_edit_matches));editlink.setAttribute("href","?action=go_site_prefs");editlink.setAttribute("style","display:block;padding-top:4px");td.appendChild(editlink);tr.appendChild(td);tbody.appendChild(tr);cpn.first_table_el.appendChild(tbody)};if(cpn.more_feat_avail){var div_el=document.createElement('div');div_el.className='footballcard details';var ul_el=document.createElement('ul');ul_el.className='form-race right';var li_el=document.createElement('li'),a_el=document.createElement('a');a_el.className='update';a_el.appendChild(document.createTextNode(fb_data.xl_show_all));a_el.href="javascript:fb_home_load_tab('"+fbcpn_id+"', '&show_all=1');void(0);";li_el.appendChild(a_el);ul_el.appendChild(li_el);div_el.appendChild(ul_el);cpn.holder_el.appendChild(div_el)};if(cpn.is_builder=='Y'){var div_el=document.getElementById(fbcpn_id+"_builder_bet_types_container"),sel_el=document.createElement('select');sel_el.id=fbcpn_id+"_builder_bet_types";sel_el=bet_types[cpn.builder_counter];div_el.appendChild(sel_el);var input_el=document.getElementById(fbcpn_id+"_builder_stake");input_el.value=cpn.builder_default_stake}}
function fbcpn_upd_sort_indicators(fbcpn_id){var cpn=FBCPN[fbcpn_id],col_keys=['TIME'].concat(cpn.col_keys);for(var i=0;i<col_keys.length;i++){var col_key=col_keys[i],col_th_id=fbcpn_id+'col'+col_key,col_th=document.getElementById(col_th_id);if(col_th==null)continue;var anchors=col_th.getElementsByTagName('a'),a=anchors[0],imgs=a.getElementsByTagName('img');if(!imgs.length){var img0=document.createElement('img');img0.src=fb_data.img_sort_asc;img0.alt='(asc.)';img0.style.display='none';a.appendChild(img0);var img1=document.createElement('img');img1.src=fb_data.img_sort_dsc;img1.alt='(desc.)';img1.style.display='none';a.appendChild(img1);imgs=[img0,img1]};if(cpn.sort_dirs[col_key]==-1){imgs[0].style.display='none';imgs[1].style.display='inline'}else if(cpn.sort_dirs[col_key]==1){imgs[0].style.display='inline';imgs[1].style.display='none'}else{imgs[0].style.display='none';imgs[1].style.display='none'}};return}
function build_bankers_options(fbcpn_id){var cpn=FBCPN[fbcpn_id],num_selns_select=document.getElementById(fbcpn_id+"_banker_num_selns"),num_options=cpn.bankers.length;num_selns_select.options[num_selns_select.options.length]=new Option("All",num_options);for(var option=1;option<=num_options;option++)num_selns_select.options[num_selns_select.options.length]=new Option(option,option);try{num_selns_select.options[5].selected=true}catch(e){}}
function enforce_bankers_threshold(fbcpn_id){var cpn=FBCPN[fbcpn_id],domrows_by_id=[],cpnrows=[];cpn.bankers=[];var default_rows=0;for(var j=0;j<cpn.sections.length;j++){var tbody=cpn.sections[j].childNodes;for(var i=1;i<tbody.length;i++){var domrow=tbody[i],fbcpnrow_id=domrow.id,cpnrow=FBCPNROW[fbcpnrow_id];if(cpnrow.meets_banker_criteria==1){cpnrows.push(cpnrow);domrows_by_id[fbcpnrow_id]=domrow};if(cpnrow.bankers_default==1)default_rows++}};if(cpn.max_matches=="")cpn.max_matches=cpnrows.length;if(default_rows>cpn.max_matches)default_rows=cpn.max_matches;cpnrows.sort(function(a,b){return fbcpn_cmp_rows("BANKER",1,a,b)});var all_rows_added=0,default_rows_added=0,mult_keys=new Array();for(var i=0;i<cpnrows.length;i++){var cpnrow=cpnrows[i],fbcpnrow_id=cpnrow.id,matches_prev_mult_key=0;if(cpnrow.banker.mult_key!="")if(mult_keys[cpnrow.banker.mult_key]!=cpnrow.banker.mult_key){mult_keys[cpnrow.banker.mult_key]=cpnrow.banker.mult_key}else var matches_prev_mult_key=1;if(!matches_prev_mult_key){if((all_rows_added-default_rows_added)<(cpn.max_matches-default_rows)){cpn.bankers.push(cpnrow.banker);if(cpnrow.bankers_default==1)default_rows_added++;all_rows_added++}else if(default_rows_added<default_rows){if(cpnrow.bankers_default==1){cpn.bankers.push(cpnrow.banker);default_rows_added++;all_rows_added++}else{domrows_by_id[fbcpnrow_id].style.display="none";$j('div#'+fbcpnrow_id+' a').hide()}}else{domrows_by_id[fbcpnrow_id].style.display="none";$j('div#'+fbcpnrow_id+' a').hide()}}else{domrows_by_id[fbcpnrow_id].style.display="none";$j('div#'+fbcpnrow_id+' a').hide()}};for(var j=0;j<cpn.sections.length;j++){var children=cpn.sections[j].childNodes,shown=0;for(var i=1;i<children.length;i++){var domrow=children[i],fbcpnrow_id=domrow.id,cpnrow=FBCPNROW[fbcpnrow_id];if(cpnrow!==null&&domrow.style.display!="none")shown++};if(shown==0)cpn.sections[j].style.display="none"}}
function enforce_builder_threshold(fbcpn_id){var cpn=FBCPN[fbcpn_id],domrows_by_id=[],cpnrows=[];cpn.builder=[];for(var j=0;j<cpn.sections.length;j++){var tbody=cpn.sections[j].childNodes;for(var i=1;i<tbody.length;i++){var domrow=tbody[i],fbcpnrow_id=domrow.id,cpnrow=FBCPNROW[fbcpnrow_id];if(cpnrow.meets_builder_criteria==1){cpnrows.push(cpnrow);domrows_by_id[fbcpnrow_id]=domrow}}};if(cpn.max_matches=="")cpn.max_matches=cpnrows.length;if(cpn.max_matches>cpn.builder_acc_max)cpn.max_matches=cpn.builder_acc_max;cpnrows.sort(function(a,b){return fbcpn_cmp_rows("BUILDER",1,a,b)});var rows_added=0,mult_keys=new Array();for(var i=0;i<cpnrows.length;i++){var cpnrow=cpnrows[i],fbcpnrow_id=cpnrow.id,matches_prev_mult_key=0;for(var k=0;k<cpn.col_keys.length;k++){var mult_key=cpnrow.builder[k],is_empty_mult_key=!mult_key;if(!is_empty_mult_key)if(cpnrow.builder[k].mult_key!="")if(mult_keys[cpnrow.builder[k].mult_key]==cpnrow.builder[k].mult_key){var matches_prev_mult_key=1;break}};if(!matches_prev_mult_key){for(var k=0;k<cpn.col_keys.length;k++){var mult_key=cpnrow.builder[k],is_empty_mult_key=!mult_key;if(!is_empty_mult_key)if(cpnrow.builder[k].mult_key!="")if(mult_keys[cpnrow.builder[k].mult_key]!=cpnrow.builder[k].mult_key)mult_keys[cpnrow.builder[k].mult_key]=cpnrow.builder[k].mult_key};if(rows_added<cpn.max_matches){if(cpnrow.meets_builder_criteria==1){cpn.builder_shown[fbcpnrow_id]=fbcpnrow_id;rows_added++}else{domrows_by_id[fbcpnrow_id].style.display="none";$j('tr#'+fbcpnrow_id+' a').hide()}}else{domrows_by_id[fbcpnrow_id].style.display="none";$j('tr#'+fbcpnrow_id+' a').hide()}}else{domrows_by_id[fbcpnrow_id].style.display="none";$j('tr#'+fbcpnrow_id+' a').hide()}};for(var j=0;j<cpn.sections.length;j++){var tbody=cpn.sections[j],shown=0;for(var i=0;i<tbody.rows.length;i++){var domrow=tbody.rows[i],fbcpnrow_id=domrow.id,cpnrow=FBCPNROW[fbcpnrow_id];if(cpnrow!==null&&domrow.style.display!="none")shown++};if(shown==0)tbody.parentNode.style.display="none"};cpn.builder_counter=rows_added;var num_selns_container=document.getElementById(fbcpn_id+"_builder_bet_types_container"),num_selns_select=document.getElementById(fbcpn_id+"_builder_bet_types");num_selns_container.removeChild(num_selns_select);var sel_el=bet_types[cpn.builder_counter];num_selns_container.appendChild(sel_el)}
function place_bankers_bets(fbcpn_id,val){var cpn=FBCPN[fbcpn_id],num_selns_select=document.getElementById(fbcpn_id+"_banker_num_selns"),num_selns=parseInt(num_selns_select.options[num_selns_select.selectedIndex].value),stake=BS_format_stake(val),pb_func="",legs=0;if(num_selns>cpn.banker_acc_max)num_selns=cpn.banker_acc_max;if(num_selns>cpn.bankers.length)num_selns=cpn.bankers.length;var cpn_val=cpn.checkbox_values;for(var j=0;j<num_selns;j++)if(cpn_val[cpn.bankers[j].ev_oc_id]==true||cpn_val[cpn.bankers[j].ev_oc_id]==null){pb_func+=cpn.bankers[j].pb_func;legs++};if(legs==0)return;eval(pb_func);if(legs>1)BS_set_extra_info("acc_stake",stake);BS_go_bets()}
function place_builders_bets(fbcpn_id,max){var cpn=FBCPN[fbcpn_id],num_selns=cpn.builder_counter;if(num_selns==0)return;var stake=document.getElementById(fbcpn_id+"_builder_stake").value;if(max!="max")if(stake==""){stake=0.0}else{stake=parseFloat(stake);if(!stake&&stake!=0)return};var bet_type_select=document.getElementById(fbcpn_id+"_builder_bet_types"),bet_type=(bet_type_select.options[bet_type_select.selectedIndex].value);stake=BS_format_stake(stake);if(max=="max")stake="MAX";var pb_func="",legs=0;if(num_selns>cpn.builder_acc_max)num_selns=cpn.builder_acc_max;for(fbcpnrow_id in cpn.builder_shown)if(cpn.builder_highlights[fbcpnrow_id]!=undefined){var cpnrow=FBCPNROW[fbcpnrow_id],i=cpn.builder_highlights[fbcpnrow_id];pb_func+=cpnrow.builder[i].pb_func;legs++};eval(pb_func);if(legs>1)BS_set_extra_info("bettype_stake",bet_type+"|"+stake);BS_go_bets()}
function toggle_builders_selection(fbcpnrow_id,col_num,ev_oc_id){var cpnrow=FBCPNROW[fbcpnrow_id],fbcpn_id=cpnrow.fbcpn_id,cpn=FBCPN[fbcpn_id];if(cpn.builder_highlights[fbcpnrow_id]==undefined){var td_el=document.getElementById(fbcpnrow_id+"_"+col_num);td_el.className+=' fbselected';cpn.builder_highlights[fbcpnrow_id]=col_num;cpn.builder_counter++}else if(cpn.builder_highlights[fbcpnrow_id]==col_num){var td_el=document.getElementById(fbcpnrow_id+"_"+col_num);delete cpn.builder_highlights[fbcpnrow_id];td_el.className='oddWrapper';cpn.builder_counter--}else{var td_el=document.getElementById(fbcpnrow_id+"_"+cpn.builder_highlights[fbcpnrow_id]);td_el.className='oddWrapper';td_el=document.getElementById(fbcpnrow_id+"_"+col_num);td_el.className+=' fbselected';cpn.builder_highlights[fbcpnrow_id]=col_num};var num_selns_container=document.getElementById(fbcpn_id+"_builder_bet_types_container"),num_selns_select=document.getElementById(fbcpn_id+"_builder_bet_types");num_selns_container.removeChild(num_selns_select);var sel_el=bet_types[cpn.builder_counter];num_selns_container.appendChild(sel_el);calculate_builder_stake(fbcpn_id)}
function bankers_set_leg(ev_oc_id,price_type,lp_num,lp_den,hcap_value,legs,stake,origin){BS_set_leg('price_type',price_type);BS_set_leg('lp_num',lp_num);BS_set_leg('lp_den',lp_den);BS_set_leg('selections',ev_oc_id);BS_set_leg('hcap_value',hcap_value);BS_set_leg('bet_origin',origin);if(legs==1)BS_set_leg('stake',stake);BS_select_bet(ev_oc_id)}
function builders_set_leg(ev_oc_id,price_type,lp_num,lp_den,hcap_value,legs,stake,origin){BS_set_leg('price_type',price_type);BS_set_leg('lp_num',lp_num);BS_set_leg('lp_den',lp_den);BS_set_leg('selections',ev_oc_id);BS_set_leg('hcap_value',hcap_value);BS_set_leg('bet_origin',origin);if(legs==1)BS_set_leg('stake',stake);BS_select_bet(ev_oc_id)}
function calculate_builder_stake(fbcpn_id){var cpn=FBCPN[fbcpn_id],stake=document.getElementById(fbcpn_id+"_builder_stake").value;if(stake==""||stake=="."){stake=0.0}else stake=parseFloat(stake);var bet_type_select=document.getElementById(fbcpn_id+"_builder_bet_types"),bet_type=(bet_type_select.options[bet_type_select.selectedIndex].value),num_lines=bet_types[bet_type],tot_stake_id=document.getElementById(fbcpn_id+"_builder_tot_stake");if(stake!=0)stake=stake*num_lines;stake=BS_format_stake(stake);tot_stake_id.innerHTML=cpn.ccy_symbol+stake;fb_builder_req_pot_winnings(fbcpn_id);var types_container=document.getElementById(fbcpn_id+"_builder_bet_types");types_container.title=bet_types[bet_type+'_desc']}
function calculate_tool_builder_stake(fbcpn_id){var cpn=ABCPN[fbcpn_id],stake=document.getElementById("accumulator_cpn_stk").value;if(stake==""||stake=="."){stake=0.0}else{stake=parseFloat(stake);if(!stake&&stake!=0)return};stake=BS_format_stake(stake);fb_builder_tool_req_pot_winnings(fbcpn_id)}
function build_banker_tool(fbcpn_id){var cpn=FBCPN[fbcpn_id],num_selns_select=document.getElementById(fbcpn_id+"_banker_num_selns"),stake_select=document.getElementById(fbcpn_id+"_banker_stake"),returns_span=document.getElementById(fbcpn_id+"_bankers_returns"),tool_form=document.getElementById(fbcpn_id+"_banker_bet_tool"),num_selns=parseInt(num_selns_select.options[num_selns_select.selectedIndex].value),stake=parseFloat(stake_select.value),mult_keys=new Array(),bankercount=1;tool_form.innerHTML="";while(tool_form.hasChildNodes())tool_form.removeChild(tool_form.lastChild());var wrapper_ul=document.createElement("ul");tool_form.appendChild(wrapper_ul);if(num_selns>cpn.bankers.length)num_selns=cpn.bankers.length;var bool_selections=false,cpn_val=cpn.checkbox_values;for(var j=0;j<num_selns;j++){if(cpn_val[cpn.bankers[j].ev_oc_id]==true||cpn_val[cpn.bankers[j].ev_oc_id]==null){stake=stake*cpn.bankers[j].price_dec;bool_selections=true};add_seln_to_tool(fbcpn_id,cpn.bankers[j],bankercount,wrapper_ul,num_selns);bankercount++};if(isNaN(stake)||bool_selections==false)stake=0;acummAnimationVars._inpt_field=returns_span;acummAnimationVars._currency_symbol=cpn.ccy_symbol;updateReturns(stake);styleCheckbox(fbcpn_id+"_banker_bet_tool")}
function add_seln_to_tool(fbcpn_id,banker,count,ul,num_selns){var cpn=FBCPN[fbcpn_id],li_el=document.createElement("li"),span_cbox_el=document.createElement("span"),input=document.createElement("input");li_el.className="odd";span_cbox_el.className="cbox";input.type="checkbox";input.name=fbcpn_id+"_add_to_banker_name";input.id=fbcpn_id+"_add_to_banker_name";input.value=banker.ev_oc_id;input.onclick=new Function("update_checkbox('','"+fbcpn_id+"')");if(cpn.checkbox_values[banker.ev_oc_id]==true){input.defaultChecked=true;input.checked=true}else if(cpn.checkbox_values[banker.ev_oc_id]==false){input.defaultChecked=false;input.checked=false}else{input.defaultChecked=true;input.checked=true};span_cbox_el.appendChild(input);var home_team="",away_team="",ev_name_trunc=trunc_string(banker.ev_name,fb_data.bank_seln_max_char,'...'),v_pos=ev_name_trunc.indexOf(" v",0),move_index=0;if(v_pos==-1){v_pos=ev_name_trunc.indexOf(" vs",0);move_index=3}else move_index=2;if(v_pos!=-1){home_team=jQuery.trim(ev_name_trunc.substring(0,v_pos));away_team=jQuery.trim(ev_name_trunc.substring(v_pos+move_index,ev_name_trunc.length))}else home_team=ev_name_trunc;var event_div=document.createElement("div"),event_bold=document.createElement("span");event_bold.className="bold uppercase";event_div.className="event-name";if(banker.col_name==fb_data.xl_oc_home){event_bold.appendChild(document.createTextNode(home_team));event_div.appendChild(event_bold);if(away_team!="")event_div.appendChild(document.createTextNode(" v "+away_team))}else{event_bold.appendChild(document.createTextNode(away_team));if(away_team!=""){event_div.appendChild(document.createTextNode(home_team+" v "))}else event_div.appendChild(document.createTextNode(home_team));event_div.appendChild(event_bold)};event_div.onclick=new Function("update_checkbox('"+banker.ev_oc_id+"','"+fbcpn_id+"')");var price_el=document.createElement("a");price_el.href="#";price_el.appendChild(document.createTextNode(banker.prc_str));price_el.onclick=new Function("update_checkbox('"+banker.ev_oc_id+"','"+fbcpn_id+"')");li_el.appendChild(event_div);li_el.appendChild(price_el);li_el.appendChild(span_cbox_el);ul.appendChild(li_el)}
function update_checkbox(ev_oc_id,fbcpn_id){var cpn=FBCPN[fbcpn_id];cpn.checkbox_values=new Array();var checkboxes=document.getElementsByName(fbcpn_id+"_add_to_banker_name");for(var c=0;c<checkboxes.length;c++){if(checkboxes[c].value==ev_oc_id)checkboxes[c].checked=!checkboxes[c].checked;cpn.checkbox_values[checkboxes[c].value]=checkboxes[c].checked};build_banker_tool(fbcpn_id)}
function fbcpn_cmp_rows(sort_by,sort_dir,cpnrowA,cpnrowB){if(sort_by=='TIME'){if(cpnrowA.srt_date+cpnrowA.srt_time<cpnrowB.srt_date+cpnrowB.srt_time){return-sort_dir}else if(cpnrowA.srt_date+cpnrowA.srt_time>cpnrowB.srt_date+cpnrowB.srt_time)return sort_dir}else{var oddsA=cpnrowA.srt_odds[sort_by],oddsB=cpnrowB.srt_odds[sort_by];if(oddsA==null)oddsA=sort_dir<0?[1,9999]:[9999,1];if(oddsB==null)oddsB=sort_dir<0?[1,9999]:[9999,1];var d=oddsA[0]*oddsB[1]-oddsA[1]*oddsB[0];if(d<0){return-sort_dir}else if(d>0)return sort_dir};if(cpnrowA.id<cpnrowB.id){return-1}else if(cpnrowA.id>cpnrowB.id)return 1;return 0}
function fb_home_load_tab(tabname,xtra_qry_str){if(xtra_qry_str==null)xtra_qry_str='';var holder_el=document.getElementById(tabname+'_holder');if(holder_el==null)return;holder_el.innerHTML='';holder_el.innerHTML='<div class="notes"><p><strong>'+fb_data.xl_loading+'</strong></p></div>';if(FBCPN[tabname]!=null){if(FBCPN[tabname].showing_all)xtra_qry_str+='&show_all=1';fbcpn_cleanup_data(tabname)};var url=tld;if(tabname=='fbcpnFEAT'){url+='?action=go_fb_feat_matches_ajax'}else if(tabname=='fbcpnMY'){url+='?action=go_fb_my_matches_ajax'}else if(tabname=='fbcpnLIVE'){url+='?action=go_fb_live_betting_ajax'}else if(tabname=='fb_other_mkts'){url+='?action=go_fb_other_mkts_ajax'}else throw('unknown tab '+tabname);if(xtra_qry_str!='')url+=xtra_qry_str;fb_simple_ajax_request(url,tabname,fb_got_ajax_content);fb_home_tabs_loaded[tabname]=true}
function fb_got_ajax_content(id,ok,response,content_type){var holder_el=document.getElementById(id+'_holder');if(holder_el==null)return;var is_fb_tab=false;for(var i=0;i<fb_home_tabnames.length;i++)if(fb_home_tabnames[i]==id){is_fb_tab=true;break};if(is_fb_tab)fb_home_tabs_loaded[id]=ok;if(!ok){holder_el.innerHTML='<div class="notes"><p><strong>'+fb_data.xl_error+' ('+response+')</strong></p></div>'}else if(content_type.indexOf('javascript')!=-1){holder_el.innerHTML='';eval(response)}else{var parts=fb_parse_script_tags(response);holder_el.innerHTML=parts[0];if(parts[1].length)eval(parts[1]);fbm_add_mouseovers(holder_el)}}
function fb_parse_script_tags(str){var html='',js='',i=0,state='HTML',script_re=new RegExp('<(/?)script([^>]*)>','gi');while((mtch=script_re.exec(str))!=null){mS=mtch.index;if(state=='HTML'){html+=str.substring(i,mS)}else js+=str.substring(i,mS)+';\n';var closer=mtch[1],attrs=mtch[2];if(closer=='/'){state='HTML'}else if(attrs.charAt(attrs.length-1)!='/'&&attrs.indexOf('src=')==-1)state='JS';i=script_re.lastIndex};if(state=='HTML'){html+=str.substring(i)}else js+=str.substring(i);return[html,js]}
function fb_simple_ajax_request(url,id,callback){var req=null;if(window.XMLHttpRequest){req=new XMLHttpRequest()}else if(window.ActiveXObject)req=new ActiveXObject('Microsoft.XMLHTTP');if(req){req.onreadystatechange=function(){if(req.readyState!=4)return;var reqStatus;try{reqStatus=req.status}catch(e){reqStatus=''};if(reqStatus!=200){callback(id,false,'HTTP')}else{var content_type=req.getResponseHeader("Content-Type");callback(id,true,req.responseText,content_type)}};try{req.open('GET',url,true);req.send(null)}catch(e){callback(id,false,'UNSUPPORTED')}}else callback(id,false,'UNSUPPORTED')};var FBCPN={},AGCPNEV={},AGCPNOC={}
function fb_got_CPNAG(junk,fbcpn_id,category,disp_cat_id,more_feat_avail,showing_all,has_hcaps,coupon_sort){var cpn={category:category,disp_cat_id:disp_cat_id,more_feat_avail:parseInt(more_feat_avail),showing_all:parseInt(showing_all),has_hcaps:parseInt(has_hcaps),coupon_sort:coupon_sort},coupon_id=fbcpn_id.slice(5,fbcpn_id.length);cpn.coupon_id=coupon_id;cpn.child_count=0;cpn.child_hash={};cpn.selected_selns_hash={};cpn.selected_count=0;cpn.previous_fave_bucket="";cpn.previous_tr="";FBCPN[fbcpn_id]=cpn;var table_el=document.createElement('div');table_el.id=fbcpn_id;table_el.className='fb_day_type_wrapper';table_el.appendChild(tbody_el);cpn.holder_el=document.getElementById(fbcpn_id+'_holder');cpn.holder_el.appendChild(table_el);cpn.tbody_el=tbody_el}
function fb_got_CPNEVAG(junk,fbcpn_id,fbcpnev_id,ev_id,ev_name,srt_date,srt_time,date_fmt,time_fmt,class_id,type_id,type_name,touchline,has_mbs,has_br_flag,stations,tv_icon,stream,coupon_sort,bet_in_run,live_now,url){var cpn=FBCPN[fbcpn_id];if(AGCPNEV[fbcpnev_id]){cpnev=AGCPNEV[fbcpnev_id]}else{var cpnev={id:fbcpnev_id,fbcpn_id:fbcpn_id,ev_id:ev_id,ev_name:ev_name,srt_date:srt_date,srt_time:srt_time,date_fmt:date_fmt,time_fmt:time_fmt,class_id:class_id,type_id:type_id,type_name:type_name,touchline:touchline,has_mbs:parseInt(has_mbs),has_br_flag:parseInt(has_br_flag),stations:stations,tv_icon:tv_icon,stream:stream,bet_in_run:bet_in_run,live_now:live_now};cpnev.child_hash={};cpn.child_hash[fbcpnev_id]=true;AGCPNEV[fbcpnev_id]=cpnev}}
function fb_got_CPNOCAG(junk,fbcpn_id,fbcpnev_id,fbcpnoc_id,ev_oc_id,oc_name,prc_str,lp_num,lp_den,hcap_str,hcap_val,tooltip,mult_key,team_name,fave_bucket){var cpn=FBCPN[fbcpn_id],cpnev=AGCPNEV[fbcpnev_id],cpnoc={id:fbcpnoc_id,fbcpn_id:fbcpn_id,fbcpnev_id:fbcpnev_id,ev_oc_id:ev_oc_id,oc_name:oc_name,prc_str:prc_str,lp_num:lp_num,lp_den:lp_den,hcap_str:hcap_str,hcap_val:hcap_val,tooltip:tooltip,mult_key:mult_key,team_name:team_name,fave_bucket:fave_bucket};cpn.child_count++;cpnev.child_hash[fbcpnoc_id]=true;AGCPNOC[fbcpnoc_id]=cpnoc;cpn.selected_selns_hash[fbcpnoc_id]=false;if(cpn.previous_fave_bucket!=fave_bucket){var tr_el=document.createElement('tr'),td_el=document.createElement('td'),strong_el=document.createElement('strong');td_el.className='bgGrey';td_el.colSpan=4;strong_el.appendChild(document.createTextNode(fb_data.xl_ag_fave+" "+fave_bucket));td_el.appendChild(strong_el);tr_el.appendChild(td_el);cpn.tbody_el.appendChild(tr_el)};var new_tr;if(cpn.child_count%2==1){var tr_el=document.createElement('tr');new_tr=true}else{var tr_el=cpn.previous_tr;new_tr=false};var td_el1=document.createElement('td'),td_el2=document.createElement('td');td_el1.className='label';td_el2.className='oddWrapper';td_el1.appendChild(document.createTextNode(oc_name+" ("+team_name+")"));var td_div_el=document.createElement('div');td_div_el.className='txt-center';var td_link_el=document.createElement('a');td_link_el.href='javascript:void(0)';var add_seln="fb_select_AG_seln('"+fbcpnoc_id+"');";td_el2.onclick=new Function(add_seln);td_link_el.innerHTML=prc_str;td_div_el.appendChild(td_link_el);td_el2.appendChild(td_div_el);tr_el.appendChild(td_el1);tr_el.appendChild(td_el2);if(new_tr)cpn.tbody_el.appendChild(tr_el);cpnoc.td_el=document.createElement("td");cpnoc.td_el=td_el2;cpn.previous_fave_bucket=fave_bucket;cpn.previous_tr=tr_el}
function fb_got_CPNENDAG(junk,fbcpn_id){var cpn=FBCPN[fbcpn_id],tr_el=document.createElement('tr'),td_el=document.createElement('td');td_el.className='total';td_el.colSpan=4;var div_left=document.createElement('div');div_left.className='left';var div_right=document.createElement('div');div_right.className='right';var total_stake_label=document.createElement('strong');total_stake_label.appendChild(document.createTextNode(fb_data.xl_ag_total_stake));var stake_input=document.createElement('input');stake_input.className="totalstake";stake_input.id=fbcpn_id+"_stake";stake_input.type="text";var stake_changed="fb_upd_AG_pot_winnings('"+fbcpn_id+"');fb_stake_changed('"+fbcpn_id+"_stake');";stake_input.onkeyup=new Function(stake_changed);stake_input.onfocus=new Function(stake_changed);stake_input.onkeypress=new Function(stake_changed);stake_input.onchange=new Function(stake_changed);var add_div=document.createElement('div');add_div.className='add-to-bs';var add_link=document.createElement('a');add_link.id=fbcpn_id+"_ag_place_bet";add_link.className='disabled';add_link.href='javascript:void(0)';add_link.innerHTML=fb_data.xl_ag_add_to_betslip;var pw_label_div=document.createElement('div');pw_label_div.className='pw';pw_label_div.appendChild(document.createTextNode(fb_data.xl_ag_pot_winnings));var pw_strong=document.createElement('strong');pw_strong.id=fbcpn_id+"_pw";pw_strong.appendChild(document.createTextNode("0.00"));add_div.appendChild(add_link);pw_label_div.appendChild(pw_strong);div_right.appendChild(add_div);div_right.appendChild(pw_label_div);div_left.appendChild(total_stake_label);div_left.appendChild(stake_input);td_el.appendChild(div_left);td_el.appendChild(div_right);tr_el.appendChild(td_el);cpn.tbody_el.appendChild(tr_el)}
function fb_select_AG_seln(fbcpnoc_id){var cpnoc=AGCPNOC[fbcpnoc_id],cpn=FBCPN[cpnoc.fbcpn_id];if(cpn.selected_selns_hash[fbcpnoc_id]){cpn.selected_selns_hash[fbcpnoc_id]=false;cpnoc.td_el.className='oddWrapper txt-center';cpn.selected_count--}else if(cpn.selected_count<3){cpn.selected_selns_hash[fbcpnoc_id]=true;cpnoc.td_el.className='oddWrapper txt-center bgGreen';cpn.selected_count++}else alert(fb_data.xl_ag_make_3_selns);fb_upd_AG_pot_winnings(cpnoc.fbcpn_id)}
function fb_place_AG_bet(fbcpn_id){var seln,cpn=FBCPN[fbcpn_id],stake=parseFloat(document.getElementById(fbcpn_id+'_stake').value);if(cpn.selected_count!=3)alert(fb_data.xl_ag_make_3_selns);for(var fbcpnoc_id in cpn.selected_selns_hash)if(cpn.selected_selns_hash[fbcpnoc_id]){seln=AGCPNOC[fbcpnoc_id];BS_set_leg('price_type','L');BS_set_leg('lp_num',seln.lp_num);BS_set_leg('lp_den',seln.lp_den);BS_set_leg('selections',seln.ev_oc_id);BS_set_leg('hcap_value',seln.hcap_val);BS_set_leg('bet_origin',cpn.coupon_sort+"_"+cpn.coupon_id);BS_select_bet(seln.ev_oc_id)};if(stake)BS_set_extra_info("acc_stake",stake);BS_go_bets()};var ABCPN={},ABCPNEV={},ABCPNOC={}
function fb_got_CPNAB(junk,fbcpn_id,category,disp_cat_id,has_hcaps,coupon_sort,min_matches,max_matches,builder_acc_max,builder_default_stake,builder_default_selections){var cpn={category:category,disp_cat_id:disp_cat_id,has_hcaps:parseInt(has_hcaps),coupon_sort:coupon_sort,min_matches:parseInt(min_matches),max_matches:parseInt(max_matches),builder_acc_max:parseInt(builder_acc_max),builder_default_stake:builder_default_stake,builder_default_selections:parseInt(builder_default_selections)};if(cpn.builder_default_selections>cpn.builder_acc_max)cpn.builder_default_selections=builder_acc_max;var coupon_id=fbcpn_id.slice(5,fbcpn_id.length);cpn.coupon_id=coupon_id;cpn.mult_keys={};cpn.cpnrows=[];cpn.selected_selections=0;ABCPN[fbcpn_id]=cpn}
function fb_got_CPNABROW(junk,fbcpn_id,fbcpnrow_id,ev_id,ev_name,srt_date,srt_time,date_fmt,time_fmt,class_id,type_id,type_name,touchline,stream,coupon_sort,bet_in_run,live_now,meets_builder_criteria,url){var cpn=ABCPN[fbcpn_id],cpnev={id:fbcpnrow_id,fbcpn_id:fbcpn_id,ev_id:ev_id,ev_name:ev_name,srt_date:srt_date,srt_time:srt_time,date_fmt:date_fmt,time_fmt:time_fmt,class_id:class_id,type_id:type_id,type_name:type_name,bet_in_run:bet_in_run,live_now:live_now,meets_builder_criteria:meets_builder_criteria,url:url};cpnev.sel={};cpnev.num_sel=0;var coupon_id=fbcpn_id.slice(5,fbcpn_id.length);ABCPNEV[fbcpnrow_id]=cpnev;cpn.cpnrows.push(cpnev);cpnev.srt_odds={}}
function fb_got_CPNABOC(junk,fbcpn_id,fbcpnrow_id,ev_oc_id,prc_str,lp_num,lp_den,hcap_str,hcap_val,tooltip,mult_key,builder,oc_name){var cpn=ABCPN[fbcpn_id],cpnev=ABCPNEV[fbcpnrow_id],sel_num=cpnev.num_sel;if(builder==1){cpnev.builder=sel_num;cpnev.selected=sel_num;cpnev.srt_odds["BUILDER"]=[lp_num,lp_den]};var price_type="L",placebet_builders="builders_set_leg('"+ev_oc_id+"','"+price_type+"','"+lp_num+"','"+lp_den+"','"+hcap_val+"',legs,stake,'"+cpn.coupon_sort+"_"+cpn.coupon_id+"');";if(cpnev.sel[sel_num]==undefined)cpnev.sel[sel_num]={};cpnev.sel[sel_num].ev_oc_id=ev_oc_id;cpnev.sel[sel_num].mult_key=mult_key;cpnev.sel[sel_num].tooltip=tooltip;cpnev.sel[sel_num].builder=builder;cpnev.sel[sel_num].pbet=placebet_builders;cpnev.sel[sel_num].oc_name=oc_name;cpnev.sel[sel_num].prc_str=prc_str;cpnev.sel[sel_num].price_dec=lp_num/lp_den+1;cpnev.num_sel++}
function fb_upd_AG_pot_winnings(fbcpn_id){var seln,price_dec,cpn=FBCPN[fbcpn_id],pot_win=parseFloat(document.getElementById(fbcpn_id+'_stake').value),pb_anchor=document.getElementById(fbcpn_id+"_ag_place_bet");if(cpn.selected_count!=3||!pot_win){pot_win=0}else for(var fbcpnoc_id in cpn.selected_selns_hash)if(cpn.selected_selns_hash[fbcpnoc_id]){seln=AGCPNOC[fbcpnoc_id];price_dec=seln.lp_num/seln.lp_den+1;pot_win=pot_win*price_dec};pot_win=cpn.ccy_symbol+BS_format_stake(pot_win);if(cpn.selected_count!=3){pb_anchor.onclick="";pb_anchor.className='disabled'}else{var place_bet="fb_place_AG_bet('"+fbcpn_id+"');";pb_anchor.onclick=new Function(place_bet);pb_anchor.className='enabled'};var pot_win_el=document.getElementById(fbcpn_id+"_pw");pot_win_el.innerHTML=pot_win}
function fb_builder_schedule_req_pot_winnings(fbcpn_id){document.PollingAjaxHelper.setTimeout("fb_builder_schedule_req_pot_winnings",function(){calculate_builder_stake(fbcpn_id)},1e3)}
function fb_builder_req_pot_winnings(fbcpn_id){var cpn=FBCPN[fbcpn_id],num_selns=cpn.builder_counter;if(num_selns==0){var ret_el=document.getElementById(fbcpn_id+"_builder_tot_returns");ret_el.innerHTML="0.00";ret_el.title="";return};var stake=document.getElementById(fbcpn_id+"_builder_stake").value;if(stake==""){stake=0}else{var stake=parseFloat(stake);if(!stake&&stake!=0)return};var bet_type_select=document.getElementById(fbcpn_id+"_builder_bet_types"),bet_type=(bet_type_select.options[bet_type_select.selectedIndex].value);stake=BS_format_stake(stake);var price_list="";for(fbcpnrow_id in cpn.builder_shown)if(cpn.builder_highlights[fbcpnrow_id]!=undefined){var cpnrow=FBCPNROW[fbcpnrow_id],i=cpn.builder_highlights[fbcpnrow_id],price=cpnrow.builder[i].price_dec;if(price_list==""){price_list=price}else price_list+="|"+price};var url=tld+'?action=fb_coupon_get_potential_winnings&stake_per_line='+stake+'&prices='+price_list+'&bet_type='+bet_type;fb_simple_ajax_request(url,fbcpn_id,fb_builder_set_pot_winnings)}
function fb_builder_set_pot_winnings(fbcpn_id,ok,response,content_type){var cpn=FBCPN[fbcpn_id],return_el=document.getElementById(fbcpn_id+"_builder_tot_returns");if(return_el==null)return;if(!ok){return_el.innerHTML=cpn.ccy_symbol+"0.00"}else if(response!=""){resp_split=response.split('|');return_el.innerHTML=resp_split[0]+BS_format_stake(resp_split[1]);return_el.title=fb_data.xl_ag_min_winnings+" "+BS_format_stake(resp_split[2])}else{return_el.innerHTML=cpn.ccy_symbol+"0.00";return_el.title=""}}
function build_builders_options(fbcpn_id){var cpn=ABCPN[fbcpn_id],valid_events_num=calculate_valid_builder_tool_events_num(fbcpn_id);if(cpn.builder_acc_max!=""){var builder_acc_max=cpn.builder_acc_max}else var builder_acc_max=99999;if(cpn.builder_default_selections!=""){var builder_default_selections=cpn.builder_default_selections}else var builder_default_selections=99999;var num_options=Math.min(valid_events_num,builder_acc_max),accumulator_selns_sel=document.getElementById('accumulator_selns_sel'),opt=new Option("All",num_options);opt.className="banker-option-values";accumulator_selns_sel.options[0]=opt;for(var option=1;option<=num_options;option++){var opt=new Option(option,option);opt.className="banker-option-values";accumulator_selns_sel.options[accumulator_selns_sel.options.length]=opt}}
function build_builder_bet_types(fbcpn_id){var cpn=ABCPN[fbcpn_id],num_selns_container=document.getElementById(fbcpn_id+"_builder_bet_types_container"),num_selns_select=document.getElementById(fbcpn_id+"_builder_bet_types");num_selns_container.removeChild(num_selns_select);var sel_el=bet_types[cpn.selected_selections];num_selns_container.appendChild(sel_el)}
function build_builder_tool(fbcpn_id){var cpn=ABCPN[fbcpn_id],cpnrows=cpn.cpnrows;cpn.builder_shown={};var func=function(){calculate_tool_builder_stake(fbcpn_id)};document.getElementById("accumulator_cpn_stk").onkeyup=func;var accumulator_selns_sel=document.getElementById('accumulator_selns_sel'),accumulator_cpnrows=document.getElementById('accumulator_cpnrows'),tmpl=[];tmpl.push('		<li>');tmpl.push('			<span class="event-name">');tmpl.push('				<span class="bold"><% trunc_string(ev_name, accum_builder_truncate_ev_length, \'...\')%></span>');tmpl.push('				<%IF ev_name != trunc_string(ev_name, accum_builder_truncate_ev_length, \'...\') %>');tmpl.push('					<span class="tooltip"><%ev_name%></span>');tmpl.push('				<%END%>');tmpl.push('			</span>');tmpl.push('			<div class="accumulator-horizontal-select">');tmpl.push('				<a <%IF num_sel > 1 %>onclick="toggle_build_tool_selections(\'<%fbcpn_id%>\',\'<%id%>\',\'left\');"<%END%> class="ahs-left<%IF num_sel == 1 %> one-selection-available<%END%>" href="javascript:void(0);"></a>');tmpl.push('					<%LOOP i num_sel%>');tmpl.push('						<span <%IF i != selected %>style="display:none;"<%END%> id="<%id%>__<%i%>" class="ahs-name"><%trunc_string(sel[i].oc_name, accum_builder_truncate_sel_length, \'...\')%></span>');tmpl.push('						<%IF sel[i].oc_name != trunc_string(sel[i].oc_name, accum_builder_truncate_sel_length, \'...\') %>');tmpl.push('							<span id="<%id%>__<%i%>_tooltip" <%IF i != selected %>style="display:none;" <%ELSE%>class="tooltip"<%END%> ><%sel[i].oc_name%></span>');tmpl.push('						<%END%>');tmpl.push('					<%END%>');tmpl.push('				<a <%IF num_sel > 1 %>onclick="toggle_build_tool_selections(\'<%fbcpn_id%>\',\'<%id%>\',\'right\');"<%END%> class="ahs-right<%IF num_sel == 1 %> one-selection-available<%END%>" href="javascript:void(0);"></a>');tmpl.push('			</div>');tmpl.push('			<div class="accumulator-odds" id="<%id%>__<%i%>_tog">');tmpl.push('				<%LOOP i num_sel%>');tmpl.push('					<a <%IF i != selected %>style="display:none;"<%END%> id="<%id%>__<%i%>_odds" href="javascript:void(0);" onclick="update_builder_checkbox(event, \''+fbcpn_id+'\',\'<%id%>\');" class="odds_clicked"><%sel[i].prc_str%></a>');tmpl.push('				<%END%>');tmpl.push('				<span class="cbox" rel="'+fbcpn_id+'|<%id%>">');tmpl.push('					<input type="checkbox" class="type_chk_box" checked="" id="<%id%>__builder_tool_checked">');tmpl.push('				</span>');tmpl.push('			</div>');tmpl.push('		</li>');tmpl_store("ac_bl_ev_selns",tmpl.join("\n"));var added_num=0,valid_sel_num=9999;valid_sel_num=calculate_valid_builder_tool_events_num(fbcpn_id);var num_selns=parseInt(accumulator_selns_sel.options[accumulator_selns_sel.selectedIndex].value);accumulator_cpnrows.innerHTML="";cpn.builder_shown={};cpn.mult_keys=new Array();for(var i=0;i<cpnrows.length&&added_num<num_selns&&added_num<valid_sel_num;i++){var cpnrow=cpnrows[i],loc_mult_key="";loc_mult_key=cpnrow.sel[cpnrow.builder].mult_key;if(loc_mult_key!=""){if(cpn.mult_keys[loc_mult_key]!=loc_mult_key){cpn.mult_keys[loc_mult_key]=loc_mult_key;if(cpnrow.meets_builder_criteria==1){cpn.builder_shown[cpnrow.id]=cpnrow.id;var rand_selected=Math.floor((Math.random()*cpnrow.num_sel));cpnrow.selected=rand_selected;var html=tmpl_play("ac_bl_ev_selns",cpnrows[i]);accumulator_cpnrows.innerHTML+=html;added_num++}}}else if(cpnrow.meets_builder_criteria==1){cpn.builder_shown[cpnrow.id]=cpnrow.id;var rand_selected=Math.floor((Math.random()*cpnrow.num_sel));cpnrow.selected=rand_selected;var html=tmpl_play("ac_bl_ev_selns",cpnrows[i]);accumulator_cpnrows.innerHTML+=html;added_num++}};cpn.selected_selections=added_num;calculate_tool_builder_stake(fbcpn_id);styleCheckbox("accumulator-odds",false);tooltip_init()}
function toggle_build_tool_selections(fbcpn_id,id,direction){var cpn=ABCPN[fbcpn_id],row={};for(i=0;i<cpn.cpnrows.length;i++)if(cpn.cpnrows[i].id==id){row=cpn.cpnrows[i];break};var num_sel=row.num_sel;if(num_sel==1)return;var selected=-1;for(i=0;i<num_sel;i++){var elem=document.getElementById(id+"__"+i);if(elem.style.display==''){selected=i;break}};if(direction=='left'){selected--;if(selected<0)selected=num_sel-1}else if(direction=='right'){selected++;if(selected>=num_sel)selected=0};row.selected=selected;for(i=0;i<num_sel;i++){var elem_sel=document.getElementById(id+"__"+i),elem_odds=document.getElementById(id+"__"+i+"_odds"),elem_tooltip=document.getElementById(id+"__"+i+"_tooltip");if(i==selected){elem_sel.style.display='';elem_odds.style.display='';if(elem_tooltip){elem_tooltip.style.display='';elem_tooltip.className='tooltip'}}else{elem_sel.style.display='none';elem_odds.style.display='none';if(elem_tooltip){elem_tooltip.style.display='none';elem_tooltip.className=''}}};calculate_tool_builder_stake(fbcpn_id);tooltip_init()}
function calculate_valid_builder_tool_events_num(fbcpn_id){var cpn=ABCPN[fbcpn_id],valid_rows=0,cpnrows=cpn.cpnrows,mult_keys=new Array();for(var i=0;i<cpnrows.length;i++){var cpnrow=cpnrows[i],fbcpnrow_id=cpnrow.id;if(cpnrow.builder!=undefined){var loc_mult_key=cpnrow.sel[cpnrow.builder].mult_key;if(loc_mult_key!=""){if(mult_keys[loc_mult_key]!=loc_mult_key){mult_keys[loc_mult_key]=loc_mult_key;if(cpnrow.meets_builder_criteria==1)valid_rows++}}else if(cpnrow.meets_builder_criteria==1)valid_rows++}};if(cpn.max_matches<valid_rows){return cpn.max_matches}else return valid_rows}
function toggle_build_tool_selection(fbcpnrow_id,cur_sel,next_sel){var cpnrow=ABCPNEV[fbcpnrow_id],cpn=ABCPN[cpnrow.fbcpn_id];if(cpnrow.selected!=cur_sel)return;var curr_sel=cpnrow.sel[cur_sel],current_mult_key="";current_mult_key=curr_sel.mult_key;var direction=0;if(next_sel==0){if(cur_sel==1){direction=-1}else if(cur_sel==(cpnrow.num_sel-1))direction=1}else direction=next_sel-cur_sel;if(current_mult_key!="")cpn.mult_keys.unset(current_mult_key);var selection_to_check="";selection_to_check=next_sel;while(true){var selection;selection=cpnrow.sel[selection_to_check];var loc_mult_key="";loc_mult_key=selection.mult_key;if(loc_mult_key==""){cpnrow.selected=selection_to_check;var old_sel=document.getElementById(fbcpnrow_id+"_"+cur_sel);old_sel.style.display="none";var new_sel=document.getElementById(fbcpnrow_id+"_"+selection_to_check);new_sel.style.display="block";fb_builder_tool_req_pot_winnings(cpnrow.fbcpn_id);return}else if(cpn.mult_keys[loc_mult_key]!=loc_mult_key){cpn.mult_keys[loc_mult_key]=loc_mult_key;cpnrow.selected=selection_to_check;var old_sel=document.getElementById(fbcpnrow_id+"_"+cur_sel);old_sel.style.display="none";var new_sel=document.getElementById(fbcpnrow_id+"_"+selection_to_check);new_sel.style.display="block";fb_builder_tool_req_pot_winnings(cpnrow.fbcpn_id);return};if(selection_to_check==0&&direction==-1){selection_to_check=cpnrow.num_sel-1}else if(selection_to_check==(cpnrow.num_sel-1)&&direction==1){selection_to_check=0}else selection_to_check+=direction}}
function update_builder_checkbox(e,fbcpn_id,fbcpnrow_id){if(!e)var e=window.event||event;var target=e.srcElement||e.target,cpn=ABCPN[fbcpn_id],checkbox=document.getElementById(fbcpnrow_id+"__builder_tool_checked");if(target.className=="odds_clicked"){var inp=checkbox,sp=inp.parentNode;if(inp.className==="type_chk_box"){if((safari&&inp.checked==true||inp.checked)){sp.className='cbox check c_off';inp.checked=false}else{sp.className='cbox check c_on';inp.checked=true}}else{if((safari&&inp.checked==true||inp.checked)){sp.className='cbox check c_off'}else sp.className='cbox check c_on';inp.click()}};if(checkbox.checked==true){cpn.selected_selections++}else cpn.selected_selections--;calculate_tool_builder_stake(fbcpn_id)}
function place_builder_bets_tool(fbcpn_id,max){var cpn=ABCPN[fbcpn_id],num_selns=cpn.builder_shown.length;if(num_selns==0)return;var stake=document.getElementById("accumulator_cpn_stk").value;if(max!="max")if(stake==""){stake=0.0}else{stake=parseFloat(stake);if(!stake&&stake!=0)return};var sel_el=bet_types[cpn.selected_selections];sel_el.selectedIndex=0;var bet_type=sel_el.options[sel_el.selectedIndex].value;stake=BS_format_stake(stake);if(max=="max")stake="MAX";var pb_func="",legs=0;if(num_selns>cpn.builder_acc_max)num_selns=cpn.builder_acc_max;for(fbcpnrow_id in cpn.builder_shown){var checkbox=document.getElementById(fbcpnrow_id+"__builder_tool_checked");if(checkbox.checked){var cpnrow=ABCPNEV[fbcpnrow_id],i=cpnrow.selected;pb_func+=cpnrow.sel[i].pbet;legs++}};eval(pb_func);if(legs>1)BS_set_extra_info("bettype_stake",bet_type+"|"+stake);BS_go_bets()}
function fb_builder_tool_req_pot_winnings(fbcpn_id){var cpn=ABCPN[fbcpn_id],num_selns=cpn.builder_shown.length;if(num_selns==0){var ret_el=document.getElementById(accumulator_cpn_rtns);ret_el.value="0.00";return};var stake=document.getElementById("accumulator_cpn_stk").value;if(stake==""){stake=0}else{var stake=parseFloat(stake);if(!stake&&stake!=0)return};stake=BS_format_stake(stake);var price_list="";for(fbcpnrow_id in cpn.builder_shown){var checkbox=document.getElementById(fbcpnrow_id+"__builder_tool_checked");if(checkbox.checked){var cpnrow=ABCPNEV[fbcpnrow_id],i=cpnrow.selected,price=cpnrow.sel[i].price_dec;if(price_list==""){price_list=price}else price_list+="|"+price}};var sel_el=bet_types[cpn.selected_selections];sel_el.selectedIndex=0;var bet_type=sel_el.options[sel_el.selectedIndex].value;if(price_list!=""&&bet_type!=""){var url=tld+'?action=fb_coupon_get_potential_winnings&stake_per_line='+stake+'&prices='+price_list+'&bet_type='+bet_type;fb_simple_ajax_request(url,fbcpn_id,fb_builder_tool_set_pot_winnings)}else fb_builder_tool_set_pot_winnings(fbcpn_id,false,null,null)}
function fb_builder_tool_set_pot_winnings(fbcpn_id,ok,response,content_type){var cpn=ABCPN[fbcpn_id],return_el=document.getElementById("accumulator_cpn_rtns");if(return_el==null)return;if(!ok){return_el.innerHTML=cpn.ccy_symbol+"0.00"}else if(response!=""){resp_split=response.split('|');acummAnimationVars._currency_symbol=cpn.ccy_symbol;acummAnimationVars._inpt_field=document.getElementById("accumulator_cpn_rtns");updateReturns(parseFloat(resp_split[1]),cpn.ccy_symbol)}else return_el.innerHTML=cpn.ccy_symbol+"0.00"}
function fb_builder_tool_schedule_req_pot_winnings(fbcpn_id){document.PollingAjaxHelper.setTimeout("fb_builder_tool_schedule_req_pot_winnings",function(){calculate_tool_builder_stake(fbcpn_id)},1e3)}
function fb_stake_changed(box_id){var el=document.getElementById(box_id),s=el.value,re=/(^[0-9]{0,8}(\.[0-9]{0,2})?)/,mtch=s.match(re),good;if(mtch.length){good=mtch[0]}else good='';if(good!=s)el.value=good}
function fb_bank_set_stake(cpnId,val){if(!isNaN(val))document.getElementById("fbcpn"+cpnId+"_banker_stake").value=val;build_banker_tool('fbcpn'+cpnId)}
function fb_banker_input_val(cpnId,input){if(isNaN(input.value)){var validChars=[];for(i=0;i<input.value.length;i++){var vchar=input.value.substring(i,i+1);if(!isNaN(vchar))validChars.push(vchar)};input.value=validChars.join("");input.focus();return false}else{build_banker_tool('fbcpn'+cpnId);return true}}
function fb_hide_mkts_off(fbcpn_id,cutoff,proc_id,arg_id,handle_buttons){var child_nodes=$j(document.getElementById(fbcpn_id)).children('div'),child_count=child_nodes.length;for(var i=cutoff;i<child_count;i++)child_nodes[i].style.display='none';if(handle_buttons){document.getElementById(fbcpn_id+'_hide_mo').style.display='none';document.getElementById(fbcpn_id+'_show_mo').style.display=''};removeExpandedMarketPageCookie(proc_id,arg_id)}
function fb_show_mkts_off(fbcpn_id,cutoff,proc_id,arg_id){var child_nodes=$j(document.getElementById(fbcpn_id)).children('div'),child_count=child_nodes.length;for(var i=cutoff;i<child_count;i++)child_nodes[i].style.display='';document.getElementById(fbcpn_id+'_hide_mo').style.display='';document.getElementById(fbcpn_id+'_show_mo').style.display='none';addExpandedMarketPageCookie(proc_id,arg_id)};var gebtn=function(parEl,child){return parEl.getElementsByTagName(child)},safari=(navigator.userAgent.toLowerCase().indexOf('safari')!=-1)?true:false;styleCheckbox=function(id){var el=document.getElementById(id);if(!el)return;var ls=gebtn(el,'input');for(var i=0;i<ls.length;i++){var l=ls[i];if(l.getAttribute('type')=='checkbox'){sp=l.parentNode;sp.className=((safari&&l.checked==true)||l.checked)?'cbox check c_on':'cbox check c_off';sp.onclick=check_it}}};var check_it=function(ev){var inp=gebtn(this,'input')[0],sp=inp.parentNode,params=new Array();if(sp.getAttribute('rel'))params=sp.getAttribute('rel').split('|');if(params[0])fbcpn_id=params[0];if(params[1])fbcpnrow_id=params[1];if(inp.className==="type_chk_box"){if((safari&&inp.checked==true||inp.checked)){sp.className='cbox check c_off';inp.checked=false}else{sp.className='cbox check c_on';inp.checked=true}}else{if((safari&&inp.checked==true||inp.checked)){sp.className='cbox check c_off'}else sp.className='cbox check c_on';inp.click()};if(params[0]&&params[1])update_builder_checkbox(ev,fbcpn_id,fbcpnrow_id)}
function _fb_get_price_str(cfg,lp_num,lp_den,lp_avail,mkt_sort){if(typeof lp_avail=="undefined")lp_avail="Y";if(typeof mkt_sort=="undefined")mkt_sort="--";var price_str_type=cfg.price_str_type;if(mkt_sort=="AH"&&cfg.price_str_type_ah!="")price_str_type=cfg.price_str_type_ah;if(mkt_sort=="HL"&&cfg.price_str_type_hl!="")price_str_type=cfg.price_str_type_hl;if(lp_avail=="N")return"SP";if(lp_num==""&&lp_den=="")return"-";var price_str;if(price_str_type=="DECIMAL"){var dps=(lp_den>100)?3:2,dp=1.0+(lp_num/lp_den),scaled_dp=""+Math.round(dp*Math.pow(10,dps)-0.5),int_part=scaled_dp.substr(0,scaled_dp.length-dps),frac_part=scaled_dp.substr(scaled_dp.length-dps);if(int_part=="")int_part="";if(frac_part=="")frac_part="";var price_str=int_part+"."+frac_part}else{if(lp_den=="")lp_den=1;if(lp_num==lp_den){price_str="evens"}else price_str=lp_num+cfg.price_str_sep+lp_den};return price_str}
function fbm_add_mouseovers(parent_el){if(parent_el==null)parent_el=document;var class_re=/(^| )fbhlt($| )/,overF=new Function("fb_hlt_cell(this,true)"),outF=new Function("fb_hlt_cell(this,false)"),cells=parent_el.getElementsByTagName('td');for(var i=0;i<cells.length;i++){var cell=cells[i];if(cell.className.match(class_re)!=null&&cells[i].onmouseover==null){cell.onmouseover=overF;cell.onmouseout=outF}}}
function fbm_bet(ev_oc_id,lp_num,lp_den,hcap_value,origin,t){if(t&&t.parentNode&&t.parentNode.className.indexOf('suspended')>=0)return;BS_set_leg('price_type','L');BS_set_leg('lp_num',lp_num);BS_set_leg('lp_den',lp_den);BS_set_leg('selections',ev_oc_id);BS_set_leg('hcap_value',hcap_value);BS_set_leg('bet_origin',origin);BS_go_bet();return}
function fbm_multi_bet(selections,origin){for(var i=0;i<selections.length;i++){var seln=selections[i];BS_set_leg('price_type','L');BS_set_leg('lp_num',seln.lp_num);BS_set_leg('lp_den',seln.lp_den);BS_set_leg('selections',seln.ev_oc_id);BS_set_leg('hcap_value',seln.hcap_value);BS_set_leg('bet_origin',origin);BS_select_bet(seln.ev_oc_id)};BS_go_bets();return}
function fbm_toggle(id){var div_element=document.getElementById('div_'+id),span_element=document.getElementById('span_'+id);if(div_element.style.display=='none'){div_element.style.display='block';span_element.innerHTML=fb_data.xl_hide;span_element.className='remove'}else{div_element.style.display='none';span_element.innerHTML=fb_data.xl_show;span_element.className='show'};return}
function fbcpn_cleanup_data(fbcpn_id){if(FBCPN[fbcpn_id]!=null){var cpn=FBCPN[fbcpn_id];FBCPN[fbcpn_id]=null;for(var i=0;i<cpn.row_ids.length;i++)FBCPNROW[cpn.row_ids[i]]=null;cpn=null}}
function fbcpn_sort(fbcpn_id,sort_by){var cpn=FBCPN[fbcpn_id];cpn.sort_dirs[sort_by]=cpn.sort_dirs[sort_by]*-1;if(cpn.sort_dirs[sort_by]==0)cpn.sort_dirs[sort_by]=1;for(var i=0;i<cpn.col_keys.length;i++){var col_key=cpn.col_keys[i];if(col_key!=sort_by)cpn.sort_dirs[col_key]=0};if(sort_by!='TIME')cpn.sort_dirs['TIME']=0;var sort_dir=cpn.sort_dirs[sort_by];for(var j=0;j<cpn.tbodies.length;j++){var tbody=cpn.tbodies[j],domrows_by_id=[],cpnrows=[];for(var i=0;i<tbody.rows.length;i++){var domrow=tbody.rows[i],fbcpnrow_id=domrow.id,cpnrow=FBCPNROW[fbcpnrow_id];if(cpnrow==null){continue}else{cpnrows.push(cpnrow);domrows_by_id[fbcpnrow_id]=domrow}};cpnrows.sort(function(a,b){return fbcpn_cmp_rows(sort_by,sort_dir,a,b)});while(tbody.childNodes.length)tbody.removeChild(tbody.childNodes[tbody.childNodes.length-1]);cpn.prev_row_date='';for(var i=0;i<cpnrows.length;i++){var cpnrow=cpnrows[i],fbcpnrow_id=cpnrow.id;tbody.appendChild(domrows_by_id[fbcpnrow_id])}};var time_sort_dir=cpn.sort_dirs['TIME'];if(time_sort_dir!=0&&time_sort_dir!=cpn.date_sort_dir){cpn.date_sort_dir=time_sort_dir;if(cpn.tbodies.length>1){var prev_table=cpn.tbodies[0].parentNode,table_parent=prev_table.parentNode;for(var i=1;i<cpn.tbodies.length;i++){var table=cpn.tbodies[i].parentNode;table_parent.removeChild(table);table_parent.insertBefore(table,prev_table);prev_table=table}};cpn.tbodies.reverse()};fbcpn_upd_sort_indicators(fbcpn_id)}
function fb_hlt_cell(td_el,on){var classes=td_el.className;if(classes.match(/(^| )bgGreen($| )/)==null){if(on)td_el.className+=' bgGreen'}else if(!on)td_el.className=classes.replace(/(^| )bgGreen($| )/,' ');var links=td_el.getElementsByTagName('a');for(var i=0;i<links.length;i++){var link_el=links[i],classes=link_el.className;if(classes.match(/(^| )white($| )/)==null){if(on)link_el.className+=' white'}else if(!on)link_el.className=classes.replace(/(^| )white($| )/,' ')};var spans=td_el.getElementsByTagName('span');for(var i=0;i<spans.length;i++){var span_el=spans[i],classes=span_el.className;if(classes.match(/(^| )fbtip_outer($| )/)!=null)if(on){span_el.style.display='block'}else span_el.style.display='none'}}
function fb_hide_show_accumulator_build_tool(){var build_tool_el=document.getElementById('fb_accu_hide'),tt_el=document.getElementById('fb_accu_tt'),header_el=document.getElementById('fb_accu_header');if(build_tool_el.style.display==""){build_tool_el.style.display="none";header_el.setAttribute("class","fb-market-wrapper fb-closed");tt_el.innerHTML=banker_expand_text}else{build_tool_el.style.display="";header_el.setAttribute("class","fb-market-wrapper");tt_el.innerHTML=banker_collapse_text}}
function fb_coupon_area_nav_toggle_navigation(tab,num_collapsed){if(tab==current_tab){return}else if(tab=="COMP"){document.getElementById('fb_nav_competitions_button').className='default-tab active';document.getElementById('fb_nav_markets_button').className='default-tab';document.getElementById('fb_nav_coupons_button').className='default-tab';document.getElementById('fb_nav_competitions').style.display='';document.getElementById('fb_nav_markets').style.display='none';document.getElementById('fb_nav_coupons').style.display='none';document.getElementById('fb_nav_markets_show_mo').style.display='none';document.getElementById('fb_nav_markets_hide_mo').style.display='none';document.getElementById('fb_nav_coupons_show_mo').style.display='none';document.getElementById('fb_nav_coupons_hide_mo').style.display='none';if(checkExpandedMarketPageCookie('FB','COMP')){document.getElementById('fb_nav_competitions_show_mo').style.display='none';document.getElementById('fb_nav_competitions_hide_mo').style.display=''}else{document.getElementById('fb_nav_competitions_show_mo').style.display='';document.getElementById('fb_nav_competitions_hide_mo').style.display='none'};current_tab='COMP'}else if(tab=="MKT"){document.getElementById('fb_nav_competitions_button').className='default-tab';document.getElementById('fb_nav_markets_button').className='default-tab active';document.getElementById('fb_nav_coupons_button').className='default-tab';document.getElementById('fb_nav_competitions').style.display='none';document.getElementById('fb_nav_markets').style.display='';document.getElementById('fb_nav_coupons').style.display='none';document.getElementById('fb_nav_competitions_show_mo').style.display='none';document.getElementById('fb_nav_competitions_hide_mo').style.display='none';document.getElementById('fb_nav_coupons_show_mo').style.display='none';document.getElementById('fb_nav_coupons_hide_mo').style.display='none';if(num_markets>num_collapsed){if(checkExpandedMarketPageCookie('FB','MKT')){document.getElementById('fb_nav_markets_show_mo').style.display='none';document.getElementById('fb_nav_markets_hide_mo').style.display=''}else{document.getElementById('fb_nav_markets_show_mo').style.display='';document.getElementById('fb_nav_markets_hide_mo').style.display='none'}}else{document.getElementById('fb_nav_markets_show_mo').style.display='none';document.getElementById('fb_nav_markets_hide_mo').style.display='none'};current_tab='MKT'}else{document.getElementById('fb_nav_competitions_button').className='default-tab';document.getElementById('fb_nav_markets_button').className='default-tab';document.getElementById('fb_nav_coupons_button').className='default-tab active';document.getElementById('fb_nav_competitions').style.display='none';document.getElementById('fb_nav_markets').style.display='none';document.getElementById('fb_nav_coupons').style.display='';document.getElementById('fb_nav_competitions_show_mo').style.display='none';document.getElementById('fb_nav_competitions_hide_mo').style.display='none';document.getElementById('fb_nav_markets_show_mo').style.display='none';document.getElementById('fb_nav_markets_hide_mo').style.display='none';if(checkExpandedMarketPageCookie('FB','CPN')){document.getElementById('fb_nav_coupons_show_mo').style.display='none';document.getElementById('fb_nav_coupons_hide_mo').style.display=''}else{document.getElementById('fb_nav_coupons_show_mo').style.display='';document.getElementById('fb_nav_coupons_hide_mo').style.display='none'};current_tab='CPN'}}
function fb_ev_mkts_off_showDD(ob,objId){var $el=jQuery("#"+objId);if(!$el)return;if($el.hasClass('hidden')){$el.slideDown(100).removeClass('hidden')}else $el.slideUp(100).addClass('hidden')}
function fb_ev_mkts_off_play_form_iframe(url,id){document.getElementById('view_all_ctgs_'+id+'_0').style.display='none';document.getElementById('view_all_mkts_'+id+'_0').style.display='none';document.getElementById('view_all_ctgs_'+id+'_1').style.display='none';document.getElementById('view_all_mkts_'+id+'_1').style.display='none';jQuery("#dd-results").addClass("hidden").hide();jQuery('.football_filter li').removeClass('active');jQuery(".dd-tab").addClass("active");document.getElementById("content_ctgs_"+id).style.display="none";document.getElementById("content_mkts_"+id).style.display="none";var iframe_div=document.getElementById("content_iframe_"+id);url+="&eventid="+id;iframe_div.innerHTML="<iframe id='fb_team-iframe-"+id+"' src='"+url+"' style='width:100%' frameborder='0' scrolling='no'></iframe>";iframe_div.style.display="block"}
function fb_ev_mkts_off_play_form_popup(url){jQuery("#dd-results").addClass("hidden").hide();var newwindow=window.open(url,'ViewAllStats','scrollbars=1,height=721 width=730,left=10,top=10,titlebar=0,status=0,toolbar=0,menubar=0,location=0,resizable=yes');if(window.focus)newwindow.focus();return false}
function fb_wallchart_toggle_content(button){var wrapperDiv=button.closest('div.fb-market-wrapper'),hlink=wrapperDiv.find('a.collapse-expand');if(wrapperDiv.hasClass('fb-closed')){wrapperDiv.find('div.fb-market-content, div.fb-sub-content').show();hlink.find('.button-text').text(fb_wallchart_collapse_txt);hlink.find('.tooltip').text(fb_wallchart_collapse_tt_txt);wrapperDiv.removeClass('fb-closed');wrapperDiv.find('div.sub-hdr').removeClass('fb-closed');wrapperDiv.find('div.sub-hdr').next().show()}else{wrapperDiv.find('div.fb-market-content').hide();hlink.find('.button-text').text(fb_wallchart_expand_txt);hlink.find('.tooltip').text(fb_wallchart_expand_tt_txt);wrapperDiv.addClass('fb-closed');wrapperDiv.find('div.sub-hdr').addClass('fb-closed');wrapperDiv.find('div.sub-hdr').next().hide()}};var nav_tabs_loaded={},selected_nav_tab={}
function changeNavTab(nav_tab_id,link,navID,ev_type_id){if(nav_tabs_loaded[nav_tab_id]['nav_'+navID]);else loadContentNavTab(nav_tab_id,navID,ev_type_id);var nav_tab_header_el=document.getElementById('list_'+nav_tab_id+'_'+selected_nav_tab[nav_tab_id]);nav_tab_header_el.className='';var nav_tab_el=document.getElementById('fb_tab_'+nav_tab_id+'_nav_'+selected_nav_tab[nav_tab_id]+'_container');nav_tab_el.style.display='none';nav_tab_header_el=document.getElementById('list_'+nav_tab_id+'_'+navID);nav_tab_header_el.className='active';nav_tab_el=document.getElementById('fb_tab_'+nav_tab_id+'_nav_'+navID+'_container');nav_tab_el.style.display='block';selected_nav_tab[nav_tab_id]=navID}
function loadContentNavTab(nav_tab_id,navID,ev_type_id){var url=nav_tab_url+"?action=get_nav_subtab&tab_id="+nav_tab_id+"&nav_type_id="+ev_type_id+"&nav_id="+navID,int_id="fb_tab_"+nav_tab_id+"_nav_"+navID+"container",clientdata={nav_tab_id:nav_tab_id,id:int_id,nav_id:navID};_lb_fb_nav_make_ajax_get_request(url,clientdata,_lb_fb_nav_got_ajax_content)}
function _lb_fb_nav_make_ajax_get_request(url,clientdata,callback){if(document.PollingAjaxHelper.checkSemaphore()){document.PollingAjaxHelper.setTimeout("_lb_fb_nav_make_ajax_get_request",function(){_lb_fb_nav_got_ajax_content(url,clientdata,callback)},300);return};document.PollingAjaxHelper.aquireSemaphore();var req=null;if(window.XMLHttpRequest){req=new XMLHttpRequest()}else if(window.ActiveXObject)req=new ActiveXObject('Microsoft.XMLHTTP');if(req){req.onreadystatechange=function(){if(req.readyState!=4)return;var reqStatus;try{reqStatus=req.status}catch(e){reqStatus=''};if(reqStatus!=200){document.PollingAjaxHelper.releaseSemaphore();callback(url,clientdata,false,'HTTP')}else{document.PollingAjaxHelper.releaseSemaphore();nav_tabs_loaded[clientdata.nav_tab_id]['nav_'+clientdata.nav_id]=true;callback(url,clientdata,true,req.responseText)}};try{req.open('GET',url,true);req.send(null)}catch(e){document.PollingAjaxHelper.releaseSemaphore();callback(url,clientdata,false,'UNSUPPORTED')}}else{document.PollingAjaxHelper.releaseSemaphore();callback(url,clientdata,false,'UNSUPPORTED')}}
function _lb_fb_nav_got_ajax_content(url,clientdata,ok,response){var holder_el=document.getElementById(clientdata.id);if(ok){if(response=="")return;var parts=_lb_fb_nav_parse_script_tags(response);if(holder_el)holder_el.innerHTML=parts[0];if(parts[1].length)try{_lb_fb_nav_global_eval(parts[1])}catch(e){ok=false}}}
function _lb_fb_nav_parse_script_tags(str){var html='',js='',i=0,state='HTML',script_re=new RegExp('<(/?)script([^>]*)>','gi');while((mtch=script_re.exec(str))!=null){mS=mtch.index;if(state=='HTML'){html+=str.substring(i,mS)}else js+=str.substring(i,mS)+';\n';var closer=mtch[1],attrs=mtch[2];if(closer=='/'){state='HTML'}else if(attrs.charAt(attrs.length-1)!='/'&&attrs.indexOf('src=')==-1)state='JS';i=script_re.lastIndex};if(state=='HTML'){html+=str.substring(i)}else js+=str.substring(i);return[html,js]};var _lb_fb_nav_global_eval=function(src){if(window.execScript){window.execScript(src);return};var fn=function(){window.eval.call(window,src)};fn()},start_now_clicked=0,lower_acc_fav_text="",lower_acc_url=""
function MyMatches(cfg){jQuery().ready(function(){jQuery("#select-your-favourites-modal").dialog({autoOpen:false,height:470,width:580,modal:true,title:lower_acc_fav_text,closeText:"Cancel",dialogClass:'select-your-favourite',zIndex:10001,buttons:{},close:reset});jQuery(document).on('click','.open_modal',function(ev){ev.preventDefault();styleCheckbox("select-your-favourites-modal",true);if(start_now_clicked===0){start_now_clicked=1;jQuery("#select-your-favourites-modal").dialog("open")}});jQuery(document).on('click','.syf-filter-list',function(){filterTypes(jQuery(this).text());selectLetter(jQuery(this))});jQuery(document).on('click','#syf-filter-all',function(){filterTypes();selectLetter(this)});jQuery(document).on('click','.cbox',function(){var type=jQuery(this).children('input').get(0),$type=jQuery(type);jQuery('input[value="'+type.value+'"]').not(type).each(function(i,e){if($type.prop('checked')!==jQuery(e).prop('checked'))jQuery(e).parent().click()})});jQuery(document).on('click','.coupon-comp-name',function(){jQuery(this).next('.cbox').trigger('click')});jQuery("#save-button").click(saveSelections)});var displayed_types={},types,top_types,popular_types,user_types;this.setTypes=function(_types,_top_types,_popular_types,_user_types){types=_types;top_types=_top_types;popular_types=_popular_types;user_types=_user_types};this.populateTypes=function(){clearTypes();populateTopTypes();populatePopularTypes();populateOtherTypes();populateUserTypes()}
function populateTopTypes(){var selected,html;for(var i=0;i<top_types.length;i++){if(userHasTypes()){selected=isSelected(top_types[i].id)}else{user_types[top_types[i].id]=top_types[i];selected=true};html=getHtmlForType(top_types[i],selected);jQuery(html).appendTo('#syf-box-competitions-bet-on .syf-box-selections-list');displayed_types[top_types[i].id]=true};if(top_types.length===0)jQuery('#syf-box-competitions-bet-on').hide()}
function populatePopularTypes(){var selected,html;for(var i=0;i<popular_types.length;i++)if(typeof displayed_types[popular_types[i].id]==="undefined"){selected=isSelected(popular_types[i].id);html=getHtmlForType(popular_types[i],selected);jQuery(html).appendTo('#syf-box-most-popular-competitions .syf-box-selections-list');displayed_types[popular_types[i].id]=true}}
function populateOtherTypes(){types.sort(function(obj_a,obj_b){var a=obj_a.name.toLowerCase(),b=obj_b.name.toLowerCase();return(a<b)?-1:(a>b)?1:0});var html,selected;for(var i=0;i<types.length;i++){selected=isSelected(types[i].id);html=getHtmlForType(types[i],selected);jQuery(html).appendTo('#syf-box-other-competitions .syf-box-selections-list');displayed_types[types[i].id]=true}}
function populateUserTypes(){var html;for(type_id in user_types)if(typeof displayed_types[type_id]==="undefined"){html=getHtmlForType(user_types[type_id],true);jQuery(html).appendTo('#syf-box-other-competitions .syf-box-selections-list')}}
function reset(){clearTypes();populateTopTypes();populatePopularTypes();populateOtherTypes();populateUserTypes();start_now_clicked=0}
function clearTypes(){displayed_types={};jQuery('#syf-box-other-competitions ul.syf-box-selections-list').html('');jQuery('#syf-box-most-popular-competitions ul.syf-box-selections-list').html('');jQuery('#syf-box-competitions-bet-on ul.syf-box-selections-list').html('')}
function checkMatchesLimit(selections){if(selections.length>cfg.my_matches_limit){alert(cfg.my_matches_limit_msg);return false}else return true}
function saveSelections(){var selections=[];jQuery('.type_chk_box:checked').each(function(){if(selections.indexOf(this.value)<0)selections.push(this.value)});if(!checkMatchesLimit(selections))return;var all_types=[];for(type in user_types)all_types.push(user_types[type]);all_types=all_types.concat(types);user_types={};for(var i=0;i<selections.length;i++){var selection=selections[i];for(var j=0;j<all_types.length;j++)if(selection===all_types[j].id){user_types[selection]=all_types[j];break}};jQuery.post(lower_acc_url+'?action=fb_home_lower_save_my_matches',{my_matches_types:selections.join(',')},function(){jQuery("#select-your-favourites-modal").dialog('close');refreshCoupon(selections.length)})}
function refreshCoupon(num_selections){if(typeof content_tab_handler==="object"){content_tab_handler.reloadCurrent()}else if(typeof lb_fb_cpn_reload==="function")if(num_selections==0){window.location.reload()}else{lb_fb_cpn_reload('MM_'+cfg.my_matches_coupon_id,cfg.my_matches_coupon_id,0,0);jQuery('.fb_item_wrapper').show();jQuery('#search').show();jQuery('.no-selections-start').hide();jQuery('.matches-bottom-links').show()}}
function selectLetter(elm){jQuery(".syf-filter-list").removeClass('syf-al-selected');jQuery("#syf-filter-all").removeClass('syf-al-selected');jQuery(elm).addClass('syf-al-selected')}
function filterTypes(letter){if(!letter){jQuery("#syf-box-other-competitions .syf-box-selections-list li").show()}else{letter=letter.toLowerCase();jQuery("#syf-box-other-competitions .syf-box-selections-list li").hide();jQuery("li.begins-with-"+letter).show();if(jQuery("li.begins-with-"+letter).length===0){jQuery("#oc-no-competitions").show()}else jQuery("#oc-no-competitions").hide()}}
function userHasTypes(){for(ut in user_types)if(user_types.hasOwnProperty(ut))return true;return false}
function isSelected(type_id){return typeof user_types[type_id]!="undefined"}
function getHtmlForType(type,selected){var html=[],begins_with=type.name.charAt(0).toLowerCase(),short_name=type.name.length>cfg.truncate_threshold?type.name.slice(0,cfg.truncate_threshold)+'...':type.name,checked=selected?' checked="checked"':'';html.push('<li class="begins-with-'+begins_with+'">');html.push('    <span class="coupon-comp-name">'+short_name);if(type.name.length>cfg.truncate_threshold){html.push('<span class="tooltip">'+type.name+'</span></span>')}else html.push('</span>');html.push('    <span class="cbox">');html.push('        <input class="type_chk_box" value="'+type.id+'" type="checkbox"'+checked+' title="'+type.name+'"/>');html.push('    </span>');html.push('</li>');return html.join('\n')}}
function getTopTypes(types){var top_type_ids_list=general_cookie.getValue('TOP_FB_TYPE').split('|'),top_type_ids={};for(var i=0;i<top_type_ids_list.length;i++)top_type_ids[top_type_ids_list[i]]=true;var top_types=[];for(var i=0;i<types.length;i++)if(top_type_ids[types[i].id])top_types.push(types[i]);return top_types};var leagueTableData={},expanded_ev="",_fb_team_ajax_details={},_fb_team_event_hash={},_fb_team_event_prelive_hash={},_fb_team_evmkt_hash={},_fb_team_selcn_hash={},_fb_team_cfg={},_fb_team_channels={},_fb_team_score_hash={},_fb_team_table_evmkt_hash={},_fb_team_table_selcn_hash={},_fb_team_hl_timers={},fb_team_idx=0,clock_init=false,_fb_team_event_reload_time=null,_fb_team_evmkts_id_prefix="fb_team_mkts_cont_",_fb_team_evmkt_id_prefix="fb_team_mkt_",_fb_team_selcns_id_prefix="fb_team_selns_cont_",_fb_team_selcn_id_prefix="fb_team_seln_",_fb_team_price_id_prefix="fb_team_price_",_tb_team_match_started_overlay_prefix="match_started_overlay_"
function fb_team_event_init(evmkts,selns,init_msg_id,cfg){var live_channels=[];for(var f in cfg)_fb_team_cfg[f]=cfg[f];_fb_team_store_templates();if(evmkts.length){scone_create(_fb_team_evmkts_id_prefix+cfg.mkt_page+evmkts[0].ev_id,{},fb_team_cmp_objects.cmpEvents,null)}else return;for(var i=0;i<evmkts.length;i++){evmkts[i].mkt_page=cfg.mkt_page;_fb_team_got_EVMKT(evmkts[i],true,false);if(!_fb_team_channels["EVENT"+evmkts[i].ev_id]){live_channels.push("sEVENT"+ps_connect_lpad_id(evmkts[i].ev_id));live_channels.push("SEVENT"+ps_connect_lpad_id(evmkts[i].ev_id));_fb_team_channels["EVENT"+evmkts[i].ev_id]=true}};for(var i=0;i<selns.length;i++)_fb_team_got_SELN(selns[i],true,false);if(live_channels.length>0){ps_connect_register("fb_team_ls"+fb_team_idx,_fb_team_got_msg,live_channels,init_msg_id);fb_team_idx++}}
function league_table_init(table_data,evmkts,selns,init_msg_id,cfg){var live_channels=[];for(var f in cfg)_fb_team_cfg[f]=cfg[f];leagueTableData.markets=[];leagueTableData.type_touch_line_id=table_data.type_touch_line_id;leagueTableData.team_touch_line_id=table_data.team_tl_id;leagueTableData.ev_type_id=table_data.ev_type_id;leagueTableData.type_title=table_data.type_names[_fb_team_cfg.lang];if(table_data.team_names!=null)leagueTableData.team_name=table_data.team_names[_fb_team_cfg.lang];for(var i=0;i<evmkts.length;i++){_fb_team_got_EVMKT(evmkts[i],true,true);if(!_fb_team_channels["EVMKT"+evmkts[i].ev_mkt_id]){live_channels.push("sEVMKT"+ps_connect_lpad_id(evmkts[i].ev_mkt_id));live_channels.push("SEVMKT"+ps_connect_lpad_id(evmkts[i].ev_mkt_id));_fb_team_channels["EVMKT"+evmkts[i].ev_mkt_id]=true}};if(live_channels.length>0){ps_connect_register("fb_team_ls"+fb_team_idx,_fb_team_got_table_msg,live_channels,init_msg_id);fb_team_idx++};for(var i=0;i<selns.length;i++)_fb_team_got_SELN(selns[i],true,true)}
function team_ev_hdr_init(event,clockn_js,init_msg_id,cfg){for(var f in cfg)_fb_team_cfg[f]=cfg[f];event.has_score=cfg.has_score;if(!clock_init){eval("initPeriodClocks("+server_clock_time+",cfg.lang)");clock_init=true};var live_channels=[];if(cfg.has_score&&!_fb_team_channels["BRSCR"+event.ev_id]){live_channels.push("sBRSCR"+ps_connect_lpad_id(event.ev_id));_fb_team_channels["BRSCR"+event.ev_id]=true};addClockEvent(event.ev_id,clockn_js,"team_ev_hdr_clock_",true);_fb_team_got_EVENT(event);_fb_team_got_SCORE(event);if(live_channels.length>0){ps_connect_register("fb_team_ls"+fb_team_idx,_fb_team_got_msg,live_channels,init_msg_id);fb_team_idx++}}
function _fb_team_got_msg(msg){var data={};if(msg.subject_level=="sPRICE"){eval("data = "+msg.data+";");data.ev_oc_id=msg.subject_id;_fb_team_got_PRICE(data,false)}else if(msg.subject_level=="sSELCN"){eval("data = "+msg.data+";");data.ev_oc_id=msg.subject_id;_fb_team_got_SELN(data,false,false)}else if(msg.subject_level=="sEVMKT"){eval("data = "+msg.data+";");data.ev_mkt_id=msg.subject_id;_fb_team_got_EVMKT(data,false,false)}else if(msg.subject_level=="sBRSCR"){eval("data = "+msg.data+";");data.ev_id=msg.subject_id;_fb_team_got_SCORE(data)}else if(msg.subject_level=="sEVENT"){eval("data = "+msg.data+";");data.ev_id=msg.subject_id;_fb_team_got_EVENT(data)};return}
function _fb_team_got_table_msg(msg){var data={};if(msg.subject_level=="sPRICE"){eval("data = "+msg.data+";");data.ev_oc_id=msg.subject_id;_fb_team_got_PRICE(data,true)}else if(msg.subject_level=="sSELCN"){eval("data = "+msg.data+";");data.ev_oc_id=msg.subject_id;_fb_team_got_SELN(data,false,true)}else if(msg.subject_level=="sEVMKT"){eval("data = "+msg.data+";");data.ev_mkt_id=msg.subject_id;_fb_team_got_EVMKT(data,false,true)};return};var fb_team_cmp_objects=new function(){}();fb_team_cmp_objects=new push_hash_cmp_objects();fb_team_cmp_objects.cmpEvents=function(cmpMode,evA,evB){if(evA.override==1){return 1}else if(evB.override==1)return-1;var d=evA.disporder-evB.disporder;if(d<0){return-1}else if(d==0){return 0}else return 1}
function _fb_team_got_SCORE(data){var info=_fb_team_score_hash[data.ev_id];if(!info){info=data}else for(var f in data)info[f]=data[f];score_home=data.score_home||data.team1_score;score_away=data.score_away||data.team2_score;document.getElementById("team_ev_hdr_score_"+data.ev_id).innerHTML=score_home+" - "+score_away}
function _fb_team_got_PRICE(data,is_table_data){if(is_table_data){var info=_fb_team_table_selcn_hash[data.ev_oc_id]}else var info=_fb_team_selcn_hash[data.ev_oc_id];if(!info)return;var orig_lp_num=info.lp_num,orig_lp_den=info.lp_den;for(var f in data)info[f]=data[f];if(is_table_data){var seln_info=_fb_team_table_selcn_hash[data.ev_oc_id],parent_info=_fb_team_table_evmkt_hash[seln_info.ev_mkt_id]}else{var seln_info=_fb_team_selcn_hash[data.ev_oc_id],parent_info=_fb_team_evmkt_hash[seln_info.ev_mkt_id]};var lp_avail=parent_info.lp_avail,mkt_sort=parent_info.mkt_sort;info.price_str=_fb_team_get_price_str(_fb_team_cfg,data.lp_num,data.lp_den,lp_avail,mkt_sort);if(is_table_data){var oc_idx=_fb_team_table_selcn_hash[data.ev_oc_id].oc_location,ev_mkt_id=_fb_team_table_selcn_hash[data.ev_oc_id].ev_mkt_id,mkt_idx=_fb_team_table_evmkt_hash[ev_mkt_id].mkt_location;leagueTableData.markets[mkt_idx].selections[oc_idx].price=info.price_str}else{var scitem_id=_fb_team_selcn_id_prefix+data.ev_oc_id;if(!scone_item_exists(scitem_id))return;var sort_info={disporder:info.disporder,lp_num:info.lp_num,lp_den:info.lp_den,ev_oc_id:info.ev_oc_id};scone_set_item_info(scitem_id,sort_info);var price_id=_fb_team_price_id_prefix+info.ev_oc_id,price_el=document.getElementById(price_id);if(!price_el)return;price_el.innerHTML=info.price_str;var d=info.lp_num*orig_lp_den-info.lp_den*orig_lp_num,span_class="";if(d==0){return}else if(d<0){span_class="odd_d"}else span_class="odd_i";_fb_team_highlight_push(info.ev_oc_id,span_class);return}}
function _fb_team_got_SELN(data,first_build,is_table_data){if(is_table_data){var parent_info=_fb_team_table_evmkt_hash[data.ev_mkt_id]}else var parent_info=_fb_team_evmkt_hash[data.ev_mkt_id];if(!parent_info)return;parent_info.child_hash[data.ev_oc_id]=true;if(is_table_data){var info=_fb_team_table_selcn_hash[data.ev_oc_id],is_new_item=!info;if(is_new_item){info=data;_fb_team_table_selcn_hash[data.ev_oc_id]=info}else for(var f in data)info[f]=data[f]}else{var info=_fb_team_selcn_hash[data.ev_oc_id],is_new_item=!info;if(is_new_item){info=data;_fb_team_selcn_hash[data.ev_oc_id]=info}else for(var f in data)info[f]=data[f]};var lp_avail=parent_info.lp_avail,mkt_sort=parent_info.mkt_sort;info.price_str=_fb_team_get_price_str(_fb_team_cfg,info.lp_num,info.lp_den,lp_avail,mkt_sort);if(is_table_data){var parent_idx=parent_info.mkt_location,selection={};selection.name=info.names[_fb_team_cfg.lang];selection.status=info.status;selection.price=info.price_str;selection.ev_oc_id=info.ev_oc_id;selection.lp_num=info.lp_num;selection.lp_den=info.lp_den;if(first_build){selection.team_id=info.team_id;selection.touch_line_id=info.touch_line_id;selection.image=info.image;var oc_idx=leagueTableData.markets[parent_idx].selections.length;_fb_team_table_selcn_hash[data.ev_oc_id].oc_location=oc_idx;leagueTableData.markets[parent_idx].selections[oc_idx]=selection}else{var oc_idx=_fb_team_table_selcn_hash[data.ev_oc_id].oc_location;leagueTableData.markets[parent_idx].selections[oc_idx].name=selection.name;leagueTableData.markets[parent_idx].selections[oc_idx].status=selection.status;leagueTableData.markets[parent_idx].selections[oc_idx].price=selection.price;leagueTableData.markets[parent_idx].selections[oc_idx].ev_oc_id=selection.ev_oc_id}}else{var scitem_id=_fb_team_selcn_id_prefix+info.ev_oc_id,pscone_id=_fb_team_selcns_id_prefix+info.ev_mkt_id;info.name=info.names[_fb_team_cfg.lang];info.name=trunc_string(info.name,_fb_team_cfg.trunc_length,"...");info.hcap_value=0;if(parent_info.hcap_values&&info.fb_result)if(parent_info.hcap_values[info.fb_result])info.hcap_value=parent_info.hcap_values[info.fb_result];info.bettable=(info.status=="A")&&parent_info.bettable;var html=tmpl_play("fb_team_seln",info),sort_info={disporder:info.disporder,lp_num:info.lp_num,lp_den:info.lp_den,ev_oc_id:info.ev_oc_id},was_visible=scone_item_exists(scitem_id),now_visible=(info.displayed=="Y");if(!was_visible&&now_visible){scone_add_item(pscone_id,scitem_id,html,sort_info)}else if(was_visible&&now_visible){scone_replace_item(scitem_id,html,sort_info,true)}else if(was_visible&&!now_visible)scone_remove_item(scitem_id)}}
function _fb_team_got_EVMKT(data,first_build,is_table_data){if(is_table_data){var info=_fb_team_table_evmkt_hash[data.ev_mkt_id],is_new_item=!info,orig_bettable;if(is_new_item){info=data;info.child_hash={};_fb_team_table_evmkt_hash[data.ev_mkt_id]=info}else{orig_bettable=info.bettable;for(var f in data)info[f]=data[f]};var market={};market.market_title=data.names[_fb_team_cfg.lang];market.status=data.status;market.displayed=data.displayed;market.disporder=data.disporder;market.ev_mkt_id=data.ev_mkt_id;if(first_build){market.selections=[];var mkt_idx=leagueTableData.markets.length;_fb_team_table_evmkt_hash[data.ev_mkt_id].mkt_location=mkt_idx}else{var mkt_idx=_fb_team_table_evmkt_hash[data.ev_mkt_id].mkt_location;market.selections=leagueTableData.markets[mkt_idx].selections};leagueTableData.markets[mkt_idx]=market}else{var info=_fb_team_evmkt_hash[data.ev_mkt_id],is_new_item=!info,orig_bettable;if(is_new_item){info=data;info.child_hash={};_fb_team_evmkt_hash[data.ev_mkt_id]=info}else{orig_bettable=info.bettable;for(var f in data)info[f]=data[f]};var parent_info=_fb_team_event_hash[info.ev_id_disp];if(is_new_item&&parent_info)parent_info.child_hash[data.ev_mkt_id]=true;var scitem_id=_fb_team_evmkt_id_prefix+info.ev_mkt_id,pscone_id=_fb_team_evmkts_id_prefix+info.mkt_page+info.ev_id_disp;info.name=info.names[_fb_team_cfg.lang];info.name=trunc_string(info.name,_fb_team_cfg.trunc_length,"...");if(parent_info){info.bettable=(info.status=="A")&&parent_info.bettable}else info.bettable=info.status=="A";var html=tmpl_play("fb_team_market",info),was_visible=scone_item_exists(scitem_id),now_visible=(info.displayed=="Y"),sort_info={override:info.override_disporder,disporder:info.disporder,ev_mkt_id:info.ev_mkt_id};if(!was_visible&&now_visible){scone_add_item(pscone_id,scitem_id,html,sort_info);var cscone_id=_fb_team_selcns_id_prefix+info.ev_mkt_id;scone_create(cscone_id,{},fb_team_cmp_objects.cmpEvMkts,null)}else if(was_visible&&now_visible){scone_replace_item(scitem_id,html,sort_info,true)}else if(was_visible&&!now_visible)scone_remove_item(scitem_id);if(now_visible&&(!was_visible||orig_bettable!=info.bettable))for(var ev_oc_id in info.child_hash)_fb_team_got_SELN({ev_oc_id:ev_oc_id,ev_mkt_id:info.ev_mkt_id},false,false)}}
function _fb_team_got_EVENT(data){var info=_fb_team_event_hash[data.ev_id],is_new_item=!info,orig_bettable,orig_is_off;if(is_new_item){info=data;info.child_hash={};_fb_team_event_hash[data.ev_id]=info}else{orig_bettable=info.bettable;orig_is_off=info.is_off;for(var f in data)info[f]=data[f]};updatePeriodClock(data);if(info.has_score==1)_fb_team_got_SCORE(data);var ev_id=data.ev_id;info.bettable=info.status=="A";var elem=document.getElementById("fb_team_ev_"+ev_id);if(elem)if(data.displayed=="N"){elem.style.display="none"}else elem.style.display="";if(orig_bettable!=info.bettable)for(var ev_mkt_id in info.child_hash)_fb_team_got_EVMKT({ev_id:ev_id,ev_mkt_id:ev_mkt_id},false,false)}
function _fb_team_highlight_push(ev_oc_id,span_class){var div=document.getElementById(_fb_team_selcn_id_prefix+ev_oc_id);if(!div)return;div.className=span_class;if(_fb_team_hl_timers[ev_oc_id]!=null){window.clearTimeout(_fb_team_hl_timers[ev_oc_id]);delete _fb_team_hl_timers[ev_oc_id]};var self=this;if(span_class!="odd")_fb_team_hl_timers[ev_oc_id]=window.setTimeout(function(){self._fb_team_highlight_push(ev_oc_id,"odd")},_fb_team_cfg.highlight_duration);return}
function fb_team_add_bet(ev_oc_id,bet_origin,is_table_seln){if(is_table_seln){var seln_info=_fb_team_table_selcn_hash[ev_oc_id]}else var seln_info=_fb_team_selcn_hash[ev_oc_id];if(!seln_info)return;if(is_table_seln){var mkt_info=_fb_team_table_evmkt_hash[seln_info.ev_mkt_id]}else var mkt_info=_fb_team_evmkt_hash[seln_info.ev_mkt_id];if(!mkt_info)return;BS_set_leg("selections",ev_oc_id);BS_set_leg("price_type","L");BS_set_leg("lp_num",seln_info.lp_num);BS_set_leg("lp_den",seln_info.lp_den);BS_set_leg("hcap_value",mkt_info.raw_hcap);BS_set_leg("bir_index",mkt_info.bir_index);BS_set_leg("market_tags","");if(bet_origin&&(typeof collate_name!=='undefined'))BS_set_leg("bet_origin",collate_name+'-'+bet_origin);BS_go_bet();return}
function fbm_bet(ev_oc_id,lp_num,lp_den,hcap_value,origin){BS_set_leg('price_type','L');BS_set_leg('lp_num',lp_num);BS_set_leg('lp_den',lp_den);BS_set_leg('selections',ev_oc_id);BS_set_leg('hcap_value',hcap_value);BS_set_leg('bet_origin',origin);BS_go_bet();return}
function _fb_team_store_templates(){var tmp=[];tmp.push('	<div id="fb_team_mkt_<%ev_mkt_id%>">\n');tmp.push('		<%IF cashout_avail == "Y"%>\n');tmp.push('		<div class="fb-cash-in-available" style="margin-left:15px">\n');tmp.push('			<a onclick="toggle_cashout_overlay()" href="javascript:void(0)"><%XL _fb_team_mkt_cashout_avail%></a>\n');tmp.push('		</div>\n');tmp.push('		<%END%>\n');tmp.push('		<p class="bet-type top-space"><%name%>\n');tmp.push('			<%IF mkt_blurb != ""%>\n');tmp.push('			<a href="#">\n');tmp.push('				<span class="tooltip"><%XL _fb_team_mkt_qmark_tt%></span>\n');tmp.push('				<span class="qmark">\n');tmp.push('					<span class="helptip">\n');tmp.push('						<%mkt_blurb%>\n');tmp.push('					</span>\n');tmp.push('				</span>\n');tmp.push('			</a>\n');tmp.push('			<%END%>\n');tmp.push('		</p>\n');tmp.push('		<div class="fb-odds-group item" id="fb_team_selns_cont_<%ev_mkt_id%>">\n');tmp.push('		</div>\n');tmp.push('		</div>\n');tmp.push('	</div>\n');tmpl_store("fb_team_market",tmp.join(""));var tmp=[];tmp.push('<%IF bettable%>\n');tmp.push('	<span class="odd" id="fb_team_seln_<%ev_oc_id%>">\n');tmp.push('		<a class="fb-odds-button" <%IF bettable%> onclick="fb_team_add_bet(<%ev_oc_id%>,\'MKT\',0)"<%END%>>\n');tmp.push('			<span class="odds-label">\n');tmp.push('				<%name%>\n');tmp.push('				<%IF hcap_value%><%hcap_value%><%END%>\n');tmp.push('			</span>\n');tmp.push('			<span id="fb_team_price_<%ev_oc_id%>" class="odds-value">\n');tmp.push('				<%price_str%>\n');tmp.push('			</span>\n');tmp.push('		</a>\n');tmp.push('	</span>\n');tmp.push('<%ELSE%>\n');tmp.push('	<span class="odd suspended" id="fb_team_seln_<%ev_oc_id%>">\n');tmp.push('		<a onclick="javascipt:void(0);" class="fb-odds-button">\n');tmp.push('			<span class="odds-label">\n');tmp.push('				<%name%>\n');tmp.push('				<%IF hcap_value%><%hcap_value%><%END%>\n');tmp.push('			</span>\n');tmp.push('			<span id="fb_team_price_<%ev_oc_id%>" class="odds-value">\n');tmp.push('				<%price_str%>\n');tmp.push('			</span>\n');tmp.push('		</a>\n');tmp.push('	</span>\n');tmp.push('<%END%>\n');tmpl_store("fb_team_seln",tmp.join(""))};var fb_team_toggle_content=function(button){var wrapperDiv=button.closest('div.fb-market-wrapper');if(wrapperDiv.hasClass('fb-closed')){wrapperDiv.find('div.fb-market-content, div.fb-sub-content').show();wrapperDiv.removeClass('fb-closed');wrapperDiv.find('div.sub-hdr').removeClass('fb-closed');wrapperDiv.find('div.sub-hdr').next().show()}else{wrapperDiv.find('div.fb-market-content').hide();wrapperDiv.addClass('fb-closed');wrapperDiv.find('div.sub-hdr').addClass('fb-closed');wrapperDiv.find('div.sub-hdr').next().hide()}}
function fb_team_toggle_all(ev_id,force_closed){var sections=_fb_team_ajax_details[ev_id].sections,expand=0;if(!force_closed){expand=1;for(var i=0;i<sections.length;i++)if(sections[i].expanded&&sections[i].name!="MBSBLURB"){expand=0;break}};for(var i=0;i<sections.length;i++){if(sections[i].expanded==expand)continue;if(sections[i].name=="MBSBLURB")continue;fb_team_set_section(ev_id,sections[i],expand)}}
function fb_team_toggle_section(ev_id,section_name){var sections=_fb_team_ajax_details[ev_id].sections;for(var i=0;i<sections.length;i++)if(sections[i].name==section_name)break;var expand=!(sections[i].expanded);fb_team_set_section(ev_id,sections[i],expand);return expand}
function fb_team_set_section(ev_id,section,expand){var action="",div_id="";if(section.name=="MBSBLURB")return;if(expanded_ev=="")expanded_ev=ev_id;if(expand&&expanded_ev!=ev_id){fb_team_toggle_all(expanded_ev,1);expanded_ev=ev_id};switch(section.name){case"TOPMKTS":var cgrp_type_id=_fb_team_ajax_details[ev_id].cgrp_type_id,team_id=_fb_team_ajax_details[ev_id].team_id,is_live=_fb_team_ajax_details[ev_id].is_live;action="?action=get_team_page_event_top_markets&ev_id="+ev_id+"&cgrp_type_id="+cgrp_type_id+"&team_id="+team_id+"&is_live="+is_live;div_id="TOPMKTS_mkt_"+ev_id;break;case"OTHMKTS":var cgrp_type_id=_fb_team_ajax_details[ev_id].cgrp_type_id,is_live=_fb_team_ajax_details[ev_id].is_live;action="?action=get_team_page_event_other_markets&ev_id="+ev_id+"&cgrp_type_id="+cgrp_type_id+"&is_live="+is_live;div_id="OTHMKTS_mkt_"+ev_id;break;case"MBSMKTS":var cgrp_type_id=_fb_team_ajax_details[ev_id].cgrp_type_id,mbs_blurb=_fb_team_ajax_details[ev_id].mbs_blurb,team_id=_fb_team_ajax_details[ev_id].team_id;action="?action=build_mbs_mktgrp&ev_id="+ev_id+"&cgrp_type_id="+cgrp_type_id+"&mbs_blurb="+mbs_blurb+"&team_id="+team_id;div_id="MBS_"+ev_id;break;case"IFRAME":var ev_type_id=_fb_team_ajax_details[ev_id].ev_type_id;action="?action=get_team_page_event_iframe&ev_id="+ev_id+"&ev_type_id="+ev_type_id;div_id="main_iframe_"+ev_id;break;case"STATS":var ev_type_id=_fb_team_ajax_details[ev_id].ev_type_id,team_id=_fb_team_ajax_details[ev_id].team_id;action="?action=get_team_page_event_stats&ev_id="+ev_id+"&ev_type_id="+ev_type_id+"&team_id="+team_id;div_id="results_iframe_"+ev_id;break;default:return};if(expand&&!section.has_content){var url=tld_football+action;_fb_team_make_AJAX_request(url,[div_id],fb_team_got_AJAX_request);section.has_content=1};section_div=$j("#"+div_id);header_div=$j("#header_"+div_id);if(expand){header_div.removeClass("fb-closed");section_div.show()}else{header_div.addClass("fb-closed");section_div.hide()};section.expanded=expand;var event_header_expanded=0;for(var i=0;i<_fb_team_ajax_details[ev_id].sections.length;i++)if(_fb_team_ajax_details[ev_id].sections[i].expanded&&_fb_team_ajax_details[ev_id].sections[i].name!="MBSBLURB"){event_header_expanded=1;break};var event_wrapper_div=$j("#fb_team_ev_"+ev_id),event_footer_btn=event_wrapper_div.find("a.collapse-expand");if(event_header_expanded==1){event_wrapper_div.removeClass("fb-closed");event_footer_btn.find(".button-text").text(_collapse_txt);event_footer_btn.find(".tooltip").text(_collapse_tt_txt)}else{event_wrapper_div.addClass("fb-closed");event_footer_btn.find(".button-text").text(_expand_txt);event_footer_btn.find(".tooltip").text(_expand_tt_txt)};if(event_footer_btn.hasClass('graysmallbutton'))event_footer_btn.removeClass('graysmallbutton').animate({opacity:1.0},30,'',function(){$j(this).css('opacity','')}).addClass('graysmallbutton')}
function fb_team_got_AJAX_request(url,clientdata,ok,response){if(!ok)return;if(response!=""){document.getElementById(clientdata[0]).innerHTML=response;var parts=_fb_team_parse_script_tags(response);if(parts[1].length)try{_fb_team_global_eval(parts[1])}catch(e){ok=false};pp_football_onload()}}
function _fb_team_make_AJAX_request(url,clientdata,callback){var req=null;if(window.XMLHttpRequest){req=new XMLHttpRequest()}else if(window.ActiveXObject)req=new ActiveXObject('Microsoft.XMLHTTP');if(req){req.onreadystatechange=function(){if(req.readyState!=4)return;var reqStatus;try{reqStatus=req.status}catch(e){reqStatus=''};if(reqStatus!=200){callback(url,clientdata,false,'HTTP')}else callback(url,clientdata,true,req.responseText)};try{req.open('GET',url,true);req.send(null)}catch(e){callback(url,clientdata,false,'UNSUPPORTED')}}else callback(url,clientdata,false,'UNSUPPORTED')}
function _fb_team_get_price_str(cfg,lp_num,lp_den,lp_avail,mkt_sort){if(typeof lp_avail=="undefined")lp_avail="Y";if(typeof mkt_sort=="undefined")mkt_sort="--";var price_str_type=cfg.price_str_type;if(mkt_sort=="AH"&&cfg.price_str_type_ah!="")price_str_type=cfg.price_str_type_ah;if(mkt_sort=="HL"&&cfg.price_str_type_hl!="")price_str_type=cfg.price_str_type_hl;if(lp_avail=="N")return"SP";if(lp_num==""&&lp_den=="")return"-";var price_str;if(price_str_type=="DECIMAL"){var dps=(lp_den>100)?3:2,dp=1.0+(lp_num/lp_den),scaled_dp=""+Math.round(dp*Math.pow(10,dps)-0.5),int_part=scaled_dp.substr(0,scaled_dp.length-dps),frac_part=scaled_dp.substr(scaled_dp.length-dps);if(int_part=="")int_part="";if(frac_part=="")frac_part="";var price_str=int_part+"."+frac_part}else{if(lp_den=="")lp_den=1;if(lp_num==lp_den){price_str="evens"}else price_str=lp_num+cfg.price_str_sep+lp_den};return price_str}
function _fb_team_parse_script_tags(str){var html='',js='',i=0,state='HTML',script_re=new RegExp('<(/?)script([^>]*)>','gi');while((mtch=script_re.exec(str))!=null){mS=mtch.index;if(state=='HTML'){html+=str.substring(i,mS)}else js+=str.substring(i,mS)+';\n';var closer=mtch[1],attrs=mtch[2];if(closer=='/'){state='HTML'}else if(attrs.charAt(attrs.length-1)!='/'&&attrs.indexOf('src=')==-1)state='JS';i=script_re.lastIndex};if(state=='HTML'){html+=str.substring(i)}else js+=str.substring(i);return[html,js]};var _fb_team_global_eval=function(src){if(window.execScript){window.execScript(src);return};var fn=function(){window.eval.call(window,src)};fn()}
function make_button_active(button,value){if(value!="no_team"){document.getElementById(button).className="greenbutton"}else document.getElementById(button).className="grey-button-disabled"}
function set_my_team_btn_clicked(button_class,modal){if(button_class=="grey-button-disabled")return true;var f=null;if(modal==true){f=document.set_my_team_frm_modal}else f=document.set_my_team_frm;f.cgrp_mem_id.value=f.team_selected.value.split(' ')[0];f.team_id.value=f.team_selected.value.split(' ')[1];f.group_id.value=f.team_selected.value.split(' ')[2];f.submit();return false}
function unset_fav_team(){document.unset_fav_team_frm.submit();return false}
function change_jersey(option,img_wrapper_id){var img_wrapper=$j('#'+img_wrapper_id),img=$j(img_wrapper).children()[0],img_extra="";if(option.selectedIndex!=0){img_extra=_fb_team_jersey_data[option.selectedIndex-1][0];img.src=_fb_team_jersey_img_url+img_extra;$j(img_wrapper).parent().removeClass('no-team');$j(img_wrapper).show()}else{$j(img_wrapper).parent().addClass('no-team');img.src="";$j(img_wrapper).hide()}}
function fb_team_event_prelive_init(ev_id,is_off_cache_arg,init_msg_id,is_home_page){var live_channels=[];live_channels.push("sEVENT"+ps_connect_lpad_id(ev_id));_fb_team_event_prelive_hash[ev_id]=is_off_cache_arg;_fb_team_event_prelive_hash.HP=is_home_page;ps_connect_register("fb_team_pre_ls_"+ev_id,_fb_team_got_prelive_msg,live_channels,init_msg_id)}
function _fb_team_got_prelive_msg(msg){var data={};if(msg.subject_level=="sEVENT"){eval("data = "+msg.data+";");data.ev_id=msg.subject_id;_fb_team_got_prelive_EVENT(data)};return}
function _fb_team_got_prelive_EVENT(data){if(!_fb_team_event_prelive_hash[data.ev_id])return;if(data.is_off=='Y'&&!_fb_team_event_reload_time){if(!_fb_team_event_prelive_hash.HP){var div=document.getElementById(_tb_team_match_started_overlay_prefix+data.ev_id);div.style.display=""};var max_wait=2e4,random_timeout=Math.floor(Math.random()*max_wait);_fb_team_event_reload_time=setTimeout('_fb_team_reload('+data.ev_id+')',random_timeout)}}
function _fb_team_reload(ev_id){if(ev_id=="")return;var is_off_cache_arg=_fb_team_event_prelive_hash[ev_id];if(_fb_team_event_prelive_hash.HP){scone_delete(_fb_team_evmkts_id_prefix+_fb_team_cfg.mkt_page+ev_id);leagueTableData={};_fb_team_ajax_details={};_fb_team_event_hash={};_fb_team_event_prelive_hash={};_fb_team_evmkt_hash={};_fb_team_selcn_hash={};_fb_team_cfg={};_fb_team_channels={};_fb_team_score_hash={};_fb_team_table_evmkt_hash={};_fb_team_table_selcn_hash={};_fb_team_hl_timers={};ps_connect_deregister("fb_team_pre_ls_"+ev_id);for(var i=0;i<fb_team_idx;i++)ps_connect_deregister("fb_team_ls"+i);section_handler.reloadSection("MY_TEAM","&ev_is_off="+is_off_cache_arg)}else{var params={};params.ev_is_off=is_off_cache_arg;_fb_team_post_to_url("",params)}}
function _fb_team_post_to_url(path,params,method){method=method||"post";var form=document.createElement("form");form.setAttribute("method",method);if(path!="")form.setAttribute("action",path);for(var key in params)if(params.hasOwnProperty(key)){var hiddenField=document.createElement("input");hiddenField.setAttribute("type","hidden");hiddenField.setAttribute("name",key);hiddenField.setAttribute("value",params[key]);form.appendChild(hiddenField)};document.body.appendChild(form);form.submit()};var FCTC_layout='straight'
function FCTC_change_layout(f,layout,fc_avail,tc_avail){var fi,box,box_type;FCTC_layout=layout;for(var i=0;i<f.elements.length;i++){fi=f.elements[i];if(fi.type!='checkbox')continue;fi.checked=false;box=fi.name.split('_')[2];box_type=fi.name.split('_')[1];if(fc_avail=='N'&&box_type=='Fcast')continue;if(tc_avail=='N'&&box_type=='Tcast')continue;if(layout=='straight'&&box=='Any'){fi.disabled='disabled'}else if(layout=='banker'&&(box=='Second'||box=='Third')){fi.disabled='disabled'}else if(layout=='combination'&&(box=='First'||box=='Second'||box=='Third')){fi.disabled='disabled'}else fi.disabled=''}}
function FCTC_clear_selections(f){var fi;for(var i=0;i<f.elements.length;i++){fi=f.elements[i];if(fi.type=='checkbox')fi.checked=false}}
function FCTC_handle_unique_checkbox(e,id_to_blank){FCTC_layout='straight';var e_checked=e.checked,f=e.form,fi;if(/cb_Fcast/.test(e.name)){bet_type='FC'}else if(/cb_Tcast/.test(e.name))bet_type='TC';for(var i=0;i<f.elements.length;i++){fi=f.elements[i];if(fi.name==e.name)fi.checked=false;if(bet_type=='FC'){if(/cb_Fcast_Any/.test(fi.name))fi.checked=false}else if(bet_type=='TC')if(/cb_Tcast_Any/.test(fi.name))fi.checked=false};e.checked=e_checked;var e_to_blank=document.getElementById(id_to_blank);if(e.checked)e_to_blank.checked=false}
function FCTC_pp_handle_any_checkbox(e){FCTC_layout='combination';var e_checked=e.checked,bet_type,f=e.form,fi,j=0;if(/cb_Fcast_Any/.test(e.name)){bet_type='FC'}else if(/cb_Tcast_Any/.test(e.name))bet_type='TC';for(var i=0;i<f.elements.length;i++){fi=f.elements[i];if(fi.checked==true)if(bet_type=='FC'){if(/cb_Fcast_[FST]/.test(fi.name))fi.checked=false}else if(bet_type=='TC')if(/cb_Tcast_[FST]/.test(fi.name))fi.checked=false};e.checked=e_checked}
function FCTC_handle_first_checkbox(e,id_to_blank){if(FCTC_layout!='banker')return;var e_checked=e.checked,f=e.form,fi;for(var i=0;i<f.elements.length;i++){fi=f.elements[i];if(fi.name==e.name)fi.checked=false};e.checked=e_checked;var e_to_blank=document.getElementById(id_to_blank);if(e.checked)e_to_blank.checked=false}
function FCTC_handle_any_checkbox(e,id_to_blank){if(FCTC_layout!='banker')return;var e_to_blank=document.getElementById(id_to_blank);if(e.checked)e_to_blank.checked=false}
function FCTC_bet_now(f){var fi,fj,fk,sort,box,ev_oc_ids='',valid_selections=false,invalid_selections=false,fc_first_list=new Array(),fc_second_list=new Array(),fc_any_list=new Array(),tc_first_list=new Array(),tc_second_list=new Array(),tc_third_list=new Array(),tc_any_list=new Array();for(var i=0;i<f.elements.length;i++){fi=f.elements[i];if(fi.checked==false)continue;sort=fi.name.split('_')[1];box=fi.name.split('_')[2];if(sort=='Fcast'){if(box=='First')fc_first_list.push(fi.value);if(box=='Second')fc_second_list.push(fi.value);if(box=='Any')fc_any_list.push(fi.value)}else if(sort=='Tcast'){if(box=='First')tc_first_list.push(fi.value);if(box=='Second')tc_second_list.push(fi.value);if(box=='Third')tc_third_list.push(fi.value);if(box=='Any')tc_any_list.push(fi.value)}};if(FCTC_layout=='straight'||FCTC_layout=='banker'){if(fc_first_list.length>0&&fc_second_list.length==0&&fc_any_list.length==0)invalid_selections=true;if(fc_second_list.length>0&&fc_first_list.length==0)invalid_selections=true;if(fc_any_list.length>0&&fc_first_list.length==0)invalid_selections=true;for(var i=0;i<fc_first_list.length;i++){for(var j=0;j<fc_second_list.length;j++){if(fc_first_list[i]==fc_second_list[j]){invalid_selections=true;continue};ev_oc_ids=fc_first_list[i]+'c'+fc_second_list[j];BS_set_leg('leg_sort','SF');BS_set_leg('price_type','D');BS_set_leg('selections',ev_oc_ids);BS_select_bet('Fcast_'+ev_oc_ids);valid_selections=true};for(var j=0;j<fc_any_list.length;j++){ev_oc_ids=fc_first_list[i]+'c'+fc_any_list[j];BS_set_leg('leg_sort','SF');BS_set_leg('price_type','D');BS_set_leg('selections',ev_oc_ids);BS_select_bet('Fcast_'+ev_oc_ids);valid_selections=true}};if(tc_first_list.length>0&&(tc_second_list.length==0||tc_third_list.length==0)&&tc_any_list.length==0)invalid_selections=true;if(tc_second_list.length>0&&(tc_first_list.length==0||tc_third_list.length==0))invalid_selections=true;if(tc_third_list.length>0&&(tc_first_list.length==0||tc_second_list.length==0))invalid_selections=true;if(tc_any_list.length>0&&tc_first_list.length==0)invalid_selections=true;for(var i=0;i<tc_first_list.length;i++){for(var j=0;j<tc_second_list.length;j++){if(tc_first_list[i]==tc_second_list[j]){invalid_selections=true;continue};for(var k=0;k<tc_third_list.length;k++){if(tc_first_list[i]==tc_third_list[k]){invalid_selections=true;continue};if(tc_second_list[j]==tc_third_list[k]){invalid_selections=true;continue};ev_oc_ids=tc_first_list[i]+'c'+tc_second_list[j]+'c'+tc_third_list[k];BS_set_leg('leg_sort','TC');BS_set_leg('price_type','D');BS_set_leg('selections',ev_oc_ids);BS_select_bet('Tcast_'+ev_oc_ids);valid_selections=true}};for(var j=0;j<tc_any_list.length;j++)for(var k=0;k<tc_any_list.length;k++){if(j==k){invalid_selections=true;continue};ev_oc_ids=tc_first_list[i]+'c'+tc_any_list[j]+'c'+tc_any_list[k];BS_set_leg('leg_sort','TC');BS_set_leg('price_type','D');BS_set_leg('banker','Y');BS_set_leg('selections',ev_oc_ids);BS_select_bet('Tcast_'+ev_oc_ids);valid_selections=true}}};if(FCTC_layout=='combination'){ev_oc_ids='';for(var i=0;i<fc_any_list.length;i++)if(i==0){ev_oc_ids=fc_any_list[i]}else ev_oc_ids+='c'+fc_any_list[i];if(fc_any_list.length==2){BS_set_leg('leg_sort','RF');BS_set_leg('price_type','D');BS_set_leg('selections',ev_oc_ids);BS_select_bet('Fcast_'+ev_oc_ids);valid_selections=true}else if(fc_any_list.length>2){BS_set_leg('leg_sort','CF');BS_set_leg('price_type','D');BS_set_leg('selections',ev_oc_ids);BS_select_bet('Fcast_'+ev_oc_ids);valid_selections=true}else if(fc_any_list.length==1)invalid_selections=true;ev_oc_ids='';for(var i=0;i<tc_any_list.length;i++)if(i==0){ev_oc_ids=tc_any_list[i]}else ev_oc_ids+='c'+tc_any_list[i];if(tc_any_list.length>=3){BS_set_leg('leg_sort','CT');BS_set_leg('price_type','D');BS_set_leg('selections',ev_oc_ids);BS_select_bet('Tcast_'+ev_oc_ids);valid_selections=true}else if(tc_any_list.length>0)invalid_selections=true};if(valid_selections&&invalid_selections){BS_open_betslip();BS_display_error(fctc.msg.FCTC_ERROR_TITLE,fctc.msg.FCTC_ERROR_SOME_SELECTIONS_INVALID,'BS_go_bets(); BS_deselect_all_bets();');return}else if(invalid_selections){BS_open_betslip();BS_display_error(fctc.msg.FCTC_ERROR_TITLE,fctc.msg.FCTC_ERROR_ALL_SELECTIONS_INVALID)}else if(valid_selections)BS_go_bets();for(var i=0;i<f.elements.length;i++){fi=f.elements[i];fi.checked=false};BS_deselect_all_bets()}
function FCTC_change_layout_form_name(f_name,layout){f=document.forms[f_name];FCTC_change_layout(f,layout)}
function hr_ev_init(event,runners,markets,selcns,open_tab,init_msg_id,cfg){var hr_ev=_hr_ev_hash[event.ev_id];if(!hr_ev){hr_ev=new hr_ev_object();_hr_ev_hash[event.ev_id]=hr_ev};for(var f in cfg)hr_ev.cfg[f]=cfg[f];hr_ev.last_msg_id=init_msg_id;hr_ev.sort_dir="a";hr_ev.sort_col="market";hr_ev.open_tab="all_mkts";hr_ev.match_betting_loaded=0;hr_ev.extra_markets_loaded=0;hr_ev.ftc_built=0;hr_ev.cb_built=0;hr_ev.expander="opened";var live_channels=[];document.showEventStartTimer=-1;event.is_simple=0;hr_ev.is_simple=0;hr_ev.is_us_vr=0;if(event.is_american||event.is_virtual){hr_ev.is_us_vr=1;hr_ev.is_simple=1;event.is_simple=0;hr_ev.open_tab="qv";if(!_hr_ev_templates_prepared)_hr_ev_single_view_store_templates()}else if(event.is_generic){hr_ev.is_generic=1;hr_ev.is_simple=1;event.is_simple=1;hr_ev.open_tab="qv";if(!_hr_ev_templates_prepared)_hr_ev_single_view_store_templates()}else if(!_hr_ev_templates_prepared)_hr_ev_store_templates();var temp_end_timer=new Date().getTime();_hr_ev_templates_prepared=true;hr_ev.event_hash={};hr_ev.runner_hash={};hr_ev.evmkt_hash={};hr_ev.selcn_hash={};hr_ev.channels={};var ev_start_timer=new Date().getTime();scone_create(_hr_ev_container_prefix+event.ev_id,{},null,null);_hr_ev_got_EVENT(event,hr_ev,false);var cur_ev_id=event.ev_id;if(!hr_ev.channels["EVENT"+event.ev_id]){live_channels.push("sEVENT"+ps_connect_lpad_id(event.ev_id));live_channels.push("SEVENT"+ps_connect_lpad_id(event.ev_id));hr_ev.channels["EVENT"+event.ev_id]=true};for(var i=0;i<runners.length;i++)_hr_ev_got_RUNNER(runners[i],hr_ev,false);for(var i=0;i<markets.length;i++)_hr_ev_got_EVMKT(markets[i],hr_ev,false);for(var i=0;i<selcns.length;i++)_hr_ev_got_SELCN(selcns[i],hr_ev,false);if(live_channels.length>0){var gotPushDataClosure=function(msg){return hr_ev.gotPushData(msg)};ps_connect_register("hr_ev"+event.ev_id,gotPushDataClosure,live_channels,init_msg_id)};hr_ev.event_hash[event.ev_id].ins_dummy_num=0;hr_ev.event_hash[event.ev_id].plc_dummy_num=0;if(event.ins_num<3&&hr_ev.is_simple==0)for(var i=0;i<3-event.ins_num;i++){var dummy_info={ev_id:event.ev_id,type:"INS",dummy_num:i,disporder:"-9999"};_hr_ev_got_DUMMYMKT(hr_ev,dummy_info,true,false);hr_ev.event_hash[event.ev_id].ins_dummy_num++};if(event.placed_num<2&&hr_ev.is_simple==0)for(var i=0;i<2-event.placed_num;i++){var dummy_info={ev_id:event.ev_id,type:"PL",dummy_num:i,disporder:"-9999"};_hr_ev_got_DUMMYMKT(hr_ev,dummy_info,true,false);hr_ev.event_hash[event.ev_id].plc_dummy_num++};for(var ev_mkt_id in hr_ev.evmkt_hash)_hr_build_dummy_selns(hr_ev,ev_mkt_id,event);_hr_ev_sort_column("market",event.ev_id,true);var new_tab_button=document.getElementById('button_'+open_tab+'_'+event.ev_id);if(open_tab!=""&&new_tab_button!=null){hr_ev_change_tab(open_tab,event.ev_id)}else if(hr_ev.is_simple==0)if(event.ins_num>0||event.placed_num>0){var pref_expand=get_pref('RACECARD');if(pref_expand=="CARD"){hr_ev_change_tab("qv",event.ev_id)}else if(pref_expand!="ALL")if(event.expand_default=="N")hr_ev_change_tab("qv",event.ev_id)}else if(event.ins_num==0&&event.placed_num==0)hr_ev_change_tab("qv",event.ev_id)}
function hr_ev_object(){this.gotPushData=function(msg){var data={};switch(msg.subject_level){case"sPRICE":eval("data = "+msg.data+";");data.ev_oc_id=msg.subject_id;_hr_ev_got_PRICE(data,this,true);break;case"sSELCN":eval("data = "+msg.data+";");data.ev_oc_id=msg.subject_id;_hr_ev_got_SELCN(data,this,true);if(this.ftc_built==1)_hr_ev_got_ftc_SELCN(data,this,true);if(this.cb_built==1)_hr_ev_got_cb_SELCN(data,this,true);break;case"sMHCAP":break;case"sEVMKT":eval("data = "+msg.data+";");data.ev_mkt_id=msg.subject_id;_hr_ev_got_EVMKT(data,this,true);if(this.ftc_built==1)_hr_ev_got_ftc_EVMKT(data,this,true);if(this.cb_built==1)_hr_ev_got_cb_EVMKT(data,this,true);break;case"sEVENT":eval("data = "+msg.data+";");data.ev_id=msg.subject_id;_hr_ev_got_EVENT(data,this,true);break;default:};return};this.cfg={lang:"en",price_str_type:"ODDS",price_str_type_ah:"DECIMAL",price_str_type_hl:"DECIMAL",price_str_sep:"-",hl_class_decrease:"_d",hl_class_increase:"_i",hl_class_same:"",highlight_duration:4e3,bet_origin:""};return};var hr_ev_cmp_objects=new function(){}();hr_ev_cmp_objects=new push_hash_cmp_objects();hr_ev_cmp_objects.cmpEvMkts=function(cmp_mode,mktA,mktB){if(mktA.disporder==-9999&&mktB.disporder==-9999)return 0;if(mktA.disporder==-9999)return-1;if(mktB.disporder==-9999)return 1;var handler=_hr_ev_hash[mktA.ev_id],event=handler.event_hash[mktA.ev_id],ev_mkt_id_A=mktA.ev_mkt_id,ev_mkt_id_B=mktB.ev_mkt_id;if(ev_mkt_id_A){var market=handler.evmkt_hash[mktA.ev_mkt_id]}else if(ev_mkt_id_B){var market=handler.evmkt_hash[mktB.ev_mkt_id]}else return 0;var mkt_cat=market.mkt_cat,disp_array={};if(mkt_cat=="EW"){return 0}else if(mkt_cat=="PL"){disp_array=event.placed_array}else if(mkt_cat=="INS"){disp_array=event.ins_array}else return 0;var mktAdisp=_hr_get_array_position(disp_array,mktA.disporder),mktBdisp=_hr_get_array_position(disp_array,mktB.disporder);if(mktAdisp<mktBdisp){return-1}else return 1}
function _hr_get_array_position(arr,disp){for(var k=0;k<arr.length;k++)if(arr[k]==disp)return k;return-1};hr_ev_cmp_objects.cmpRunners=function(cmp_mode,rnA,rnB){var handler=_hr_ev_hash[rnA.ev_id],column=handler.sort_col,direction=0;if(handler.sort_dir=="d"){direction=1}else if(handler.sort_dir=="a")direction=-1;var runnerA=handler.runner_hash[rnA.runner_id],runnerB=handler.runner_hash[rnB.runner_id];if(runnerA.fb_result==1||runnerA.fb_result==2){if(runnerB.fb_result==1||runnerB.fb_result==2)return runnerA.fb_result-runnerB.fb_result;return 1};if(runnerB.fb_result==1||runnerB.fb_result==2)return-1;if(runnerA.fb_result=="N"&&runnerB.fb_result=="N"){return 0}else if(runnerA.fb_result=="N"){return 1}else if(runnerB.fb_result=="N")return-1;if(column=="horse"){if(parseInt(runnerA.runner_number)>parseInt(runnerB.runner_number)){return direction}else return-1*direction}else if(column=="weight"){if(runnerA.pa_feed_weight_text==""&&runnerB.pa_feed_weight_text=="")return 0;if(runnerA.pa_feed_weight_text=="")return direction;if(runnerB.pa_feed_weight_text=="")return-1*direction;var runnerA_weight=runnerA.pa_feed_weight_text.split("-"),runnerB_weight=runnerB.pa_feed_weight_text.split("-");if(parseInt(runnerA_weight[0])>parseInt(runnerB_weight[0])){return direction}else if(parseInt(runnerA_weight[0])<parseInt(runnerB_weight[0])){return-1*direction}else if(parseInt(runnerA_weight[1])>parseInt(runnerB_weight[1])){return direction}else return-1*direction}else if(column=="rp"){if(runnerA.rp_rating==""&&runnerB.rp_rating=="")return 0;if(runnerA.rp_rating=="")return direction;if(runnerB.rp_rating=="")return-1*direction;if(parseInt(runnerA.rp_rating)>parseInt(runnerB.rp_rating)){return-1*direction}else return direction}else if(column=="jockey"){if(runnerA.jockey_name==""&&runnerB.jockey_name=="")return 0;if(runnerA.jockey_name=="")return direction;if(runnerB.jockey_name=="")return-1*direction;if(runnerA.jockey_name>runnerB.jockey_name){return direction}else return-1*direction}else if(column=="market"){var selA=handler.selcn_hash[(handler.runner_hash[rnA.runner_id]).wew_ev_oc_id],selB=handler.selcn_hash[(handler.runner_hash[rnB.runner_id]).wew_ev_oc_id];if(!selA&&!selB)return 0;if(!selA)return 1;if(!selB)return-1;if(selA.mkt_lp_avail=="N"&&selB.mkt_lp_avail=="N")if(selA.mkt_sp_avail=="Y"&&selB.mkt_sp_avail=="Y"){var d=selA.disporder-selB.disporder;if(d){if(d>0){return direction}else return-1*direction}else return 0}else return 0;if(selA.lp_avail=="N")return direction;if(selB.lp_avail=="N")return-1*direction;if(cmp_mode=="manual"){var d=selA.lp_num*selB.lp_den-selB.lp_num*selA.lp_den;selA.init_lp_num=selA.lp_num;selA.init_lp_den=selA.lp_den;selB.init_lp_num=selB.lp_num;selB.init_lp_den=selB.lp_den}else var d=selA.init_lp_num*selB.init_lp_den-selB.init_lp_num*selA.init_lp_den;if(d){if(d>0){return direction}else return-1*direction}else{var d=selA.disporder-selB.disporder;if(d){if(d>0){return direction}else return-1*direction}else return 0}}else return 0};var _hr_ev_container_prefix="hr_ev_container_",_hr_ev_event_prefix="hr_ev_event_",_hr_ev_runners_prefix="hr_ev_runners_",_hr_ev_runner_prefix="hr_ev_runner_",_hr_ev_runner_jt_prefix="hr_ev_runner_jt_names_",_hr_ev_evmkts_prefix="hr_ev_evmkts_",_hr_ev_evmkt_prefix="hr_ev_evmkt_",_hr_ev_selcns_prefix="hr_ev_selcns_",_hr_ev_selcn_prefix="hr_ev_selcn_",_hr_ev_selcn_price_prefix="hr_ev_selcn_price_",_hr_ev_ib_head_cont_prefix="hr_ev_ib_head_cont_",_hr_ev_pf_head_cont_prefix="hr_ev_pf_head_cont_",_hr_ev_win_head_cont_prefix="hr_ev_win_head_cont_",_hr_ev_ib_cont_prefix="hr_ev_evmkts_ib_",_hr_ev_pf_cont_prefix="hr_ev_evmkts_pf_",_hr_ev_win_cont_prefix="hr_ev_evmkts_win_",_hr_ev_evmkt_head_prefix="hr_ev_evmkt_head_",_hr_ev_win_head_cont_ftc_prefix="hr_ev_win_head_cont_ftc_",_hr_ev_runners_ftc_prefix="hr_ev_runners_ftc_",_hr_ev_runner_ftc_prefix="hr_ev_runner_ftc_",_hr_ev_evmkts_ftc_prefix="hr_ev_evmkts_ftc_",_hr_ev_evmkt_ftc_prefix="hr_ev_evmkt_ftc_",_hr_ev_evmkt_head_ftc_prefix="hr_ev_evmkt_head_ftc_",_hr_ev_win_cont_ftc_prefix="hr_ev_evmkts_win_ftc_",_hr_ev_selcns_ftc_prefix="hr_ev_selcns_ftc_",_hr_ev_selcn_ftc_prefix="hr_ev_selcn_ftc_",_hr_ev_selcn_price_ftc_prefix="hr_ev_selcn_price_ftc_",_hr_ev_event_cb_help_cont_prefix="hr_ev_event_cb_help_cont_",_hr_ev_event_cb_help_prefix="hr_ev_event_cb_help_",_hr_ev_event_cb_graphic_prefix="hr_ev_event_cb_graphic_",_hr_ev_event_cb_graphic_price_prefix="hr_ev_event_cb_graphic_price_",_hr_ev_runners_cb_prefix="hr_ev_runners_cb_",_hr_ev_runners_cb_graphic_prefix="hr_ev_runners_cb_graphic_",_hr_ev_runner_cb_prefix="hr_ev_runner_cb_",_hr_ev_runner_cb_graphic_prefix="hr_ev_runner_cb_graphic_",_hr_ev_runner_cb_graphic_blank_prefix="hr_ev_runner_cb_graphic_blank_",_hr_ev_evmkt_head_cont_cb_prefix="hr_ev_mkt_header_cont_cb_",_hr_ev_evmkt_head_cb_prefix="hr_ev_mkt_header_cb_",_hr_ev_evmkt_prices_cb_prefix="hr_ev_mkt_prices_cb_",_hr_ev_evmkt_price_cb_prefix="hr_ev_mkt_price_cb_",_hr_ev_evmkt_cb_control_cont_prefix="hr_ev_mkt_cb_control_cont_",_hr_ev_evmkt_cb_control_prefix="hr_ev_mkt_cb_control_",_hr_ev_selcn_prices_cb_prefix="hr_ev_selcn_prices_cb_",_hr_ev_selcn_price_cb_prefix="hr_ev_selcn_price_cb_",_hr_ev_selcn_cb_control_cont_prefix="hr_ev_selcn_cb_control_cont_",_hr_ev_selcn_cb_control_prefix="hr_ev_selcn_cb_control_",_hr_ev_extra_markets_cont_prefix="exm_",_hr_ev_extra_markets_cont_elem_prefix="sm_ev_",_hr_ev_expander_prefix="hr_ev_expander_",_hr_ev_qv_header="qv_header_",_hr_ev_selcn_base_class="odd",_hr_ev_cb_selcn_base_class="odds",_hr_ev_cb_event_price_base_class="price",_hr_ev_hl_timers={},_hr_ev_hash={},_hr_ev_templates_prepared=false,hr_ev_played_rp_template=0
function _hr_ev_got_EVENT(data,handler,pushed){var info=handler.event_hash[data.ev_id],is_new_item=!info,orig_bettable,orig_displayed;if(is_new_item){info=data;handler.event_hash[data.ev_id]=info;info.hidden=false;info.child_hash={};info.from_search=from_search;if(filter_type=="J"||filter_type=="T"){info.filtered=true}else info.filtered=false}else{orig_bettable=info.bettable;orig_displayed=info.displayed;for(var f in data)info[f]=data[f]};info.name=info.names[handler.cfg.lang];var max=handler.cfg.event_name_trunc_threshold;if(info.name.length>max)info.name=info.name.substr(0,max)+'&hellip;';if(info.is_american==0&&is_list==0&&info.is_virtual==0&&info.is_generic==0)info.name=info.name.replace(/^\d\d:\d\d /,'');info.bettable=info.status=="A";info.type_name=info.type_names[handler.cfg.lang];info.img_url=handler.cfg.image_url;info.link_url=handler.cfg.link_url;info.is_list=is_list;info.open_tab=handler.open_tab;info.sort_col=handler.sort_col;info.sort_dir=handler.sort_dir;if(info.before_ev_url!=""){info.before_ev_desc=info.before_ev_descs[handler.cfg.lang]}else info.before_ev_desc="";if(info.after_ev_url!=""){info.after_ev_desc=info.after_ev_descs[handler.cfg.lang]}else info.after_ev_desc="";if(info.station_num>0)for(var i=0;i<info.stations.length;i++){var station=info.stations[i];info.stations[i].name=station.station_xls[handler.cfg.lang]};info.expander=handler.expander;info.win_array=info.win_disp.split(" ");info.placed_array=info.placed_disp.split(" ");info.ins_array=info.ins_disp.split(" ");info.has_stream=0;if((info.stream_avail==1)||(info.rp_stream_avail==1)||(info.cb_stream_avail==1)||(info.wc_stream_avail==1))info.has_stream=1;if(!is_list)hr_ev_setup_bir_redirect(info);info.ev_start_time=info.start_time.substring(11,16);info.bids_status_text=_hr_ev_bids_status_xl(info.bids_status);info.ev_special_blurb=info.ev_special_blurbs[handler.cfg.lang];info.ev_special_cond=info.ev_special_conds[handler.cfg.lang].replace(new RegExp('\r?\n','g'),'<br />');info.ev_class_blurb=info.ev_class_blurbs[handler.cfg.lang];var scitem_id=_hr_ev_event_prefix+info.ev_id,pscone_id=_hr_ev_container_prefix+info.ev_id,was_visible=scone_item_exists(scitem_id),now_visible=(info.displayed=="Y"),event_info=handler.event_hash[info.ev_id];if(event_info.is_list){info.bet_origin="HR_EV_LIST"}else info.bet_origin="HR_EV";if(handler.cfg.bet_origin!="")info.bet_origin=handler.cfg.bet_origin;var html=tmpl_play("hr_ev_event",info),sort_info={};if(!was_visible&&now_visible){scone_add_item(pscone_id,scitem_id,html,sort_info,null,!pushed);if(!handler.is_simple){var cscone_id=_hr_ev_ib_head_cont_prefix+info.ev_id;scone_create(cscone_id,{},hr_ev_cmp_objects.cmpEvMkts,null)};var cscone_id=_hr_ev_pf_head_cont_prefix+info.ev_id;scone_create(cscone_id,{},hr_ev_cmp_objects.cmpEvMkts,null);var cscone_id=_hr_ev_win_head_cont_prefix+info.ev_id;scone_create(cscone_id,{},hr_ev_cmp_objects.cmpEvMkts,null);var cscone_id=_hr_ev_runners_prefix+info.ev_id;scone_create(cscone_id,{},hr_ev_cmp_objects.cmpRunners,null);var cscone_id=_hr_ev_win_head_cont_ftc_prefix+info.ev_id;scone_create(cscone_id,{},null,null);var cscone_id=_hr_ev_runners_ftc_prefix+info.ev_id;scone_create(cscone_id,{},hr_ev_cmp_objects.cmpRunners,null);if(info.has_cb_avail=="Y"){var cscone_id=_hr_ev_evmkt_head_cont_cb_prefix+info.ev_id;scone_create(cscone_id,{},null,null);var cscone_id=_hr_ev_event_cb_help_cont_prefix+info.ev_id;scone_create(cscone_id,{},null,null);var cscone_id=_hr_ev_runners_cb_graphic_prefix+info.ev_id;scone_create(cscone_id,{},cb_graphic.compare_selections,'cb');var cscone_id=_hr_ev_runners_cb_prefix+info.ev_id;scone_create(cscone_id,{},hr_ev_cmp_objects.cmpRunners,null)};if(info.has_extra_markets){var cscone_id=_hr_ev_extra_markets_cont_prefix+info.ev_id;scone_create(cscone_id,{},null,null)}}else if(was_visible&&now_visible){scone_replace_item(scitem_id,html,sort_info,true)}else if(was_visible&&!now_visible){scone_remove_item(scitem_id);if(info.has_extra_markets)handler.extra_markets_loaded=0};if(handler.cb_built===1)cb_graphic.update_price(info.ev_id);if((orig_displayed!=info.displayed||orig_bettable!=info.bettable)&&pushed)for(var ev_mkt_id in info.child_hash){_hr_ev_got_EVMKT({ev_id:info.ev_id,ev_mkt_id:ev_mkt_id},handler,pushed);if(handler.ftc_built==1)_hr_ev_got_ftc_EVMKT({ev_id:info.ev_id,ev_mkt_id:ev_mkt_id},handler,pushed);if(handler.cb_built==1)_hr_ev_got_cb_EVMKT({ev_id:info.ev_id,ev_mkt_id:ev_mkt_id},handler,pushed)}}
function _hr_ev_got_RUNNER(data,handler,pushed){var info=handler.runner_hash[data.runner_id],is_new_item=!info,orig_bettable;if(is_new_item){var parent_info=handler.event_hash[data.ev_id]}else var parent_info=handler.event_hash[info.ev_id];if(!parent_info)return;if(is_new_item){info=data;handler.runner_hash[data.runner_id]=info;info.hidden=false;info.show_ins=false;info.show_plc=false;info.displayed="Y";info.placed_num=0;info.ins_num=0;info.plc_dummy_num=0;info.ins_dummy_num=0;info.plc_disps=new Object();info.ins_disps=new Object()}else{orig_bettable=info.bettable;for(var f in data)info[f]=data[f]};if(pushed){info.mkt_num=_hr_ev_count_displayed_markets(handler)}else info.mkt_num=parent_info.mkt_num;info.horse_name=info.horse_names[handler.cfg.lang];info.jockey_name=info.jockey_names[handler.cfg.lang];info.jockey_name_display=trunc_string(info.jockey_name,handler.cfg.jockey_name_max_chars,'...');info.pa_feed_trainer_name_display=trunc_string(info.pa_feed_trainer_name,handler.cfg.trainer_name_max_chars,'...');info.has_form=info.has_rp;info.pushed=pushed;if(pushed){info.rp_built=1}else info.rp_built=0;info.silk_url=handler.cfg.silk_url;info.video_url=handler.cfg.video_url;info.is_simple=parent_info.is_simple;info.is_american=parent_info.is_american;info.search_url=handler.cfg.search_link;if(info.rp_rating==parent_info.max_rp_rating){info.max_rp_rating=true}else info.max_rp_rating=false;info.runner_filtered=false;info.filtered=parent_info.filtered;if(parent_info.filtered)if(filter_type=="J"&&info.jockey_name==filter_text){info.runner_filtered=true}else if(filter_type=="T"&&info.pa_feed_trainer_name==filter_text)info.runner_filtered=true;if(info.search_url!=""&&info.jockey_in_other_races==1){info.j_search_url=info.search_url+'?racethru=j&search_term='+info.jockey_name}else info.j_search_url="";if(info.search_url!=""&&info.trainer_in_other_races==1){info.t_search_url=info.search_url+'?racethru=t&search_term='+info.pa_feed_trainer_name}else info.t_search_url="";if(info.has_rp)info.form_num=info.fr_race_form.num_form;info.prev_odds_string="";info.prev_odds_class="";var j=0,wew_info=handler.selcn_hash[data.wew_ev_oc_id];if(wew_info){var curr_lp_num=wew_info.lp_num,curr_lp_den=wew_info.lp_den}else{var curr_lp_num=info.lp_num,curr_lp_den=info.lp_den};for(j=0;j<info.prev_odds.num_odds;j++){if(info.prev_odds_string==""){info.prev_odds_string=_hr_ev_get_price_str(handler,info.prev_odds[j].p_num,info.prev_odds[j].p_den,'Y','--')}else info.prev_odds_string=info.prev_odds_string+" "+_hr_ev_get_price_str(handler,info.prev_odds[j].p_num,info.prev_odds[j].p_den,'Y','--');if(j==info.prev_odds.num_odds-1&&curr_lp_num!=""&&curr_lp_den!=""){var d=info.prev_odds[j].p_num*curr_lp_den-curr_lp_num*info.prev_odds[j].p_den;if(d>0){info.prev_odds_class="down"}else if(d<0)info.prev_odds_class="up"}};info.expander=handler.expander;var pscone_id=_hr_ev_runners_prefix+info.ev_id,scitem_id=_hr_ev_runner_prefix+info.ev_id+"_"+info.runner_id,was_visible=scone_item_exists(scitem_id),now_visible=true;info.hide=false;if(pushed){now_visible=info.displayed=="Y";info.hide=info.displayed=="N"};if(info.fb_result==1||info.fb_result==2){var html=tmpl_play("hr_ev_runner_fav",info)}else var html=tmpl_play("hr_ev_runner",info);var sort_info={runner_id:info.runner_id,ev_id:info.ev_id},no_sort=!pushed;if(!was_visible&&now_visible){scone_add_item(pscone_id,scitem_id,html,sort_info,no_sort,!pushed);if(info.fb_result!=1&&info.fb_result!=2){if(!handler.is_us_vr&&!handler.is_simple){var cscone_id=_hr_ev_ib_cont_prefix+info.ev_id+"_"+info.runner_id;scone_create(cscone_id,{},hr_ev_cmp_objects.cmpEvMkts,null)};var cscone_id=_hr_ev_pf_cont_prefix+info.ev_id+"_"+info.runner_id;scone_create(cscone_id,{},hr_ev_cmp_objects.cmpEvMkts,null)};var cscone_id=_hr_ev_win_cont_prefix+info.ev_id+"_"+info.runner_id;scone_create(cscone_id,{},hr_ev_cmp_objects.cmpEvMkts,null);if(!handler.is_simple)if(handler.expander=="opened")_hr_ev_expand_toggle_runner(info.ev_id,info.runner_id,true,false)}else if(was_visible&&now_visible){scone_replace_item(scitem_id,html,sort_info,true);if(pushed&&handler.expander=="opened"&&!handler.is_simple)_hr_ev_expand_toggle_runner(info.ev_id,info.runner_id,true,false)}else if(was_visible&&!now_visible){scone_replace_item(scitem_id,html,sort_info,true);if(pushed&&handler.expander=="opened"&&!handler.is_simple)_hr_ev_expand_toggle_runner(info.ev_id,info.runner_id,true,false)};if(handler.cb_built===1){var pscone_id=_hr_ev_runners_cb_graphic_prefix+info.ev_id,scitem_id=_hr_ev_runner_cb_graphic_prefix+info.ev_id+'_'+wew_info.ev_oc_id;if(scone_exists(pscone_id)&&scone_item_exists(scitem_id)){var tmp_runner=$j.extend({},info);tmp_runner.wew_ev_oc_id=wew_info.ev_oc_id;tmp_runner.bettable=wew_info.bettable;tmp_runner.price_str=wew_info.price_str;var scone_item_info=scone_get_item_info(scitem_id),html=tmpl_play('hr_ev_runner_cb_graphic',tmp_runner);scone_replace_item(scitem_id,html,scone_item_info,true);cb_graphic.restyle_positions(info.ev_id)}};if(pushed)tooltip_init()}
function _hr_ev_count_displayed_markets(handler){var count=0;for(var ev_mkt_id in handler.evmkt_hash)if(handler.evmkt_hash[ev_mkt_id].displayed=="Y")count++;return count}
function _hr_ev_got_ftc_RUNNER(data,handler,pushed){var info=handler.runner_hash[data.runner_id],is_new_item=!info,orig_bettable;if(is_new_item){var parent_info=handler.event_hash[data.ev_id]}else var parent_info=handler.event_hash[info.ev_id];if(!parent_info)return;var pscone_id_ftc=_hr_ev_runners_ftc_prefix+info.ev_id,scitem_id_ftc=_hr_ev_runner_ftc_prefix+info.ev_id+"_"+info.runner_id,was_visible=scone_item_exists(scitem_id_ftc),now_visible=true;info.hide=false;if(pushed){now_visible=info.displayed=="Y";info.hide=info.displayed=="N"};if(info.fb_result==1||info.fb_result==2||info.fb_result=="N"){return}else var html_ftc=tmpl_play("hr_ev_runner_ftc",info);var sort_info={runner_id:info.runner_id,ev_id:info.ev_id};if(!was_visible&&now_visible){scone_add_item(pscone_id_ftc,scitem_id_ftc,html_ftc,sort_info,false,!pushed);var cscone_id=_hr_ev_win_cont_ftc_prefix+info.ev_id+"_"+info.runner_id;scone_create(cscone_id,{},hr_ev_cmp_objects.cmpEvMkts,null)}else if(was_visible&&now_visible){scone_replace_item(scitem_id_ftc,html_ftc,sort_info,true)}else if(was_visible&&!now_visible)scone_replace_item(scitem_id_ftc,html_ftc,sort_info,true)}
function _hr_ev_got_cb_RUNNER(data,handler,pushed){var info=handler.runner_hash[data.runner_id];if(!info)return;var parent_info=handler.event_hash[info.ev_id];if(!parent_info)return;var pscone_id_cb=_hr_ev_runners_cb_prefix+info.ev_id,scitem_id_cb=_hr_ev_runner_cb_prefix+info.ev_id+"_"+info.runner_id,was_visible=scone_item_exists(scitem_id_cb),now_visible=true;info.hide=false;if(pushed){now_visible=info.displayed=="Y";info.hide=info.displayed=="N"};if(info.fb_result==1||info.fb_result==2){return}else var html_cb=tmpl_play("hr_ev_runner_cb",info);var sort_info={runner_id:info.runner_id,ev_id:info.ev_id};if(!was_visible&&now_visible){scone_add_item(pscone_id_cb,scitem_id_cb,html_cb,sort_info,false,!pushed);var prices_cscone_id=_hr_ev_evmkt_prices_cb_prefix+info.ev_id+"_"+info.runner_id;scone_create(prices_cscone_id,{},null,null);var control_cscone_id=_hr_ev_evmkt_cb_control_cont_prefix+info.ev_id+"_"+info.runner_id;scone_create(control_cscone_id,{},null,null)}else if(was_visible&&now_visible){scone_replace_item(scitem_id_cb,html_cb,sort_info,true)}else if(was_visible&&!now_visible)scone_replace_item(scitem_id_cb,html_cb,sort_info,true)}
function _hr_ev_got_EVMKT(data,handler,pushed){var info=handler.evmkt_hash[data.ev_mkt_id],is_new_item=!info,orig_bettable,orig_displayed,orig_lp_avail;if(is_new_item){var parent_info=handler.event_hash[data.ev_id]}else var parent_info=handler.event_hash[info.ev_id];if(!parent_info)return;parent_info.child_hash[data.ev_mkt_id]=true;if(is_new_item){info=data;handler.evmkt_hash[data.ev_mkt_id]=info;info.child_hash={};info.hidden=false}else{orig_bettable=info.bettable;orig_displayed=info.displayed;orig_lp_avail=info.lp_avail;orig_num_mkts=parent_info.mkt_num;for(var f in data)info[f]=data[f]};info.sort_col=handler.sort_col;info.sort_dir=handler.sort_dir;if(pushed&&is_new_item){var found=0;for(var j=0;j<parent_info.win_array.length&&found==0;j++)if(parent_info.win_array[j]==info.disporder)return;for(var k=0;k<parent_info.placed_array.length&&found==0;k++)if(parent_info.placed_array[k]==info.disporder){found=1;info.mkt_cat="PL"};for(var l=0;l<parent_info.ins_array.length&&found==0;l++)if(parent_info.ins_array[l]==info.disporder){found=1;info.mkt_cat="INS"};if(!found)return};info.bettable=(info.status=="A")&&parent_info.bettable;info.name=info.names[handler.cfg.lang];if(info.mkt_tooltips)info.mkt_tooltip=info.mkt_tooltips[handler.cfg.lang];info.is_simple=parent_info.is_simple;var mkt_template="",mkt_head_template="",mkt_parent_prefix="";info.ew_text="";info.cashout_avail=parent_info.event_cashout_avail;info.num_mkts=_hr_ev_count_displayed_markets(handler);parent_info.mkt_num=info.num_mkts;if(pushed){var rebuild_runners=false;if(orig_num_mkts>1&&info.num_mkts==1){rebuild_runners=true;if(handler.expander=="opened"){hr_ev_change_tab("qv",parent_info.ev_id);_hr_ev_toggle_all_mkts_btn(parent_info.ev_id,false)}}else if(orig_num_mkts==1&&info.num_mkts>1){rebuild_runners=true;_hr_ev_toggle_all_mkts_btn(parent_info.ev_id,true)};if(rebuild_runners){var runner=null;for(var runner_id in handler.runner_hash){runner=handler.runner_hash[runner_id];if(runner)_hr_ev_got_RUNNER(runner,handler,true)}}};if(info.mkt_cat=="EW"){mkt_head_template="hr_ev_mkt_header_win";mkt_parent_head_prefix=_hr_ev_win_head_cont_prefix;if(info.ew_avail=="Y"){var ew_string="";if(info.ew_fac_num!=""&&info.ew_fac_den!=""){ew_string="<strong>"+_hr_ev_ew_odds+"&raquo;</strong> "+info.ew_fac_num+"/"+info.ew_fac_den+" ";info.ew_text=info.ew_fac_num+"/"+info.ew_fac_den+" "};if(info.ew_places!=""){var place_string="";for(var k=1;k<=info.ew_places;k++)if(k==info.ew_places){place_string+=k}else place_string+=k+",";ew_string+=place_string;info.ew_text+=place_string};var footer_elem=document.getElementById('hr_ev_event_footer_'+info.ev_id);if(footer_elem)footer_elem.innerHTML=ew_string}}else if(info.mkt_cat=="PL"){mkt_head_template="hr_ev_mkt_header";mkt_parent_head_prefix=_hr_ev_pf_head_cont_prefix}else if(info.mkt_cat=="INS"&&!handler.is_simple){mkt_head_template="hr_ev_mkt_header";mkt_parent_head_prefix=_hr_ev_ib_head_cont_prefix}else return;var now_visible=(info.displayed=="Y"),scitem_id=_hr_ev_evmkt_head_prefix+info.ev_id+"_"+info.ev_mkt_id,pscone_id=mkt_parent_head_prefix+info.ev_id,was_visible=scone_item_exists(scitem_id),html=tmpl_play(mkt_head_template,info),sort_info={ev_mkt_id:info.ev_mkt_id,disporder:info.disporder,ev_id:info.ev_id};if(!was_visible&&now_visible){scone_add_item(pscone_id,scitem_id,html,sort_info,null,!pushed);if(info.mkt_cat=="PL"&&pushed&&!handler.is_simple){parent_info.placed_num++;if(parent_info.plc_dummy_num>0){var dummy_num=parent_info.plc_dummy_num-1,dummy_info={ev_id:parent_info.ev_id,type:"PL",dummy_num:dummy_num,disporder:"-9999"};_hr_ev_got_DUMMYMKT(handler,dummy_info,false,pushed);parent_info.plc_dummy_num--}};if(info.mkt_cat=="INS"&&pushed&&!handler.is_simple){parent_info.ins_num++;if(parent_info.ins_dummy_num>0){var dummy_num=parent_info.ins_dummy_num-1,dummy_info={ev_id:parent_info.ev_id,type:"INS",dummy_num:dummy_num,disporder:"-9999"};_hr_ev_got_DUMMYMKT(handler,dummy_info,false,pushed);parent_info.ins_dummy_num--}};if(pushed&&!handler.is_simple)_hr_build_dummy_selns(handler,info.ev_mkt_id,parent_info)}else if(was_visible&&now_visible){scone_replace_item(scitem_id,html,sort_info,true)}else if(was_visible&&!now_visible){scone_remove_item(scitem_id);if(info.mkt_cat=="PL"&&pushed&&!handler.is_simple){parent_info.placed_num--;var dummy_num=parent_info.plc_dummy_num,dummy_info={ev_id:parent_info.ev_id,type:"PL",dummy_num:dummy_num,disporder:"-9999"};_hr_ev_got_DUMMYMKT(handler,dummy_info,true,pushed);parent_info.plc_dummy_num++;for(var runner_id in handler.runner_hash){var runner_info=handler.runner_hash[runner_id];if(runner_info.plc_dummy_num>0&&!runner_info.plc_disps[info.disporder]){var dummy_info={ev_id:info.ev_id,type:info.mkt_cat,dummy_num:info.disporder,disporder:info.disporder};_hr_ev_got_DUMMYSELCN(runner_id,handler,dummy_info,false,pushed);runner_info.plc_dummy_num--}else{runner_info.placed_num--;runner_info.plc_disps[info.disporder]=0}}};if(info.mkt_cat=="INS"&&pushed&&!handler.is_simple){parent_info.ins_num--;var dummy_num=parent_info.ins_dummy_num,dummy_info={ev_id:parent_info.ev_id,type:"INS",dummy_num:dummy_num,disporder:"-9999"};_hr_ev_got_DUMMYMKT(handler,dummy_info,true,pushed);parent_info.ins_dummy_num++;for(var runner_id in handler.runner_hash){var runner_info=handler.runner_hash[runner_id];if(runner_info.ins_dummy_num>0&&!runner_info.ins_disps[info.disporder]){var dummy_info={ev_id:info.ev_id,type:info.mkt_cat,dummy_num:info.disporder,disporder:info.disporder};_hr_ev_got_DUMMYSELCN(runner_id,handler,dummy_info,false,pushed);runner_info.ins_dummy_num--}else{runner_info.ins_num--;runner_info.ins_disps[info.disporder]=0}}}};if((orig_displayed!=info.displayed||orig_bettable!=info.bettable||orig_lp_avail!=info.lp_avail)&&pushed)for(var ev_oc_id in info.child_hash)_hr_ev_got_SELCN({ev_oc_id:ev_oc_id,ev_mkt_id:info.ev_mkt_id},handler,pushed)}
function _hr_ev_got_ftc_EVMKT(data,handler,pushed){var info=handler.evmkt_hash[data.ev_mkt_id];if(info.mkt_cat!="EW")return;var is_new_item=!info,orig_bettable,orig_displayed;if(is_new_item){var parent_info=handler.event_hash[data.ev_id]}else var parent_info=handler.event_hash[info.ev_id];if(!parent_info)return;var now_visible=(info.displayed=="Y"),scitem_id_ftc=_hr_ev_evmkt_head_ftc_prefix+info.ev_id+"_"+info.ev_mkt_id,pscone_id_ftc=_hr_ev_win_head_cont_ftc_prefix+info.ev_id,was_visible=scone_item_exists(scitem_id_ftc),html_ftc=tmpl_play("hr_ev_mkt_header_win_ftc",info),sort_info={ev_mkt_id:info.ev_mkt_id,disporder:info.disporder,ev_id:info.ev_id};if(!was_visible&&now_visible){scone_add_item(pscone_id_ftc,scitem_id_ftc,html_ftc,sort_info,null,!pushed)}else if(was_visible&&now_visible){scone_replace_item(scitem_id_ftc,html_ftc,sort_info,true)}else if(was_visible&&!now_visible)scone_remove_item(scitem_id_ftc);for(var runner_id in handler.runner_hash){info.runner_id=runner_id;var runner_info=handler.runner_hash[runner_id];if(runner_info.fb_result!=1&&runner_info.fb_result!=2&&runner_info.fb_result!="N"){pscone_id_ftc=_hr_ev_win_cont_ftc_prefix+info.ev_id+"_"+runner_id;scitem_id_ftc=_hr_ev_evmkt_ftc_prefix+info.ev_id+"_"+runner_id+"_"+info.ev_mkt_id;was_visible=scone_item_exists(scitem_id_ftc);html_ftc=tmpl_play("hr_ev_mkt_ftc",info);if(!was_visible&&now_visible){scone_add_item(pscone_id_ftc,scitem_id_ftc,html_ftc,sort_info,null,!pushed);cscone_id=_hr_ev_selcns_ftc_prefix+info.ev_id+"_"+runner_id+"_"+info.ev_mkt_id;scone_create(cscone_id,{},null,null)}else if(was_visible&&now_visible){scone_replace_item(scitem_id_ftc,html_ftc,sort_info,true)}else if(was_visible&&!now_visible)scone_remove_item(scitem_id_ftc)}};if(pushed)for(var ev_oc_id in info.child_hash)_hr_ev_got_ftc_SELCN({ev_oc_id:ev_oc_id,ev_mkt_id:info.ev_mkt_id},handler,pushed)}
function _hr_ev_got_cb_EVMKT(data,handler,pushed){var info=handler.evmkt_hash[data.ev_mkt_id];if(!info)return;if(info.mkt_cat!="EW")return;var is_new_item=!info;if(is_new_item){var parent_info=handler.event_hash[data.ev_id]}else var parent_info=handler.event_hash[info.ev_id];if(!parent_info)return;var now_visible=(info.displayed=="Y"),scitem_id_cb_mkt_head=_hr_ev_evmkt_head_cb_prefix+info.ev_id+"_"+info.ev_mkt_id,pscone_id_cb_mkt_head=_hr_ev_evmkt_head_cont_cb_prefix+info.ev_id,head_was_visible=scone_item_exists(scitem_id_cb_mkt_head),html_cb_mkt_head=tmpl_play("hr_ev_mkt_header_cb",info),sort_info={ev_mkt_id:info.ev_mkt_id,disporder:info.disporder,ev_id:info.ev_id};if(!head_was_visible&&now_visible){scone_add_item(pscone_id_cb_mkt_head,scitem_id_cb_mkt_head,html_cb_mkt_head,sort_info,null,!pushed)}else if(head_was_visible&&now_visible){scone_replace_item(scitem_id_cb_mkt_head,html_cb_mkt_head,sort_info,true)}else if(head_was_visible&&!now_visible)scone_remove_item(scitem_id_cb_mkt_head);if(data.bettable){cb_graphic.event_wew_market_bettable(data.ev_id)}else cb_graphic.event_wew_market_unbettable(data.ev_id);for(var runner_id in handler.runner_hash){info.runner_id=runner_id;var runner_info=handler.runner_hash[runner_id];if(runner_info.fb_result!=1&&runner_info.fb_result!=2){pscone_id_prices_cb=_hr_ev_evmkt_prices_cb_prefix+info.ev_id+"_"+runner_id;scitem_id_price_cb=_hr_ev_evmkt_price_cb_prefix+info.ev_id+"_"+runner_id+"_"+info.ev_mkt_id;mkt_price_was_visible=scone_item_exists(scitem_id_price_cb);if(scone_exists(pscone_id_prices_cb)){html_prices_cb=tmpl_play("hr_ev_mkt_price_cb",info);if(!mkt_price_was_visible&&now_visible){scone_add_item(pscone_id_prices_cb,scitem_id_price_cb,html_prices_cb,sort_info,null,!pushed);selcn_prices_cscone_id=_hr_ev_selcn_prices_cb_prefix+info.ev_id+"_"+runner_id+"_"+info.ev_mkt_id;scone_create(selcn_prices_cscone_id,{},null,null)}else if(mkt_price_was_visible&&now_visible){scone_replace_item(scitem_id_price_cb,html_prices_cb,sort_info,true)}else if(mkt_price_was_visible&&!now_visible)scone_remove_item(scitem_id_price_cb)};pscone_id_cb_control=_hr_ev_evmkt_cb_control_cont_prefix+info.ev_id+"_"+runner_id;scitem_id_cb_control=_hr_ev_evmkt_cb_control_prefix+info.ev_id+"_"+runner_id+"_"+info.ev_mkt_id;mkt_control_was_visible=scone_item_exists(scitem_id_cb_control);if(scone_exists(pscone_id_prices_cb)){html_cb_control=tmpl_play("hr_ev_mkt_cb_control",info);if(!mkt_control_was_visible&&now_visible){scone_add_item(pscone_id_cb_control,scitem_id_cb_control,html_cb_control,sort_info,null,!pushed);selcn_control_cscone_id=_hr_ev_selcn_cb_control_cont_prefix+info.ev_id+"_"+runner_id+"_"+info.ev_mkt_id;scone_create(selcn_control_cscone_id,{},null,null)}else if(mkt_control_was_visible&&now_visible){scone_replace_item(scitem_id_cb_control,html_cb_control,sort_info,true)}else if(mkt_control_was_visible&&!now_visible)scone_remove_item(scitem_id_cb_control)}}};if(pushed)for(var ev_oc_id in info.child_hash)_hr_ev_got_cb_SELCN({ev_oc_id:ev_oc_id,ev_mkt_id:info.ev_mkt_id},handler,pushed)}
function _hr_ev_got_DUMMYMKT(handler,info,add,pushed){var pscone_id="",h_pscone_id="",h_pscone_id="",h_scitem_id="",market_type=info.type,event_info=handler.event_hash[info.ev_id];if(info.type=="PL"){h_pscone_id=_hr_ev_pf_head_cont_prefix+info.ev_id;h_scitem_id=_hr_ev_evmkt_head_prefix+info.ev_id+"_dummy_PL_"+info.dummy_num}else if(info.type=="INS"){h_pscone_id=_hr_ev_ib_head_cont_prefix+info.ev_id;h_scitem_id=_hr_ev_evmkt_head_prefix+info.ev_id+"_dummy_INS_"+info.dummy_num}else return;var sort_info={disporder:"-9999"};if(add){var html=tmpl_play("hr_ev_mkt_header_dummy",info);scone_add_item(h_pscone_id,h_scitem_id,html,sort_info,null,!pushed)}else scone_remove_item(h_scitem_id);var scitem_id="";for(var runner_id in handler.runner_hash)_hr_ev_got_DUMMYSELCN(runner_id,handler,info,add,pushed)}
function _hr_ev_got_SELCN(data,handler,pushed){var parent_info=handler.evmkt_hash[data.ev_mkt_id];if(!parent_info)return;parent_info.child_hash[data.ev_oc_id]=true;var info=handler.selcn_hash[data.ev_oc_id],is_new_item=!info,orig_lp_num,orig_lp_den,orig_hcap_value,orig_fb_runner;if(is_new_item){if(data.link_key=="")return;info=data;info.ev_id=parent_info.ev_id;handler.selcn_hash[data.ev_oc_id]=info;info.init_lp_num=info.lp_num;info.init_lp_den=info.lp_den;info.selected_cb=false}else{orig_lp_num=info.lp_num;orig_lp_den=info.lp_den;orig_hcap_value=info.hcap_value;orig_fb_runner=info.fb_runner;for(var f in data)info[f]=data[f]};var event_info=handler.event_hash[info.ev_id];info.name=info.names[handler.cfg.lang];if(event_info.is_list){info.bet_origin="HR_EV_LIST"}else info.bet_origin="HR_EV";if(handler.cfg.bet_origin!="")info.bet_origin=handler.cfg.bet_origin;info.bettable=(info.status=="A")&&parent_info.bettable;info.mkt_sp_avail=parent_info.sp_avail;info.mkt_lp_avail=parent_info.lp_avail;var mkt_parent_prefix="";if(parent_info.mkt_cat=="EW"){mkt_parent_prefix=_hr_ev_win_cont_prefix}else if(parent_info.mkt_cat=="PL"){mkt_parent_prefix=_hr_ev_pf_cont_prefix}else if(parent_info.mkt_cat=="INS"&&!handler.is_simple){mkt_parent_prefix=_hr_ev_ib_cont_prefix}else return;info.mkt_cat=parent_info.mkt_cat;var scitem_id=_hr_ev_selcn_prefix+info.ev_id+"_"+info.link_key+"_"+info.ev_mkt_id+"_"+info.ev_oc_id,pscone_id=mkt_parent_prefix+info.ev_id+"_"+info.link_key;if(!scone_exists(pscone_id))return;var now_visible=(info.displayed=="Y")&&(parent_info.displayed=="Y"),parent_visible=(parent_info.displayed=="Y");info.now_visible=now_visible;info.price_str=_hr_ev_get_price_str(handler,info.lp_num,info.lp_den,parent_info.lp_avail,parent_info.mkt_sort);var runner_info=handler.runner_hash[info.link_key];if(runner_info&&parent_info.mkt_cat!="EW"&&runner_info.fb_result=="N")info.fb_result=runner_info.fb_result;var sort_info={ev_mkt_id:info.ev_mkt_id,disporder:parent_info.disporder,ev_id:info.ev_id},html=tmpl_play("hr_ev_selcn",info),was_visible=scone_item_exists(scitem_id);if(!was_visible&&now_visible){scone_add_item(pscone_id,scitem_id,html,sort_info,null,!pushed);if(parent_visible&&parent_info.mkt_cat=="PL"&&!handler.is_simple){runner_info.placed_num++;runner_info.plc_disps[parent_info.disporder]=1;if(pushed&&runner_info.plc_dummy_num>0){var dummy_info={ev_id:info.ev_id,type:"PL",dummy_num:parent_info.disporder,disporder:parent_info.disporder};_hr_ev_got_DUMMYSELCN(info.link_key,handler,dummy_info,false,pushed);runner_info.plc_dummy_num--}};if(parent_visible&&parent_info.mkt_cat=="INS"&&!handler.is_simple){runner_info.ins_num++;runner_info.ins_disps[parent_info.disporder]=1;if(pushed&&runner_info.ins_dummy_num>0){var dummy_info={ev_id:info.ev_id,type:"INS",dummy_num:parent_info.disporder,disporder:parent_info.disporder};_hr_ev_got_DUMMYSELCN(info.link_key,handler,dummy_info,false,pushed);runner_info.ins_dummy_num--}}}else if(was_visible&&now_visible){scone_replace_item(scitem_id,html,sort_info,true)}else if(was_visible&&!now_visible){scone_remove_item(scitem_id);if(parent_visible&&parent_info.mkt_cat=="PL"&&!handler.is_simple){runner_info.placed_num--;runner_info.plc_disps[parent_info.disporder]=0;var dummy_info={ev_id:info.ev_id,type:"PL",dummy_num:parent_info.disporder,disporder:parent_info.disporder};_hr_ev_got_DUMMYSELCN(info.link_key,handler,dummy_info,true,pushed);runner_info.plc_dummy_num++};if(parent_visible&&parent_info.mkt_cat=="INS"&&!handler.is_simple){runner_info.ins_num--;runner_info.ins_disps[parent_info.disporder]=0;var dummy_info={ev_id:info.ev_id,type:"INS",dummy_num:parent_info.disporder,disporder:parent_info.disporder};_hr_ev_got_DUMMYSELCN(info.link_key,handler,dummy_info,true,pushed);runner_info.ins_dummy_num++}};if(!is_new_item&&now_visible&&info.bettable){_hr_ev_highlight_price_change(handler,info,orig_lp_num,orig_lp_den);if(event_info.cb_avail=="Y"&&handler.cb_built)_hr_ev_highlight_price_change_cb(handler,info,orig_lp_num,orig_lp_den)};if(((handler.runner_hash[info.link_key]).wew_ev_oc_id==info.ev_oc_id)&&(pushed&&!handler.is_us_vr)||!now_visible){var runner_info=handler.runner_hash[info.link_key];if(!runner_info)return;if(parent_info.mkt_cat=="EW"){runner_info.fb_result=info.fb_result;runner_info.horse_names=info.names;runner_info.displayed=info.displayed;runner_info.lp_avail=info.mkt_lp_avail;var d=info.lp_num*orig_lp_den-info.lp_den*orig_lp_num;if(d!=0&&orig_lp_num!=""&&orig_lp_den!="")if(runner_info.prev_odds.num_odds<3){runner_info.prev_odds[runner_info.prev_odds.num_odds]={};runner_info.prev_odds[runner_info.prev_odds.num_odds].p_num=orig_lp_num;runner_info.prev_odds[runner_info.prev_odds.num_odds].p_den=orig_lp_den;runner_info.prev_odds.num_odds++}else for(var i=0;i<3;i++)if(i==2){runner_info.prev_odds[i].p_num=orig_lp_num;runner_info.prev_odds[i].p_den=orig_lp_den}else{runner_info.prev_odds[i].p_num=runner_info.prev_odds[i+1].p_num;runner_info.prev_odds[i].p_den=runner_info.prev_odds[i+1].p_den};_hr_ev_got_RUNNER(runner_info,handler,true)}}}
function _hr_ev_got_ftc_SELCN(data,handler,pushed){var parent_info=handler.evmkt_hash[data.ev_mkt_id];if(!parent_info)return;var info=handler.selcn_hash[data.ev_oc_id];if(parent_info.mkt_cat!="EW"||info.fb_result=="N"||info.fb_result==2||info.fb_result==1)return;var orig_lp_num,orig_lp_den,orig_hcap_value,orig_fb_runner,event_info=handler.event_hash[info.ev_id];info.mkt_fc_avail=parent_info.fc_avail;info.mkt_tc_avail=parent_info.tc_avail;var scitem_id_ftc=_hr_ev_selcn_ftc_prefix+info.ev_id+"_"+info.link_key+"_"+info.ev_mkt_id+"_"+info.ev_oc_id,pscone_id_ftc=_hr_ev_selcns_ftc_prefix+info.ev_id+"_"+info.link_key+"_"+info.ev_mkt_id;if(!scone_exists(pscone_id_ftc))return;var now_visible=(info.displayed=="Y")&&(parent_info.displayed=="Y");info.now_visible=now_visible;var html_ftc=tmpl_play("hr_ev_selcn_ftc",info),was_visible=scone_item_exists(scitem_id_ftc);if(!was_visible){scone_add_item(pscone_id_ftc,scitem_id_ftc,html_ftc,null,null,!pushed)}else scone_replace_item(scitem_id_ftc,html_ftc,null,true)}
function _hr_ev_got_cb_SELCN(data,handler,pushed){var parent_info=handler.evmkt_hash[data.ev_mkt_id];if(!parent_info)return;var info=handler.selcn_hash[data.ev_oc_id];if(!info)return;if(parent_info.mkt_cat!="EW"||info.fb_result==2||info.fb_result==1)return;var event_info=handler.event_hash[info.ev_id],scitem_id_selcn_prices_cb=_hr_ev_selcn_price_cb_prefix+info.ev_id+"_"+info.link_key+"_"+info.ev_mkt_id+"_"+info.ev_oc_id,pscone_id_selcn_prices_cb=_hr_ev_selcn_prices_cb_prefix+info.ev_id+"_"+info.link_key+"_"+info.ev_mkt_id,scitem_id_selcn_cb_control=_hr_ev_selcn_cb_control_prefix+info.ev_id+"_"+info.link_key+"_"+info.ev_mkt_id+"_"+info.ev_oc_id,pscone_id_selcn_cb_control=_hr_ev_selcn_cb_control_cont_prefix+info.ev_id+"_"+info.link_key+"_"+info.ev_mkt_id,now_visible=(info.displayed=="Y")&&(parent_info.displayed=="Y");info.now_visible=now_visible;if(scone_exists(pscone_id_selcn_prices_cb)){var html_cb_prices=tmpl_play("hr_ev_seln_cb_price",info),was_visible=scone_item_exists(scitem_id_selcn_prices_cb);if(!was_visible){scone_add_item(pscone_id_selcn_prices_cb,scitem_id_selcn_prices_cb,html_cb_prices,null,null,!pushed)}else scone_replace_item(scitem_id_selcn_prices_cb,html_cb_prices,null,true)};if(scone_exists(pscone_id_selcn_cb_control)){var html_cb_control=tmpl_play("hr_ev_seln_cb_control",info),was_visible=scone_item_exists(scitem_id_selcn_cb_control);if(!was_visible){scone_add_item(pscone_id_selcn_cb_control,scitem_id_selcn_cb_control,html_cb_control,null,null,!pushed)}else scone_replace_item(scitem_id_selcn_cb_control,html_cb_control,null,true)};cb_graphic.update_add_buttons(info.ev_id);cb_graphic.update_price(info.ev_id);if(pushed||!now_visible){var runner_info=handler.runner_hash[info.link_key];if(!runner_info)return;_hr_ev_got_cb_RUNNER(runner_info,handler,true)}}
function _hr_ev_got_DUMMYSELCN(runner_id,handler,info,add,pushed){var market_type=info.type,scitem_id=_hr_ev_evmkt_prefix+"dummy_"+info.ev_id+"_"+runner_id+"_"+market_type+"_"+info.dummy_num;if(market_type=="PL"){pscone_id=_hr_ev_pf_cont_prefix+info.ev_id+"_"+runner_id}else if(market_type=="INS")pscone_id=_hr_ev_ib_cont_prefix+info.ev_id+"_"+runner_id;if(add){info.runner_id=runner_id;var runner_info=handler.runner_hash[runner_id];if(scone_item_exists(scitem_id))return;if(runner_info.fb_result!=1&&runner_info.fb_result!=2){var html=tmpl_play("hr_ev_mkt_dummy",info);scone_add_item(pscone_id,scitem_id,html,info,null,!pushed)}}else{info.runner_id=runner_id;var runner_info=handler.runner_hash[runner_id];if(runner_info.fb_result!=1&&runner_info.fb_result!=2)scone_remove_item(scitem_id)}}
function _hr_ev_got_RP(ev_id,runner_id){var handler=_hr_ev_hash[ev_id];if(!hr_ev_played_rp_template){_hr_ev_store_rp_templates();hr_ev_played_rp_template=1};var info=handler.runner_hash[runner_id];if(info.rp_built||!info.has_rp)return;var html=tmpl_play("hr_ev_post_data",info),runner_el_id=_hr_ev_runner_prefix+ev_id+"_"+runner_id,runner_row=document.getElementById(runner_el_id),runner_col=runner_row.children[0],html_div=document.createElement("div");html_div.innerHTML=html;runner_col.appendChild(html_div);tooltip_init();info.rp_built=1}
function _hr_ev_got_PRICE(data,handler,rebuild_parents){var info=handler.selcn_hash[data.ev_oc_id];if(!info)return;var parent_info=handler.evmkt_hash[info.ev_mkt_id];if(!parent_info)return;var event_info=handler.event_hash[info.ev_id],orig_lp_num=info.lp_num,orig_lp_den=info.lp_den;for(var f in data)info[f]=data[f];var sel_id=_hr_ev_selcn_prefix+info.ev_id+"_"+info.link_key+"_"+info.ev_mkt_id+"_"+info.ev_oc_id,sel_el=document.getElementById(sel_id);if(!sel_el)return;var price_el=sel_el.children[0],inner_price=price_el.children[0];if(parent_info.mkt_cat=="EW"&&(info.mkt_fc_avail=="Y"||info.mkt_tc_avail=="Y")&&info.fb_result!="N"&&info.fb_result!=2&&info.fb_result!=1){var price_id_ftc=_hr_ev_selcn_price_ftc_prefix+info.ev_id+"_"+info.link_key+"_"+info.ev_mkt_id+"_"+info.ev_oc_id,price_el_ftc=document.getElementById(price_id_ftc)};var update_cb=0;if(parent_info.mkt_cat=="EW"&&event_info.has_cb_avail=="Y"&&handler.cb_built==1&&info.fb_result!="N"&&info.fb_result!=2&&info.fb_result!=1){update_cb=1;var price_id_cb=_hr_ev_selcn_price_cb_prefix+info.ev_id+"_"+info.link_key+"_"+info.ev_mkt_id+"_"+info.ev_oc_id,price_el_cb=document.getElementById(price_id_cb)};info.price_str=_hr_ev_get_price_str(handler,info.lp_num,info.lp_den,parent_info.lp_avail,parent_info.mkt_sort);var d=info.lp_num*orig_lp_den-info.lp_den*orig_lp_num;if(info.ev_oc_id==(handler.runner_hash[info.link_key]).wew_ev_oc_id&&!handler.is_simple&&d!=0&&orig_lp_num!=""&&orig_lp_den!=""){var runner_info=handler.runner_hash[info.link_key];if(!runner_info)return;if(runner_info.prev_odds.num_odds<3){runner_info.prev_odds[runner_info.prev_odds.num_odds]={};runner_info.prev_odds[runner_info.prev_odds.num_odds].p_num=orig_lp_num;runner_info.prev_odds[runner_info.prev_odds.num_odds].p_den=orig_lp_den;runner_info.prev_odds.num_odds++}else for(var i=0;i<3;i++)if(i==2){runner_info.prev_odds[i].p_num=orig_lp_num;runner_info.prev_odds[i].p_den=orig_lp_den}else{runner_info.prev_odds[i].p_num=runner_info.prev_odds[i+1].p_num;runner_info.prev_odds[i].p_den=runner_info.prev_odds[i+1].p_den};_hr_ev_got_RUNNER(runner_info,handler,true);if(update_cb)_hr_ev_got_cb_RUNNER(runner_info,handler,true)};if(parent_info.lp_avail!="Y")return;if(info.displayed!="Y")return;inner_price.innerHTML=info.price_str;if(parent_info.mkt_cat=="EW"&&(info.mkt_fc_avail=="Y"||info.mkt_tc_avail=="Y")&&info.fb_result!="N"&&info.fb_result!=2&&info.fb_result!=1&&handler.ftc_built){if(!price_el_ftc)return;price_el_ftc.innerHTML=info.price_str};if(info.bettable)_hr_ev_highlight_price_change(handler,info,orig_lp_num,orig_lp_den);if(update_cb){if(!price_el_cb)return;price_el_cb.innerHTML=info.price_str;var runner_cb_graphic_id=_hr_ev_runner_cb_graphic_prefix+info.ev_id+"_"+info.ev_oc_id;$j('#'+runner_cb_graphic_id).find('.odds').text(info.price_str);cb_graphic.update_price(info.ev_id);if(info.bettable)_hr_ev_highlight_price_change_cb(handler,info,orig_lp_num,orig_lp_den)};return}
function _hr_ev_highlight_price_change(handler,info,old_lp_num,old_lp_den){if(isNaN(info.lp_num)||isNaN(old_lp_num))return;var d=info.lp_num*old_lp_den-info.lp_den*old_lp_num;if(d==0)return;var event_info=handler.event_hash[info.ev_id],price_id=_hr_ev_selcn_prefix+info.ev_id+"_"+info.link_key+"_"+info.ev_mkt_id+"_"+info.ev_oc_id;_hr_ev_highlight(handler,price_id,_hr_ev_selcn_base_class,d);return}
function _hr_ev_highlight_price_change_cb(handler,info,old_lp_num,old_lp_den){if(isNaN(info.lp_num)||isNaN(old_lp_num))return;var d=info.lp_num*old_lp_den-info.lp_den*old_lp_num;if(d==0)return;var price_id=_hr_ev_selcn_prices_cb_prefix+info.ev_id+"_"+info.link_key+"_"+info.ev_mkt_id;_hr_ev_highlight(handler,price_id,_hr_ev_cb_selcn_base_class,d);var selcn_scone_item_id=_hr_ev_runner_cb_graphic_prefix+info.ev_id+'_'+info.ev_oc_id;if(scone_item_exists(selcn_scone_item_id)){var price_id=_hr_ev_event_cb_graphic_price_prefix+info.ev_id;_hr_ev_highlight(handler,price_id,_hr_ev_cb_event_price_base_class,d)};return}
function _hr_ev_highlight(handler,id,base_class,dir){var item=document.getElementById(id);if(!item)return;el=item.children[0];if(!el)return;var highlight_class="";if(dir<0){highlight_class=base_class+handler.cfg.hl_class_decrease}else if(dir>0){highlight_class=base_class+handler.cfg.hl_class_increase}else highlight_class=base_class+handler.cfg.hl_class_same;var classes=el.className.split(" "),found=false;for(var i=0;i<classes.length;i++)if(classes[i]==base_class+handler.cfg.hl_class_same||classes[i]==base_class+handler.cfg.hl_class_increase||classes[i]==base_class+handler.cfg.hl_class_decrease){classes[i]=highlight_class;found=true;break};if(!found)classes.push(highlight_class);el.className=classes.join(" ");if(_hr_ev_hl_timers[id]!=null){window.clearTimeout(_hr_ev_hl_timers[id]);delete _hr_ev_hl_timers[id]};var self=this;if(dir!=0)_hr_ev_hl_timers[id]=window.setTimeout(function(){self._hr_ev_highlight(handler,id,base_class,0)},handler.cfg.highlight_duration);return}
function _hr_ev_bids_status_xl(bids_status){if(document.bids_status_xlations&&document.bids_status_xlations[bids_status]){return document.bids_status_xlations[bids_status]}else return''}
function hr_ev_do_racecard_bet(ev_oc_id,ev_id,price_type,bet_origin){var handler=_hr_ev_hash[ev_id],selcn=handler.selcn_hash[ev_oc_id],evmkt=handler.evmkt_hash[selcn.ev_mkt_id],lp_num='',lp_den='';if(price_type!='S'){if(evmkt.gp_avail=='Y')price_type='G';lp_num=selcn.lp_num;lp_den=selcn.lp_den};var ew_fac_num='',ew_fac_den='',ew_places='';if(evmkt.ew_avail=='Y'){ew_fac_num=evmkt.ew_fac_num;ew_fac_den=evmkt.ew_fac_den;ew_places=evmkt.ew_places};BS_set_leg('selections',ev_oc_id);BS_set_leg('price_type',price_type);BS_set_leg('lp_num',lp_num);BS_set_leg('lp_den',lp_den);BS_set_leg('market_tags',evmkt.mkt_tags);BS_set_leg('ew_fac_num',ew_fac_num);BS_set_leg('ew_fac_den',ew_fac_den);BS_set_leg('ew_places',ew_places);if((typeof bet_origin!='undefined')&&(bet_origin!=undefined)&&(bet_origin!=""))BS_set_leg('bet_origin',bet_origin);BS_go_bet()}
function _hr_ev_get_price_str(handler,lp_num,lp_den,lp_avail,mkt_sort){if(typeof lp_avail=="undefined")lp_avail="Y";if(typeof mkt_sort=="undefined")mkt_sort="--";var price_str_type=handler.cfg.price_str_type;if(mkt_sort=="AH"&&handler.cfg.price_str_type_ah!="")price_str_type=handler.cfg.price_str_type_ah;if(mkt_sort=="HL"&&handler.cfg.price_str_type_hl!="")price_str_type=handler.cfg.price_str_type_hl;if(lp_avail=="N")return"SP";if(lp_num==""&&lp_den=="")return"-";var price_str;if(price_str_type=="DECIMAL"){var dps=(lp_den>100)?3:2,dp=1.0+(lp_num/lp_den),scaled_dp=""+Math.round(dp*Math.pow(10,dps)-0.5),int_part=scaled_dp.substr(0,scaled_dp.length-dps),frac_part=scaled_dp.substr(scaled_dp.length-dps);if(int_part=="")int_part="";if(frac_part=="")frac_part="";var price_str=int_part+"."+frac_part}else{if(lp_den=="")lp_den=1;if(lp_num==lp_den){price_str="evens"}else price_str=lp_num+handler.cfg.price_str_sep+lp_den};return price_str}
function _hr_ev_sort_column(column,ev_id,from_init){var handler=_hr_ev_hash[ev_id],ev_info=handler.event_hash[ev_id];if(column!=handler.sort_col){handler.sort_col=column;if(column=="weight"){handler.sort_dir="a"}else handler.sort_dir="d"}else if(handler.sort_dir=="d"){handler.sort_dir="a"}else handler.sort_dir="d";var cont_elem=_hr_ev_runners_prefix+ev_id;scone_sort(cont_elem,"manual",true);if(from_init){if(ev_info.has_fcast=="Y"||ev_info.has_tcast=="Y"){var cont_elem=_hr_ev_runners_ftc_prefix+ev_id;scone_sort(cont_elem,"manual",true)};if(ev_info.has_cb_avail=="Y"){var cont_elem=_hr_ev_runners_cb_prefix+ev_id;scone_sort(cont_elem,"manual",true)}};var thead=document.getElementById(_hr_ev_qv_header+ev_id);if(!thead)return;var spans=thead.getElementsByTagName('span'),col_dir="",col_class_name="",span_idx=0;for(var i=0;i<spans.length;i++)if(spans[i].className=="asc"||spans[i].className=="desc"){col_class_name=spans[i].parentNode.className;if(span_idx%2){col_dir="a"}else col_dir="d";if(col_dir!=handler.sort_dir){spans[i].style.display='none'}else if(col_class_name=="h_info left"&&column=="horse"){spans[i].style.display='block'}else if(col_class_name=="rp"&&column=="rp"){spans[i].style.display='block'}else if(col_class_name=="jt"&&column=="jockey"){spans[i].style.display='block'}else if(col_class_name=="wa"&&column=="weight"){spans[i].style.display='block'}else if(col_class_name==""&&column=="market"){spans[i].style.display='block'}else if(col_class_name=="wew right"&&column=="market"){spans[i].style.display='block'}else spans[i].style.display='none';span_idx++}}
function _hr_ev_form_build_toggle(elem_id,runner_id,ev_id){_hr_ev_got_RP(ev_id,runner_id);_hr_ev_form_toggle(elem_id)}
function _hr_ev_form_build_open_all(type,ev_id){if(type!='form'&&type!='spotlight')return;var runner_ids=_hr_ev_hash[ev_id].runner_hash;for(var runner_id in runner_ids){var runner=_hr_ev_hash[ev_id].runner_hash[runner_id],id=['hr_ev_runner',type,ev_id,runner_id].join('_'),e=document.getElementById(id);if(runner.fb_result==1||runner.fb_result==2)continue;if(e==null){_hr_ev_got_RP(ev_id,runner_id);e=document.getElementById(id)};if(e!=null&&e.style.display!='')e.style.display=''}}
function _hr_ev_form_toggle(elem_id){var elem=document.getElementById(elem_id);if(!elem)return;if(elem.style.display=="none"){elem.style.display=""}else elem.style.display="none"}
function _hr_ev_expand_toggle_all(ev_id){var handler=_hr_ev_hash[ev_id],expand="";if(handler.expander=="closed"){expand=true;handler.expander="opened";handler.open_tab="all_mkts"}else{expand=false;handler.expander="closed";handler.open_tab="qv"};_hr_ev_expand_toggle_runner(ev_id,"header",expand,true);for(var runner_id in handler.runner_hash)_hr_ev_expand_toggle_runner(ev_id,runner_id,expand,true)}
function _hr_ev_expand_toggle_runner(ev_id,runner_id,expand,animate){if(animate){var anim_time=1e3}else var anim_time=0;var elem_id=_hr_ev_expander_prefix+ev_id+"_"+runner_id,jt_elem_id=_hr_ev_runner_jt_prefix+ev_id+"_"+runner_id,jt_elem=document.getElementById(jt_elem_id);if(expand){$j('#'+elem_id).animate({left:'-255'},0);if(jt_elem)jt_elem.style.display=""}else{$j('#'+elem_id).animate({left:'20'},0);if(jt_elem)jt_elem.style.display="none"}}
function _hr_ev_toggle_all_mkts_btn(ev_id,active){var all_mkts_id="button_all_mkts_"+ev_id,all_mkts_button=document.getElementById(all_mkts_id);if(active){var classes=all_mkts_button.className.split(" ");all_mkts_button.className="";var new_classes=[];for(var i=0;i<classes.length;i++)if(classes[i]!="inactive")new_classes.push(classes[i]);all_mkts_button.className=new_classes.join(" ");$j('#'+all_mkts_id+' a').get(0).attributes["onclick"].value="hr_ev_change_tab('all_mkts','"+ev_id+"')"}else{all_mkts_button.className=all_mkts_button.className+" inactive";$j('#'+all_mkts_id+' a').get(0).attributes["onclick"].value=""}}
function hr_ev_show_hide_jockey_trainer_search(ev_id){var handler=_hr_ev_hash[ev_id],event="",runner="";if(handler){event=handler.event_hash[ev_id];event.filtered=!event.filtered;for(var runner_id in handler.runner_hash){runner=handler.runner_hash[runner_id];if(runner)_hr_ev_got_RUNNER(runner,handler,true)};_hr_ev_got_EVENT(event,handler,true)}}
function hr_ev_change_tab(tab,ev_id){var new_elem_id=tab+"_"+ev_id,new_button_elem_id="button_"+tab+"_"+ev_id,handler=_hr_ev_hash[ev_id],old_tab=handler.open_tab;if(old_tab==tab)return;var old_elem_id=old_tab+"_"+ev_id,old_button_elem_id="button_"+old_tab+"_"+ev_id;if(old_tab=="all_mkts"){_hr_ev_expand_toggle_all(ev_id);var qv_elem=document.getElementById("qv_"+ev_id);qv_elem.style.display="none"}else{var old_elem=document.getElementById(old_elem_id);old_elem.style.display="none"};if(tab=="all_mkts"){var qv_elem=document.getElementById("qv_"+ev_id);qv_elem.style.display="";_hr_ev_expand_toggle_all(ev_id)}else{var new_elem=document.getElementById(new_elem_id);new_elem.style.display=""};var new_button_elem=document.getElementById(new_button_elem_id),old_button_elem=document.getElementById(old_button_elem_id);handler.open_tab=tab;new_button_elem.className=new_button_elem.className+" active";var classes=old_button_elem.className.split(" ");old_button_elem.className="";var new_classes=[];for(var i=0;i<classes.length;i++)if(classes[i]!="active")new_classes.push(classes[i]);old_button_elem.className=new_classes.join(" ");if(tab=="h2h")if(!handler.match_betting_loaded){var url=handler.cfg.link_url+"?action=go_hr_match_betting_AJAX&ev_id="+ev_id,h2h_id="h2h_"+ev_id,clientdata={id:h2h_id};_hr_ev_make_ajax_get_request("hr_ev_change_tab_h2h"+ev_id,url,clientdata,_hr_ev_got_ajax_content)};if(tab=="exm")if(!handler.extra_markets_loaded){var url=handler.cfg.link_url+"?action=go_hr_extra_markets_AJAX&ev_id="+ev_id,parent_id=_hr_ev_extra_markets_cont_prefix+ev_id,child_id=_hr_ev_extra_markets_cont_elem_prefix+ev_id,clientdata={id:"",parent_id:parent_id,child_id:child_id};_hr_ev_make_ajax_get_request("hr_ev_change_tab_exm"+ev_id,url,clientdata,_hr_ev_got_ajax_content)};if(tab=="ftc"&&(handler.ftc_built==0))_hr_build_ftc_view(ev_id);if(tab=="comb_bets"&&(handler.cb_built==0))_hr_build_combined_bets_view(ev_id)}
function _hr_build_ftc_view(ev_id){var handler=_hr_ev_hash[ev_id],event=handler.event_hash[ev_id];if(event.has_fcast==0&&event.has_tcast==0)return;if(!handler.is_simple){_hr_ev_store_ftc_templates()}else _hr_ev_single_view_store_ftc_templates();for(var runner_id in handler.runner_hash){var runner_info=handler.runner_hash[runner_id];_hr_ev_got_ftc_RUNNER(runner_info,handler,false)};for(var ev_mkt_id in handler.evmkt_hash){var mkt_info=handler.evmkt_hash[ev_mkt_id];if(mkt_info.mkt_cat=="EW")_hr_ev_got_ftc_EVMKT(mkt_info,handler,false)};for(var runner_id in handler.runner_hash){var selcn_info=handler.selcn_hash[(handler.runner_hash[runner_id]).wew_ev_oc_id];_hr_ev_got_ftc_SELCN(selcn_info,handler,false)};tooltip_init();handler.ftc_built=1}
function _hr_build_combined_bets_view(ev_id){var handler=_hr_ev_hash[ev_id],event=handler.event_hash[ev_id];if(event.has_cb_avail!="Y")return;_hr_ev_store_cb_templates();cb_graphic.display_selns(ev_id,null);for(var runner_id in handler.runner_hash){var runner_info=handler.runner_hash[runner_id];_hr_ev_got_cb_RUNNER(runner_info,handler,false)};for(var ev_mkt_id in handler.evmkt_hash){var mkt_info=handler.evmkt_hash[ev_mkt_id];if(mkt_info.mkt_cat=="EW")_hr_ev_got_cb_EVMKT(mkt_info,handler,false)};for(var runner_id in handler.runner_hash){var selcn_info=handler.selcn_hash[(handler.runner_hash[runner_id]).wew_ev_oc_id];_hr_ev_got_cb_SELCN(selcn_info,handler,false)};cb_graphic.update_info_message(ev_id);tooltip_init();handler.cb_built=1}
function _hr_build_dummy_selns(handler,ev_mkt_id,event){for(var runner_id in handler.runner_hash){var runner_info=handler.runner_hash[runner_id],market_info=handler.evmkt_hash[ev_mkt_id];if(market_info.mkt_cat=="INS"&&runner_info.ins_num<event.ins_num&&handler.is_simple==0){if(!runner_info.ins_disps[market_info.disporder]){var dummy_info={ev_id:event.ev_id,type:"INS",dummy_num:market_info.disporder,disporder:market_info.disporder};_hr_ev_got_DUMMYSELCN(runner_id,handler,dummy_info,true,false);runner_info.ins_dummy_num++}}else if(market_info.mkt_cat=="PL"&&runner_info.placed_num<event.placed_num&&handler.is_simple==0)if(!runner_info.plc_disps[market_info.disporder]){var dummy_info={ev_id:event.ev_id,type:"PL",dummy_num:market_info.disporder,disporder:market_info.disporder};_hr_ev_got_DUMMYSELCN(runner_id,handler,dummy_info,true,false);runner_info.plc_dummy_num++}}}
function hr_expand_event_tab(ev_id,open_tab){document.getElementById('btn_expand_'+ev_id).attributes['onclick'].value="";document.getElementById('btn_hdr_expand_'+ev_id).attributes['onclick'].value="";var ev_ids=unexpanded_ev_ids.split(",");for(var i=0;i<ev_ids.length;i++)if(ev_ids[i]==ev_id)ev_ids.splice(i,1);unexpanded_ev_ids=ev_ids.join(",");var url=tld_racing+"?action=go_hr_event_AJAX&ev_id="+ev_id+'&open_tab='+open_tab,clientdata="";_hr_ev_make_ajax_get_request("hr_expand_event_tab"+ev_id,url,clientdata,_hr_ev_got_ajax_content)}
function hr_expand_event_tab_all(open_tab){var ev_id_list=unexpanded_ev_ids.split(",");for(var i=0;i<ev_id_list.length;i++){document.getElementById('btn_expand_'+ev_id_list[i]).attributes['onclick'].value="";document.getElementById('btn_hdr_expand_'+ev_id_list[i]).attributes['onclick'].value="";document.getElementById('btn_expand_all_'+ev_id_list[i]).attributes['onclick'].value=""};unexpanded_ev_ids="";var url=tld_racing+"?action=go_hr_event_list_AJAX&ev_id_list="+ev_id_list.join("|")+"&open_tab="+open_tab,clientdata="";_hr_ev_make_ajax_get_request("hr_expand_event_tab_all",url,clientdata,_hr_ev_got_ajax_content)}
function _hr_ev_make_ajax_get_request(id,url,clientdata,callback){if(document.PollingAjaxHelper.checkSemaphore()){document.PollingAjaxHelper.setTimeout(id,function(){_hr_ev_make_ajax_get_request(id,url,clientdata,callback)},300);return};document.PollingAjaxHelper.aquireSemaphore();var req=null;if(window.XMLHttpRequest){req=new XMLHttpRequest()}else if(window.ActiveXObject)req=new ActiveXObject('Microsoft.XMLHTTP');if(req){req.onreadystatechange=function(){if(req.readyState!=4)return;var reqStatus;try{reqStatus=req.status}catch(e){reqStatus=''};if(reqStatus!=200){document.PollingAjaxHelper.releaseSemaphore();callback(url,clientdata,false,'HTTP')}else{document.PollingAjaxHelper.releaseSemaphore();callback(url,clientdata,true,req.responseText)}};try{req.open('GET',url,true);req.send(null)}catch(e){document.PollingAjaxHelper.releaseSemaphore();callback(url,clientdata,false,'UNSUPPORTED')}}else{document.PollingAjaxHelper.releaseSemaphore();callback(url,clientdata,false,'UNSUPPORTED')}}
function _hr_ev_got_ajax_content(url,clientdata,ok,response){if(clientdata.id!="")var holder_el=document.getElementById(clientdata.id);if(ok){if(response=="")return;var parts=_hr_ev_parse_script_tags(response);if(clientdata.id!=""){if(holder_el)holder_el.innerHTML=parts[0]}else scone_add_item(clientdata.parent_id,clientdata.child_id,parts[0],null,null,true);if(parts[1].length)try{_hr_ev_global_eval(parts[1])}catch(e){ok=false}}}
function _hr_ev_parse_script_tags(str){var html='',js='',i=0,state='HTML',script_re=new RegExp('<(/?)script([^>]*)>','gi');while((mtch=script_re.exec(str))!=null){mS=mtch.index;if(state=='HTML'){html+=str.substring(i,mS)}else js+=str.substring(i,mS)+';\n';var closer=mtch[1],attrs=mtch[2];if(closer=='/'){state='HTML'}else if(attrs.charAt(attrs.length-1)!='/'&&attrs.indexOf('src=')==-1)state='JS';i=script_re.lastIndex};if(state=='HTML'){html+=str.substring(i)}else js+=str.substring(i);return[html,js]};var _hr_ev_global_eval=function(src){if(window.execScript){window.execScript(src);return};var fn=function(){window.eval.call(window,src)};fn()}
function hr_ev_do_foretricasts_reset(ev_id){var tf,count=0,handler=_hr_ev_hash[ev_id];for(var col_max=2;col_max<=3;col_max++){count=0;if(col_max==2){tf="f"}else tf="t";var combination=0;for(var i=1;i<=(col_max+1);i++)for(var j in handler.runner_hash){if(i>col_max){chkbx_name="tfcast"+tf+"_"+ev_id+"_"+j+"_A"}else chkbx_name="tfcast"+tf+"_"+ev_id+"_"+j+"_"+i;var obj=document.getElementById(chkbx_name);if(!obj)continue;obj.checked=false}}}
function hr_ev_place_fore_tricast(ev_id){if(hr_ev_prepXCast(ev_id)){alert(_hr_ev_not_enough_selections);return};BS_go_bets()}
function hr_ev_prepXCast(ev_id){var badXCast=true,handler=_hr_ev_hash[ev_id];for(var col_max=2;col_max<=3;col_max++){var selns=new Array(),tf=col_max==2?'f':'t',combi=false,leg_sort='BAD';for(var i=1;i<=(col_max+1);i++)for(var j in handler.runner_hash){if(i>col_max){chkbx_name="tfcast"+tf+"_"+ev_id+"_"+j+"_A"}else chkbx_name="tfcast"+tf+"_"+ev_id+"_"+j+"_"+i;obj=document.getElementById(chkbx_name);if(!obj)continue;if(obj.checked!=true)continue;selns.push(obj.value);if(i>col_max)combi=true};if(selns.length<col_max)continue;if(col_max==2){leg_sort=combi?'RF':'SF'}else leg_sort=combi?'CT':'TC';if(leg_sort=='BAD')continue;var ev_oc_ids=selns.join('c');BS_set_leg('leg_sort',leg_sort);BS_set_leg('price_type','D');BS_set_leg('selections',ev_oc_ids);BS_select_bet(leg_sort+'_'+ev_oc_ids);badXCast=false};return badXCast}
function hr_ev_checkLimits123(tf,col_max,link_key,seln_col,ev_id){var chkbx_name,handler=_hr_ev_hash[ev_id];for(var j in handler.runner_hash){chkbx_name="tfcast"+tf+"_"+ev_id+"_"+j+"_A";hr_ev_clear(chkbx_name)};var this_name="tfcast"+tf+"_"+ev_id+"_"+link_key+"_"+seln_col;for(var j in handler.runner_hash){chkbx_name="tfcast"+tf+"_"+ev_id+"_"+j+"_"+seln_col;if(chkbx_name!=this_name)hr_ev_clear(chkbx_name)};for(var i=1;i<=col_max;i++){chkbx_name="tfcast"+tf+"_"+ev_id+"_"+link_key+"_"+i;if(chkbx_name!=this_name)hr_ev_clear(chkbx_name)};return}
function hr_ev_checkLimitsAny(tf,col_max,link_key,seln_col,ev_id){var chkbx_name,handler=_hr_ev_hash[ev_id],this_name="tfcast"+tf+"_"+ev_id+"_"+link_key+"_"+seln_col;for(var i=1;i<=col_max;i++)for(var j in handler.runner_hash){chkbx_name="tfcast"+tf+"_"+ev_id+"_"+j+"_"+i;hr_ev_clear(chkbx_name)};return}
function hr_ev_checkLimits(tf,link_key,seln_col,ev_id){var col_max;if(tf=="t"){col_max=3}else col_max=2;if(seln_col=="A"){hr_ev_checkLimitsAny(tf,col_max,link_key,seln_col,ev_id)}else hr_ev_checkLimits123(tf,col_max,link_key,seln_col,ev_id);return}
function hr_ev_clear(name){var obj=document.getElementById(name);if(obj)obj.checked=false}
function hr_ev_setup_bir_redirect(ev_msg){var ms_before_start=-1,ev_id=ev_msg.ev_id,current_time_ms=Date.parse(Date()),post_ev_id=ev_msg.post_ev_id;if(ev_msg.status=='S'&&ev_msg.displayed=='N'&&ev_msg.is_off=='-'){ms_before_start=0}else if(typeof ev_msg.suspend_at=='string'&&ev_msg.suspend_at!=''){ms_before_start=_hr_ev_time_in_milliseconds(ev_msg.suspend_at)-current_time_ms}else if(ev_msg.is_off=='Y'){ms_before_start=0}else if(ev_msg.is_off!='N'&&typeof ev_msg.start_time=='string'&&ev_msg.start_time!='')ms_before_start=_hr_ev_time_in_milliseconds(ev_msg.start_time)-current_time_ms;clearTimeout(document.showEventStartTimer);if(document.show_popup)if(ms_before_start==0||ms_before_start<-1){_hr_ev_showEventStartNotification(ev_id,post_ev_id)}else if(ms_before_start!=-1)document.showEventStartTimer=setTimeout('_hr_ev_showEventStartNotification(\''+ev_id+'\',\''+post_ev_id+'\')',ms_before_start)}
function _hr_ev_showEventStartNotification(ev_id,post_ev_id){var redirect_popup=null,redirect_link=null;if(post_ev_id=="")return;redirect_popup=document.getElementById('event_link_popup');if(redirect_popup)redirect_popup.style.display='';if(document.pre_bir_redirect_link_only==true){redirect_link=document.getElementById('event_link_anchor');if(redirect_link)redirect_link.href=getBIREventLink(post_ev_id)}else{max_wait=document.pre_bir_redirect_max_wait;random_timeout=Math.floor(Math.random()*max_wait);setTimeout('_hr_go_BIR_event('+post_ev_id+')',random_timeout)}}
function _hr_ev_time_in_milliseconds(time_frm){return Date.parse(new Date(parseInt(time_frm.substring(0,4),10),(parseInt(time_frm.substring(5,7),10)-1),parseInt(time_frm.substring(8,10),10),parseInt(time_frm.substring(11,13),10),parseInt(time_frm.substring(14,16),10),parseInt(time_frm.substring(17),10)))}
function hr_ev_set_predictor(ev_id){var handler=_hr_ev_hash[ev_id],event=handler.event_hash[ev_id];window.open(event.rp_predictor_url,'Predictor','height=390,width=635,statusbar=no')}
function hr_ev_open_form_site(ev_id){var handler=_hr_ev_hash[ev_id],event=handler.event_hash[ev_id];window.open(event.form_site_url,'Form_Site_Predictor')}
function hr_ev_open_archive(cgi_url,pf_ev_id,stream_id){var archive_url=cgi_url+"?action=go_archive&pf_ev_id="+pf_ev_id+"&stream_id="+stream_id+"&ahrplayer=1";window.open(archive_url,'Archive','height=595,width=810,statusbar=no')}
function hr_daily_specials_go_racecard(){var ev_oc_ids=document.getElementsByName("sel"),ev_list="|";for(i=0;i<ev_oc_ids.length;i++)if(ev_oc_ids[i].checked)ev_list=ev_list+ev_oc_ids[i].value+"|";if(ev_list.length<=1)return;var url=hr_daily_specials_racecard_url+"&ev_ids="+ev_list;window.location=url}
function hr_daily_specials_expand_all(){var cnts=document.getElementsByName("hr_daily_specials_cnt"),tools=document.getElementsByName("hr_daily_specials_tools");for(i=0;i<cnts.length;i++){cnts[i].style.display="";tools[i].style.display="none"}}
function _hr_go_BIR_event(post_ev_id){if(post_ev_id=="")return;if(document.show_popup==true)window.document.location=getBIREventLink(post_ev_id);return}
function getBIREventLink(post_ev_id){var link=cgi_racing_url+'?action=go_betlive_event&ev_id='+post_ev_id+'&gone_live=1';return link}
function ShowGPImg(){var gp=document.getElementById('meeting-title');if(gp&&gp.className.indexOf("bpg")==-1)gp.className+=' bpg'}
function _hr_ev_store_templates(){var tmp=[];tmp.push('	<%IF is_list==0%>\n');tmp.push('		<div class="meeting<%IF gp_avail=="Y"%> bpg<%END%>" id="hr_ev_event_<%ev_id%>">\n');tmp.push('			<div class="title">\n');tmp.push('				<h1 class="left"><a href="<%url%>"><%type_name%></a></h1>\n');tmp.push('				<div class="clear"></div>\n');tmp.push('			</div>\n');tmp.push('			<div class="item">\n');tmp.push('	<%END%>\n');tmp.push('				<div class="cnt" <%IF is_list==1%> id="hr_ev_event_<%ev_id%>"<%END%>>\n');tmp.push('					<div class="race-infos">\n');tmp.push('						<h2>\n');tmp.push('						<%IF is_list==0%>\n');tmp.push('							<div class="prevnext">\n');tmp.push('								<div class="prev"><%IF before_ev_url!=""%>\n');tmp.push('									<a href="<%before_ev_url%>"></a>\n');tmp.push('									<span class="tooltip"><%XL _hr_ev_view%> <%before_ev_desc%></span><%END%>\n');tmp.push('								</div>\n');tmp.push('								<div class="time"><%ev_start_time%></div>\n');tmp.push('								<div class="next"><%IF after_ev_url!=""%>\n');tmp.push('									<a href="<%after_ev_url%>"></a>\n');tmp.push('									<span class="tooltip"><%XL _hr_ev_view%> <%after_ev_desc%></span><%END%>\n');tmp.push('								</div>\n');tmp.push('							</div><%END%>\n');tmp.push('							<%name%>\n');tmp.push('						</h2><%IF event_cashout_avail=="Y"%><span class="cash-out-available"></span><%END%>\n');tmp.push('						<%IF has_rp == 1%>');tmp.push('							<%IF form_site_enabled == 1 && form_site_url != ""%>');tmp.push('								<div id="predictor_<%ev_id%>" class="form-site-predictor"><ul class="btns rpredictor"><li class="green">');tmp.push('								<a href="javascript:hr_ev_open_form_site(\'<%ev_id%>\')"><span></span><%XL _hr_ev_race_form%></a>');tmp.push('								</li></ul></div>\n');tmp.push('							<%ELSE IF rp_predictor_url != ""%>');tmp.push('								<div id="predictor_<%ev_id%>" class="form-site-predictor"><ul class="btns rpredictor"><li class="green">');tmp.push('								<a href="javascript:hr_ev_set_predictor(\'<%ev_id%>\')"><span></span><%XL _hr_ev_race_predictor%></a>');tmp.push('								</li></ul></div>\n');tmp.push('							<%END%>');tmp.push('						<%END%>');tmp.push('						<%IF bids_status_text!=""%><h3><%XL _hr_ev_race_status%>\n');tmp.push('							<span class="red">- <%bids_status_text%></span>\n');tmp.push('						</h3><%END%>\n');tmp.push('						<%IF station_num > 0%><h4><%XL _hr_ev_live_on%>\n');tmp.push('							<%LOOP hr_ev_idx station_num%>\n');tmp.push('								<img src="<%img_url%>/<%stations[hr_ev_idx].station_image%>" alt="<%stations[hr_ev_idx].name%>">\n');tmp.push('							<%END%>\n');tmp.push('						</h4><%END%>\n');tmp.push('						<div class="clear"></div>\n');tmp.push('					</div>\n');tmp.push('					<div class="rp-infos">\n');tmp.push('					<div class="medias"><ul>\n');tmp.push('						<%IF has_stream%><li id="watch_<%ev_id%>" class="watch-race-live">\n');tmp.push('							<%IF (stream_avail == 1) || (rp_stream_avail == 1) || (cb_stream_avail == 1)%><a href="javascript:open_rp_window(\'<%ev_id%>\')"><%XL _hr_ev_watch_live%><span class="tooltip"><%XL _hr_ev_only_ukie%></span></a><%END%>\n');tmp.push('							<%IF wc_stream_avail == 1%><a href="javascript:open_wc_window()"><%XL _hr_ev_watch_live%><span class="tooltip"><%XL _hr_ev_only_ukie%></span></a><%END%>\n');tmp.push('						</li><%END%>\n');tmp.push('						<%IF region == "UK" || region == "IE"%><li id="audio_<%ev_id%>" class="race-radio"><a href="javascript:MM_openBrWindow(\'<%audio_link%>\',\'p\',\'width=786,height=678\')"><%XL _hr_ev_radio%></a></li><%END%>\n');tmp.push('						<%IF region == "UK" || region == "IE"%><li class="text-commentary"><a href="javascript:MM_openBrWindow(\'<%text_link%>\',\'p\',\'width=786,height=678\')"><%XL _hr_ev_text%></a></li><%END%>\n');tmp.push('					</ul></div>\n');tmp.push('					<%IF has_race_post%>\n');tmp.push('						<span class="rp-logo"><%XL _hr_ev_racing_post%></span>');tmp.push('						<div class="rp-verdict-scroll">\n');tmp.push('								<p><%rp_overview%></p>\n');tmp.push('						</div>\n');tmp.push('						<p>\n');tmp.push('							<strong><%XL _hr_ev_distance%></strong> <%rp_distance%>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong><%XL _hr_ev_going%></strong> <%rp_going%>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong><%XL _hr_ev_bias%></strong> <%rp_stalls%>\n');tmp.push('						</p>\n');tmp.push('					<%END%></div>\n');tmp.push('					<%IF ev_special_blurb != ""%><div class="mbs"><%ev_special_blurb%><%IF ev_special_cond != ""%> <a href="#" onclick="spc.show_conditions(\'hr_mbs_cond_<%ev_id%>\');return false" class="boldgrey"><%XL _hr_ev_conditions%></a><div id="hr_mbs_cond_<%ev_id%>" style="display: none;"><%ev_special_cond%></div><%END%></div><%END%>\n');tmp.push('					<%IF ev_class_blurb != ""%><div><%ev_class_blurb%></div><%END%>\n');tmp.push('					<div>\n');tmp.push('						<div class="filter">\n');tmp.push('							<ul class="tabs left">\n');tmp.push('								<li id="button_qv_<%ev_id%>" class="default-tab <%IF expander == \'closed\'%>active <%END%>">\n');tmp.push('									<div>\n');tmp.push('										<a href="javascript:void(0)" onclick="hr_ev_change_tab(\'qv\',\'<%ev_id%>\')" rel="qv_<%ev_id%>">\n');tmp.push('											<%XL _hr_ev_quick_view%><span class="tooltip"><%XL _hr_ev_quick_view_tt%></span>\n');tmp.push('										</a>\n');tmp.push('									</div>\n');tmp.push('								</li>\n');tmp.push('								<li id="button_all_mkts_<%ev_id%>" class="<%IF mkt_num < 2%>inactive<%END%> <%IF expander == \'opened\'%>active <%END%>">\n');tmp.push('									<div>\n');tmp.push('										<a href="javascript:void(0)" <%IF mkt_num >= 2%>onclick="hr_ev_change_tab(\'all_mkts\',\'<%ev_id%>\')"<%END%>>\n');tmp.push('											<%XL _hr_ev_all_mkts%><%IF mkt_num >= 2%><span class="tooltip"><%XL _hr_ev_all_mkts_tt%></span><%END%>\n');tmp.push('										</a>\n');tmp.push('									</div>\n');tmp.push('								</li>\n');tmp.push('							</ul>\n');tmp.push('							<ul class="tabs tote right">\n');tmp.push('							<%IF !from_search%>\n');tmp.push('								<%IF has_cb_avail=="Y"%><li id="button_comb_bets_<%ev_id%>" class="<%IF open_tab == "comb_bets"%>active <%END%>"><div><a href="javascript:void(0)" onclick="hr_ev_change_tab(\'comb_bets\',\'<%ev_id%>\')" rel="cb_<%ev_id%>"><%XL _hr_ev_combined_bets%><%IF open_tab != "comb_bets"%><span class="tooltip"><%XL _hr_ev_combined_bets_tt%></span><%END%></a></div></li><%END%>\n');tmp.push('								<%IF ev_id_tote!=""%><li><div><a href="<%link_url%>?action=go_TOTE_racing&template_id=ViewByMeeting&framework_id=default_framework&selected_ev_id=<%ev_id_tote%>"><%XL _hr_ev_tote%><span class="tooltip"><%XL _hr_ev_tote_tt%></span></a></div></li><%END%>\n');tmp.push('								<%IF has_match_betting%><li id="button_h2h_<%ev_id%>" class="<%IF open_tab == "h2h"%>active <%END%>"><div><a href="javascript:void(0)" onclick="hr_ev_change_tab(\'h2h\',\'<%ev_id%>\')" rel="h2h_<%ev_id%>"><%XL _hr_ev_match_bet%><%IF open_tab != "h2h"%><span class="tooltip"><%XL _hr_ev_match_bet_tt%></span><%END%></a></div></li><%END%>\n');tmp.push('								<%IF has_tcast == "Y" || has_fcast == "Y"%><li id="button_ftc_<%ev_id%>" class="<%IF open_tab == "ftc"%>active <%END%>"><div><a href="javascript:void(0)" onclick="hr_ev_change_tab(\'ftc\',\'<%ev_id%>\')" rel="ftc_<%ev_id%>"><%XL _hr_ev_tricast%><%IF open_tab != "ftc"%><span class="tooltip"><%XL _hr_ev_tricast_tt%></span><%END%></a></div></li><%END%>\n');tmp.push('								<%IF has_extra_markets%><li id="button_exm_<%ev_id%>" class="<%IF open_tab == "exm"%>active <%END%>"><div><a href="javascript:void(0)" onclick="hr_ev_change_tab(\'exm\',\'<%ev_id%>\')" rel="exm_<%ev_id%>"><%XL _hr_ev_extra_markets%><%IF open_tab != "exm"%><span class="tooltip"><%XL _hr_ev_extra_markets_tt%></span><%END%></a></div></li><%END%>\n');tmp.push('							<%ELSE%>\n');tmp.push('								<%IF filtered%>\n');tmp.push('									<li><div><a href="javascript:hr_ev_show_hide_jockey_trainer_search(<%ev_id%>)" rel="sa"><%XL _hr_ev_show_all%></a></div></li>\n');tmp.push('								<%ELSE%>\n');tmp.push('									<li><div><a href="javascript:hr_ev_show_hide_jockey_trainer_search(<%ev_id%>)" rel="sa"><%XL _hr_ev_show_less%></a></div></li>\n');tmp.push('								<%END%>\n');tmp.push('							<%END%>\n');tmp.push('							</ul>\n');tmp.push('							<div class="clear"></div>\n');tmp.push('						</div>\n');tmp.push('					<div class="tab-content" id="qv_<%ev_id%>" <%IF open_tab != "qv" && open_tab != "all_mkts" %>style="display: none" <%END%>>\n');tmp.push('						<table summary="<%XL _hr_ev_quick_view%>" class="race">\n');tmp.push('							<thead id="qv_header_<%ev_id%>"><tr><th>\n');tmp.push('								<div class="h_info left" onclick="_hr_ev_sort_column(\'horse\',\'<%ev_id%>\')"><%XL _hr_ev_h_info_title%><span class="tooltip"><%XL _hr_ev_h_info_title_tt%></span>\n');tmp.push('									<span <%IF sort_col=="horse" && sort_dir =="a"%>style="display: block;"<%ELSE%>style="display: none;"<%END%> class="asc" title="asc"></span>\n');tmp.push('									<span <%IF sort_col=="horse" && sort_dir =="d"%>style="display: block;"<%ELSE%>style="display: none;"<%END%> class="desc" title="desc"></span>\n');tmp.push('								</div>\n');tmp.push('								<div class="mask left">\n');tmp.push('									<div class="wp">\n');tmp.push('										<div class="rp" onclick="_hr_ev_sort_column(\'rp\',\'<%ev_id%>\')"><%XL _hr_ev_rp_title%><span class="tooltip"><%XL _hr_ev_rp_title_tt%></span>\n');tmp.push('											<span <%IF sort_col=="rp" && sort_dir =="a"%>style="display: block;"<%ELSE%>style="display: none;"<%END%> class="asc" title="asc"></span>\n');tmp.push('											<span <%IF sort_col=="rp" && sort_dir =="d"%>style="display: block;"<%ELSE%>style="display: none;"<%END%> class="desc" title="desc"></span>\n');tmp.push('										</div>\n');tmp.push('										<div class="jt" onclick="_hr_ev_sort_column(\'jockey\',\'<%ev_id%>\')"><%XL _hr_ev_jockey_title%><span class="tooltip"><%XL _hr_ev_jockey_name_tt%></span>\n');tmp.push('											<span <%IF sort_col=="jockey" && sort_dir =="a"%>style="display: block;"<%ELSE%>style="display: none;"<%END%> class="asc" title="asc"></span>\n');tmp.push('											<span <%IF sort_col=="jockey" && sort_dir =="d"%>style="display: block;"<%ELSE%>style="display: none;"<%END%> class="desc" title="desc"></span>\n');tmp.push('										</div>\n');tmp.push('										<div class="wa" onclick="_hr_ev_sort_column(\'weight\',\'<%ev_id%>\')"><%XL _hr_ev_weight_title%><br /><small class="normal"><%XL _hr_ev_age_title%></small><span class="tooltip"><%XL _hr_ev_age_title_tt%></span>\n');tmp.push('											<span <%IF sort_col=="weight" && sort_dir =="a"%>style="display: block;"<%ELSE%>style="display: none;"<%END%> class="asc" title="asc"></span>\n');tmp.push('											<span <%IF sort_col=="weight" && sort_dir =="d"%>style="display: block;"<%ELSE%>style="display: none;"<%END%> class="desc" title="desc"></span>\n');tmp.push('										</div>\n');tmp.push('										<div class="po"><%XL _hr_ev_prev_odds_title%></div>\n');tmp.push('										<div id="hr_ev_expander_<%ev_id%>_header" class="slider" style="left: <%IF expander != \'closed\'%>-255px;<%ELSE%>20px;<%END%>">\n');tmp.push('											<div id="hr_ev_expander_col_<%ev_id%>_header" class="exp-col collapse">&nbsp;</div>\n');tmp.push('											<div class="ib left">\n');tmp.push('												<div id="hr_ev_ib_head_cont_<%ev_id%>" ></div>\n');tmp.push('											</div>\n');tmp.push('											<div class="pf left">\n');tmp.push('												<div id="hr_ev_pf_head_cont_<%ev_id%>"></div>\n');tmp.push('											</div>\n');tmp.push('										</div>\n');tmp.push('									</div>\n');tmp.push('								</div>\n');tmp.push('								<div class="wew right" id="hr_ev_win_head_cont_<%ev_id%>" onclick="_hr_ev_sort_column(\'market\',\'<%ev_id%>\')"></div>\n');tmp.push('							</th></tr></thead>\n');tmp.push('							<tbody id="hr_ev_runners_<%ev_id%>"></tbody>\n');tmp.push('						</table>\n');tmp.push('						<div class="tools legend">\n');tmp.push('							<ul class="left"><li><div id="hr_ev_event_footer_<%ev_id%>"></div></li></ul>\n');tmp.push('							<ul class="right">\n');tmp.push('								<li><strong><%XL _hr_ev_price_movement%></strong> </li>\n');tmp.push('								<li><div class="shortering"><%XL _hr_ev_odds_shortening%></div><div class="left">&nbsp;<%XL _hr_ev_odds_shortening%></div></li>\n');tmp.push('								<li><div class="drifting"><%XL _hr_ev_odds_drifting%></div><div class="left">&nbsp;<%XL _hr_ev_odds_drifting%></div></li>\n');tmp.push('							</ul>\n');tmp.push('						</div>\n');tmp.push('					</div>\n');tmp.push('					<div class="tab-content" id="h2h_<%ev_id%>" <%IF open_tab != "h2h"%>style="display: none"<%END%>></div>\n');tmp.push('					<div class="tab-content" id="ftc_<%ev_id%>" <%IF open_tab != "ftc"%>style="display: none"<%END%>>\n');tmp.push('						<table summary="<%XL _hr_ev_tricast%>" class="race fc">\n');tmp.push('							<thead id="hr_ev_win_head_cont_ftc_<%ev_id%>"></thead>\n');tmp.push('							<tbody id="hr_ev_runners_ftc_<%ev_id%>"></tbody>\n');tmp.push('						</table>\n');tmp.push('						<div class="tools">\n');tmp.push('							<ul class="right btns">\n');tmp.push('								<li class="green"><a href="javascript:void(0)" onclick="hr_ev_do_foretricasts_reset(\'<%ev_id%>\')" class=""><%XL _hr_ev_reset_foretricast%></a></li>\n');tmp.push('								<li class="green"><a href="javascript:void(0)" onclick="hr_ev_place_fore_tricast(\'<%ev_id%>\');hr_ev_do_foretricasts_reset(\'<%ev_id%>\')" class=""><%XL _hr_ev_place_foretricast%></a></li>\n');tmp.push('							</ul>\n');tmp.push('						</div>\n');tmp.push('					</div>\n');tmp.push('					<div class="tab-content" id="comb_bets_<%ev_id%>" class="combined_bets" <%IF open_tab != "comb_bets"%>style="display: none"<%END%>>\n');tmp.push('						<div>\n');tmp.push('							<div class="comb-bets-info<%IF !bettable%> disabled<%END%>">\n');tmp.push('								<div class="help">\n');tmp.push('									<span class="tooltip"><%XL _hr_ev_combined_bets_help_tt%></span>\n');tmp.push('								</div>\n');tmp.push('								<span id="hr_ev_event_cb_help_cont_<%ev_id%>"></span>\n');tmp.push('							</div>\n');tmp.push('							<div id="hr_ev_event_cb_graphic_<%ev_id%>" class="cb_graphic">\n');tmp.push('								<div id="hr_ev_runners_cb_graphic_<%ev_id%>" class="runners"></div>\n');tmp.push('								<div class="odds_title"><%XL _hr_ev_combined_bets_odds_title%></div>\n');tmp.push('								<div id="hr_ev_event_cb_graphic_price_<%ev_id%>" class="odds_container" onclick="commit_cb_selns(\'<%ev_id%>\', \'<%bet_origin%>\')">\n');tmp.push('									<div class="combined-horses-odds-wrap">\n');tmp.push('										<a class="odds" href="javascript:void(0)"></a>\n');tmp.push('									</div>\n');tmp.push('								</div>\n');tmp.push('								<div class="connection_cover"></div>\n');tmp.push('							</div>\n');tmp.push('						</div>\n');tmp.push('						<table summary="<%XL _hr_ev_combined_bets%>" class="race ch">\n');tmp.push('							<thead id="hr_ev_mkt_header_cont_cb_<%ev_id%>"></thead>\n');tmp.push('							<tbody id="hr_ev_runners_cb_<%ev_id%>"></tbody>\n');tmp.push('						</table>\n');tmp.push('						<div class="tools legend">\n');tmp.push('							<ul class="left"><li><div id="hr_ev_cb_footer_<%ev_id%>"></div></li></ul>\n');tmp.push('							<ul class="right">\n');tmp.push('								<li><strong><%XL _hr_ev_price_movement%></strong> </li>\n');tmp.push('								<li><div class="shortering"><%XL _hr_ev_odds_shortening%></div><div class="left">&nbsp;<%XL _hr_ev_odds_shortening%></div></li>\n');tmp.push('								<li><div class="drifting"><%XL _hr_ev_odds_drifting%></div><div class="left">&nbsp;<%XL _hr_ev_odds_drifting%></div></li>\n');tmp.push('							</ul>\n');tmp.push('						</div>\n');tmp.push('					</div>\n');tmp.push('					<div class="tab-content" id="exm_<%ev_id%>" <%IF open_tab != "exm"%>style="display: none"<%END%>></div>\n');tmp.push('				</div>\n');tmp.push('			</div>\n');tmp.push('	<%IF is_list==0%>\n');tmp.push('			</div>\n');tmp.push('		</div>\n');tmp.push('	<%END%>\n');tmpl_store("hr_ev_event",tmp.join(""));var tmp=[];tmp.push('	<tr id="hr_ev_runner_<%ev_id%>_<%runner_id%>" <%IF hide%>style="display: none"<%END%> <%IF filtered && !runner_filtered%>style="display: none"<%END%>>\n');tmp.push('		<td>\n');tmp.push('			<div class="h_info left">\n');tmp.push('				<div class="silk left"><div class="s-color"><img src="<%silk_url%>/<%pa_feed_silks_file%>" /></div><%IF pa_feed_stall!=""%><div class="number"><small>(<%pa_feed_stall%>)</small><span class="tooltip"><%XL _hr_ev_stall_tt%></span></div><%END%></div>\n');tmp.push('				<div class="infos left">\n');tmp.push('					<h4 class="left"><%runner_number%>&nbsp;<%IF ext_competitor_id !=""%><a href="javascript:void(0)" onclick="window.open(\'http://www.racingpost.com/horses/horse_home.sd?horse_id=<%ext_competitor_id%>&affid=PaddyPower\', \'RacingPost\', \'scrollbars=1,width=700,height=700\');"><%END%><%horse_name%><span class="tooltip"><%XL _hr_ev_horse_name_tt%></span><%IF ext_competitor_id !=""%></a><%END%></h4>\n');tmp.push('					<%IF archive_enabled == 1 && archive_avail == 1%><span class="archive"><a href="javascript:hr_ev_open_archive(\'<%video_url%>\',<%archive_pf_ev%>,<%archive_stream%>)"><%XL _hr_ev_video_archive%><span class="tooltip"><%XL _hr_ev_video_archive_tt%> <%horse_name%></span></a></span><%END%>\n');tmp.push('					<div class="clear"></div>\n');tmp.push('					<div class="left" id="hr_ev_runner_jt_names_<%ev_id%>_<%runner_id%>" <%IF expander != "opened"%>style="display:none;"<%END%>>\n');tmp.push('						<%IF j_search_url!=""%><a href="<%j_search_url%>"><%END%><span class="normal"><%jockey_name_display%></span><%IF j_search_url!=""%></a><%END%>&nbsp;/&nbsp;\n');tmp.push('						<%IF t_search_url!=""%><a href="<%t_search_url%>"><%END%><span class="normal"><%pa_feed_trainer_name_display%></span><%IF t_search_url!=""%></a><%END%>\n');tmp.push('					</div>\n');tmp.push('					<div class="clear"></div>\n');tmp.push('					<%IF has_rp%><%IF form_num>0%><span class="left"><a onclick="_hr_ev_form_build_toggle(\'hr_ev_runner_form_<%ev_id%>_<%runner_id%>\',\'<%runner_id%>\',\'<%ev_id%>\')" href="javascript:void(0)"><%XL _hr_ev_form%><span class="tooltip"><%XL _hr_ev_form_tt%></span></a><%END%><%END%><%IF (!has_rp || form_num==0) && pa_feed_form_figures != ""%><%XL _hr_ev_form%><%END%> <%pa_feed_form_figures%> \n');tmp.push('					<%IF has_rp%><%IF form_num>0%><a class="greenArrow" onclick="_hr_ev_form_build_toggle(\'hr_ev_runner_form_<%ev_id%>_<%runner_id%>\',\'<%runner_id%>\',\'<%ev_id%>\')" href="javascript:void(0)"><span class="tooltip"><%XL _hr_ev_form_tt%></span></a></span><%END%><%END%>\n');tmp.push('					<%IF has_form%><%IF fr_overview!=""%>\n');tmp.push('						<span class="left"><a onclick="_hr_ev_form_build_toggle(\'hr_ev_runner_spotlight_<%ev_id%>_<%runner_id%>\',\'<%runner_id%>\',\'<%ev_id%>\')" href="javascript:void(0)"><%XL _hr_ev_spotlight%><span class="tooltip"><%XL _hr_ev_spotlight_tt%></span></a>\n');tmp.push('						<a class="greenArrow" onclick="_hr_ev_form_build_toggle(\'hr_ev_runner_spotlight_<%ev_id%>_<%runner_id%>\',\'<%runner_id%>\',\'<%ev_id%>\')" href="javascript:void(0)"><span class="tooltip"><%XL _hr_ev_spotlight_tt%></span></a></span>\n');tmp.push('					<%END%><%END%>\n');tmp.push('				</div>\n');tmp.push('			</div>\n');tmp.push('			<div class="mask left">\n');tmp.push('				<div class="wp">\n');tmp.push('					<div class="rp"><%IF rp_rating!=""%><div class="<%IF max_rp_rating%>black<%ELSE%>white<%END%>"><%rp_rating%></div><%END%></div>\n');tmp.push('					<div class="jt">\n');tmp.push('						<%IF j_search_url!=""%><a id="jockey_name_<%runner_id%>" href="<%tmpl_esc_html(j_search_url)%>"><%END%><%jockey_name_display%><%IF j_search_url!=""%></a><%END%><br />\n');tmp.push('						<%IF t_search_url!=""%><a id="trainer_name_<%runner_id%>" href="<%tmpl_esc_html(t_search_url)%>"><%END%><span class="normal"><%pa_feed_trainer_name_display%></span><%IF t_search_url!=""%></a><%END%>\n');tmp.push('					</div>\n');tmp.push('					<div class="wa"><%pa_feed_weight_text%><br /><small class="normal"><%IF pa_feed_age!=""%><%XL _hr_ev_age%> <%pa_feed_age%><%END%></small></div>\n');tmp.push('					<div class="po"><%IF lp_avail == "Y"%><%prev_odds_string%><div class="<%prev_odds_class%>"><%prev_odds_class%></div><%END%></div>\n');tmp.push('					<div id="hr_ev_expander_<%ev_id%>_<%runner_id%>" class="slider" style="left: <%IF expander == \'opened\'%>-255px;<%ELSE%>20px;<%END%>">\n');tmp.push('						<div class="ib left" id="hr_ev_evmkts_ib_<%ev_id%>_<%runner_id%>"></div>\n');tmp.push('						<div class="pf left" id="hr_ev_evmkts_pf_<%ev_id%>_<%runner_id%>"></div>\n');tmp.push('					</div>\n');tmp.push('				</div>\n');tmp.push('			</div>\n');tmp.push('			<div class="wew right" id="hr_ev_evmkts_win_<%ev_id%>_<%runner_id%>"></div>\n');tmp.push('			<%IF has_rp && pushed%>\n');tmp.push('				<div>\n');tmp.push('					<%IF fr_overview != ""%>\n');tmp.push('						<div id="hr_ev_runner_spotlight_<%ev_id%>_<%runner_id%>" style="display: none">\n');tmp.push('							<div class="spotlight">\n');tmp.push('								<p><span class="rp-logo"><%XL _hr_ev_racing_post%></span> <strong><%XL _hr_ev_spotlight%> </strong><%fr_overview%></p><br />\n');tmp.push('								<div class="right"><a href="javascript:void(0)" onclick="_hr_ev_form_toggle(\'hr_ev_runner_spotlight_<%ev_id%>_<%runner_id%>\')" class="close-me"><span class="normal">Close</span><span class="tooltip"><%XL _hr_ev_close_tt%></span></a></div>\n');tmp.push('								<div class="clear"></div>\n');tmp.push('							</div>\n');tmp.push('						</div>\n');tmp.push('					<%END%>\n');tmp.push('					<div id="hr_ev_runner_form_<%ev_id%>_<%runner_id%>" style="display: none;" class="form">\n');tmp.push('						<table class="stats"  summary="">\n');tmp.push('							<tr><th class="date"><%XL _hr_ev_rp_date%></th><th class="rc"><%XL _hr_ev_rp_conditions%></th><th class="w"><%XL _hr_ev_rp_weight%></th>\n');tmp.push('							<th class="ro"><%XL _hr_ev_rp_outcome%></th><th class="j"><%XL _hr_ev_rp_jockey%></th>\n');tmp.push('							<th class="or"><%XL _hr_ev_rp_or%><span class="tooltip"><%XL _hr_ev_rp_or_tt%></span></th>\n');tmp.push('							<th class="ts"><%XL _hr_ev_rp_ts%><span class="tooltip"><%XL _hr_ev_rp_ts_tt%></span></th>\n');tmp.push('							<th class="rpr"><%XL _hr_ev_rp_rpr%><span class="tooltip"><%XL _hr_ev_rp_rpr_tt%></span></th></tr>\n');tmp.push('							<%LOOP hr_ev_form_idx form_num%>\n');tmp.push('							<tr>\n');tmp.push('								<th class="date"><%fr_race_form[hr_ev_form_idx].date%></th>\n');tmp.push('								<td class="rc"><%fr_race_form[hr_ev_form_idx].conditions%></td>\n');tmp.push('								<td class="w"><%fr_race_form[hr_ev_form_idx].weight_text%></td>\n');tmp.push('								<td class="ro"><%fr_race_form[hr_ev_form_idx].race_outcome%></td>\n');tmp.push('								<td class="j"><%fr_race_form[hr_ev_form_idx].jockey%></td>\n');tmp.push('								<td class="or"><%fr_race_form[hr_ev_form_idx].official_rating%></td>\n');tmp.push('								<td class="ts"><%fr_race_form[hr_ev_form_idx].topspeed%></td>\n');tmp.push('								<td class="rpr"><%fr_race_form[hr_ev_form_idx].rpr%></td>\n');tmp.push('							</tr>\n');tmp.push('							<%END%>\n');tmp.push('						</table>\n');tmp.push('						<div class="right"><a href="javascript:void(0)" onclick="_hr_ev_form_toggle(\'hr_ev_runner_form_<%ev_id%>_<%runner_id%>\')" class="close-me"><span class="normal">Close</span><span class="tooltip"><%XL _hr_ev_close_tt%></span></a></div>\n');tmp.push('						<div class="clear"></div>\n');tmp.push('					</div>\n');tmp.push('				</div>\n');tmp.push('			<%END%>\n');tmp.push('		</td>\n');tmp.push('	</tr>\n');tmpl_store("hr_ev_runner",tmp.join(""));var tmp=[];tmp.push('	<tr id="hr_ev_runner_<%ev_id%>_<%runner_id%>" <%IF hide%>style="display: none"<%END%> <%IF filtered%>style="display: none"<%END%>>\n');tmp.push('		<td class="fav">\n');tmp.push('			<div class="h_info left">\n');tmp.push('				<div class="silk left"><div class="s-color"><img src="<%silk_url%>/<%pa_feed_silks_file%>" /></div></div>\n');tmp.push('				<div class="infos left"><h4 class="left"><%horse_name%></h4></div>\n');tmp.push('			</div>\n');tmp.push('			<div class="wew right" id="hr_ev_evmkts_win_<%ev_id%>_<%runner_id%>"></div>\n');tmp.push('		</td>\n');tmp.push('	</tr>\n');tmpl_store("hr_ev_runner_fav",tmp.join(""));var tmp=[];tmp.push('	<div class="odd" id="hr_ev_evmkt_head_<%ev_id%>_<%ev_mkt_id%>"><small class="normal"><%name%></small><%IF mkt_tooltip %><span class="tooltip"><%mkt_tooltip%></span><%END%></div>\n');tmpl_store("hr_ev_mkt_header",tmp.join(""));var tmp=[];tmp.push('	<div class="odd" id="hr_ev_evmkt_head_<%ev_id%>_dummy_<%type%>_<%dummy_num%>"><small class="normal"><%XL _hr_ev_mkt_not_available%></small></div>\n');tmpl_store("hr_ev_mkt_header_dummy",tmp.join(""));var tmp=[];tmp.push('	<span style="display: none;" class="asc" title="asc"></span>\n');tmp.push('	<span style="display: none;" class="desc" title="desc"></span>\n');tmp.push('	<span class="tooltip"><%XL _hr_ev_wew_tt%></span>\n');tmp.push('	<div id="hr_ev_evmkt_head_<%ev_id%>_<%ev_mkt_id%>"><%name%>');tmp.push('		<%IF ew_text!=""%><small class="normal terms"><%XL _hr_ev_terms_text%> <%ew_text%></small><%END%>');tmp.push('		<%IF cashout_avail=="Y"%><span class="cash-out-available"></span><%END%>\n');tmp.push('	</div>\n');tmpl_store("hr_ev_mkt_header_win",tmp.join(""));var tmp=[];tmp.push('	<div id="hr_ev_evmkt_<%ev_id%>_<%runner_id%>_<%ev_mkt_id%>" class="left"><div class="left"><div class="odd suspended"><a href="javascript:void(0)" id="hr_ev_selcns_<%ev_id%>_<%runner_id%>_<%ev_mkt_id%>" class="empty"><%XL _hr_ev_not_available%></a></div></div></div>\n');tmpl_store("hr_ev_mkt_non_runner",tmp.join(""));var tmp=[];tmp.push('	<div id="hr_ev_evmkt_dummy_<%ev_id%>_<%runner_id%>_<%type%>_<%dummy_num%>" class="left"><div class="left"><div class="odd suspended"><a href="javascript:void(0)" class="empty"><%XL _hr_ev_not_available%></a></div></div>\n');tmpl_store("hr_ev_mkt_dummy",tmp.join(""));var tmp=[];tmp.push('	<div id="hr_ev_selcn_<%ev_id%>_<%link_key%>_<%ev_mkt_id%>_<%ev_oc_id%>" class="left">\n');tmp.push('		<%IF !now_visible%>\n');tmp.push('			<div class="odd suspended"><a href="javascript:void(0)" class="empty"><%XL _hr_ev_not_available%></a></div>\n');tmp.push('		<%ELSE IF fb_result == "X"%>\n');tmp.push('			<div class="odd suspended"><a href="javascript:void(0)" class="empty"><%XL _hr_ev_without%></a></div>\n');tmp.push('		<%ELSE IF fb_result == "N"%>\n');tmp.push('			<%IF mkt_cat == "EW"%><div class="nr"><%XL _hr_ev_non_runner%></div><%ELSE%><div class="odd suspended"><a href="javascript:void(0)" class="empty"><%XL _hr_ev_not_available%></a></div><%END%>\n');tmp.push('		<%ELSE IF fb_result == "1" || fb_result == "2"%>\n');tmp.push('			<%IF mkt_sp_avail == "Y"%><div class="sp-med"><%IF bettable%><a href="javascript:void(0)" onclick="hr_ev_do_racecard_bet(\'<%ev_oc_id%>\',\'<%ev_id%>\',\'S\',\'<%bet_origin%>\')">SP</a><%END%></div><%END%>\n');tmp.push('		<%ELSE%>\n');tmp.push('			<%IF bettable%>\n');tmp.push('				<%IF mkt_lp_avail == "Y"%><div class="odd <%IF !bettable%> suspended<%END%>"><%IF bettable%><a href="javascript:void(0)" onclick="hr_ev_do_racecard_bet(\'<%ev_oc_id%>\',\'<%ev_id%>\',\'L\',\'<%bet_origin%>\')"><%price_str%></a><%END%></div><%END%>\n');tmp.push('				<%IF mkt_sp_avail == "Y"%><div class="<%IF mkt_cat == "EW"%>sp<%IF mkt_lp_avail != "Y"%>-med<%END%><%ELSE%>odd<%END%> <%IF !bettable%> suspended<%END%>"><%IF bettable%><a href="javascript:void(0)" onclick="hr_ev_do_racecard_bet(\'<%ev_oc_id%>\',\'<%ev_id%>\',\'S\',\'<%bet_origin%>\')">SP</a><%END%></div><%END%>\n');tmp.push('			<%ELSE%>\n');tmp.push('				<%IF mkt_lp_avail == "Y"%><div class="odd <%IF !bettable%> suspended<%END%>"><%IF !bettable%><a href="javascript:void(0)" class="empty" id="hr_ev_selcn_price_<%ev_id%>_<%link_key%>_<%ev_mkt_id%>_<%ev_oc_id%>" ><%price_str%></a><%END%></div><%END%>\n');tmp.push('				<%IF mkt_sp_avail == "Y"%><div class="<%IF mkt_cat == "EW"%>sp<%IF mkt_lp_avail != "Y"%>-med<%END%><%ELSE%>odd<%END%> <%IF !bettable%> suspended<%END%>"><%IF !bettable%><a href="javascript:void(0)" class="empty">SP</a><%END%></div><%END%>\n');tmp.push('			<%END%>\n');tmp.push('		<%END%>\n');tmp.push('	</div>\n');tmpl_store("hr_ev_selcn",tmp.join(""))}
function _hr_ev_store_rp_templates(){var tmp=[];tmp.push('	<%IF fr_overview != ""%>\n');tmp.push('		<div id="hr_ev_runner_spotlight_<%ev_id%>_<%runner_id%>" style="display: none">\n');tmp.push('			<div class="spotlight">\n');tmp.push('				<p><span class="rp-logo"><%XL _hr_ev_racing_post%></span> <strong><%XL _hr_ev_spotlight%> </strong><%fr_overview%></p><br />\n');tmp.push('				<div class="left"><a href="javascript:void(0);" onclick="_hr_ev_form_build_open_all(\'spotlight\',<%ev_id%>)"><%XL _hr_ev_open_all_spotlights%></a></div>\n');tmp.push('				<div class="right"><a href="javascript:void(0)" onclick="_hr_ev_form_toggle(\'hr_ev_runner_spotlight_<%ev_id%>_<%runner_id%>\')" class="close-me"><span class="normal">Close</span><span class="tooltip"><%XL _hr_ev_close_tt%></span></a></div>\n');tmp.push('				<div class="clear"></div>\n');tmp.push('			</div>\n');tmp.push('		</div>\n');tmp.push('	<%END%>\n');tmp.push('	<div id="hr_ev_runner_form_<%ev_id%>_<%runner_id%>" style="display: none;" class="form">\n');tmp.push('		<table class="stats"  summary="">\n');tmp.push('			<tr><th class="date"><%XL _hr_ev_rp_date%></th><th class="rc"><%XL _hr_ev_rp_conditions%></th><th class="w"><%XL _hr_ev_rp_weight%></th>\n');tmp.push('			<th class="ro"><%XL _hr_ev_rp_outcome%></th><th class="j"><%XL _hr_ev_rp_jockey%></th>\n');tmp.push('			<th class="or"><%XL _hr_ev_rp_or%><span class="tooltip"><%XL _hr_ev_rp_or_tt%></span></th>\n');tmp.push('			<th class="ts"><%XL _hr_ev_rp_ts%><span class="tooltip"><%XL _hr_ev_rp_ts_tt%></span></th>\n');tmp.push('			<th class="rpr"><%XL _hr_ev_rp_rpr%><span class="tooltip"><%XL _hr_ev_rp_rpr_tt%></span></th></tr>\n');tmp.push('			<%LOOP hr_ev_form_idx form_num%>\n');tmp.push('			<tr>\n');tmp.push('				<th class="date"><%fr_race_form[hr_ev_form_idx].date%></th>\n');tmp.push('				<td class="rc"><%fr_race_form[hr_ev_form_idx].conditions%></td>\n');tmp.push('				<td class="w"><%fr_race_form[hr_ev_form_idx].weight_text%></td>\n');tmp.push('				<td class="ro"><%fr_race_form[hr_ev_form_idx].race_outcome%></td>\n');tmp.push('				<td class="j"><%fr_race_form[hr_ev_form_idx].jockey%></td>\n');tmp.push('				<td class="or"><%fr_race_form[hr_ev_form_idx].official_rating%></td>\n');tmp.push('				<td class="ts"><%fr_race_form[hr_ev_form_idx].topspeed%></td>\n');tmp.push('				<td class="rpr"><%fr_race_form[hr_ev_form_idx].rpr%></td>\n');tmp.push('			</tr>\n');tmp.push('			<%END%>\n');tmp.push('		</table>\n');tmp.push('		<div class="left"><a href="javascript:void(0);" onclick="_hr_ev_form_build_open_all(\'form\',<%ev_id%>)"><%XL _hr_ev_open_all_forms%></a></div>\n');tmp.push('		<div class="right"><a href="javascript:void(0)" onclick="_hr_ev_form_toggle(\'hr_ev_runner_form_<%ev_id%>_<%runner_id%>\')" class="close-me"><span class="normal">Close</span><span class="tooltip"><%XL _hr_ev_close_tt%></span></a></div>\n');tmp.push('		<div class="clear"></div>\n');tmp.push('	</div>\n');tmpl_store("hr_ev_post_data",tmp.join(""))}
function _hr_ev_store_ftc_templates(){var tmp=[];tmp.push('	<tr id="hr_ev_runner_ftc_<%ev_id%>_<%runner_id%>"  <%IF hide%>style="display: none"<%END%>>\n');tmp.push('		<td>\n');tmp.push('			<div class="h_info left">\n');tmp.push('				<div class="silk left"><%IF pa_feed_stall!=""%><span class="tooltip"><%XL _hr_ev_stall_tt%></span><%END%><div class="s-color"><img src="<%silk_url%>/<%pa_feed_silks_file%>" /></div><%IF pa_feed_stall!=""%><div class="number"><strong><%XL _hr_ev_stall%></strong><small>(<%pa_feed_stall%>)</small></div><%END%></div>\n');tmp.push('				<div class="infos left">\n');tmp.push('					<h4 class="left"><%runner_number%>&nbsp;<%IF ext_competitor_id !=""%><a href="javascript:void(0)" onclick="window.open(\'http://www.racingpost.com/horses/horse_home.sd?horse_id=<%ext_competitor_id%>&affid=PaddyPower\', \'RacingPost\', \'scrollbars=1,width=700,height=700\');"><%END%><%horse_name%><%IF ext_competitor_id !=""%></a><%END%></h4>\n');tmp.push('					<div class="clear"></div>\n');tmp.push('					<%IF has_rp%><%IF form_num>0%><a onclick="_hr_ev_form_toggle(\'hr_ev_runner_form_ftc_<%ev_id%>_<%runner_id%>\')" href="javascript:void(0)"><%XL _hr_ev_form%><span class="tooltip"><%XL _hr_ev_form_tt%></span></a><%END%><%END%><%IF (!has_rp || form_num==0) && pa_feed_form_figures != ""%><%XL _hr_ev_form%><%END%> <%pa_feed_form_figures%> <%IF has_form%><%IF fr_overview!=""%><a onclick="_hr_ev_form_toggle(\'hr_ev_runner_spotlight_ftc_<%ev_id%>_<%runner_id%>\')" href="javascript:void(0)"><%XL _hr_ev_spotlight%> <span class="tooltip"><%XL _hr_ev_spotlight_tt%></span></a><%END%><%END%>\n');tmp.push('					<br>\n');tmp.push('					<strong>J:</strong> <%IF j_search_url!=""%><a href="<%j_search_url%>"><%END%><%jockey_name_display%><span class="tooltip"><%XL _hr_ev_jockey_name_ftc_tt%></span><%IF j_search_url!=""%></a><%END%><br>\n');tmp.push('					<span class="normal"><strong>T: </strong><%IF t_search_url!=""%><a href="<%t_search_url%>"><%END%><span class="normal"><%pa_feed_trainer_name_display%></span><span class="tooltip"><%XL _hr_ev_trainer_name_tt%></span><%IF t_search_url!=""%></a><%END%></span>\n');tmp.push('				</div>\n');tmp.push('			</div>\n');tmp.push('			<div class="wew right">\n');tmp.push('				<div id="hr_ev_evmkts_win_ftc_<%ev_id%>_<%runner_id%>"></div>\n');tmp.push('				<div class="clear"></div>\n');tmp.push('			</div>\n');tmp.push('			<div class="clear"></div>\n');tmp.push('			<%IF has_rp%><%IF fr_overview != ""%>\n');tmp.push('				<div id="hr_ev_runner_spotlight_ftc_<%ev_id%>_<%runner_id%>" style="display: none">\n');tmp.push('					<div class="spotlight">\n');tmp.push('						<p><span class="rp-logo"><%XL _hr_ev_racing_post%></span> <strong><%XL _hr_ev_spotlight%> </strong><%fr_overview%></p><br />\n');tmp.push('						<div class="right"><a href="javascript:void(0)" onclick="_hr_ev_form_toggle(\'hr_ev_runner_spotlight_ftc_<%ev_id%>_<%runner_id%>\')" class="close-me"><span class="normal">Close</span><span class="tooltip"><%XL _hr_ev_close_tt%></span></a></div>\n');tmp.push('						<div class="clear"></div>\n');tmp.push('					</div>\n');tmp.push('				</div>\n');tmp.push('			<%END%><%END%>\n');tmp.push('			<%IF has_rp%><div id="hr_ev_runner_form_ftc_<%ev_id%>_<%runner_id%>" style="display: none">\n');tmp.push('				<table class="stats"  summary="">\n');tmp.push('					<tr><th class="date"><%XL _hr_ev_rp_date%></th><th class="rc"><%XL _hr_ev_rp_conditions%></th><th class="w"><%XL _hr_ev_rp_weight%></th>\n');tmp.push('					<th class="ro"><%XL _hr_ev_rp_outcome%></th><th class="j"><%XL _hr_ev_rp_jockey%></th>\n');tmp.push('					<th class="or"><%XL _hr_ev_rp_or%><span class="tooltip"><%XL _hr_ev_rp_or_tt%></span></th>\n');tmp.push('					<th class="ts"><%XL _hr_ev_rp_ts%><span class="tooltip"><%XL _hr_ev_rp_ts_tt%></span></th>\n');tmp.push('					<th class="rpr"><%XL _hr_ev_rp_rpr%><span class="tooltip"><%XL _hr_ev_rp_rpr_tt%></span></th></tr>\n');tmp.push('					<%LOOP hr_ev_form_idx form_num%>\n');tmp.push('					<tr>\n');tmp.push('						<th class="date"><%fr_race_form[hr_ev_form_idx].date%></th>\n');tmp.push('						<td class="rc"><%fr_race_form[hr_ev_form_idx].conditions%></td>\n');tmp.push('						<td class="w"><%fr_race_form[hr_ev_form_idx].weight_text%></td>\n');tmp.push('						<td class="ro"><%fr_race_form[hr_ev_form_idx].race_outcome%></td>\n');tmp.push('						<td class="j"><%fr_race_form[hr_ev_form_idx].jockey%></td>\n');tmp.push('						<td class="or"><%fr_race_form[hr_ev_form_idx].official_rating%></td>\n');tmp.push('						<td class="ts"><%fr_race_form[hr_ev_form_idx].topspeed%></td>\n');tmp.push('						<td class="rpr"><%fr_race_form[hr_ev_form_idx].rpr%></td>\n');tmp.push('					</tr>\n');tmp.push('					<%END%>\n');tmp.push('				</table>\n');tmp.push('				<div class="right"><a href="javascript:void(0)" onclick="_hr_ev_form_toggle(\'hr_ev_runner_form_ftc_<%ev_id%>_<%runner_id%>\')" class="close-me"><span class="normal">Close</span><span class="tooltip"><%XL _hr_ev_close_tt%></span></a></div>\n');tmp.push('			<div class="clear"></div></div><%END%>\n');tmp.push('		</td>\n');tmp.push('	</tr>\n');tmpl_store("hr_ev_runner_ftc",tmp.join(""));var tmp=[];tmp.push('	<tr id="hr_ev_evmkt_head_ftc_<%ev_id%>_<%ev_mkt_id%>">\n');tmp.push('		<th>\n');tmp.push('			<div class="h_info left"><%XL _hr_ev_horse_jockey%><span class="tooltip"><%XL _hr_ev_horse_jockey_tt%></span></div>\n');tmp.push('			<div class="h_odds"><%XL _hr_ev_odds%><span class="tooltip"><%XL _hr_ev_odds_tt%></span></div>\n');tmp.push('			<div class="h_fc"><%XL _hr_ev_fcast%><span class="tooltip"><%XL _hr_ev_fcast_tt%></span><br />\n');tmp.push('				<div class="elt"><small class="normal"><%XL _hr_ev_first%></small></div>\n');tmp.push('				<div class="elt"><small class="normal"><%XL _hr_ev_second%></small></div>\n');tmp.push('				<div class="elt ao"><small class="normal"><%XL _hr_ev_any%></small></div>\n');tmp.push('				<div class="clear"></div>\n');tmp.push('			</div>\n');tmp.push('			<div class="h_tc"><%XL _hr_ev_tcast%><span class="tooltip"><%XL _hr_ev_tcast_tt%></span><br />\n');tmp.push('				<div class="elt"><small class="normal"><%XL _hr_ev_first%></small></div>\n');tmp.push('				<div class="elt"><small class="normal"><%XL _hr_ev_second%></small></div>\n');tmp.push('				<div class="elt"><small class="normal"><%XL _hr_ev_third%></small></div>\n');tmp.push('				<div class="elt ao"><small class="normal"><%XL _hr_ev_any%></small></div>\n');tmp.push('				<div class="clear"></div>\n');tmp.push('			</div>\n');tmp.push('		</th>\n');tmp.push('	</tr>\n');tmpl_store("hr_ev_mkt_header_win_ftc",tmp.join(""));var tmp=[];tmp.push('	<div id="hr_ev_evmkt_ftc_<%ev_id%>_<%runner_id%>_<%ev_mkt_id%>"><div id="hr_ev_selcns_ftc_<%ev_id%>_<%runner_id%>_<%ev_mkt_id%>"></div></div>\n');tmpl_store("hr_ev_mkt_ftc",tmp.join(""));var tmp=[];tmp.push('	<div id="hr_ev_selcn_ftc_<%ev_id%>_<%link_key%>_<%ev_mkt_id%>_<%ev_oc_id%>" class="">\n');tmp.push('		<div id="hr_ev_selcn_price_ftc_<%ev_id%>_<%link_key%>_<%ev_mkt_id%>_<%ev_oc_id%>" class="h_odds left"><%price_str%></div>\n');tmp.push('		<%IF fb_result == "N"%>\n');tmp.push('			<div class="nr"><%XL _hr_ev_non_runner%></div>\n');tmp.push('		<%ELSE IF fb_result == "1" || fb_result == "2"%>\n');tmp.push('			<div class="nr"><%XL _hr_ev_un_fav%></div>\n');tmp.push('		<%ELSE%>\n');tmp.push('			<%IF bettable%>\n');tmp.push('				<%IF mkt_fc_avail == "Y"%><div class="h_fc">\n');tmp.push('					<div class="elt"><input id="tfcastf_<%ev_id%>_<%link_key%>_1" type="checkbox" onclick="hr_ev_checkLimits(\'f\',\'<%link_key%>\',\'1\',\'<%ev_id%>\')" name="fc" value="<%ev_oc_id%>"/></div>\n');tmp.push('					<div class="elt"><input id="tfcastf_<%ev_id%>_<%link_key%>_2" type="checkbox" onclick="hr_ev_checkLimits(\'f\',\'<%link_key%>\',\'2\',\'<%ev_id%>\')" name="fc" value="<%ev_oc_id%>"/></div>\n');tmp.push('					<div class="elt ao"><input id="tfcastf_<%ev_id%>_<%link_key%>_A" type="checkbox" onclick="hr_ev_checkLimits(\'f\',\'<%link_key%>\',\'A\',\'<%ev_id%>\')" name="fc" value="<%ev_oc_id%>"/></div>\n');tmp.push('					<div class="clear"></div>\n');tmp.push('				</div><%END%>\n');tmp.push('				<%IF mkt_tc_avail == "Y"%><div class="h_tc">\n');tmp.push('					<div class="elt"><input id="tfcastt_<%ev_id%>_<%link_key%>_1" type="checkbox" onclick="hr_ev_checkLimits(\'t\',\'<%link_key%>\',\'1\',\'<%ev_id%>\')" name="fc" value="<%ev_oc_id%>"/></div>\n');tmp.push('					<div class="elt"><input id="tfcastt_<%ev_id%>_<%link_key%>_2" type="checkbox" onclick="hr_ev_checkLimits(\'t\',\'<%link_key%>\',\'2\',\'<%ev_id%>\')" name="fc" value="<%ev_oc_id%>"/></div>\n');tmp.push('					<div class="elt"><input id="tfcastt_<%ev_id%>_<%link_key%>_3" type="checkbox" onclick="hr_ev_checkLimits(\'t\',\'<%link_key%>\',\'3\',\'<%ev_id%>\')" name="fc" value="<%ev_oc_id%>"/></div>\n');tmp.push('					<div class="elt ao"><input id="tfcastt_<%ev_id%>_<%link_key%>_A" type="checkbox" onclick="hr_ev_checkLimits(\'t\',\'<%link_key%>\',\'A\',\'<%ev_id%>\')" name="fc" value="<%ev_oc_id%>"/></div>\n');tmp.push('					<div class="clear"></div>\n');tmp.push('				</div><%END%>\n');tmp.push('			<%ELSE%>\n');tmp.push('				<div class="nr"><%XL _hr_ev_susp%></div>\n');tmp.push('			<%END%>\n');tmp.push('		<%END%>\n');tmp.push('	</div>\n');tmpl_store("hr_ev_selcn_ftc",tmp.join(""))}
function _hr_ev_store_cb_templates(){var tmp=[];tmp.push('	<tr id="hr_ev_mkt_header_cb_<%ev_id%>_<%ev_mkt_id%>">\n');tmp.push('		<th>\n');tmp.push('			<div class="h_info left"><%XL _hr_ev_h_info_title%></div>\n');tmp.push('			<div class="rp"><%XL _hr_ev_rp_title%></div>\n');tmp.push('			<div class="po"><%XL _hr_ev_prev_odds_title%></div>\n');tmp.push('			<div class="wew left"><div><%name%></div></div>\n');tmp.push('			<div class="button_wrap"></div>\n');tmp.push('		</th>\n');tmp.push('	</tr>\n');tmpl_store("hr_ev_mkt_header_cb",tmp.join(""));var tmp=[];tmp.push('	<tr id="hr_ev_runner_cb_<%ev_id%>_<%runner_id%>" <%IF hide%>style="display: none"<%END%>>\n');tmp.push('		<td>\n');tmp.push('			<div class="h_info left">\n');tmp.push('				<div class="silk left"><div class="s-color"><img src="<%silk_url%>/<%pa_feed_silks_file%>" /></div></div>\n');tmp.push('				<div class="infos left">\n');tmp.push('					<h4 class="left"><%runner_number%>&nbsp;<%IF ext_competitor_id !=""%><a href="javascript:void(0)" onclick="window.open(\'http://www.racingpost.com/horses/horse_home.sd?horse_id=<%ext_competitor_id%>&affid=PaddyPower\', \'RacingPost\', \'scrollbars=1,width=700,height=700\');"><%END%><%horse_name%><span class="tooltip"><%XL _hr_ev_horse_name_tt%></span><%IF ext_competitor_id !=""%></a><%END%></h4>\n');tmp.push('					<div class="clear"></div>\n');tmp.push('					<div class="left">\n');tmp.push('						<%IF j_search_url!=""%><a href="<%j_search_url%>"><%END%><span class="normal"><%jockey_name_display%></span><%IF j_search_url!=""%></a><%END%>\n');tmp.push('					</div>\n');tmp.push('					<div class="clear"></div>\n');tmp.push('				</div>\n');tmp.push('			</div>\n');tmp.push('			<div class="rp"><%IF rp_rating!=""%><div class="<%IF max_rp_rating%>black<%ELSE%>white<%END%>"><%rp_rating%></div><%END%></div>\n');tmp.push('			<div class="po"><%IF lp_avail == "Y"%><%prev_odds_string%><div class="<%prev_odds_class%>"><%prev_odds_class%></div><%END%></div>\n');tmp.push('			<div class="wew left" id="hr_ev_mkt_prices_cb_<%ev_id%>_<%runner_id%>"></div>\n');tmp.push('			<div class="button_wrap" id="hr_ev_mkt_cb_control_cont_<%ev_id%>_<%runner_id%>"><\div>\n');tmp.push('		</td>\n');tmp.push('	</tr>\n');tmpl_store("hr_ev_runner_cb",tmp.join(""));var tmp=[];tmp.push('	<div id="hr_ev_mkt_price_cb_<%ev_id%>_<%runner_id%>_<%ev_mkt_id%>"><div id="hr_ev_selcn_prices_cb_<%ev_id%>_<%runner_id%>_<%ev_mkt_id%>"></div></div>\n');tmpl_store("hr_ev_mkt_price_cb",tmp.join(""));var tmp=[];tmp.push('	<div id="hr_ev_mkt_cb_control_<%ev_id%>_<%runner_id%>_<%ev_mkt_id%>"><div id="hr_ev_selcn_cb_control_cont_<%ev_id%>_<%runner_id%>_<%ev_mkt_id%>"></div></div>\n');tmpl_store("hr_ev_mkt_cb_control",tmp.join(""));var tmp=[];tmp.push('	<div id="hr_ev_selcn_price_cb_<%ev_id%>_<%link_key%>_<%ev_mkt_id%>_<%ev_oc_id%>" class="odds">\n');tmp.push('		<%IF now_visible && fb_result != "N"%>\n');tmp.push('			<%price_str%>\n');tmp.push('		<%END%>\n');tmp.push('	</div>\n');tmpl_store("hr_ev_seln_cb_price",tmp.join(""));var tmp=[];tmp.push('	<div id="hr_ev_selcn_cb_control_<%ev_id%>_<%link_key%>_<%ev_mkt_id%>_<%ev_oc_id%>">\n');tmp.push('		<%IF !now_visible%>\n');tmp.push('			<div class="button_suspended"><a href="javascript:void(0)" class="empty"><%XL _hr_ev_not_available%></a></div>\n');tmp.push('		<%ELSE IF selected_cb%>\n');tmp.push('			<div class="button_remove"><a href="javascript:void(0)" onclick="remove_cb_seln(\'<%ev_id%>\',\'<%ev_oc_id%>\', true)"><%XL _hr_ev_combined_bets_btn_remove%></a></div>');tmp.push('		<%ELSE IF fb_result == "N"%>\n');tmp.push('			<div class="nr"><%XL _hr_ev_non_runner%></div>\n');tmp.push('		<%ELSE%>\n');tmp.push('			<%IF bettable%>\n');tmp.push('				<%IF mkt_lp_avail == "Y"%>\n');tmp.push('					<div class="button_add"><a href="javascript:void(0)" onclick="add_cb_seln(\'<%ev_id%>\',\'<%ev_oc_id%>\')"><%XL _hr_ev_combined_bets_btn_add%></a></div>');tmp.push('				<%END%>\n');tmp.push('			<%ELSE%>\n');tmp.push('				<div class="button_suspended"><a href="javascript:void(0)" class="empty"><%XL _hr_ev_not_available%></a></div>\n');tmp.push('			<%END%>\n');tmp.push('		<%END%>\n');tmp.push('	</div>\n');tmpl_store("hr_ev_seln_cb_control",tmp.join(""));var tmp=[];tmp.push('	<div id="hr_ev_runner_cb_graphic_<%ev_id%>_<%wew_ev_oc_id%>" class="runner <%IF bettable%>active<%ELSE%>suspended<%END%>">\n');tmp.push('		<div class="h_info left">\n');tmp.push('			<div class="silk left">\n');tmp.push('				<div class="s-color"><img src="<%silk_url%>/<%pa_feed_silks_file%>" /></div>\n');tmp.push('			</div>\n');tmp.push('		<div class="infos left">\n');tmp.push('			<h4 class="left"><%runner_number%>&nbsp;<%IF ext_competitor_id !=""%><a href="javascript:void(0)" onclick="window.open(\'http://www.racingpost.com/horses/horse_home.sd?horse_id=<%ext_competitor_id%>&affid=PaddyPower\', \'RacingPost\', \'scrollbars=1,width=700,height=700\');"><%END%><%horse_name%><span class="tooltip"><%XL _hr_ev_horse_name_tt%></span><%IF ext_competitor_id !=""%></a><%END%></h4>\n');tmp.push('			<div class="clear"></div>\n');tmp.push('			<div class="left">\n');tmp.push('				<%IF j_search_url!=""%><a href="<%j_search_url%>"><%END%><span class="normal"><%jockey_name_display%></span><%IF j_search_url!=""%></a><%END%>\n');tmp.push('			</div>\n');tmp.push('		</div>\n');tmp.push('		<div class="odds"><%price_str%></div>\n');tmp.push('		<div class="remove" onclick="remove_cb_seln(\'<%ev_id%>\',\'<%wew_ev_oc_id%>\', true)"><span class="tooltip"><%XL _hr_ev_combined_bets_runner_remove_tt%></span></div>\n');tmp.push('	</div>\n');tmpl_store('hr_ev_runner_cb_graphic',tmp.join(''));var tmp=[];tmp.push('	<div id="hr_ev_runner_cb_graphic_blank_<%ev_id%>_<%position%>" class="runner <%position%>"></div>');tmpl_store('hr_ev_runner_cb_graphic_blank',tmp.join(''));var tmp=[];tmp.push('<span id="hr_ev_event_cb_help_<%ev_id%>"><%message%></span>');tmpl_store('hr_ev_event_cb_help',tmp.join(''))};var _hr_ev_pcast_container_prefix="hr_ev_pcast_container",_hr_ev_pcast_event_prefix="hr_ev_pcast_event_",_hr_ev_pcast_header_prefix="hr_ev_pcast_header_",_hr_ev_pcast_competitors_container_prefix="hr_ev_pcast_competitors_container_",_hr_ev_pcast_section_head_prefix="hr_ev_pcast_section_head_",_hr_ev_pcast_section_rows_prefix="hr_ev_pcast_section_rows_",_hr_ev_pcast_section_row_prefix="hr_ev_pcast_section_row_",_hr_ev_pcast_runner_prefix="hr_ev_pcast_runner_",_hr_ev_pcast_seln_container_prefix="hr_ev_pcast_seln_container_",_hr_ev_pcast_seln_prefix="hr_ev_pcast_seln_",_hr_ev_pcast_footer_prefix="hr_ev_pcast_footer_",_hr_ev_pcast_selcn_base_class="odds",_hr_ev_pcast_hl_timers={},_hr_ev_pcast_hash={}
function hr_ev_pcast_init(event,runners,markets,selcns,init_msg_id,cfg){var hr_ev_pcast=_hr_ev_pcast_hash[event.ev_id];if(!hr_ev_pcast){hr_ev_pcast=new hr_ev_pcast_object();_hr_ev_pcast_hash[event.ev_id]=hr_ev_pcast};for(var f in cfg)hr_ev_pcast.cfg[f]=cfg[f];hr_ev_pcast.last_msg_id=init_msg_id;var live_channels=[];_hr_ev_pcast_store_templates();hr_ev_pcast.event_hash={};hr_ev_pcast.evmkt_hash={};hr_ev_pcast.selcn_hash={};hr_ev_pcast.runner_hash={};hr_ev_pcast.now_displaying_runners={};hr_ev_pcast.selcn_mkt_hash={};hr_ev_pcast.show_section_2=false;hr_ev_pcast.show_section_3=false;hr_ev_pcast.show_section_4=false;hr_ev_pcast.channels={};for(var i=0;i<runners.length;i++){runner=runners[i];hr_ev_pcast.runner_hash[runner.runner_number]=runner};if(event.is_hr_homepage_ajax!="Y"){document.getElementById(_hr_ev_pcast_container_prefix).style.display='block';scone_create(_hr_ev_pcast_container_prefix,{},null,null)};_hr_ev_pcast_got_EVENT(event,hr_ev_pcast,false);if(!hr_ev_pcast.channels["EVENT"+event.ev_id]){live_channels.push("sEVENT"+ps_connect_lpad_id(event.ev_id));hr_ev_pcast.channels["EVENT"+event.ev_id]=true};for(var i=0;i<markets.length;i++){_hr_ev_pcast_got_EVMKT(markets[i],hr_ev_pcast,false);if(!hr_ev_pcast.channels["EVMKT"+markets[i].ev_mkt_id]){live_channels.push("sEVMKT"+ps_connect_lpad_id(markets[i].ev_mkt_id));hr_ev_pcast.channels["EVMKT"+markets[i].ev_mkt_id]=true}};for(var i=0;i<selcns.length;i++){_hr_ev_pcast_got_SELCN(selcns[i],hr_ev_pcast,false);if(!hr_ev_pcast.channels["SELCN"+selcns[i].ev_oc_id]){live_channels.push("sSELCN"+ps_connect_lpad_id(selcns[i].ev_oc_id));hr_ev_pcast.channels["SELCN"+selcns[i].ev_oc_id]=true}};if(live_channels.length>0){var gotPushDataClosure=function(msg){return hr_ev_pcast.gotPushData(msg)};ps_connect_register("hr_ev_pcast"+event.ev_id,gotPushDataClosure,live_channels,init_msg_id)};if(!hr_ev_pcast.show_section_2)$j("#"+_hr_ev_pcast_competitors_container_prefix+"2_"+event.ev_id).remove();if(!hr_ev_pcast.show_section_3)$j("#"+_hr_ev_pcast_competitors_container_prefix+"3_"+event.ev_id).remove();if(!hr_ev_pcast.show_section_4)$j("#"+_hr_ev_pcast_competitors_container_prefix+"4_"+event.ev_id).remove()}
function hr_ev_pcast_object(){this.gotPushData=function(msg){var data={};switch(msg.subject_level){case"sPRICE":eval("data = "+msg.data+";");data.ev_oc_id=msg.subject_id;_hr_ev_pcast_got_PRICE(data,this,true);break;case"sSELCN":eval("data = "+msg.data+";");data.ev_oc_id=msg.subject_id;_hr_ev_pcast_got_SELCN(data,this,true);break;case"sMHCAP":break;case"sEVMKT":eval("data = "+msg.data+";");data.ev_mkt_id=msg.subject_id;_hr_ev_pcast_got_EVMKT(data,this,true);break;case"sEVENT":eval("data = "+msg.data+";");data.ev_id=msg.subject_id;_hr_ev_pcast_got_EVENT(data,this,true);init_powercast();break;default:};return};this.cfg={lang:"en",price_str_type:"ODDS",price_str_type_ah:"DECIMAL",price_str_type_hl:"DECIMAL",price_str_sep:"-",hl_class_decrease:"_d",hl_class_increase:"_i",hl_class_same:"",highlight_duration:4e3,bet_origin:"HR_EV_PCAST"};return}
function _hr_ev_pcast_got_EVENT(data,handler,pushed){var info=handler.event_hash[data.ev_id],is_new_item=!info,orig_bettable,orig_displayed;if(is_new_item){info=data;handler.event_hash[data.ev_id]=info;info.child_hash={}}else{orig_bettable=info.bettable;orig_displayed=info.displayed;for(var f in data)info[f]=data[f]};info.bettable=info.status=="A";info.event_type_name=info.type_names[handler.cfg.lang];var event_name=info.names[handler.cfg.lang];info.event_name=event_name.substr(5);var max=handler.cfg.event_name_trunc_threshold;if(event_name.length>max)event_name=event_name.substr(0,max)+'&hellip;';if(info.is_american==0&&info.is_virtual==0&&info.is_generic==0)event_name=event_name.replace(/^\d\d:\d\d /,'');info.img_url=handler.cfg.image_url;info.link_url=handler.cfg.link_url;var scitem_id=_hr_ev_pcast_event_prefix+info.ev_id,pscone_id=_hr_ev_pcast_container_prefix,was_visible=scone_item_exists(scitem_id),now_visible=(info.displayed=="Y");if(handler.cfg.bet_origin!="")info.bet_origin=handler.cfg.bet_origin;var html=tmpl_play("hr_ev_pcast_event",info),sort_info={};if(!was_visible&&now_visible){scone_add_item(pscone_id,scitem_id,html,sort_info,null,!pushed);var cscone_id=_hr_ev_pcast_section_rows_prefix+"2_"+info.ev_id;scone_create(cscone_id,{},null,null);var scitem_id=_hr_ev_pcast_section_head_prefix+"2_"+info.ev_id,pscone_id=cscone_id,html=tmpl_play("hr_ev_pcast_section_head_2",info);scone_add_item(pscone_id,scitem_id,html,sort_info,null,!pushed);var cscone_id=_hr_ev_pcast_section_rows_prefix+"3_"+info.ev_id;scone_create(cscone_id,{},null,null);var scitem_id=_hr_ev_pcast_section_head_prefix+"3_"+info.ev_id,pscone_id=cscone_id,html=tmpl_play("hr_ev_pcast_section_head_3",info);scone_add_item(pscone_id,scitem_id,html,sort_info,null,!pushed);var cscone_id=_hr_ev_pcast_section_rows_prefix+"4_"+info.ev_id;scone_create(cscone_id,{},null,null);var scitem_id=_hr_ev_pcast_section_head_prefix+"4_"+info.ev_id,pscone_id=cscone_id,html=tmpl_play("hr_ev_pcast_section_head_4",info);scone_add_item(pscone_id,scitem_id,html,sort_info,null,!pushed)}else if(was_visible&&now_visible){scone_replace_item(scitem_id,html,sort_info,true)}else if(was_visible&&!now_visible)scone_remove_item(scitem_id);if((orig_displayed!=info.displayed||orig_bettable!=info.bettable)&&pushed)for(var ev_mkt_id in info.child_hash)_hr_ev_pcast_got_EVMKT({ev_id:info.ev_id,ev_mkt_id:ev_mkt_id},handler,pushed)}
function _hr_ev_pcast_got_EVMKT(data,handler,pushed){var info=handler.evmkt_hash[data.ev_mkt_id],is_new_item=!info,orig_bettable,orig_displayed,orig_lp_avail;if(is_new_item){var parent_info=handler.event_hash[data.ev_id]}else var parent_info=handler.event_hash[info.ev_id];if(!parent_info)return;parent_info.child_hash[data.ev_mkt_id]=true;if(is_new_item){info=data;handler.evmkt_hash[data.ev_mkt_id]=info;info.child_hash={}}else{orig_bettable=info.bettable;orig_displayed=info.displayed;for(var f in data)info[f]=data[f]};info.bettable=(info.status=="A")&&parent_info.bettable;info.name=info.names[handler.cfg.lang];if(info.mkt_tooltips)info.mkt_tooltip=info.mkt_tooltips[handler.cfg.lang];runners_sorted_arr=info.runners_sorted.split(" ");fb_result_arr=info.fb_result.split(" ");for(var j=0;j<runners_sorted_arr.length;j++){info.curr_runners_sorted=runners_sorted_arr[j];info.curr_fb_result=fb_result_arr[j];info.curr_num_runners=info.curr_fb_result.split(",").length;var scitem_id=_hr_ev_pcast_section_row_prefix+info.ev_id+"_"+info.curr_runners_sorted,pscone_id=_hr_ev_pcast_section_rows_prefix+info.curr_num_runners+"_"+info.ev_id,was_visible=scone_item_exists(scitem_id),now_visible=(info.displayed=="Y"),html=tmpl_play("hr_ev_pcast_section_row",info),sort_info={};if(!was_visible&&now_visible){scone_add_item(pscone_id,scitem_id,html,sort_info,null,!pushed);var cscone_id=scitem_id;scone_create(cscone_id,{},null,null);seln_runners=info.curr_fb_result.split(",");var pscone_id=cscone_id,scitem_id_prefix=_hr_ev_pcast_runner_prefix+info.ev_id+"_"+info.curr_num_runners+"_"+info.curr_runners_sorted;if(info.curr_num_runners==2){handler.show_section_2=true}else if(info.curr_num_runners==3){handler.show_section_3=true}else if(info.curr_num_runners==4)handler.show_section_4=true;for(var i=0;i<seln_runners.length;i++){runner_info=handler.runner_hash[seln_runners[i]];runner_info.num_runners=info.curr_num_runners;runner_info.runners_sorted=info.curr_runners_sorted;runner_info.silk_url=handler.cfg.silk_url;runner_info.horse_name=runner_info.horse_names[handler.cfg.lang];var scitem_id=scitem_id_prefix+"_"+runner_info.runner_number,html=tmpl_play("hr_ev_pcast_runner",runner_info),sort_info={};scone_add_item(pscone_id,scitem_id,html,sort_info,null,!pushed)};handler.now_displaying_runners[info.curr_num_runners+"_"+info.curr_runners_sorted]=seln_runners.join("_");allowed_mkts=parent_info.allowed_mkt_selcns["section_"+info.curr_num_runners];allowed_mkt_sorts=allowed_mkts.split(",");for(var i=0;i<allowed_mkt_sorts.length;i++){info.allowed_mkt_sort=allowed_mkt_sorts[i];var scitem_id=_hr_ev_pcast_seln_container_prefix+info.ev_id+"_"+info.curr_num_runners+"_"+info.curr_runners_sorted+"_"+info.allowed_mkt_sort,html=tmpl_play("hr_ev_pcast_seln_container",info),sort_info={};scone_add_item(pscone_id,scitem_id,html,sort_info,null,!pushed);cscone_id=scitem_id;scone_create(cscone_id,{},null,null)}}};if((orig_displayed!=info.displayed||orig_bettable!=info.bettable||orig_lp_avail!=info.lp_avail)&&pushed)for(var ev_oc_id in info.child_hash)_hr_ev_pcast_got_SELCN({ev_oc_id:ev_oc_id,ev_mkt_id:info.ev_mkt_id},handler,pushed)}
function _hr_ev_pcast_got_SELCN(data,handler,pushed){var parent_info=handler.evmkt_hash[data.ev_mkt_id];if(!parent_info)return;parent_info.child_hash[data.ev_oc_id]=true;var info=handler.selcn_hash[data.ev_oc_id],is_new_item=!info,orig_lp_num,orig_lp_den;if(is_new_item){info=data;handler.selcn_hash[data.ev_oc_id]=info;info.init_lp_num=info.lp_num;info.init_lp_den=info.lp_den;info.mkt_sort=parent_info.mkt_sort}else{orig_lp_num=info.lp_num;orig_lp_den=info.lp_den;for(var f in data)info[f]=data[f]};info.name=info.names[handler.cfg.lang];if(handler.cfg.bet_origin!="")info.bet_origin=handler.cfg.bet_origin;info.bettable=(info.status=="A")&&parent_info.bettable;info.mkt_lp_avail=parent_info.lp_avail;info.price_str=_hr_ev_pcast_get_price_str(handler,info.lp_num,info.lp_den,parent_info.lp_avail,info.mkt_sort);var scitem_id=_hr_ev_pcast_seln_prefix+info.ev_id+"_"+info.num_runners+"_"+info.runners_sorted+"_"+info.mkt_sort,pscone_id=_hr_ev_pcast_seln_container_prefix+info.ev_id+"_"+info.num_runners+"_"+info.runners_sorted+"_"+info.mkt_sort,now_visible=(info.displayed=="Y")&&(parent_info.displayed=="Y"),parent_visible=(parent_info.displayed=="Y");info.now_visible=now_visible;var html=tmpl_play("hr_ev_pcast_seln",info),sort_info={};if(!pushed)handler.selcn_mkt_hash[info.ev_id+"_"+info.num_runners+"_"+info.runners_sorted+"_"+info.mkt_sort+"_"+info.fb_result.split(",").join("_")]=info;var was_visible=scone_item_exists(scitem_id);if(!was_visible&&now_visible){if(info.mkt_sort=="FR"||info.mkt_sort=="TC"){if(handler.now_displaying_runners[info.num_runners+"_"+info.runners_sorted]==info.fb_result.split(",").join("_"))scone_add_item(pscone_id,scitem_id,html,sort_info,null,!pushed)}else scone_add_item(pscone_id,scitem_id,html,sort_info,null,!pushed)}else if(was_visible&&now_visible){if(info.mkt_sort=="FR"||info.mkt_sort=="TC"){if(handler.now_displaying_runners[info.num_runners+"_"+info.runners_sorted]==info.fb_result.split(",").join("_"))scone_replace_item(scitem_id,html,sort_info,true)}else if(pushed)scone_replace_item(scitem_id,html,sort_info,null,!pushed)}else if(was_visible&&!now_visible)scone_remove_item(scitem_id);if(is_new_item&&now_visible&&info.bettable)_hr_ev_pcast_highlight_price_change(handler,info,orig_lp_num,orig_lp_den)}
function _hr_ev_pcast_got_PRICE(data,handler,rebuild_parents){var info=handler.selcn_hash[data.ev_oc_id];if(!info)return;var parent_info=handler.evmkt_hash[info.ev_mkt_id];if(!parent_info)return;var event_info=handler.event_hash[info.ev_id],orig_lp_num=info.lp_num,orig_lp_den=info.lp_den;for(var f in data)info[f]=data[f];if(info.mkt_sort=="FR"||info.mkt_sort=="TC")if(handler.now_displaying_runners[info.num_runners+"_"+info.runners_sorted]!=info.fb_result.split(",").join("_"))return;var sel_id=_hr_ev_pcast_seln_prefix+info.ev_id+"_"+info.num_runners+"_"+info.runners_sorted+"_"+info.mkt_sort,price_el=document.getElementById(sel_id);if(!price_el)return;var inner_price=price_el.children[0];info.price_str=_hr_ev_get_price_str(handler,info.lp_num,info.lp_den,parent_info.lp_avail,info.mkt_sort);var d=info.lp_num*orig_lp_den-info.lp_den*orig_lp_num;if(parent_info.lp_avail!="Y")return;if(info.displayed!="Y")return;inner_price.innerHTML=info.price_str;if(info.bettable)_hr_ev_pcast_highlight_price_change(handler,info,orig_lp_num,orig_lp_den);return}
function hr_ev_pcast_do_bet(ev_oc_id,ev_id,price_type,bet_origin){var handler=_hr_ev_pcast_hash[ev_id],selcn=handler.selcn_hash[ev_oc_id],evmkt=handler.evmkt_hash[selcn.ev_mkt_id],lp_num='',lp_den='';if(price_type!='S'){if(evmkt.gp_avail=='Y')price_type='G';lp_num=selcn.lp_num;lp_den=selcn.lp_den};var ew_fac_num='',ew_fac_den='',ew_places='';if(evmkt.ew_avail=='Y'){ew_fac_num=evmkt.ew_fac_num;ew_fac_den=evmkt.ew_fac_den;ew_places=evmkt.ew_places};BS_set_leg('selections',ev_oc_id);BS_set_leg('price_type',price_type);BS_set_leg('lp_num',lp_num);BS_set_leg('lp_den',lp_den);BS_set_leg('market_tags',evmkt.mkt_tags);BS_set_leg('ew_fac_num',ew_fac_num);BS_set_leg('ew_fac_den',ew_fac_den);BS_set_leg('ew_places',ew_places);if((typeof bet_origin!='undefined')&&(bet_origin!=undefined)&&(bet_origin!=""))BS_set_leg('bet_origin',bet_origin);BS_go_bet()}
function _hr_ev_pcast_get_price_str(handler,lp_num,lp_den,lp_avail,mkt_sort){if(typeof lp_avail=="undefined")lp_avail="Y";if(typeof mkt_sort=="undefined")mkt_sort="--";var price_str_type=handler.cfg.price_str_type;if(mkt_sort=="AH"&&handler.cfg.price_str_type_ah!="")price_str_type=handler.cfg.price_str_type_ah;if(mkt_sort=="HL"&&handler.cfg.price_str_type_hl!="")price_str_type=handler.cfg.price_str_type_hl;if(lp_avail=="N")return"SP";if(lp_num==""&&lp_den=="")return"-";var price_str;if(price_str_type=="DECIMAL"){var dps=(lp_den>100)?3:2,dp=1.0+(lp_num/lp_den),scaled_dp=""+Math.round(dp*Math.pow(10,dps)-0.5),int_part=scaled_dp.substr(0,scaled_dp.length-dps),frac_part=scaled_dp.substr(scaled_dp.length-dps);if(int_part=="")int_part="";if(frac_part=="")frac_part="";var price_str=int_part+"."+frac_part}else{if(lp_den=="")lp_den=1;if(lp_num==lp_den){price_str="evens"}else price_str=lp_num+handler.cfg.price_str_sep+lp_den};return price_str}
function _hr_ev_pcast_highlight_price_change(handler,info,old_lp_num,old_lp_den){if(isNaN(info.lp_num)||isNaN(old_lp_num))return;var d=info.lp_num*old_lp_den-info.lp_den*old_lp_num;if(d==0)return;var event_info=handler.event_hash[info.ev_id],price_id=_hr_ev_pcast_seln_prefix+info.ev_id+"_"+info.num_runners+"_"+info.runners_sorted+"_"+info.mkt_sort;_hr_ev_pcast_highlight(handler,price_id,_hr_ev_pcast_selcn_base_class,d);return}
function _hr_ev_pcast_highlight(handler,id,base_class,dir){var el=document.getElementById(id);if(!el)return;var highlight_class="";if(dir<0){highlight_class=base_class+handler.cfg.hl_class_decrease}else if(dir>0){highlight_class=base_class+handler.cfg.hl_class_increase}else highlight_class=base_class+handler.cfg.hl_class_same;var classes=el.className.split(" "),found=false;for(var i=0;i<classes.length;i++)if(classes[i]==base_class+handler.cfg.hl_class_same||classes[i]==base_class+handler.cfg.hl_class_increase||classes[i]==base_class+handler.cfg.hl_class_decrease){classes[i]=highlight_class;found=true;break};if(!found)classes.push(highlight_class);el.className=classes.join(" ");if(_hr_ev_pcast_hl_timers[id]!=null){window.clearTimeout(_hr_ev_pcast_hl_timers[id]);delete _hr_ev_pcast_hl_timers[id]};var self=this;if(dir!=0)_hr_ev_pcast_hl_timers[id]=window.setTimeout(function(){self._hr_ev_pcast_highlight(handler,id,base_class,0)},handler.cfg.highlight_duration);return}
function hr_ev_pcast_show_event(old_ev_id,new_ev_id){var handler=_hr_ev_pcast_hash[old_ev_id],url=handler.cfg.link_url+"?action=do_hr_power_cast_event_hp_AJAX&ev_id="+new_ev_id,clientdata={old_ev_id:old_ev_id};_hr_ev_pcast_make_ajax_get_request(_hr_ev_pcast_container_prefix,url,clientdata,_hr_ev_pcast_got_ajax_content)}
function _hr_ev_pcast_make_ajax_get_request(id,url,clientdata,callback){if(document.PollingAjaxHelper.checkSemaphore()){document.PollingAjaxHelper.setTimeout(id,function(){_hr_ev_pcast_make_ajax_get_request(id,url,clientdata,callback)},300);return};document.PollingAjaxHelper.aquireSemaphore();var req=null;if(window.XMLHttpRequest){req=new XMLHttpRequest()}else if(window.ActiveXObject)req=new ActiveXObject('Microsoft.XMLHTTP');if(req){req.onreadystatechange=function(){if(req.readyState!=4)return;var reqStatus;try{reqStatus=req.status}catch(e){reqStatus=''};if(reqStatus!=200){document.PollingAjaxHelper.releaseSemaphore();callback(url,clientdata,false,'HTTP')}else{document.PollingAjaxHelper.releaseSemaphore();callback(url,clientdata,true,req.responseText)}};try{req.open('GET',url,true);req.send(null)}catch(e){document.PollingAjaxHelper.releaseSemaphore();callback(url,clientdata,false,'UNSUPPORTED')}}else{document.PollingAjaxHelper.releaseSemaphore();callback(url,clientdata,false,'UNSUPPORTED')}}
function _hr_ev_pcast_got_ajax_content(url,clientdata,ok,response){if(ok){if(response=="")return;scone_remove_item(_hr_ev_pcast_event_prefix+clientdata.old_ev_id);global_eval(response);init_powercast();$j('.item a.close').click(function(){if($j(this).hasClass('on')){$j(this).attr('class','close off');$j(this).parents('.item').find('.cnt').hide()}else{$j(this).attr('class','close on');$j(this).parents('.item').find('.cnt').show()}});tooltip_init()}}
function hr_ev_pcast_open_form_site(ev_id){var handler=_hr_ev_pcast_hash[ev_id],event=handler.event_hash[ev_id];window.open(event.form_site_url,'Form_Site_Predictor')}
function _hr_ev_pcast_store_templates(){var tmp=[];tmp.push('<div class="meeting powercast" id="hr_ev_pcast_event_<%ev_id%>">\n');tmp.push('	<div class="item">\n');tmp.push('		<div class="hdr">\n');tmp.push('			<a class="close on" href="javascript:void(0)" id="btn_hdr_expand_<%ev_id%>" onclick="">Close</a>\n');tmp.push('			<h2><%XL _hr_ev_pcast_top_header%><span class="normal"></span></h2>\n');tmp.push('		</div>\n');tmp.push('	<%IF is_hr_homepage == "Y"%>');tmp.push('		<div class="cnt">\n');tmp.push('			<div class="race-infos">\n');tmp.push('				<h2>\n');tmp.push('					<div class="race-venue"><%IF ev_type_id != -1%><a href="<%url%>"><%END%><%event_type_name%><%IF ev_type_id != -1%></a><%END%><span class="tooltip"><%event_type_name%></span></div>\n');tmp.push('					<div class="prevnext">\n');tmp.push('						<div class="prev"><%IF pcast_ev_id_before!=""%><a href="#" onclick="javascript:hr_ev_pcast_show_event(\'<%ev_id%>\',\'<%pcast_ev_id_before%>\');return false;"></a><span class="tooltip"><%XL _hr_ev_pcast_view%> <%pcast_ev_id_before_desc%></span><%END%></div>\n');tmp.push('						<div class="time"><%ev_start_time%></div>\n');tmp.push('						<div class="next"><%IF pcast_ev_id_after!=""%><a href="#" onclick="javascript:hr_ev_pcast_show_event(\'<%ev_id%>\',\'<%pcast_ev_id_after%>\');return false;"></a><span class="tooltip"><%XL _hr_ev_pcast_view%> <%pcast_ev_id_after_desc%></span><%END%></div>\n');tmp.push('					</div>\n');tmp.push('					<div class="race-type-distance"><%event_name%><span class="tooltip"><%event_name%></span></div>\n');tmp.push('				</h2>\n');tmp.push('		<%IF has_rp == 1%>');tmp.push('			<%IF form_site_enabled == 1 && form_site_url != ""%>');tmp.push('				<div id="pcast_predictor_<%ev_id%>" class="form-site-predictor"><ul class="btns rpredictor"><li class="green">');tmp.push('				<a href="javascript:hr_ev_pcast_open_form_site(\'<%ev_id%>\')"><span></span><%XL _hr_ev_pcast_race_form%></a>');tmp.push('				</li></ul></div>\n');tmp.push('			<%ELSE IF rp_predictor_url != ""%>');tmp.push('				<div id="pcast_predictor_<%ev_id%>" class="form-site-predictor"><ul class="btns rpredictor"><li class="green">');tmp.push('				<a href="javascript:hr_ev_set_predictor(\'<%ev_id%>\')"><span></span><%XL _hr_ev_pcast_race_predictor%></a>');tmp.push('				</li></ul></div>\n');tmp.push('			<%END%>');tmp.push('		<%END%>');tmp.push('				<div class="clear"></div>\n');tmp.push('			</div>\n');tmp.push('		</div>\n');tmp.push('	<%END%>');tmp.push('		<div class="powercast-sub-container" id="hr_ev_pcast_competitors_container_2_<%ev_id%>">\n');tmp.push('			<div class="powercast-sub-heading open"><span></span><%XL _hr_ev_pcast_drag%><span class="tooltip"><%XL _hr_ev_pcast_drag_tt%></span></div>\n');tmp.push('			<div class="powercast-sub-content">\n');tmp.push('				<div class="powercast-table two-competitor" id="hr_ev_pcast_section_rows_2_<%ev_id%>">\n');tmp.push('				</div>\n');tmp.push('			</div>\n');tmp.push('		</div>\n');tmp.push('		<div class="powercast-sub-container" id="hr_ev_pcast_competitors_container_3_<%ev_id%>">\n');tmp.push('			<div class="powercast-sub-heading open"><span></span><%XL _hr_ev_pcast_drag%><span class="tooltip"><%XL _hr_ev_pcast_drag_tt%></span></div>\n');tmp.push('			<div class="powercast-sub-content">\n');tmp.push('				<div class="powercast-table three-competitor" id="hr_ev_pcast_section_rows_3_<%ev_id%>">\n');tmp.push('				</div>\n');tmp.push('			</div>\n');tmp.push('		</div>\n');tmp.push('		<div class="powercast-sub-container" id="hr_ev_pcast_competitors_container_4_<%ev_id%>">\n');tmp.push('			<div class="powercast-sub-heading open"><span></span><%XL _hr_ev_pcast_no_drag%><span class="tooltip"><%XL _hr_ev_pcast_no_drag_tt%></span></div>\n');tmp.push('			<div class="powercast-sub-content">\n');tmp.push('				<div class="powercast-table four-competitor" id="hr_ev_pcast_section_rows_4_<%ev_id%>">\n');tmp.push('				</div>\n');tmp.push('			</div>\n');tmp.push('		</div>\n');tmp.push('		<div class="footer">\n');tmp.push('			<div class="left betting-terms"><a href="#" onclick="javascript:help_url(\'kb\', \'terms\');return false;" target="_top" rel="nofollow">Powercast Betting Terms</a></div>\n');tmp.push('			<div class="right price-movement-guide"><p><strong><%XL _hr_ev_pcast_price_movement%></strong><span class="shortening"><%XL _hr_ev_pcast_shortening%></span><span class="drifting"><%XL _hr_ev_pcast_drifting%></span></p></div>\n');tmp.push('		</div>\n');tmp.push('	</div>\n');tmp.push('</div>\n');tmpl_store("hr_ev_pcast_event",tmp.join(""));var tmp=[];tmp.push('					<ul class="heading" id="hr_ev_pcast_section_head_2_<%ev_id%>">\n');tmp.push('						<li><%XL _hr_ev_pcast_1st%></li>\n');tmp.push('						<li><%XL _hr_ev_pcast_2nd%></li>\n');tmp.push('						<li class="odds-data"><%XL _hr_ev_pcast_forecast%></li>\n');tmp.push('						<li class="odds-data"><%XL _hr_ev_pcast_each_way_forecast%></li>\n');tmp.push('					</ul>\n');tmpl_store("hr_ev_pcast_section_head_2",tmp.join(""));var tmp=[];tmp.push('					<ul class="heading" id="hr_ev_pcast_section_head_3_<%ev_id%>">\n');tmp.push('						<li><%XL _hr_ev_pcast_1st%></li>\n');tmp.push('						<li><%XL _hr_ev_pcast_2nd%></li>\n');tmp.push('						<li><%XL _hr_ev_pcast_3rd%></li>\n');tmp.push('						<li class="odds-data"><%XL _hr_ev_pcast_any_order_forecast%></li>\n');tmp.push('						<li class="odds-data"><%XL _hr_ev_pcast_tricast%></li>\n');tmp.push('						<li class="odds-data"><%XL _hr_ev_pcast_any_order_tricast%></li>\n');tmp.push('					</ul>\n');tmpl_store("hr_ev_pcast_section_head_3",tmp.join(""));var tmp=[];tmp.push('					<ul class="heading" id="hr_ev_pcast_section_head_4_<%ev_id%>">\n');tmp.push('						<li><%XL _hr_ev_pcast_1st%></li>\n');tmp.push('						<li><%XL _hr_ev_pcast_2nd%></li>\n');tmp.push('						<li><%XL _hr_ev_pcast_3rd%></li>\n');tmp.push('						<li><%XL _hr_ev_pcast_4th%></li>\n');tmp.push('						<li class="odds-data"><%XL _hr_ev_pcast_any_order_forecast%></li>\n');tmp.push('						<li class="odds-data"><%XL _hr_ev_pcast_any_order_tricast%></li>\n');tmp.push('					</ul>\n');tmpl_store("hr_ev_pcast_section_head_4",tmp.join(""));var tmp=[];tmp.push('					<ul id="hr_ev_pcast_section_row_<%ev_id%>_<%curr_runners_sorted%>">\n');tmp.push('					</ul>\n');tmpl_store("hr_ev_pcast_section_row",tmp.join(""));var tmp=[];tmp.push('						<li class="selection-data" id="hr_ev_pcast_runner_<%ev_id%>_<%num_runners%>_<%runners_sorted%>_<%runner_number%>">\n');tmp.push('							<div class="horse-jockey-info">\n');tmp.push('								<div class="silk">\n');tmp.push('									<div class="colours">\n');tmp.push('										<img src="<%silk_url%>/<%pa_feed_silks_file%>">\n');tmp.push('									</div>\n');tmp.push('									<div class="stall-number">\n');tmp.push('										<small><%IF pa_feed_stall != ""%>(<%pa_feed_stall%>)<%END%></small>\n');tmp.push('										<span class="tooltip"><%XL _hr_ev_pcast_stall_tt%></span>\n');tmp.push('									</div>\n');tmp.push('								</div>\n');tmp.push('								<div class="runner-info">\n');tmp.push('									<span><%runner_number%></span>&nbsp;<%IF ext_competitor_id !=""%><a href="javascript:void(0)" onclick="window.open(\'http://www.racingpost.com/horses/horse_home.sd?horse_id=<%ext_competitor_id%>&amp;affid=PaddyPower\', \'RacingPost\', \'scrollbars=1,width=700,height=700\');"><%END%><%horse_name%><%IF ext_competitor_id !=""%><span class="tooltip"><%XL _hr_ev_pcast_history_tt%></span></a><%END%>\n');tmp.push('								</div>\n');tmp.push('							</div>\n');tmp.push('						</li>\n');tmpl_store("hr_ev_pcast_runner",tmp.join(""));var tmp=[];tmp.push('						<li class="odds-data" id="hr_ev_pcast_seln_container_<%ev_id%>_<%curr_num_runners%>_<%curr_runners_sorted%>_<%allowed_mkt_sort%>">\n');tmp.push('						</li>\n');tmpl_store("hr_ev_pcast_seln_container",tmp.join(""));var tmp=[];tmp.push('				<%IF mkt_lp_avail == "Y"%><div class="odd <%IF !bettable%> suspended<%END%>" id="hr_ev_pcast_seln_<%ev_id%>_<%num_runners%>_<%runners_sorted%>_<%mkt_sort%>"><a href="javascript:void(0)" <%IF bettable%>onclick="hr_ev_pcast_do_bet(\'<%ev_oc_id%>\',\'<%ev_id%>\',\'L\',\'<%bet_origin%>\')"<%END%>><%price_str%></a></div><%END%>\n');tmpl_store("hr_ev_pcast_seln",tmp.join(""))}
function _hr_ev_single_view_store_templates(){var tmp=[];tmp.push('	<%IF is_simple ==1%>\n');tmp.push('		<div class="<%IF is_simple ==1%>specials-adv<%ELSE%>future-adv<%END%>" id="hr_ev_event_<%ev_id%>">\n');tmp.push('		<%IF is_list==0%>\n');tmp.push('				<div class="item">\n');tmp.push('	<%END%>\n');tmp.push('			<div class="t-hdr">\n');tmp.push('				<h2><%name%></h2>\n');tmp.push('				<p class="caption left">\n');tmp.push('					<span class="grey"><%start_date%> @ <%ev_start_time%></span><br />\n');tmp.push('				</p>\n');tmp.push('				<div class="back"><a href="<%cgi_racing_url%><%IF is_generic==1 %><%generic_url%><%END%>"><%IF is_generic==1 %><%XL _hr_ev_back_to_class_page%><%END%></a></div>\n');tmp.push('				<div class="clear"></div>\n');tmp.push('			</div>\n');tmp.push('			<div class="cnt">\n');tmp.push('	<%ELSE%>\n');tmp.push('		<%IF is_list==0%>\n');tmp.push('			<div class="meeting" id="hr_ev_event_<%ev_id%>">\n');tmp.push('				<div class="title">\n');tmp.push('					<h1 class="left"><%type_name%></h1><div class="clear"></div>\n');tmp.push('				</div>\n');tmp.push('				<div class="item">\n');tmp.push('		<%END%>\n');tmp.push('				<div class="cnt" <%IF is_list==1%> id="hr_ev_event_<%ev_id%>"<%END%>>\n');tmp.push('					<div class="race-infos">\n');tmp.push('						<h2>\n');tmp.push('						<%IF is_list==0%>\n');tmp.push('							<div class="prevnext">\n');tmp.push('								<div class="prev"><%IF before_ev_url!=""%><a href="<%before_ev_url%>"></a><span class="tooltip"><%XL _hr_ev_view%> <%before_ev_desc%></span><%END%></div>\n');tmp.push('								<div class="time"><%ev_start_time%></div>\n');tmp.push('								<div class="next"><%IF after_ev_url!=""%><a href="<%after_ev_url%>"></a><span class="tooltip"><%XL _hr_ev_view%> <%after_ev_desc%></span><%END%></div>\n');tmp.push('							</div>\n');tmp.push('							- <%END%><%name%>\n');tmp.push('						</h2>\n');tmp.push('						<%IF bids_status_text!=""%><h3><%XL _hr_ev_race_status%> <span class="red">- <%bids_status_text%></span></h3><%END%>\n');tmp.push('						<%IF station_num > 0%><h4><%XL _hr_ev_live_on%>\n');tmp.push('						<%LOOP hr_ev_idx station_num%><img src="<%img_url%>/<%stations[hr_ev_idx].station_image%>" alt="<%stations[hr_ev_idx].name%>"><%END%>\n');tmp.push('						</h4><%END%><div class="clear"></div>\n');tmp.push('					</div>\n');tmp.push('					<%IF ev_special_blurb != ""%><div class="mbs"><%ev_special_blurb%></div><%END%>\n');tmp.push('					<%IF ev_class_blurb != ""%><div class="mbs"><%ev_class_blurb%></div><%END%>\n');tmp.push('					<%IF ev_mkt_descs != ""%><div class="mbs"><%ev_mkt_descs%></div><%END%>\n');tmp.push('					<div>\n');tmp.push('						<div class="filter">\n');tmp.push('							<ul class="tabs left">\n');tmp.push('								<li id="button_qv_<%ev_id%>" class="default-tab <%IF open_tab == "qv"%>active <%END%>"><div><a href="javascript:void(0)" onclick="hr_ev_change_tab(\'qv\',\'<%ev_id%>\')" rel="qv_<%ev_id%>"><%XL _hr_ev_racecard_only%><span class="tooltip"><%XL _hr_ev_quick_view_tt%></span></a></div></li>\n');tmp.push('								<%IF has_tcast == "Y" || has_fcast == "Y"%><li id="button_ftc_<%ev_id%>" class="<%IF open_tab == "ftc"%>active <%END%> fore-tri-cast"><div><a href="javascript:void(0)" onclick="hr_ev_change_tab(\'ftc\',\'<%ev_id%>\')" rel="ftc_<%ev_id%>"><%XL _hr_ev_tricast%><span class="tooltip"><%XL _hr_ev_tricast_tt%></span></a></div></li><%END%>\n');tmp.push('							</ul>\n');tmp.push('							<ul class="tabs right">\n');tmp.push('								<%IF has_cb_avail=="Y"%><li id="button_cb_<%ev_id%>" class="<%IF open_tab == "comb_bets"%>active <%END%>"><div><a href="javascript:void(0)" onclick="hr_ev_change_tab(\'comb_bets\',\'<%ev_id%>\')" rel="cb_<%ev_id%>"><%XL _hr_ev_combined_bets%><%IF open_tab != "comb_bets"%><span class="tooltip"><%XL _hr_ev_combined_bets_tt%></span><%END%></a></div></li><%END%>\n');tmp.push('							</ul>\n');tmp.push('							<div class="clear"></div>\n');tmp.push('						</div>\n');tmp.push('					<%END%>\n');tmp.push('					<div class="<%IF is_simple ==0%>tab-content<%END%>" id="qv_<%ev_id%>" <%IF open_tab != "qv"%>style="display: none" <%END%>>\n');tmp.push('						<div class="<%IF is_simple ==1%>all-mkt vr-us<%ELSE%>all-mkt vr-us<%END%>">\n');tmp.push('							<div class="wrapper-th">\n');tmp.push('								<div class="hj">\n');tmp.push('									<div class="left"><%XL _hr_ev_horse_jockey_title%></div>\n');tmp.push('									<div class="right">\n');tmp.push('										<%IF is_simple == 1%><div class="po"><%XL _hr_ev_prev_odds_title%></div><%END%>\n');tmp.push('										<div class="<%IF is_simple == 1 || is_american == 1%>wew<%ELSE%>po<%END%>" <%IF is_simple == 1  || is_american == 1%>id="hr_ev_win_head_cont_<%ev_id%>"<%ELSE%>id="hr_ev_pf_head_cont_<%ev_id%>"<%END%>></div>\n');tmp.push('										<div class="<%IF is_simple == 1 || is_american == 1%>pf<%ELSE%>wew<%END%>" <%IF is_simple == 1 || is_american == 1%>id="hr_ev_pf_head_cont_<%ev_id%>"<%ELSE%>id="hr_ev_win_head_cont_<%ev_id%>"<%END%>></div>\n');tmp.push('									</div>\n');tmp.push('									<div class="clear"></div>\n');tmp.push('								</div>\n');tmp.push('							</div>\n');tmp.push('							<div class="wrapper" id="hr_ev_runners_<%ev_id%>"></div>\n');tmp.push('						</div>\n');tmp.push('						<div class="tools legend">\n');tmp.push('							<ul class="left"><li><div id="hr_ev_event_footer_<%ev_id%>"></div></li></ul>\n');tmp.push('							<ul class="right">\n');tmp.push('								<li><strong><%XL _hr_ev_price_movement%></strong> </li>\n');tmp.push('								<li><div class="shortering"><%XL _hr_ev_odds_shortening%></div><div class="left">&nbsp;<%XL _hr_ev_odds_shortening%></div></li>\n');tmp.push('								<li><div class="drifting"><%XL _hr_ev_odds_drifting%></div><div class="left">&nbsp;<%XL _hr_ev_odds_drifting%></div></li>\n');tmp.push('							</ul>\n');tmp.push('						</div>\n');tmp.push('					</div>\n');tmp.push('					<div class="<%IF is_simple ==0%>tab-content<%END%>" id="ftc_<%ev_id%>" <%IF open_tab != "ftc"%>style="display: none"<%END%>>\n');tmp.push('						<table summary="<%XL _hr_ev_tricast%>" class="race fc">\n');tmp.push('							<thead id="hr_ev_win_head_cont_ftc_<%ev_id%>"></thead>\n');tmp.push('							<tbody id="hr_ev_runners_ftc_<%ev_id%>"></tbody>\n');tmp.push('						</table>\n');tmp.push('						<div class="tools">\n');tmp.push('							<ul class="btns right">\n');tmp.push('								<li class="green"><a href="javascript:void(0)" onclick="hr_ev_do_foretricasts_reset(\'<%ev_id%>\')" class=""><%XL _hr_ev_reset_foretricast%></a></li>\n');tmp.push('								<li class="green"><a href="javascript:void(0)" onclick="hr_ev_place_fore_tricast(\'<%ev_id%>\');hr_ev_do_foretricasts_reset(\'<%ev_id%>\')" class=""><%XL _hr_ev_place_foretricast%></a></li>\n');tmp.push('							</ul>\n');tmp.push('						</div>\n');tmp.push('					</div>\n');tmp.push('					</div>\n');tmp.push('				</div>\n');tmp.push('	<%IF is_list==0%>\n');tmp.push('			</div>\n');tmp.push('		<%IF is_simple ==0%></div><%END%>\n');tmp.push('	<%END%>\n');tmp.push('	<%IF is_simple ==1%></div>\n');tmp.push('	<%END%>\n');tmpl_store("hr_ev_event",tmp.join(""));var tmp=[];tmp.push('	<div class="hj" id="hr_ev_runner_<%ev_id%>_<%runner_id%>" <%IF hide%>style="display: none"<%END%>>\n');tmp.push('		<div class="h_info left">\n');tmp.push('			<div class="infos left">\n');tmp.push('				<h4 class="left"><%runner_number%>&nbsp;<%horse_name%></h4>\n');tmp.push('				<div class="clear"></div>\n');tmp.push('				<div><%jockey_name%></div>\n');tmp.push('			</div>\n');tmp.push('		</div>\n');tmp.push('		<div class="right">\n');tmp.push('			<%IF is_simple == 1%>\n');tmp.push('			<div class="po"><%IF lp_avail == "Y"%><%prev_odds_string%><div class="<%prev_odds_class%>"><%prev_odds_class%></div><%END%></div>\n');tmp.push('			<%END%>\n');tmp.push('			<div class="<%IF is_simple == 1 || is_american == 1%>wew<%ELSE%>po<%END%>" <%IF is_simple == 1 || is_american == 1%>id="hr_ev_evmkts_win_<%ev_id%>_<%runner_id%>"<%ELSE%>id="hr_ev_evmkts_pf_<%ev_id%>_<%runner_id%>"<%END%>></div>\n');tmp.push('			<div class="<%IF is_simple == 1 || is_american == 1%>pf<%ELSE%>wew<%END%>" <%IF is_simple == 1 || is_american == 1%>id="hr_ev_evmkts_pf_<%ev_id%>_<%runner_id%>"<%ELSE%>id="hr_ev_evmkts_win_<%ev_id%>_<%runner_id%>"<%END%>></div>\n');tmp.push('		<div class="clear"></div></div>\n');tmp.push('		<div class="clear"></div>\n');tmp.push('	</div>\n');tmpl_store("hr_ev_runner",tmp.join(""));var tmp=[];tmp.push('	<div class="fav" id="hr_ev_runner_<%ev_id%>_<%runner_id%>" <%IF hide%>style="display: none"<%END%>>\n');tmp.push('		<div class="h_info left">\n');tmp.push('			<div class="infos left">\n');tmp.push('				<h4 class="left"><%horse_name%></h4>\n');tmp.push('			</div>\n');tmp.push('		</div>\n');tmp.push('		<div class="right">\n');tmp.push('			<div class="<%IF is_simple == 1 || is_american == 1%>wew<%ELSE%>po<%END%>" <%IF is_simple == 1 || is_american == 1%>id="hr_ev_evmkts_win_<%ev_id%>_<%runner_id%>"<%ELSE%>id="hr_ev_evmkts_pf_<%ev_id%>_<%runner_id%>"<%END%>></div>\n');tmp.push('			<div class="<%IF is_simple == 1 || is_american == 1%>pf<%ELSE%>wew<%END%>" <%IF is_simple == 1 || is_american == 1%>id="hr_ev_evmkts_pf_<%ev_id%>_<%runner_id%>"<%ELSE%>id="hr_ev_evmkts_win_<%ev_id%>_<%runner_id%>"<%END%>></div>\n');tmp.push('		<div class="clear"></div></div>\n');tmp.push('		<div class="clear"></div>\n');tmp.push('	</div>\n');tmpl_store("hr_ev_runner_fav",tmp.join(""));var tmp=[];tmp.push('	<div id="hr_ev_evmkt_head_<%ev_id%>_<%ev_mkt_id%>"><%name%></div>\n');tmpl_store("hr_ev_mkt_header_win",tmp.join(""));var tmp=[];tmp.push('	<div <%IF is_simple == 1%>class="odd"<%END%> id="hr_ev_evmkt_head_<%ev_id%>_<%ev_mkt_id%>"><%IF is_simple == 1%><small class="normal"><%END%><%name%><%IF is_simple == 1%></small><%END%></div>\n');tmpl_store("hr_ev_mkt_header",tmp.join(""));var tmp=[];tmp.push('	<div id="hr_ev_evmkt_<%ev_id%>_<%runner_id%>_<%ev_mkt_id%>"><div id="hr_ev_selcns_<%ev_id%>_<%runner_id%>_<%ev_mkt_id%>"></div></div>\n');tmpl_store("hr_ev_mkt",tmp.join(""));var tmp=[];tmp.push('	<div id="hr_ev_selcn_<%ev_id%>_<%link_key%>_<%ev_mkt_id%>_<%ev_oc_id%>" class="">\n');tmp.push('		<%IF fb_result == "N"%>\n');tmp.push('			<div class="nr"><%XL _hr_ev_non_runner%></div>\n');tmp.push('		<%ELSE IF fb_result == "1" || fb_result == "2"%>\n');tmp.push('			<%IF mkt_sp_avail == "Y"%><div class="sp-med"><%IF bettable%><a href="javascript:void(0)" onclick="hr_ev_do_racecard_bet(\'<%ev_oc_id%>\',\'<%ev_id%>\',\'S\',\'<%bet_origin%>\')">SP</a><%END%></div><%END%>\n');tmp.push('		<%ELSE%>\n');tmp.push('			<%IF bettable%>\n');tmp.push('				<%IF mkt_lp_avail == "Y"%><div class="odd <%IF !bettable%> suspended<%END%>"><%IF bettable%><a id="hr_ev_selcn_price_<%ev_id%>_<%link_key%>_<%ev_mkt_id%>_<%ev_oc_id%>" href="javascript:void(0)" onclick="hr_ev_do_racecard_bet(\'<%ev_oc_id%>\',\'<%ev_id%>\',\'L\',\'<%bet_origin%>\')"><%price_str%></a><%END%></div><%END%>\n');tmp.push('				<%IF mkt_sp_avail == "Y"%><div class="sp<%IF mkt_lp_avail != "Y"%>-med<%END%> <%IF !bettable%> suspended<%END%>"><%IF bettable%><a href="javascript:void(0)" onclick="hr_ev_do_racecard_bet(\'<%ev_oc_id%>\',\'<%ev_id%>\',\'S\',\'<%bet_origin%>\')">SP</a><%END%></div><%END%>\n');tmp.push('			<%ELSE%>\n');tmp.push('				<%IF mkt_lp_avail == "Y"%><div class="odd <%IF !bettable%> suspended<%END%>"><%IF !bettable%><a href="javascript:void(0)" id="hr_ev_selcn_price_<%ev_id%>_<%link_key%>_<%ev_mkt_id%>_<%ev_oc_id%>" ><%price_str%></a><%END%></div><%END%>\n');tmp.push('				<%IF mkt_sp_avail == "Y"%><a href="javascript:void(0)" class="sp<%IF mkt_lp_avail != "Y"%>-med<%END%> <%IF !bettable%> suspended<%END%>"><%IF !bettable%>SP<%END%></a><%END%>\n');tmp.push('			<%END%><div class="clear"></div>\n');tmp.push('		<%END%>\n');tmp.push('	</div>\n');tmpl_store("hr_ev_selcn",tmp.join(""))}
function _hr_ev_single_view_store_ftc_templates(){var tmp=[];tmp.push('	<tr id="hr_ev_runner_ftc_<%ev_id%>_<%runner_id%>" <%IF hide%>style="display: none"<%END%>>\n');tmp.push('		<td>\n');tmp.push('			<div class="h_info left">\n');tmp.push('				<div class="silk left"><%IF pa_feed_stall!=""%><span class="tooltip"><%XL _hr_ev_stall_tt%></span><%END%><div class="s-color"><img src="<%silk_url%>/<%pa_feed_silks_file%>" /></div><%IF pa_feed_stall!=""%><div class="number"><strong><%XL _hr_ev_stall%></strong><small>(<%pa_feed_stall%>)</small></div><%END%></div>\n');tmp.push('				<div class="infos left">\n');tmp.push('					<h4 class="left"><%runner_number%>&nbsp;<%horse_name%></h4>\n');tmp.push('					<div class="clear"></div>\n');tmp.push('					<div><%jockey_name%></div>\n');tmp.push('					<%IF has_rp%><%IF form_num>0%><a onclick="_hr_ev_form_toggle(\'hr_ev_runner_form_ftc_<%ev_id%>_<%runner_id%>\')" href="javascript:void(0)"><%XL _hr_ev_form%></a><%END%><%END%><%IF (!has_rp || form_num==0) && pa_feed_form_figures != ""%><%XL _hr_ev_form%><%END%> <%pa_feed_form_figures%> <%IF has_form%><%IF fr_overview!=""%><a onclick="_hr_ev_form_toggle(\'hr_ev_runner_spotlight_ftc_<%ev_id%>_<%runner_id%>\')" href="javascript:void(0)"><%XL _hr_ev_spotlight%> </a><%END%><%END%>\n');tmp.push('				</div>\n');tmp.push('			</div>\n');tmp.push('			<div class="wew right">\n');tmp.push('				<div id="hr_ev_evmkts_win_ftc_<%ev_id%>_<%runner_id%>"></div>\n');tmp.push('				<div class="clear"></div>\n');tmp.push('			</div>\n');tmp.push('			<div class="clear"></div>\n');tmp.push('			<%IF has_rp%><%IF fr_overview != ""%>\n');tmp.push('				<div id="hr_ev_runner_spotlight_ftc_<%ev_id%>_<%runner_id%>" style="display: none">\n');tmp.push('					<div class="spotlight">\n');tmp.push('						<p><span class="rp-logo"><%XL _hr_ev_racing_post%></span> <strong><%XL _hr_ev_spotlight%> </strong><%fr_overview%></p><br />\n');tmp.push('						<div class="right"><a href="javascript:void(0)" onclick="_hr_ev_form_toggle(\'hr_ev_runner_spotlight_ftc_<%ev_id%>_<%runner_id%>\')" class="close-me"><span class="normal">Close</span></a></div>\n');tmp.push('						<div class="clear"></div>\n');tmp.push('					</div>\n');tmp.push('				</div>\n');tmp.push('			<%END%><%END%>\n');tmp.push('			<%IF has_rp%><div id="hr_ev_runner_form_ftc_<%ev_id%>_<%runner_id%>" style="display: none">\n');tmp.push('				<table class="stats"  summary="">\n');tmp.push('					<tr><th class="date"><%XL _hr_ev_rp_date%></th><th class="rc"><%XL _hr_ev_rp_conditions%></th><th class="w"><%XL _hr_ev_rp_weight%></th>\n');tmp.push('					<th class="ro"><%XL _hr_ev_rp_outcome%></th><th class="j"><%XL _hr_ev_rp_jockey%></th><th class="or"><%XL _hr_ev_rp_or%></th><th class="ts"><%XL _hr_ev_rp_ts%></th>\n');tmp.push('					<th class="rpr"><%XL _hr_ev_rp_rpr%></th></tr>\n');tmp.push('					<%LOOP hr_ev_form_idx form_num%>\n');tmp.push('					<tr>\n');tmp.push('						<th class="date"><%fr_race_form[hr_ev_form_idx].date%></th>\n');tmp.push('						<td class="rc"><%fr_race_form[hr_ev_form_idx].conditions%></td>\n');tmp.push('						<td class="w"><%fr_race_form[hr_ev_form_idx].weight_text%></td>\n');tmp.push('						<td class="ro"><%fr_race_form[hr_ev_form_idx].race_outcome%></td>\n');tmp.push('						<td class="j"><%fr_race_form[hr_ev_form_idx].jockey%></td>\n');tmp.push('						<td class="or"><%fr_race_form[hr_ev_form_idx].official_rating%></td>\n');tmp.push('						<td class="ts"><%fr_race_form[hr_ev_form_idx].topspeed%></td>\n');tmp.push('						<td class="rpr"><%fr_race_form[hr_ev_form_idx].rpr%></td>\n');tmp.push('					</tr>\n');tmp.push('					<%END%>\n');tmp.push('				</table>\n');tmp.push('				<div class="right"><a href="javascript:void(0)" onclick="_hr_ev_form_toggle(\'hr_ev_runner_form_ftc_<%ev_id%>_<%runner_id%>\')" class="close-me"><span class="normal">Close</span></a></div>\n');tmp.push('			<div class="clear"></div></div><%END%>\n');tmp.push('		</td>\n');tmp.push('	</tr>\n');tmpl_store("hr_ev_runner_ftc",tmp.join(""));var tmp=[];tmp.push('	<tr id="hr_ev_evmkt_head_ftc_<%ev_id%>_<%ev_mkt_id%>">\n');tmp.push('		<th>\n');tmp.push('			<div class="h_info left"><%XL _hr_ev_horse_jockey%></div>\n');tmp.push('			<div class="h_odds"><%XL _hr_ev_odds%></div>\n');tmp.push('			<div class="h_fc"><%XL _hr_ev_fcast%><br />\n');tmp.push('				<div class="elt"><small class="normal"><%XL _hr_ev_first%></small></div>\n');tmp.push('				<div class="elt"><small class="normal"><%XL _hr_ev_second%></small></div>\n');tmp.push('				<div class="elt ao"><small class="normal"><%XL _hr_ev_any%></small></div>\n');tmp.push('				<div class="clear"></div>\n');tmp.push('			</div>\n');tmp.push('			<div class="h_tc"><%XL _hr_ev_tcast%><br />\n');tmp.push('				<div class="elt"><small class="normal"><%XL _hr_ev_first%></small></div>\n');tmp.push('				<div class="elt"><small class="normal"><%XL _hr_ev_second%></small></div>\n');tmp.push('				<div class="elt"><small class="normal"><%XL _hr_ev_third%></small></div>\n');tmp.push('				<div class="elt ao"><small class="normal"><%XL _hr_ev_any%></small></div>\n');tmp.push('				<div class="clear"></div>\n');tmp.push('			</div>\n');tmp.push('		</th>\n');tmp.push('	</tr>\n');tmpl_store("hr_ev_mkt_header_win_ftc",tmp.join(""));var tmp=[];tmp.push('	<div id="hr_ev_evmkt_ftc_<%ev_id%>_<%runner_id%>_<%ev_mkt_id%>"><div id="hr_ev_selcns_ftc_<%ev_id%>_<%runner_id%>_<%ev_mkt_id%>"></div></div>\n');tmpl_store("hr_ev_mkt_ftc",tmp.join(""));var tmp=[];tmp.push('	<div id="hr_ev_selcn_ftc_<%ev_id%>_<%link_key%>_<%ev_mkt_id%>_<%ev_oc_id%>" class="">\n');tmp.push('		<div id="hr_ev_selcn_price_ftc_<%ev_id%>_<%link_key%>_<%ev_mkt_id%>_<%ev_oc_id%>" class="h_odds left"><%price_str%></div>\n');tmp.push('		<%IF fb_result == "N"%>\n');tmp.push('			<div class="nr"><%XL _hr_ev_non_runner%></div>\n');tmp.push('		<%ELSE IF fb_result == "1" || fb_result == "2"%>\n');tmp.push('			<div class="nr"><%XL _hr_ev_un_fav%></div>\n');tmp.push('		<%ELSE%>\n');tmp.push('			<%IF bettable%>\n');tmp.push('				<%IF mkt_fc_avail == "Y"%><div class="h_fc">\n');tmp.push('					<div class="elt"><input id="tfcastf_<%ev_id%>_<%link_key%>_1" type="checkbox" onclick="hr_ev_checkLimits(\'f\',\'<%link_key%>\',\'1\',\'<%ev_id%>\')" name="fc" value="<%link_key%>"/></div>\n');tmp.push('					<div class="elt"><input id="tfcastf_<%ev_id%>_<%link_key%>_2" type="checkbox" onclick="hr_ev_checkLimits(\'f\',\'<%link_key%>\',\'2\',\'<%ev_id%>\')" name="fc" value="<%link_key%>"/></div>\n');tmp.push('					<div class="elt ao"><input id="tfcastf_<%ev_id%>_<%link_key%>_A" type="checkbox" onclick="hr_ev_checkLimits(\'f\',\'<%link_key%>\',\'A\',\'<%ev_id%>\')" name="fc" value="<%link_key%>"/></div>\n');tmp.push('					<div class="clear"></div>\n');tmp.push('				</div><%END%>\n');tmp.push('				<%IF mkt_tc_avail == "Y"%><div class="h_tc">\n');tmp.push('					<div class="elt"><input id="tfcastt_<%ev_id%>_<%link_key%>_1" type="checkbox" onclick="hr_ev_checkLimits(\'t\',\'<%link_key%>\',\'1\',\'<%ev_id%>\')" name="fc" value="<%link_key%>"/></div>\n');tmp.push('					<div class="elt"><input id="tfcastt_<%ev_id%>_<%link_key%>_2" type="checkbox" onclick="hr_ev_checkLimits(\'t\',\'<%link_key%>\',\'2\',\'<%ev_id%>\')" name="fc" value="<%link_key%>"/></div>\n');tmp.push('					<div class="elt"><input id="tfcastt_<%ev_id%>_<%link_key%>_3" type="checkbox" onclick="hr_ev_checkLimits(\'t\',\'<%link_key%>\',\'3\',\'<%ev_id%>\')" name="fc" value="<%link_key%>"/></div>\n');tmp.push('					<div class="elt ao"><input id="tfcastt_<%ev_id%>_<%link_key%>_A" type="checkbox" onclick="hr_ev_checkLimits(\'t\',\'<%link_key%>\',\'A\',\'<%ev_id%>\')" name="fc" value="<%link_key%>"/></div>\n');tmp.push('					<div class="clear"></div>\n');tmp.push('				</div><%END%>\n');tmp.push('			<%ELSE%>\n');tmp.push('				<%IF mkt_lp_avail == "Y"%><div class="odd <%IF !bettable%> suspended<%END%>"><%IF !bettable%><a href="javascript:void(0)" class="empty" id="hr_ev_selcn_price_<%ev_id%>_<%link_key%>_<%ev_mkt_id%>_<%ev_oc_id%>" ><%price_str%></a><%END%></div><%END%>\n');tmp.push('				<%IF mkt_sp_avail == "Y"%><div class="sp<%IF mkt_lp_avail != "Y"%>-med<%END%> <%IF !bettable%> suspended<%END%>"><%IF !bettable%><a href="javascript:void(0)" class="empty">SP</a><%END%></div><%END%>\n');tmp.push('			<%END%>\n');tmp.push('		<%END%>\n');tmp.push('	</div>\n');tmpl_store("hr_ev_selcn_ftc",tmp.join(""))};var EVENT={},MARKET={},SELN={}
function singlemarket(msg_type){if(msg_type=='EVENT'){_got_EVENT.apply(this,arguments)}else if(msg_type=='MARKET'){_got_MARKET.apply(this,arguments)}else if(msg_type=='SELN'){_got_SELN.apply(this,arguments)}else if(msg_type=='END'){_got_END.apply(this,arguments)}else throw('Unexpected msg_type "'+msg_type+'"')}
function _got_EVENT(junk,ev_elem_id){var ev={ev_elem_id:ev_elem_id};ev.markets=[];EVENT[ev_elem_id]=ev}
function _got_MARKET(junk,ev_elem_id,mkt_elem_id){var ev=EVENT[ev_elem_id],market={ev_elem_id:ev_elem_id,mkt_elem_id:mkt_elem_id};market.sort_dirs={};market.sort_dirs["NAME"]=0;market.sort_dirs["PRICE"]=1;market.selns=[];MARKET[mkt_elem_id]=market;ev.markets.push(mkt_elem_id)}
function _got_SELN(junk,ev_elem_id,mkt_elem_id,oc_elem_id,id,name,lp_num,lp_den){var ev=EVENT[ev_elem_id],market=MARKET[mkt_elem_id],seln={ev_elem_id:ev_elem_id,mkt_elem_id:mkt_elem_id,oc_elem_id:oc_elem_id,id:id,name:name,lp_num:lp_num,lp_den:lp_den};SELN[oc_elem_id]=seln;market.selns.push(oc_elem_id)}
function _got_END(junk,ev_elem_id){var ev=EVENT[ev_elem_id];for(var j=0;j<ev.markets.length;j++){var market=MARKET[ev.markets[j]];market.elem=document.getElementById(market.mkt_elem_id);for(var i=0;i<market.selns.length;i++){var seln=SELN[market.selns[i]];seln.elem=document.getElementById(seln.oc_elem_id)}}}
function singlemarket_sort(mkt_elem_id,sort_by){var selns_ordered=[],market=MARKET[mkt_elem_id];if(sort_by=="PRICE"){market.sort_dirs["NAME"]=0}else if(sort_by=="NAME"){market.sort_dirs["PRICE"]=0}else throw('Unexpected sort_by "'+sort_by+'"');market.sort_dirs[sort_by]=market.sort_dirs[sort_by]*-1;if(market.sort_dirs[sort_by]==0)market.sort_dirs[sort_by]=1;var sort_dir=market.sort_dirs[sort_by];for(var i=0;i<market.selns.length;i++){var seln=SELN[market.selns[i]];market.elem.removeChild(seln.elem);selns_ordered.push(seln)};selns_ordered.sort(function(a,b){return singlemarket_cmp(sort_by,sort_dir,a,b)});for(var i=0;i<selns_ordered.length;i++){var seln=selns_ordered[i];market.elem.appendChild(seln.elem)}}
function singlemarket_cmp(sort_by,sort_dir,selnA,selnB){if(sort_by=='NAME'){if(selnA.name<selnB.name){return-sort_dir}else if(selnA.name>selnB.name)return sort_dir}else if(sort_by=="PRICE"){var d=selnA.lp_num*selnB.lp_den-selnA.lp_den*selnB.lp_num;if(d<0){return-sort_dir}else if(d>0)return sort_dir};if(selnA.id<selnB.id){return-1}else if(selnA.id>selnB.id)return 1;return 0}
function do_sgl_mkt_racecard_bet(ev_oc_id,price_string,bet_origin){var price_terms=price_string.split('_'),P=new Object();P.price_type=price_terms[0];P.lp_num=price_terms[1];P.lp_den=price_terms[2];P.mkt_tags=price_terms[3];P.ew_fac_num=price_terms[4];P.ew_fac_den=price_terms[5];P.ew_places=price_terms[6];for(var i=2;i<arguments.length;i+=2){var key=arguments[i],val=arguments[i+1];P[key]=val};if(P.price_type=='S'){P.lp_num='';P.lp_den=''};BS_set_leg('selections',ev_oc_id);BS_set_leg('price_type',P.price_type);BS_set_leg('lp_num',P.lp_num);BS_set_leg('lp_den',P.lp_den);BS_set_leg('market_tags',P.mkt_tags);BS_set_leg('ew_fac_num',P.ew_fac_num);BS_set_leg('ew_fac_den',P.ew_fac_den);BS_set_leg('ew_places',P.ew_places);if((typeof bet_origin!='undefined')&&(bet_origin!=undefined)&&(bet_origin!=""))BS_set_leg('bet_origin',bet_origin);BS_go_bet()};var _hr_match_betting_hdr_prefix="h2h_",_hr_match_betting_tbody_prefix="ev_h2h_",_hr_match_betting_row="match_betting_",_hr_match_betting_selns="match_betting_selns_",_hr_match_betting_seln="match_betting_seln_",_hr_match_betting_seln_price="match_betting_seln_price_",_hr_match_betting_seln_hl="match_betting_seln_hl_",_hr_match_betting_selcn_base_class="odd",_hr_match_betting_hl_timers={},_hr_match_betting_channels={},_hr_match_betting_cfg={lang:"en",selns_len:10,jockey_len:10,trainer_len:10,event_len:10,price_str_type:"ODDS",price_str_type_ah:"DECIMAL",price_str_type_hl:"DECIMAL",price_str_sep:"-",hl_class_decrease:"_d",hl_class_increase:"_i",hl_class_same:"",highlight_duration:4e3};_hr_match_betting_ev_hash={};_hr_match_betting_markets_hash={};_hr_match_betting_selns_hash={}
function hr_match_betting_init(init_msg_id,event,markets,selns,cfg){_hr_match_betting_msg_id=init_msg_id;for(var f in cfg)_hr_match_betting_cfg[f]=cfg[f];_hr_match_betting_store_templates();var channels_match_betting=[];if(typeof event!='undefined'&&event!=null&&event!=""){var pscone_id=_hr_match_betting_hdr_prefix+event.ev_id;scone_create(pscone_id,{},{},null);_hr_match_betting_got_EVENT(event,false)};if(!_hr_match_betting_channels["EVENT"+event.ev_id]){channels_match_betting.push("sEVENT"+ps_connect_lpad_id(event.ev_id));_hr_match_betting_channels["EVENT"+event.ev_id]=true};for(var x=0;x<markets.length;x++){_hr_match_betting_got_MARKET(markets[x],false);if(!_hr_match_betting_channels["EVMKT"+markets[x].ev_mkt_id]){channels_match_betting.push("sEVMKT"+ps_connect_lpad_id(markets[x].ev_mkt_id));_hr_match_betting_channels["EVMKT"+markets[x].ev_mkt_id]=true}};for(var x=0;x<selns.length;x++){_hr_match_betting_got_SELN(selns[x],false);if(!_hr_match_betting_channels["SELCN"+selns[x].ev_oc_id]){channels_match_betting.push("sSELCN"+ps_connect_lpad_id(selns[x].ev_oc_id));_hr_match_betting_channels["SELCN"+selns[x].ev_oc_id]=true}};if(channels_match_betting.length>0)ps_connect_register("hr_match_betting_"+event.ev_id,_hr_match_betting_got_msg,channels_match_betting,init_msg_id);var ev_page_handler=_hr_ev_hash[event.ev_id];ev_page_handler.match_betting_loaded=true;event_betslip()}
function _hr_match_betting_store_templates(){tmpl_store("hr_match_betting",'	<table class="race h2h" summary="<%XL _hr_ev_h2h_summary%>" id="match_betting_table_<%ev_id%>">\n 	<thead><tr><th>&nbsp;</th><th style="text-align: right"><%XL _hr_ev_h2h_curr_odds%></th><th>&nbsp</th><th><%XL _hr_ev_h2h_curr_odds%></th><th>&nbsp;</th></tr></thead>\n		<tbody id="ev_h2h_<%ev_id%>"></tbody>\n	</table>\n');tmpl_store("hr_match_betting_row",' <tr id="match_betting_<%ev_id%>_<%disporder%>">\n 	<td colspan="2" id="match_betting_selns_<%ev_id%>_l_<%disporder%>"></td>\n 	<td class="vs"><span>VS</span></td>\n 	<td colspan="2" id="match_betting_selns_<%ev_id%>_r_<%disporder%>"></td>\n </tr>\n');tmpl_store("hr_match_betting_seln",' 	<div id="match_betting_seln_<%ev_oc_id%>_<%disporder%>">\n	<%IF is_left == "0"%>\n 		<div id="match_betting_seln_hl_<%ev_oc_id%>" class="odd left">\n 			<%IF fb_results == "N"%>\n				<a id="match_betting_seln_price_<%ev_oc_id%>" href="javascript:void(0)">NR</a>\n 			<%ELSE%>\n				<%IF mkt_lp_avail == "Y"%>\n             	<a href="javascript:void(0)" id="match_betting_seln_price_<%ev_oc_id%>" onclick="hr_match_betting_do_bet(\'<%ev_oc_id%>\',\'<%ev_id%>\',\'L\',\'\',0)"><%price_str%></a>\n				<%ELSE IF mkt_sp_avail == "Y"%>\n					<a href="javascript:void(0)" id="match_betting_seln_price_<%ev_oc_id%>" onclick="hr_match_betting_do_bet(\'<%ev_oc_id%>\',\'<%ev_id%>\',\'S\',\'\',0)"><%price_str%></a>\n				<%END%>\n			<%END%>\n 		</div>\n 	<%END%>\n 	<div class="h_info left">\n			<div class="silk left">\n 				<div class="s-color"><img src="<%silk_url%>/<%silks_file%>" /></div>\n 				<%IF runner_number != ""%><div class="number"><small>(<%runner_number%>)</small></div><%END%>\n			</div>\n 		<div class="infos left">\n 			<h4 class="left"><%runner_num%>&nbsp;<%IF ext_competitor_id !=""%><a href="javascript:void(0)" onclick="window.open(\'http://www.racingpost.com/horses/horse_home.sd?horse_id=<%ext_competitor_id%>&affid=PaddyPower\', \'RacingPost\', \'scrollbars=1,width=700,height=700\');"><%END%><%name%><%IF ext_competitor_id !=""%></a><%END%></h4>\n 			<div class="clear"></div>\n 			<%IF j_search_url!=""%><a href="<%j_search_url%>"><%END%><%jockey_name%><%IF j_search_url!=""%></a><%END%>\n 		</div>\n 	</div>\n	<%IF is_left == "1"%>\n 		<div id="match_betting_seln_hl_<%ev_oc_id%>" class="odd right">\n 			<%IF fb_results == "N"%>\n				<a id="match_betting_seln_price_<%ev_oc_id%>" href="javascript:void(0)">NR</a>\n 			<%ELSE%>\n				<%IF mkt_lp_avail == "Y"%>\n             			<a href="javascript:void(0)" id="match_betting_seln_price_<%ev_oc_id%>" onclick="hr_match_betting_do_bet(\'<%ev_oc_id%>\',\'<%ev_id%>\',\'L\',\'\',0)"><%price_str%></a>\n				<%ELSE IF mkt_sp_avail == "Y"%>\n					<a href="javascript:void(0)" id="match_betting_seln_price_<%ev_oc_id%>" onclick="hr_match_betting_do_bet(\'<%ev_oc_id%>\',\'<%ev_id%>\',\'S\',\'\',0)"><%price_str%></a>\n				<%END%>\n			<%END%>\n 		</div>\n 	<%END%>\n 	</div>\n')}
function _hr_match_betting_got_msg(msg){var data={};switch(msg.subject_level){case"sPRICE":eval("data = "+msg.data+";");data.ev_oc_id=msg.subject_id;_hr_match_betting_got_PRICE(data,true);break;case"sSELCN":eval("data = "+msg.data+";");data.ev_oc_id=msg.subject_id;_hr_match_betting_got_SELN(data,true);break;case"sEVMKT":eval("data = "+msg.data+";");data.ev_mkt_id=msg.subject_id;_hr_match_betting_got_MARKET(data,true);break;case"sEVENT":eval("data = "+msg.data+";");data.ev_id=msg.subject_id;_hr_match_betting_got_EVENT(data,true);break;default:};return}
function _hr_match_betting_got_EVENT(data,pushed){var info=_hr_match_betting_ev_hash[data.ev_id],is_new_item=!info;if(is_new_item){info=data;info.child_hash={};_hr_match_betting_ev_hash[data.ev_id]=info}else for(var f in data)info[f]=data[f];info.name=info.names[_hr_match_betting_cfg.lang];info.full_name=info.name;info.start_time=info.ev_start_time;info.bettable=info.status=="A";var scitem_id=_hr_match_betting_tbody_prefix+info.ev_id,pscone_id=_hr_match_betting_hdr_prefix+info.ev_id,was_visible=scone_item_exists(scitem_id),now_visible=(info.displayed=="Y"),html=tmpl_play("hr_match_betting",info),sort_info={};if(!was_visible&&now_visible){scone_add_item(pscone_id,scitem_id,html,sort_info);var csone_id=_hr_match_betting_tbody_prefix+info.ev_id;scone_create(csone_id,null,null,null)}else if(was_visible&&now_visible){scone_replace_item(scitem_id,html,sort_info,true)}else scrone_remove_item(scitem_id);if(pushed)for(var ev_mkt_id in info.child_hash)_hr_match_betting_got_MARKET({ev_id:info.ev_id,ev_mkt_id:info.ev_mkt_id},pushed)}
function _hr_match_betting_got_MARKET(data,pushed){var parent_info=_hr_match_betting_ev_hash[data.ev_id];if(typeof parent_info=='undefined'||parent_info==null)return;parent_info.child_hash[data.ev_mkt_id]=true;var info=_hr_match_betting_markets_hash[data.ev_mkt_id],is_new_item=!info,orig_bettable,orig_displayed;if(is_new_item){info=data;info.child_hash={};_hr_match_betting_markets_hash[info.ev_mkt_id]=info}else{orig_bettable=info.bettable;orig_displayed=info.displayed;for(var f in data)info[f]=data[f]};info.bettable=(info.status=="A")&&parent_info.bettable;if((orig_displayed!=info.displayed||orig_bettable!=info.bettable)&&pushed)for(var ev_oc_id in info.child_hash)_hr_match_betting_got_SELN({ev_oc_id:ev_oc_id,ev_mkt_id:info.ev_mkt_id},pushed)}
function _hr_match_betting_got_SELN(data,pushed){var parent_info=_hr_match_betting_markets_hash[data.ev_mkt_id];if(typeof parent_info=='undefined'||parent_info==null)return;parent_info.child_hash[data.ev_oc_id]=true;var orig_lp_num,orig_lp_den,info=_hr_match_betting_selns_hash[data.ev_oc_id],is_new_item=!info;if(is_new_item){info=data;_hr_match_betting_selns_hash[data.ev_oc_id]=info}else{orig_names=info.names;orig_lp_num=info.lp_num;orig_lp_den=info.lp_den;for(var f in data)info[f]=data[f];info.names=orig_names};info.name=info.names[_hr_match_betting_cfg.lang];info.suspended=(info.status=="A")?"N":"Y";info.bettable=(info.status=="A")&&parent_info.bettable;info.silk_url=_hr_match_betting_cfg.silk_url;info.jockey_name=info.jockey_names[_hr_match_betting_cfg.lang];info.search_url=_hr_match_betting_cfg.search_link;if(info.search_url!=""&&info.jockey_in_other_races==1){info.j_search_url=info.search_url+'?racethru=j&search_term='+info.jockey_name}else info.j_search_url="";info.price_str=_hr_match_betting_get_price_str(info.lp_num,info.lp_den,parent_info.lp_avail,parent_info.mkt_sort);var tscone_id=_hr_match_betting_row+info.ev_id+"_"+info.disporder,pscone_id=_hr_match_betting_tbody_prefix+info.ev_id;if(!scone_item_exists(tscone_id)){var html=tmpl_play("hr_match_betting_row",info),sort_info={};scone_add_item(pscone_id,tscone_id,html,sort_info);var csone_id=_hr_match_betting_selns+info.ev_id+"_l_"+info.disporder;scone_create(csone_id,null,null,null);var csone_id=_hr_match_betting_selns+info.ev_id+"_r_"+info.disporder;scone_create(csone_id,null,null,null)};var scitem_id=_hr_match_betting_seln+info.ev_oc_id+"_"+info.disporder;if(info.is_left==1){var pscone_id=_hr_match_betting_selns+info.ev_id+"_l_"+info.disporder}else var pscone_id=_hr_match_betting_selns+info.ev_id+"_r_"+info.disporder;var was_visible=scone_item_exists(scitem_id),now_visible=(info.displayed=="Y"),html=tmpl_play("hr_match_betting_seln",info),sort_info={};if(!was_visible&&now_visible){scone_add_item(pscone_id,scitem_id,html,sort_info)}else if(was_visible&&now_visible){scone_replace_item(scitem_id,html,sort_info,true)}else if(was_visible&&!now_visible)scone_remove_item(scitem_id);if(pushed&&now_visible&&info.bettable)_hr_match_betting_highlight_price_change(info,orig_lp_num,orig_lp_den)}
function _hr_match_betting_got_PRICE(data,rebuild_parents){var info=_hr_match_betting_selns_hash[data.ev_oc_id];if(!info)return;var parent_info=_hr_match_betting_markets_hash[info.ev_mkt_id];if(!parent_info)return;var orig_lp_num=info.lp_num,orig_lp_den=info.lp_den;for(var f in data)info[f]=data[f];var price_id=_hr_match_betting_seln_price+info.ev_oc_id,price_el=document.getElementById(price_id);if(!price_el)return;if(info.displayed!="Y")return;info.price_str=_hr_match_betting_get_price_str(info.lp_num,info.lp_den,parent_info.lp_avail,parent_info.mkt_sort);price_el.innerHTML=info.price_str;if(info.bettable)_hr_match_betting_highlight_price_change(info,orig_lp_num,orig_lp_den);return}
function _hr_match_betting_get_price_str(lp_num,lp_den,lp_avail,mkt_sort){if(typeof lp_avail=="undefined")lp_avail="Y";if(typeof mkt_sort=="undefined")mkt_sort="--";var price_str_type=_hr_match_betting_cfg.price_str_type;if(mkt_sort=="AH"&&_hr_match_betting_cfg.price_str_type_ah!="")price_str_type=_hr_match_betting_cfg.price_str_type_ah;if(mkt_sort=="HL"&&_hr_match_betting_cfg.price_str_type_hl!="")price_str_type=_hr_match_betting_cfg.price_str_type_hl;if(lp_avail=="N")return"SP";if(lp_num==""&&lp_den=="")return"-";var price_str;if(price_str_type=="DECIMAL"){var dps=(lp_den>100)?3:2,dp=1.0+(lp_num/lp_den),scaled_dp=""+Math.round(dp*Math.pow(10,dps)-0.5),int_part=scaled_dp.substr(0,scaled_dp.length-dps),frac_part=scaled_dp.substr(scaled_dp.length-dps);if(int_part=="")int_part="";if(frac_part=="")frac_part="";var price_str=int_part+"."+frac_part}else{if(lp_den=="")lp_den=1;if(lp_num==lp_den){price_str="evens"}else price_str=lp_num+_hr_match_betting_cfg.price_str_sep+lp_den};return price_str}
function _hr_match_betting_highlight_price_change(info,old_lp_num,old_lp_den){if(isNaN(info.lp_num)||isNaN(old_lp_num))return;var d=info.lp_num*old_lp_den-info.lp_den*old_lp_num;if(d==0)return;var price_id=_hr_match_betting_seln_hl+info.ev_oc_id;_hr_match_betting_highlight(price_id,_hr_match_betting_selcn_base_class,d);return}
function _hr_match_betting_highlight(id,base_class,dir){var el=document.getElementById(id);if(!el)return;var highlight_class="";if(dir<0){highlight_class=base_class+_hr_match_betting_cfg.hl_class_decrease}else if(dir>0){highlight_class=base_class+_hr_match_betting_cfg.hl_class_increase}else highlight_class=base_class+_hr_match_betting_cfg.hl_class_same;var classes=el.className.split(" "),found=false;for(var i=0;i<classes.length;i++)if(classes[i]==base_class+_hr_match_betting_cfg.hl_class_same||classes[i]==base_class+_hr_match_betting_cfg.hl_class_increase||classes[i]==base_class+_hr_match_betting_cfg.hl_class_decrease){classes[i]=highlight_class;found=true;break};if(!found)classes.push(highlight_class);el.className=classes.join(" ");if(_hr_match_betting_hl_timers[id]!=null){window.clearTimeout(_hr_match_betting_hl_timers[id]);delete _hr_match_betting_hl_timers[id]};var self=this;if(dir!=0)_hr_match_betting_hl_timers[id]=window.setTimeout(function(){self._hr_match_betting_highlight(id,base_class,0)},_hr_match_betting_cfg.highlight_duration);return}
function hr_match_betting_do_bet(ev_oc_id,ev_id,price_type,bet_origin){var selcn=_hr_match_betting_selns_hash[ev_oc_id],evmkt=_hr_match_betting_markets_hash[selcn.ev_mkt_id],lp_num='',lp_den='';if(price_type!='S'){if(evmkt.gp_avail=='Y')price_type='G';lp_num=selcn.lp_num;lp_den=selcn.lp_den};var ew_fac_num='',ew_fac_den='',ew_places='';if(evmkt.ew_avail=='Y'){ew_fac_num=evmkt.ew_fac_num;ew_fac_den=evmkt.ew_fac_den;ew_places=evmkt.ew_places};BS_set_leg('selections',ev_oc_id);BS_set_leg('price_type',price_type);BS_set_leg('lp_num',lp_num);BS_set_leg('lp_den',lp_den);BS_set_leg('market_tags',evmkt.mkt_tags);BS_set_leg('ew_fac_num',ew_fac_num);BS_set_leg('ew_fac_den',ew_fac_den);BS_set_leg('ew_places',ew_places);if((typeof bet_origin!='undefined')&&(bet_origin!=undefined)&&(bet_origin!=""))BS_set_leg('bet_origin',bet_origin);BS_go_bet()}
function hr_nxt3_init(type,events,markets,selns,init_msg_id,cfg){var hr_nxt3_feat=_hr_nxt3_feat_hash[type];if(!hr_nxt3_feat){hr_nxt3_feat=new hr_nxt3_feat_object();hr_nxt3_feat.type=type;_hr_nxt3_feat_hash[type]=hr_nxt3_feat};hr_nxt3_feat.system_date=hr_client_date;hr_nxt3_feat.last_msg_id=init_msg_id;var channels=[];for(var f in cfg)hr_nxt3_feat.cfg[f]=cfg[f];_hr_nxt3_store_templates();hr_nxt3_feat.events_hash={};hr_nxt3_feat.markets_hash={};hr_nxt3_feat.selns_hash={};hr_nxt3_feat.used_channels={};if(type=="nxt3"){scone_create(_hr_nxt3_container_prefix,{},_hr_nxt3_cmp_objects.cmpEventsNxt3,null)}else scone_create(_hr_featured_container_prefix,{},null,null);if(events.length==0){_hr_nxt3_no_events(type)}else for(var i=0;i<events.length;i++){if(type=="featured"){events[i].disporder=i;_hr_nxt3_got_EVENT(hr_nxt3_feat,events[i],false,true)}else _hr_nxt3_got_EVENT(hr_nxt3_feat,events[i],false,true);if(!hr_nxt3_feat.used_channels["EVENT"+events[i].ev_id]){channels.push("sEVENT"+ps_connect_lpad_id(events[i].ev_id));hr_nxt3_feat.used_channels["EVENT"+events[i].ev_id]=true}};for(var i=0;i<markets.length;i++){_hr_nxt3_got_MARKET(hr_nxt3_feat,markets[i],false,false);if(!hr_nxt3_feat.used_channels["EVMKT"+markets[i].ev_mkt_id]){channels.push("sEVMKT"+ps_connect_lpad_id(markets[i].ev_mkt_id));hr_nxt3_feat.used_channels["EVMKT"+markets[i].ev_mkt_id]=true}};for(var i=0;i<selns.length;i++){_hr_nxt3_got_SELN(hr_nxt3_feat,selns[i],false);if(!hr_nxt3_feat.used_channels["SELCN"+selns[i].ev_oc_id]){channels.push("sSELCN"+ps_connect_lpad_id(selns[i].ev_oc_id));hr_nxt3_feat.used_channels["SELCN"+selns[i].ev_oc_id]=true}};var gotPushDataClosure=function(msg){return hr_nxt3_feat.gotPushData(msg)};if(channels.length>0)ps_connect_register("hr_"+type,gotPushDataClosure,channels,init_msg_id);_hr_nxt3_show_top3_EVENTS(hr_nxt3_feat)}
function hr_nxt3_feat_object(){this.gotPushData=function(msg){var data={};switch(msg.subject_level){case"sPRICE":eval("data = "+msg.data+";");data.ev_oc_id=msg.subject_id;_hr_nxt3_got_PRICE(this,data,true);break;case"sSELCN":eval("data = "+msg.data+";");data.ev_oc_id=msg.subject_id;_hr_nxt3_got_SELN(this,data,true);break;case"sEVMKT":eval("data = "+msg.data+";");data.ev_mkt_id=msg.subject_id;_hr_nxt3_got_MARKET(this,data,true,false);break;case"sEVENT":eval("data = "+msg.data+";");data.ev_id=msg.subject_id;_hr_nxt3_got_EVENT(this,data,true,false);break;default:}};this.cfg={lang:"en",jockey_trun_len:10,event_trun_len:10,trainer_trun_len:10,seln_trun_len:10,price_str_type:"ODDS",price_str_type_ah:"DECIMAL",price_str_type_hl:"DECIMAL",price_str_sep:"-",hl_class_decrease:"_d",hl_class_increase:"_i",hl_class_same:"",highlight_duration:4e3};return};var _hr_nxt3_container_prefix="next_3_hp",_hr_featured_container_prefix="featured_hp",_hr_nxt3_selcn_base_class="odd",_hr_nxt3_ev_prefix="hr_nxt3_ev_",_hr_nxt3_ev_seln_hdr="selns_",_hr_nxt3_ev_seln_prefix="hr_nxt3_ev_seln_",_hr_nxt3_ev_price_prefix="hr_nxt3_ev_seln_price_",_hr_nxt3_ev_price_hl_prefix="hr_nxt3_ev_seln_price_hl_",_hr_nxt3_no_events_id="hr_nxt3_no_events",_hr_featured_no_events_id="hr_featured_no_events",_hr_featured_ajax_available=1,_hr_nxt3_featured_hl_timers={},_hr_nxt3_feat_hash={}
function _hr_nxt3_store_templates(){tmpl_store("hr_nxt3_noEv",'	<div class="wp" id="hr_<%type%>_no_events">\n		<div class="title"><h3><%XL HR_NXT3_NO_EVENTS%></h3></div>\n		<div class="clear"></div>\n	</div>\n');tmpl_store("hr_nxt3_event",'	<div <%IF hidden == true%>style="display: none;"<%END%> class="wp" id="hr_nxt3_ev_<%type%>_<%ev_id%>">\n		<div class="title"><a href="<%ev_url%>"><h3><%ev_minutes%> <span><%type_name%></span></h3></a> <%IF cashout_avail == "Y"%> <span class="cash-out-available"></span><%END%></div>\n		<div class="elts" id="selns_<%type%>_<%ev_id%>"></div>\n		<div class="tool_buttons" id="hr_nxt3_tools_<%ev_id%>">\n			<div class="<%IF has_stream%>opts<%ELSE%>opt<%END%>">\n				<a class="fc" href="<%tmpl_esc_html(ev_url)%>"><%XL HR_NXT3_FULL_RACECARD%><span class="tooltip"><%XL HR_NXT3_FULL_RACECARD_TT%></span></a>\n				<%IF has_stream%>\n					<%IF (stream_avail == 1) || (rp_stream_avail == 1) || (cb_stream_avail == 1)%><a class="wr" href="javascript:open_rp_window(\'<%ev_id%>\')"><%XL HR_NXT3_WATCH_RACE%><span class="tooltip"><%XL HR_NXT3_WATCH_TOOLTIP%></span></a><%END%>\n					<%IF wc_stream_avail == 1%><a class="wr" href="javascript:open_wc_window()"><%XL HR_NXT3_WATCH_RACE%><span class="tooltip"><%XL HR_NXT3_WATCH_TOOLTIP%></span></a><%END%>\n				<%END%>\n			</div>\n		</div>\n		<div class="clear"></div>\n	</div>\n');tmpl_store("hr_nxt3_seln",' <div class="elt" id="hr_nxt3_ev_seln_<%type%>_<%ev_oc_id%>">\n 	<div class="silk">\n		<div class="s-color"><%IF event_hidden == false%><img src="<%img_url%>/<%pa_feed_silks_file%>" alt="<%silks_alt%>" title="<%silks_alt%>" /><%END%></div>\n		<div class="number"><%IF runner_number != ""%>(<%runner_number%>)<%END%></div>\n	</div>\n	<div class="infos">\n		<%IF runner_number != ""%><%runner_number%>&nbsp;<%END%><%IF ext_competitor_id !=""%><a href="javascript:void(0)" onclick="window.open(\'http://www.racingpost.com/horses/horse_home.sd?horse_id=<%ext_competitor_id%>&affid=PaddyPower\', \'RacingPost\', \'scrollbars=1,width=700,height=700\');"><%END%><%name%><%IF ext_competitor_id !=""%></a><%END%>\n		<%IF jockey_name != ""%><small><%XL HR_NXT3_JOCKEY_NAME%>:&nbsp;<%IF j_search_url!=""%><a href="<%tmpl_esc_html(j_search_url)%>"><%END%><%jockey_name_display%></small><%IF j_search_url!=""%></a><%END%><%END%>\n 		<%IF trainer_name_display != ""%><small><%XL HR_NXT3_TRAINER_NAME%>:&nbsp;<%IF t_search_url!=""%><a href="<%tmpl_esc_html(t_search_url)%>"><%END%><%trainer_name_display%></small><%IF t_search_url!=""%></a><%END%><%END%>\n	</div>\n	<div id="hr_nxt3_ev_seln_price_hl_<%type%>_<%ev_oc_id%>" class="odd <%IF !bettable%> suspended<%END%>">\n 	<%IF fb_results == "N"%>\n		<a id="hr_nxt3_ev_seln_price_<%type%>_<%ev_oc_id%>" href="javascript:void(0)">NR</a>\n 	<%ELSE%>\n 	<%IF bettable%>\n			<%IF mkt_lp_avail == "Y" && lp_num != "" && lp_den != ""%>\n				<a href="javascript:void(0)" id="hr_nxt3_ev_seln_price_<%type%>_<%ev_oc_id%>" onclick="hr_nxt3_do_bet(\'<%type%>\',\'<%ev_oc_id%>\',\'<%ev_id%>\')"><%price_str%></a>\n			<%ELSE IF mkt_sp_avail == "Y"%>\n				<a href="javascript:void(0)" id="hr_nxt3_ev_seln_price_<%type%>_<%ev_oc_id%>" onclick="hr_nxt3_do_bet(\'<%type%>\',\'<%ev_oc_id%>\',\'<%ev_id%>\')"><%price_str%></a>\n			<%END%>\n		<%ELSE%>\n			<a href="javascript:void(0)" id="hr_nxt3_ev_seln_price_<%type%>_<%ev_oc_id%>"><%price_str%></a>\n 		<%END%>\n	<%END%>\n 	</div>\n	<div class="clear"></div>\n </div>\n')};var _hr_nxt3_cmp_objects=new function(){}();_hr_nxt3_cmp_objects=new push_hash_cmp_objects();_hr_nxt3_cmp_objects.cmpEvMkts=function(cmp_mode,mktA,mktB){var d=mktA.disporder-mktA.disporder;if(d)return d;return mktA.ev_mkt_id-mktA.ev_mkt_id;return d};_hr_nxt3_cmp_objects.cmpEventsNxt3=function(cmpMode,evA,evB){var t=evA.start_time_disp_order-evB.start_time_disp_order;if(t)return t;var d=evA.disporder-evB.disporder;if(d)return d;return evA.ev_id-evB.ev_id};_hr_nxt3_cmp_objects.cmpEventsFeatured=function(cmpMode,evA,evB){var d=evA.disporder-evB.disporder;if(d)return d;return evA.ev_id-evB.ev_id};_hr_nxt3_cmp_objects.cmpSelcns=function(cmpMode,selcnA,selcnB){var p=selcnA.price_disporder-selcnB.price_disporder;if(p)return p;var d=selcnA.disporder-selcnB.disporder;if(d)return d;return selcnA.ev_oc_id-selcnB.ev_oc_id}
function _hr_nxt3_got_EVENT(handler,data,pushed,force){var info=handler.events_hash[data.ev_id],is_new_item=!info,orig_bettable,orig_displayed;if(is_new_item){info=data;info.hidden=true;info.type=handler.type;info.child_hash={};handler.events_hash[data.ev_id]=info}else{orig_bettable=info.bettable;orig_displayed=info.displayed;for(var f in data)info[f]=data[f]};info.name=info.names[handler.cfg.lang];info.full_name=info.name;info.name=trunc_string(info.name,handler.cfg.event_trun_len,'...');info.type_name=info.type_names[handler.cfg.lang];info.type_name_full=info.type_name;info.type_name=trunc_string(info.type_name,handler.cfg.event_trun_len,'...');info.start_time=info.start_time;info.start_time_timestamp=time_in_milliseconds(info.start_time);info.bettable=info.status=="A";info.has_stream=0;if((info.stream_avail==1)||(info.rp_stream_avail==1)||(info.cb_stream_avail==1)||(info.wc_stream_avail==1))info.has_stream=1;if(info.suspend_at!=""){var susp_time_ms=time_in_milliseconds(info.suspend_at),cur_time=time_in_milliseconds(hr_server_date)+((new Date().getTime())-handler.system_date),susp_time_dif=susp_time_ms-cur_time;if(susp_time_dif<2e3)info.displayed="N"};if(info.is_off=="Y")info.displayed="N";var scitem_id=_hr_nxt3_ev_prefix+handler.type+"_"+info.ev_id;if(handler.type=="nxt3"){var pscone_id=_hr_nxt3_container_prefix}else var pscone_id=_hr_featured_container_prefix;var was_visible=scone_item_exists(scitem_id),now_visible=(info.displayed=="Y");if(!scone_exists(pscone_id))return;var html=tmpl_play("hr_nxt3_event",info),sort_info={disporder:info.disporder,ev_id:info.ev_id,start_time_disp_order:info.start_time_timestamp};if(!was_visible&&now_visible){scone_add_item(pscone_id,scitem_id,html,sort_info);var cscone_id=_hr_nxt3_ev_seln_hdr+handler.type+"_"+info.ev_id;scone_create(cscone_id,{},_hr_nxt3_cmp_objects.cmpSelcns,null)}else if(was_visible&&now_visible){scone_replace_item(scitem_id,html,sort_info,true)}else if(was_visible&&!now_visible)scone_remove_item(scitem_id);if(pushed&&!force)_hr_nxt3_show_top3_EVENTS(handler);if(pushed&&(now_visible&&!was_visible)||(orig_bettable!=info.bettable)||force)for(var ev_mkt_id in info.child_hash)_hr_nxt3_got_MARKET(handler,{ev_mkt_id:ev_mkt_id,ev_id:info.ev_id},pushed,true)}
function _hr_nxt3_show_top3_EVENTS(handler){if(handler.type=="nxt3"){var pscone_id=_hr_nxt3_container_prefix}else var pscone_id=_hr_featured_container_prefix;var event_scones=scone_get_items(pscone_id),counter=0;for(var e=0;e<event_scones.length;e++){var event_elem_name=event_scones[e],ev_id=event_elem_name.substring(_hr_nxt3_ev_prefix.length+handler.type.length+1,event_elem_name.length),info=handler.events_hash[ev_id];if(info){if(counter<3){info.hidden=false}else info.hidden=true;_hr_nxt3_got_EVENT(handler,info,true,true);counter++}};if(event_scones.length==0)_hr_nxt3_no_events(handler.type)}
function _hr_nxt3_got_MARKET(handler,data,pushed,force){var parent_info=handler.events_hash[data.ev_id];if(typeof parent_info=='undefined'||parent_info==null)return;parent_info.child_hash[data.ev_mkt_id]=true;var info=handler.markets_hash[data.ev_mkt_id],is_new_item=!info,orig_bettable,orig_displayed,orig_lp_avail;ev_mkt_id=data.ev_mkt_id;if(is_new_item){info=data;info.type=handler.type;info.child_hash={};handler.markets_hash[data.ev_mkt_id]=info}else{orig_bettable=info.bettable;orig_displayed=info.displayed;orig_lp_avail=info.lp_avail;for(var f in data)info[f]=data[f]};info.bettable=(info.status=="A")&&parent_info.bettable;if((orig_displayed!=info.displayed)||(orig_bettable!=info.bettable)||(orig_lp_avail!=info.lp_avail)||force&&pushed)for(var ev_oc_id in info.child_hash)_hr_nxt3_got_SELN(handler,{ev_oc_id:ev_oc_id,ev_mkt_id:info.ev_mkt_id},pushed)}
function _hr_nxt3_got_SELN(handler,data,pushed){var parent_info=handler.markets_hash[data.ev_mkt_id];if(typeof parent_info=='undefined'||parent_info==null)return;parent_info.child_hash[data.ev_oc_id]=true;var event_info=handler.events_hash[parent_info.ev_id],info=handler.selns_hash[data.ev_oc_id],is_new_item=!info,orig_lp_num,orig_lp_den;if(is_new_item){info=data;info.type=handler.type;handler.selns_hash[data.ev_oc_id]=info;info.jockey_name=data.jockey_names[handler.cfg.lang];info.jockey_name_display=trunc_string(info.jockey_name,handler.cfg.jockey_trun_len,'...');info.trainer_name_full=info.trainer_name;info.trainer_name_display=trunc_string(info.trainer_name_full,handler.cfg.trainer_trun_len,'...');info.silks_alt=data.silks_alt_desc[handler.cfg.lang]}else{orig_lp_num=info.lp_num;orig_lp_den=info.lp_den;for(var f in data)info[f]=data[f]};info.search_url=handler.cfg.search_link;info.name=info.names[handler.cfg.lang];info.name=trunc_string(info.name,handler.cfg.seln_trun_len,'...');info.bettable=(info.status=="A")&&parent_info.bettable;info.img_url=handler.cfg.img_url;info.price_str=_hr_nxt3_get_price_str(handler,info.lp_num,info.lp_den,parent_info.lp_avail,parent_info.sp_avail,parent_info.mkt_sort);if(info.search_url!=""&&info.jockey_in_other_races==1){info.j_search_url=info.search_url+'?racethru=j&search_term='+tmpl_esc_js(info.jockey_name)}else info.j_search_url="";if(info.search_url!=""&&info.trainer_in_other_races==1){info.t_search_url=info.search_url+'?racethru=t&search_term='+tmpl_esc_js(info.trainer_name_full)}else info.t_search_url="";info.event_hidden=event_info.hidden;var scitem_id=_hr_nxt3_ev_seln_prefix+handler.type+"_"+info.ev_oc_id,pscone_id=_hr_nxt3_ev_seln_hdr+handler.type+"_"+info.ev_id,was_visible=scone_item_exists(scitem_id),now_visible=(info.displayed=="Y")&&(parent_info.displayed=="Y"),html=tmpl_play("hr_nxt3_seln",info);if(!scone_exists(pscone_id))return;var sort_info={disporder:info.disporder,price_disporder:info.price_disporder,ev_oc_id:info.ev_oc_id};if(!was_visible&&now_visible){scone_add_item(pscone_id,scitem_id,html,sort_info)}else if(was_visible&&now_visible){scone_replace_item(scitem_id,html,sort_info,true)}else if(was_visible&&!now_visible)scone_remove_item(scitem_id);if(pushed&&now_visible&&info.bettable&&parent_info.lp_avail=="Y")_hr_nxt3_highlight_price_change(handler,info,orig_lp_num,orig_lp_den)}
function _hr_nxt3_got_PRICE(handler,data,pushed){var info=handler.selns_hash[data.ev_oc_id];if(!info)return;var parent_info=handler.markets_hash[info.ev_mkt_id];if(typeof parent_info=='undefined'||parent_info==null)return;var orig_lp_num=info.lp_num,orig_lp_den=info.lp_den;for(var f in data)info[f]=data[f];var scitem_id=_hr_nxt3_ev_seln_prefix+handler.type+"_"+info.ev_oc_id;if(!scone_item_exists(scitem_id))return;var sort_info={disporder:info.disporder,price_disporder:info.price_disporder,ev_oc_id:info.ev_oc_id};scone_set_item_info(scitem_id,sort_info);var price_id=_hr_nxt3_ev_price_prefix+handler.type+"_"+info.ev_oc_id,price_el=document.getElementById(price_id);if(!price_el)return;if(info.displayed!="Y")return;info.price_str=_hr_nxt3_get_price_str(handler,info.lp_num,info.lp_den,parent_info.lp_avail,parent_info.lp_avail,parent_info.mkt_sort);price_el.innerHTML=info.price_str;if(info.bettable&&parent_info.lp_avail=="Y")_hr_nxt3_highlight_price_change(handler,info,orig_lp_num,orig_lp_den)}
function _hr_nxt3_get_price_str(handler,lp_num,lp_den,lp_avail,sp_avail,mkt_sort){if(typeof lp_avail=="undefined")lp_avail="Y";if(typeof mkt_sort=="undefined")mkt_sort="--";var price_str_type=handler.cfg.price_str_type;if(mkt_sort=="AH"&&handler.cfg.price_str_type_ah!="")price_str_type=handler.cfg.price_str_type_ah;if(mkt_sort=="HL"&&handler.cfg.price_str_type_hl!="")price_str_type=handler.cfg.price_str_type_hl;if(lp_avail=="N")return"SP";if(lp_num==""&&lp_den=="")if(sp_avail!="N"){return"SP"}else return"-";var price_str;if(price_str_type=="DECIMAL"){var dps=(lp_den>100)?3:2,dp=1.0+(lp_num/lp_den),scaled_dp=""+Math.round(dp*Math.pow(10,dps)-0.5),int_part=scaled_dp.substr(0,scaled_dp.length-dps),frac_part=scaled_dp.substr(scaled_dp.length-dps);if(int_part=="")int_part="";if(frac_part=="")frac_part="";var price_str=int_part+"."+frac_part}else{if(lp_den=="")lp_den=1;if(lp_num==lp_den){price_str="evens"}else price_str=lp_num+handler.cfg.price_str_sep+lp_den};return price_str}
function _hr_nxt3_highlight_price_change(handler,info,old_lp_num,old_lp_den){if(isNaN(info.lp_num)||isNaN(old_lp_num))return;var d=info.lp_num*old_lp_den-info.lp_den*old_lp_num;if(d==0)return;var price_id=_hr_nxt3_ev_price_hl_prefix+handler.type+"_"+info.ev_oc_id;_hr_nxt3_highlight(handler,price_id,_hr_nxt3_selcn_base_class,d);return}
function _hr_nxt3_highlight(handler,id,base_class,dir){var el=document.getElementById(id);if(!el)return;var highlight_class="";if(dir<0){highlight_class=base_class+handler.cfg.hl_class_decrease}else if(dir>0){highlight_class=base_class+handler.cfg.hl_class_increase}else highlight_class=base_class+handler.cfg.hl_class_same;var classes=el.className.split(" "),found=false;for(var i=0;i<classes.length;i++)if(classes[i]==base_class+handler.cfg.hl_class_same||classes[i]==base_class+handler.cfg.hl_class_increase||classes[i]==base_class+handler.cfg.hl_class_decrease){classes[i]=highlight_class;found=true;break};if(!found)classes.push(highlight_class);el.className=classes.join(" ");if(_hr_nxt3_featured_hl_timers[id]!=null){window.clearTimeout(_hr_nxt3_featured_hl_timers[id]);delete _hr_nxt3_featured_hl_timers[id]};var self=this;if(dir!=0)_hr_nxt3_featured_hl_timers[id]=window.setTimeout(function(){self._hr_nxt3_highlight(handler,id,base_class,0)},handler.cfg.highlight_duration);return}
function hr_featured_ajax_call(cgi_url){if(_hr_featured_ajax_available==0)return;var url=cgi_url+"?action=go_hr_featured_races_AJAX&type=HR",req=null;if(window.XMLHttpRequest){req=new XMLHttpRequest()}else if(window.ActiveXObject)req=new ActiveXObject("Microsoft.XMLHTTP");if(req){req.onreadystatechange=function(){if(req.readyState!=4)return;var reqStatus;try{reqStatus=req.status}catch(e){reqStatus=''};if(reqStatus!=200){got_featured_content(url,false,"HTML")}else{_hr_featured_ajax_available=0;got_featured_content(url,true,req.responseText)}};try{req.open('GET',url,true);req.send()}catch(e){}}}
function got_featured_content(url,ok,response){if(ok){if(response=="")return;var parts=_hr_ev_featured_parse_script_tags(response);if(parts[1].length)try{_hr_ev_featured_global_eval(parts[1])}catch(e){ok=false}}}
function _hr_ev_featured_parse_script_tags(str){var html='',js='',i=0,state='HTML',script_re=new RegExp('<(/?)script([^>]*)>','gi');while((mtch=script_re.exec(str))!=null){mS=mtch.index;if(state=='HTML'){html+=str.substring(i,mS)}else js+=str.substring(i,mS)+';\n';var closer=mtch[1],attrs=mtch[2];if(closer=='/'){state='HTML'}else if(attrs.charAt(attrs.length-1)!='/'&&attrs.indexOf('src=')==-1)state='JS';i=script_re.lastIndex};if(state=='HTML'){html+=str.substring(i)}else js+=str.substring(i);return[html,js]};var _hr_ev_featured_global_eval=function(src){if(window.execScript){window.execScript(src);return};var fn=function(){window.eval.call(window,src)};fn()}
function _hr_nxt3_no_events(type){if(type=="nxt3"){var pscone_id=_hr_nxt3_container_prefix,scitem_id=_hr_nxt3_no_events_id}else{var pscone_id=_hr_featured_container_prefix,scitem_id=_hr_featured_no_events_id};var info={type:type},html=tmpl_play("hr_nxt3_noEv",info),sort_info={};if(!scone_exists(scitem_id))scone_add_item(pscone_id,scitem_id,html,sort_info)}
function hr_nxt3_do_bet(type,ev_oc_id,ev_id){var handler=_hr_nxt3_feat_hash[type],selcn=handler.selns_hash[ev_oc_id],evmkt=handler.markets_hash[selcn.ev_mkt_id],lp_num='',lp_den='';if(evmkt.lp_avail=='Y'&&selcn.lp_num!==''&&selcn.lp_den!==''){price_type='L';if(evmkt.gp_avail=='Y')price_type='G';lp_num=selcn.lp_num;lp_den=selcn.lp_den}else price_type='S';var ew_fac_num='',ew_fac_den='',ew_places='';if(evmkt.ew_avail=='Y'){ew_fac_num=evmkt.ew_fac_num;ew_fac_den=evmkt.ew_fac_den;ew_places=evmkt.ew_places};BS_set_leg('selections',ev_oc_id);BS_set_leg('price_type',price_type);BS_set_leg('lp_num',lp_num);BS_set_leg('lp_den',lp_den);BS_set_leg('market_tags',evmkt.mkt_tags);BS_set_leg('ew_fac_num',ew_fac_num);BS_set_leg('ew_fac_den',ew_fac_den);BS_set_leg('ew_places',ew_places);var bet_origin="HR_HP_"+type.toUpperCase();BS_set_leg('bet_origin',bet_origin);BS_go_bet()}
function hr_pn_init(call_type,types,events,markets,init_msg_id,cfg){_hr_pn_system_date=hr_client_date;if(call_type=="js"){ps_connect_deregister("hr_pn");switch_view_race_names(true);_is_racecard_view=false;scone_delete(_hr_pn_types_area_id);scone_delete(_hr_pn_types_names_area_id);_view_less_count=0}else{_hr_pn_store_templates();_hr_pn_display_all=cfg.display_all};for(var f in cfg)_hr_pn_cfg[f]=cfg[f];_hr_pn_last_msg_id=init_msg_id;var live_channels=[];_hr_pn_type_hash={};_hr_pn_event_hash={};_hr_pn_market_hash={};_hr_pn_event_type_hash={};_hr_pn_station_lookup_hash={};_hr_pn_station_name_hash={};_hr_pn_station_img_hash={};_hr_pn_channels_hash={};pnav_current_type=null;scone_create(_hr_pn_types_area_id,{},_hr_pn_cmp_objects.cmpType,null);scone_create(_hr_pn_types_names_area_id,{},_hr_pn_cmp_objects.cmpType,null);var has_live=false;for(var i=0;i<types.length;i++)if(types[i].ev_type_id==-1)has_live=true;if(has_live)_hr_pn_cfg.minimum_rows=_hr_pn_cfg.minimum_rows-1;for(var i=0;i<types.length;i++)_hr_pn_got_TYPE(types[i],true);for(var i=0;i<events.length;i++){_hr_pn_got_EVENT(events[i],true);if(!_hr_pn_channels_hash["EV"+events[i].ev_id]){live_channels.push("sEVENT"+ps_connect_lpad_id(events[i].ev_id));_hr_pn_channels_hash["EV"+events[i].ev_id]=true}};if(_hr_pn_cfg.region_code=="VI"){for(var i=0;i<types.length;i++)if(types[i].type!="next")build_ev_for_type(types[i].ev_type_id,"load")}else for(var i=0;i<types.length;i++)for(var ev_id in types[i].child_hash){var template_ev_id="hr_pn_event_"+types[i].ev_type_id+"_"+ev_id;document.getElementById(template_ev_id).style.display="block"};for(var i=0;i<markets.length;i++)if(!_hr_pn_channels_hash["EVMKT"+markets[i].ev_mkt_id]){live_channels.push("sEVMKT"+ps_connect_lpad_id(markets[i].ev_mkt_id));_hr_pn_channels_hash["EVMKT"+markets[i].ev_mkt_id]=true};_hr_pn_show_hide_no_TYPEs(types.length);hr_pn_set_more_less_button();_hr_pn_build_tv_chans();var show_types=_hr_pn_get_TYPE_count();if(!pn_day_changed&&current_pnav_when=="today"&&(show_types.count==0)||(show_types.count==1&&show_types.last_ev_type_id==-2)){document.getElementById("pnav_tomorrow").checked=true;hr_pn_go_when()}else ps_connect_register("hr_pn",_hr_pn_got_msg,live_channels,init_msg_id);pn_day_changed=false};var _is_racecard_view=false,_view_less_count=0,_hr_pn_display_all=true,_hr_pn_js_elem_id="powernav_js",_hr_pn_content_elem_id="hr_pn_content",_hr_pn_content_no_evs_elem_id="hr_pn_content_no_evs",_hr_pn_no_evs_tools_elem_id="pn_no_ev_tools",_hr_pn_main_tools_elem_id="pn_main_tools",_hr_pn_rc_tools_elem_id="pn_rc_tools",_hr_pn_tv_chans_elem_id="pn_tv_channels_table",_hr_pn_more_less_elem_id="pn_more_less",_hr_pn_types_area_id="hr_pn_types",_hr_pn_type_id_prefix="hr_pn_type_",_hr_pn_events_id_prefix="hr_pn_events_",_hr_pn_event_id_prefix="hr_pn_event_",_hr_pn_types_names_area_id="hr_pn_types_names",_hr_pn_type_names_id_prefix="hr_pn_type_names_",_hr_pn_type_names_link_id_prefix="hr_pn_type_names_link_",_hr_pn_events_names_id_prefix="hr_pn_events_names_",_hr_pn_event_names_id_prefix="hr_pn_event_names_",_hr_pn_tv_link="whats-on-tv",_hr_pn_tv_submit="build_tv_racecard",pn_day_changed=false
function _hr_pn_got_msg(msg){var data={},mkt_data={};switch(msg.subject_level){case"sEVMKT":eval("mkt_data = "+msg.data+";");data.ev_id=mkt_data.ev_id;data.lp_avail=mkt_data.lp_avail;_hr_pn_disseminate_EVENT(data,false);break;case"sEVENT":eval("data = "+msg.data+";");data.ev_id=msg.subject_id;_hr_pn_disseminate_EVENT(data,false);break;default:};powernav_rebind();tooltip_init();return};var _hr_pn_cfg={lang:"en",price_str_type:"ODDS",price_str_type_ah:"DECIMAL",price_str_type_hl:"DECIMAL",price_str_sep:"-"},_hr_pn_system_date=0,_hr_pn_cmp_objects=new function(){}();_hr_pn_cmp_objects.cmpEvents=function(cmpMode,evA,evB){var t=evA.start_time_disp_order-evB.start_time_disp_order;if(t)return t;var d=evA.disporder-evB.disporder;if(d)return d;return evA.ev_id-evB.ev_id};_hr_pn_cmp_objects.cmpType=function(cmpMode,typeA,typeB){if(typeA.type=="next")return-1;if(typeB.type=="next")return 1;if(typeA.type=="live")return 1;if(typeB.type=="live")return-1;var t=typeA.disporder-typeB.disporder;if(t)return t;return typeA.ev_type_id-typeB.ev_type_id}
function _hr_pn_store_templates(){tmpl_store("hr_pn_type",'	<tr id="hr_pn_type_<%ev_type_id%>" class="keep-visible" <%IF hidden == "Y" || exceeds_minimum_rows == "Y" || (ev_type_id == -1 && racecard) %>style="display: none;"<%END%>>\n		<th <%IF ev_type_id == -1%>class="lb"<%END%>><%IF ev_type_id != -1%><a href="<%tmpl_esc_html(url)%>"><%END%><%name%><%IF ev_type_id != -1%></a><%END%></th>\n		<td>\n			<%IF type != "next" && _hr_pn_cfg["region_code"] == "VI"%><a href="javascript:void(0);" id="hr_pn_type_left_button_<%ev_type_id%>" class="virtuals_prev off" onclick="build_ev_for_type(\'<%ev_type_id%>\',\'left\')">&nbsp;</a><%END%>\n     </td>\n		<td id="hr_pn_events_<%ev_type_id%>">\n			<%IF override_text_info != ""%>\n			<div class="race"><%override_text_info%></div>\n			<%END%>\n		</td>\n		<td>\n			<%IF type != "next" && _hr_pn_cfg["region_code"] == "VI"%><a href="javascript:void(0);" id="hr_pn_type_right_button_<%ev_type_id%>" class="virtuals_next off" onclick="build_ev_for_type(\'<%ev_type_id%>\',\'right\')">&nbsp;</a><%END%>\n     </td>\n	</tr>\n');tmpl_store("hr_pn_event",'<%IF racecard%>\n<div id="hr_pn_event_<%ev_type_id%>_<%ev_id%>" <%IF ev_type_id == -1%>class="race lb"<%ELSE%>class="race"<%END%>>\n		<%IF is_off != "Y" && settled !="Y"%>\n			<input class="checkbox" type="checkbox" name="checkbox_ev_id" value="<%ev_id%>">\n			<input type="hidden" name="ev_start_time" value="<%start_time_timestamp%>">\n		<%ELSE IF settled != "Y"%>\n			<input class="checkbox" type="checkbox" disabled>\n		<%END%>\n		<a href="<%tmpl_esc_html(ev_url)%>">\n		<%start_time_short%>\n		<span class="tooltip">\n		<%IF type == "next" || type == "live"%>\n			<div style="color: #1a5243; margin-bottom: 3px;"><%type_name%></div>\n		<%END%>\n		<%name%><br />\n		<%IF settled=="Y"%>\n			<div style="padding-top: 3px; border: 1px solid #1a5243;height: 17px; margin-top: 5px; background: #1a5243; color: #fff; font-size: 10px;">\n			&nbsp;<span style="color: #e76a01; font-size: 10px;"><%XL PN_HR_SETTLED%></span> = This race has run click for result&nbsp;&nbsp;</div>\n		<%ELSE%>\n			<%IF lp_avail=="Y"%>\n				<div style="padding-top: 3px; border: 1px solid #1a5243;height: 17px; margin-top: 5px; background: #1a5243; color: #fff; font-size: 10px;">\n				&nbsp;<span style="color: #e76a01; font-size: 10px;">P</span> = <%XL PN_HR_ODDS_AVAIL%>&nbsp;&nbsp;</div>\n			<%END%>\n		<%END%>\n		</span>\n		</a>\n		<%IF settled=="Y"%>\n			&nbsp;<span class="p" title="R"><img src="'+img_url+'/sb/hr/8X10pxWithoutR.png"></span>\n		<%ELSE%>\n			<%IF lp_avail=="Y"%>\n				&nbsp;<span class="p" title="<%XL PN_HR_ODDS_AVAIL%>">P</span>\n			<%ELSE%>\n				&nbsp;<span class="p">&nbsp;&nbsp;</span>\n			<%END%>\n		<%END%>\n</div>\n<%ELSE%>\n<a class="no_custom" href="<%tmpl_esc_html(ev_url)%>" style="text-decoration: none;">\n	<div id="hr_pn_event_<%ev_type_id%>_<%ev_id%>" <%IF ev_type_id == -1%>class="race lb"<%ELSE%>class="race"<%END%>>\n			<%start_time_short%>\n			<span class="tooltip">\n				<%IF type == "next" || type == "live"%>\n					<div style="color: #1a5243; margin-bottom: 3px;"><%type_name%></div>\n				<%END%>\n				<%name%><br />\n		<%IF settled=="Y"%>\n				<div style="padding-top: 3px; border: 1px solid #1a5243;height: 17px; margin-top: 5px; background: #1a5243; color: #fff; font-size: 10px;">\n				&nbsp;<span style="color: #e76a01; font-size: 10px;"><img src="'+img_url+'/sb/hr/8X10pxWithoutR.png"></span> = This race has run click for result&nbsp;&nbsp;</div>\n		<%ELSE%>\n			<%IF lp_avail=="Y"%>\n				<div style="padding-top: 3px; border: 1px solid #1a5243;height: 17px; margin-top: 5px; background: #1a5243; color: #fff; font-size: 10px;">\n				&nbsp;<span style="color: #e76a01; font-size: 10px;">P</span> = <%XL PN_HR_ODDS_AVAIL%>&nbsp;&nbsp;</div>\n			<%END%>\n		<%END%>\n			</span>\n		<%IF settled=="Y"%>\n			&nbsp;<span class="p" title="R"><img src="'+img_url+'/sb/hr/8X10pxWithoutR.png"></span>\n		<%ELSE%>\n			<%IF lp_avail=="Y"%>\n				&nbsp;<span class="p" title="<%XL PN_HR_ODDS_AVAIL%>">P</span>\n			<%ELSE%>\n				&nbsp;<span class="p">&nbsp;&nbsp;</span>\n			<%END%>\n		<%END%>\n	</div>\n</a>\n<%END%>\n');tmpl_store("hr_pn_event_mbs",'<%IF racecard%>\n<div id="hr_pn_event_<%ev_type_id%>_<%ev_id%>" <%IF ev_type_id == -1%>class="race lb mbs"<%ELSE%>class="race mbs"<%END%>>\n		<%IF is_off != "Y" && settled !="Y"%>\n			<input class="checkbox" type="checkbox" name="checkbox_ev_id" value="<%ev_id%>">\n			<input type="hidden" name="ev_start_time" value="<%start_time_timestamp%>">\n		<%ELSE IF settled != "Y"%>\n			<input class="checkbox" type="checkbox" disabled>\n		<%END%>\n		<a class="mbs" href="<%tmpl_esc_html(ev_url)%>">\n			<%start_time_short%>\n			<span class="tooltip">\n			<%IF type == "next" || type == "live"%>\n				<div style="color: #1a5243; margin-bottom: 3px;"><%type_name%></div>\n			<%END%>\n				<%name%><br />\n				<div style="padding-top: 3px;height: 17px; margin-top: 5px; background: #cc0808; repeat; color: #fff; font-size: 10px;">&nbsp;&nbsp;Money Back Special on this race&nbsp;&nbsp;</div>\n			</span>\n		</a>\n		<%IF settled=="Y"%>\n			&nbsp;<span class="p" title="<%XL PN_HR_SETTLED%>"><%XL PN_HR_SETTLED%></span>\n		<%ELSE%>\n			<%IF lp_avail=="Y"%>\n				&nbsp;<span class="p" title="<%XL PN_HR_ODDS_AVAIL%>">P</span>\n			<%ELSE%>\n				&nbsp;<span class="p">&nbsp;&nbsp;</span>\n			<%END%>\n		<%END%>\n	</div>\n<%ELSE%>\n<a class="mbs no_custom" href="<%tmpl_esc_html(ev_url)%>" style="text-decoration: none;">\n<div id="hr_pn_event_<%ev_type_id%>_<%ev_id%>" <%IF ev_type_id == -1%>class="race lb mbs red"<%ELSE%>class="race mbs red"<%END%>>\n		<%start_time_short%>\n		<span class="tooltip">\n			<%IF type == "next" || type == "live"%>\n				<div style="color: #1a5243; margin-bottom: 3px;"><%type_name%></div>\n			<%END%>\n			<%name%><br />\n			<div style="padding-top: 3px;height: 17px; margin-top: 5px; background: #cc0808; color: #fff; font-size: 10px;">&nbsp;&nbsp;Money Back Special on this race&nbsp;&nbsp;</div>\n		</span>\n		<%IF settled=="Y"%>\n			&nbsp;<span class="p" title="<%XL PN_HR_SETTLED%>"><%XL PN_HR_SETTLED%></span>\n		<%ELSE%>\n			<%IF lp_avail=="Y"%>\n				&nbsp;<span class="p" title="<%XL PN_HR_ODDS_AVAIL%>">P</span>\n			<%ELSE%>\n				&nbsp;<span class="p">&nbsp;&nbsp;</span>\n			<%END%>\n		<%END%>\n	</div>\n</a>\n<%END%>\n');tmpl_store("hr_pn_type_names",'	<tr id="hr_pn_type_names_<%ev_type_id%>" <%IF hidden == "Y" || exceeds_minimum_rows == "Y"%>style="display: none;"<%END%>>\n		<th <%IF ev_type_id == -1%>class="lb"<%ELSE%>class="event"<%END%>><div class="hr_pn_type_names_link_wrap"><a id="hr_pn_type_names_link_<%ev_type_id%>" href="javascript:void(0)"><%name%></a></div></th>\n		<td>\n			<h3><%name%></h3>\n			<div id="hr_pn_events_names_<%ev_type_id%>">\n				<%IF override_text_info != ""%>\n					<div class="race"><%override_text_info%></div>\n				<%END%>\n			</div>\n		</td>\n	</tr>\n');tmpl_store("hr_pn_event_names",'	<div id="hr_pn_event_names_<%ev_type_id%>_<%ev_id%>" <%IF ev_type_id == -1%>class="race lb"<%ELSE%>class="race"<%END%>>\n		<a href="<%tmpl_esc_html(ev_url)%>">\n			<strong>\n				<%IF type == "next" || type == "live"%>\n					<%type_name%>&nbsp;-&nbsp;\n				<%END%>\n			</strong>\n			&nbsp;<%name%><%IF settled=="Y"%>&nbsp;<%XL PN_HR_SETTLED%><%END%>\n		</a>\n	</div>\n');tmpl_store("hr_pn_tv_chan",'	<%IF alignment == "l"%>\n	<tr>\n	<%END%>\n	<td class="no-bdr-<%alignment%>">\n		<input onclick="javascript:hr_pn_check_tv_racecard();" type="checkbox" class="checkbox" name="tv_channels" value="<%idx%>" value="channels_<%idx%>"/>\n		<label for="channels_<%idx%>" title="<%name%>">\n			<%IF img != ""%>\n				<img src="<%XL PN_HR_IMG_URL%>/<%img%>" />\n			<%END%>\n		</label>\n	</td>\n	<%IF alignment == "r"%>\n	</tr>\n	<%END%>\n')}
function _hr_pn_got_TYPE(data,build){var info=_hr_pn_type_hash[data.ev_type_id],is_new_item=!info,orig_bettable;if(is_new_item){info=data;info.hidden="N";_hr_pn_type_hash[data.ev_type_id]=info;info.child_hash={};info.suspend_at=""}else{orig_bettable=info.bettable;for(var f in data)info[f]=data[f]};info.bettable=(info.status=="A");info.name_full=info.names[_hr_pn_cfg.lang];info.name=trunc_string(info.name_full,_hr_pn_cfg.name_truncate_threshold,'...');info.racecard=_is_racecard_view;if(build)if(!_hr_pn_display_all&&_view_less_count>=_hr_pn_cfg.minimum_rows&&info.ev_type_id!=-1){info.exceeds_minimum_rows="Y"}else info.exceeds_minimum_rows="N";var scitem_id=_hr_pn_type_id_prefix+data.ev_type_id,pscone_id=_hr_pn_types_area_id,scitem_id_names=_hr_pn_type_names_id_prefix+data.ev_type_id,pscone_id_names=_hr_pn_types_names_area_id;if(!scone_exists(pscone_id)||!scone_exists(pscone_id_names))return;var html=tmpl_play("hr_pn_type",info),html_names=tmpl_play("hr_pn_type_names",info),sort_info={disporder:info.disporder,ev_type_id:info.ev_type_id,type:info.type},was_visible=scone_item_exists(scitem_id),now_visible=(info.displayed=="Y");if(!was_visible&&now_visible){scone_add_item(pscone_id,scitem_id,html,sort_info);scone_add_item(pscone_id_names,scitem_id_names,html_names,sort_info);if(info.override_text_info==""){var cscone_id=_hr_pn_events_id_prefix+data.ev_type_id;scone_create(cscone_id,{},_hr_pn_cmp_objects.cmpEvents,null);var cscone_id_names=_hr_pn_events_names_id_prefix+data.ev_type_id;scone_create(cscone_id_names,{},_hr_pn_cmp_objects.cmpEvents,null)}}else if(was_visible&&now_visible){scone_replace_item(scitem_id,html,sort_info,true);scone_replace_item(scitem_id_names,html_names,sort_info,true)}else if(was_visible&&!now_visible){scone_remove_item(scitem_id);scone_remove_item(scitem_id_names)};if(build)if(now_visible&&info.hidden=="N"&&info.exceeds_minimum_rows=="N")_view_less_count++;if(info.curr_type)pnav_current_type=$j('#'+_hr_pn_type_names_link_id_prefix+data.ev_type_id)}
function _hr_pn_get_TYPE_count(){var showing_types_count=0,data=null,last_ev_type_id=null;for(var ev_type_id in _hr_pn_type_hash){data=_hr_pn_type_hash[ev_type_id];if(data&&data.hidden=="N")showing_types_count++;last_ev_type_id=ev_type_id};var info={count:showing_types_count,last_ev_type_id:last_ev_type_id};return info}
function _hr_pn_show_hide_TYPE(ev_type_id,hidden){var info=_hr_pn_type_hash[ev_type_id];if(info){info.hidden=hidden;_hr_pn_got_TYPE(info)};var show_types=_hr_pn_get_TYPE_count();if(current_pnav_when=="today"&&(show_types.count==0)||(show_types.count==1&&show_types.last_ev_type_id==-2)){document.getElementById("pnav_tomorrow").checked=true;hr_pn_go_when()}else{powernav_rebind();tooltip_init()}}
function _hr_pn_show_hide_no_TYPEs(types_count){if(types_count==0){document.getElementById(_hr_pn_content_elem_id).style.display="none";document.getElementById(_hr_pn_main_tools_elem_id).style.display="none";document.getElementById(_hr_pn_content_no_evs_elem_id).style.display="block";document.getElementById(_hr_pn_no_evs_tools_elem_id).style.display="block";document.getElementById(_hr_pn_rc_tools_elem_id).style.display="none"}else{document.getElementById(_hr_pn_content_elem_id).style.display="block";document.getElementById(_hr_pn_main_tools_elem_id).style.display="block";document.getElementById(_hr_pn_content_no_evs_elem_id).style.display="none";document.getElementById(_hr_pn_no_evs_tools_elem_id).style.display="none";document.getElementById(_hr_pn_rc_tools_elem_id).style.display="none";if(types_count<=_hr_pn_cfg.minimum_rows){document.getElementById(_hr_pn_more_less_elem_id).style.display="none"}else document.getElementById(_hr_pn_more_less_elem_id).style.display="block"}}
function _hr_pn_disseminate_EVENT(data,build){var ev_type_ids=_hr_pn_event_type_hash[data.ev_id];for(var ev_type_id in ev_type_ids){data.ev_type_id=ev_type_id;_hr_pn_got_EVENT(data,build)}}
function _hr_pn_got_EVENT(data,build){var info=_hr_pn_event_hash[data.ev_type_id+"_"+data.ev_id],is_new_item=!info,orig_bettable,parent_info=_hr_pn_type_hash[data.ev_type_id];if(!parent_info)return;parent_info.child_hash[data.ev_id]=true;if(_hr_pn_cfg.region_code=="VI"){for(var i=0;i<parent_info.display_list.length;i++)if(parent_info.display_list[i].ev_id==data.ev_id){parent_info.display_list.splice(i,1);break};var new_event={ev_id:data.ev_id,timestamp:data.start_time,settled:data.settled};parent_info.display_list.push(new_event);if(build)parent_info.display_list.sort(time_sort)};if(is_new_item){info=data;_hr_pn_event_hash[data.ev_type_id+"_"+data.ev_id]=info;info.child_hash={}}else{orig_bettable=info.bettable;for(var f in data)info[f]=data[f]};if(!_hr_pn_event_type_hash[info.ev_id])_hr_pn_event_type_hash[info.ev_id]={};_hr_pn_event_type_hash[info.ev_id][info.ev_type_id]=true;if(info.settled=="Y"){info.ev_url=_hr_pn_cfg.results_url+info.ev_id}else if(data.ev_type_id==-1){info.ev_url=_hr_pn_cfg.event_url+info.ev_id}else info.ev_url=info.url;info.name_full=info.names[_hr_pn_cfg.lang];info.name=trunc_string(info.name_full,_hr_pn_cfg.name_truncate_threshold,'...');info.type_name_full=info.type_names[_hr_pn_cfg.lang];info.type_name=trunc_string(info.type_name_full,_hr_pn_cfg.name_truncate_threshold,'...');info.start_time_xl=info.start_time_xls[_hr_pn_cfg.lang];info.start_time_timestamp=time_in_milliseconds(info.start_time);info.start_time_short=info.start_time.substring(11,16);info.bettable=(info.status=="A")&&parent_info.bettable;info.racecard=_is_racecard_view;if(info.suspend_at>parent_info.suspend_at)parent_info.suspend_at=info.suspend_at;var scitem_id=_hr_pn_event_id_prefix+info.ev_type_id+"_"+info.ev_id,pscone_id=_hr_pn_events_id_prefix+info.ev_type_id,scitem_id_names=_hr_pn_event_names_id_prefix+info.ev_type_id+"_"+info.ev_id,pscone_id_names=_hr_pn_events_names_id_prefix+info.ev_type_id;if(!scone_exists(pscone_id)||!scone_exists(pscone_id_names))return;if(info.mbs_available=='1'){var html=tmpl_play("hr_pn_event_mbs",info)}else var html=tmpl_play("hr_pn_event",info);var html_names=tmpl_play("hr_pn_event_names",info),sort_info={disporder:info.disporder,ev_id:info.ev_id,start_time_disp_order:info.start_time_timestamp},was_visible=scone_item_exists(scitem_id),now_visible=(info.displayed=="Y"),add_ev_to_station=true;if(!was_visible&&now_visible){scone_add_item(pscone_id,scitem_id,html,sort_info);scone_add_item(pscone_id_names,scitem_id_names,html_names,sort_info);add_ev_to_station=true}else if(was_visible&&now_visible){scone_replace_item(scitem_id,html,sort_info,true);scone_replace_item(scitem_id_names,html_names,sort_info,true);add_ev_to_station=true}else if(was_visible&&!now_visible){scone_remove_item(scitem_id);scone_remove_item(scitem_id_names);add_ev_to_station=false};var station="";for(var i=0;i<info.stations.length;i++){station=info.stations[i];if(!_hr_pn_station_name_hash[station.name]){_hr_pn_station_name_hash[station.name]={};_hr_pn_station_img_hash[station.name]=station.img};if(add_ev_to_station){_hr_pn_station_name_hash[station.name][info.ev_id]=info.start_time_timestamp}else delete _hr_pn_station_name_hash[station.name][info.ev_id]};if(!build){_hr_pn_build_tv_chans();var event_count=0,resulted_hidden_count=0;for(var ev_id in parent_info.child_hash){var ev_info=_hr_pn_event_hash[info.ev_type_id+"_"+ev_id];if(ev_info.displayed=="N"||ev_info.settled=="Y")resulted_hidden_count++;event_count++};if(resulted_hidden_count==event_count){_hr_pn_schedule_hide_TYPE(info.ev_type_id)}else{_hr_pn_show_hide_TYPE(info.ev_type_id,"N");if(_hr_pn_cfg.region_code=="VI"&&data.ev_type_id!=-2)build_ev_for_type(data.ev_type_id,"rebuild")}}}
function build_ev_for_type(ev_type_id,build){var left_button="hr_pn_type_left_button_"+ev_type_id,right_button="hr_pn_type_right_button_"+ev_type_id;if(build=="left"){if(document.getElementById(left_button).className=="virtuals_prev off")return}else if(build=="right")if(document.getElementById(right_button).className=="virtuals_next off")return;var ev_type_info=_hr_pn_type_hash[ev_type_id],no_of_events=ev_type_info.display_list.length;for(var j=0;j<no_of_events;j++){var template_ev_id="hr_pn_event_"+ev_type_id+"_"+ev_type_info.display_list[j].ev_id;document.getElementById(template_ev_id).style.display="none"};var from_display_position=ev_type_info.display_position;if(build=="left"){if(from_display_position==-1){from_display_position=no_of_events-1}else from_display_position-=1}else if(build=="right")from_display_position+=1;var no_of_events_displayed=0,limit_no_events_pn=_hr_pn_cfg.limit_no_events_virtual_pn,current_time_ms=Date.parse(new Date());if(build=="left"||build=="right"){ev_type_info.display_position=from_display_position;for(j=from_display_position;j<no_of_events&&no_of_events_displayed<limit_no_events_pn;j++){var template_ev_id="hr_pn_event_"+ev_type_id+"_"+ev_type_info.display_list[j].ev_id;document.getElementById(template_ev_id).style.display="block";no_of_events_displayed=no_of_events_displayed+1};var event_racecard_modify="";if(build=="left"){event_racecard_modify=from_display_position}else event_racecard_modify=j-1;if(time_in_milliseconds(ev_type_info.display_list[event_racecard_modify].timestamp)>=current_time_ms){var event_identifier=ev_type_id+"_"+ev_type_info.display_list[event_racecard_modify].ev_id;info=_hr_pn_event_hash[event_identifier];info.racecard=_is_racecard_view;_hr_pn_got_EVENT(info,true)}}else{ev_type_info.display_list.sort(time_sort);ev_type_info.display_position=-1;for(j=0;j<no_of_events&&no_of_events_displayed<limit_no_events_pn;j++)if(time_in_milliseconds(ev_type_info.display_list[j].timestamp)>=current_time_ms&&ev_type_info.display_list[j].settled!="Y"){if(ev_type_info.display_position==-1)ev_type_info.display_position=j;var template_ev_id="hr_pn_event_"+ev_type_id+"_"+ev_type_info.display_list[j].ev_id;document.getElementById(template_ev_id).style.display="block";no_of_events_displayed=no_of_events_displayed+1}};if(ev_type_info.display_position!=0){document.getElementById(left_button).className="virtuals_prev on"}else document.getElementById(left_button).className="virtuals_prev off";if(ev_type_info.display_position+limit_no_events_pn<no_of_events){document.getElementById(right_button).className="virtuals_next on"}else document.getElementById(right_button).className="virtuals_next off";if(build=="load"){var hide_type=true;for(j=0;j<no_of_events;j++){var template_ev_id="hr_pn_event_"+ev_type_id+"_"+ev_type_info.display_list[j].ev_id;if(document.getElementById(template_ev_id).style.display!="none"){hide_type=false;break}};if(hide_type)_hr_pn_show_hide_TYPE(ev_type_id,"Y")};if(build=="left"||build=="right"){powernav_rebind();tooltip_init()}}
function time_sort(a,b){return time_in_milliseconds(a.timestamp)-time_in_milliseconds(b.timestamp)}
function _hr_pn_schedule_hide_TYPE(ev_type_id){var info=_hr_pn_type_hash[ev_type_id];if(info){var last_susp_time_ms=time_in_milliseconds(info.suspend_at),cur_time=time_in_milliseconds(hr_server_date)+((new Date().getTime())-_hr_pn_system_date),susp_time_dif=cur_time-last_susp_time_ms;if(susp_time_dif>0){var timer=_hr_pn_cfg.hide_type_timer-(susp_time_dif/100)}else var timer=_hr_pn_cfg.hide_type_timer;if(timer>0){setTimeout(function(){_hr_pn_show_hide_TYPE(ev_type_id,"Y")},(timer*1e3))}else _hr_pn_show_hide_TYPE(ev_type_id,"Y")}}
function _hr_pn_build_tv_chans(){var channel_idx=0,tv_html="",ev_ids=null,ev_info=null,chan_has_evs=false;for(var station in _hr_pn_station_name_hash){ev_ids=_hr_pn_station_name_hash[station];chan_has_evs=false;if(ev_ids)for(var ev_id in ev_ids){var ev_type_ids=_hr_pn_event_type_hash[ev_id];for(var ev_type_id in ev_type_ids){var ev_info=_hr_pn_event_hash[ev_type_id+"_"+ev_id];if(ev_info)if(ev_info.is_off!="Y"&&ev_info.settled!="Y"){chan_has_evs=true;break}};if(chan_has_evs==true)break};if(!chan_has_evs)continue;_hr_pn_station_lookup_hash[channel_idx]=station;var img=_hr_pn_station_img_hash[station],alignment="";if((channel_idx+1)%2){var alignment="l"}else var alignment="r";var info={idx:channel_idx,name:station,img:img,alignment:alignment};tv_html+=tmpl_play("hr_pn_tv_chan",info);channel_idx++};if(alignment=="l"){tv_html+="<td></td>";tv_html+="</tr>"};tv_html='<table summary="channels list"><tbody>'+tv_html+'</tbody></table>';hr_pn_replace_html(document.getElementById(_hr_pn_tv_chans_elem_id),tv_html);if(channel_idx>0){document.getElementById(_hr_pn_tv_link).style.display=""}else document.getElementById(_hr_pn_tv_link).style.display="none"}
function hr_pn_replace_html(el,html){if(el){var oldEl=(typeof el==="string"?document.getElementById(el):el),newEl=document.createElement(oldEl.nodeName);newEl.id=oldEl.id;newEl.className=oldEl.className;newEl.innerHTML=html;if(oldEl.parentNode){oldEl.parentNode.replaceChild(newEl,oldEl)}else oldEl.innerHTML=html;return newEl}}
function hr_pn_switch_to_racecard(){_is_racecard_view=!_is_racecard_view;if(_is_racecard_view){document.getElementById(_hr_pn_main_tools_elem_id).style.display="none";document.getElementById(_hr_pn_rc_tools_elem_id).style.display="block"}else{document.getElementById(_hr_pn_main_tools_elem_id).style.display="block";document.getElementById(_hr_pn_rc_tools_elem_id).style.display="none"};var info=_hr_pn_type_hash[-1];if(info){info.racecard=_is_racecard_view;_hr_pn_got_TYPE(info,true)};var current_time_ms=Date.parse(new Date());for(var event_identifier in _hr_pn_event_hash){info=_hr_pn_event_hash[event_identifier];if(_hr_pn_cfg.region_code=="VI"){var template_ev_id="hr_pn_event_"+event_identifier;if(info.start_time_timestamp>=current_time_ms&&document.getElementById(template_ev_id).style.display!="none"){info.racecard=_is_racecard_view;_hr_pn_got_EVENT(info,true)}}else{info.racecard=_is_racecard_view;_hr_pn_disseminate_EVENT(info,true)}};powernav_rebind();tooltip_init();switch_view_race_names(true)}
function hr_pn_build_racecard(){var ev_id_list="",ev_time_list="",num_selected=0,ev_id_checkboxes=document.getElementsByName('checkbox_ev_id'),ev_start_times=document.getElementsByName('ev_start_time');for(i=0;i<ev_id_checkboxes.length;i++)if(ev_id_checkboxes[i].checked){if(ev_id_list!=""){ev_id_list=ev_id_list+"|";ev_time_list=ev_time_list+"|"};ev_id_list=ev_id_list+ev_id_checkboxes[i].value;ev_time_list=ev_time_list+ev_start_times[i].value;num_selected=num_selected+1};if(num_selected==0){alert(_hr_pn_cfg.racecard_no_races_msg)}else if(num_selected>_hr_pn_cfg.racecard_limit){alert(_hr_pn_cfg.racecard_limit_msg+': '+_hr_pn_cfg.racecard_limit)}else{document.forms["ev_ids_form"].ev_ids.value=ev_id_list;document.forms["ev_ids_form"].ev_times.value=ev_time_list;document.forms["ev_ids_form"].list_origin.value="HR_EV_LIST_CUSTOM";document.forms["ev_ids_form"].submit()}}
function hr_pn_check_tv_racecard(){var tv_checkboxes=document.getElementsByName('tv_channels'),tv_checkboxes_length=0;for(i=0;i<tv_checkboxes.length;i++)if(tv_checkboxes[i].checked)tv_checkboxes_length++;if(tv_checkboxes_length>0){document.getElementById(_hr_pn_tv_submit).style.display="block"}else document.getElementById(_hr_pn_tv_submit).style.display="none"}
function hr_pn_build_tv_racecard(){var num_selected=0,channel_idx="",channel="",ev_id_list="",ev_time_list="",tv_checkboxes=document.getElementsByName('tv_channels'),no_ev_duplicates={};for(i=0;i<tv_checkboxes.length;i++)if(tv_checkboxes[i].checked){channel_idx=tv_checkboxes[i].value;channel=_hr_pn_station_lookup_hash[channel_idx];channel=_hr_pn_station_name_hash[channel];if(channel)for(var ev_id in channel)if(!no_ev_duplicates[ev_id]){if(ev_id_list!=""){ev_id_list=ev_id_list+"|";ev_time_list=ev_time_list+"|"};ev_id_list+=ev_id;ev_time_list+=channel[ev_id];num_selected++;no_ev_duplicates[ev_id]=true}};if(num_selected==0){alert(_hr_pn_cfg.racecard_no_races_msg)}else{document.forms["ev_ids_form"].ev_ids.value=ev_id_list;document.forms["ev_ids_form"].ev_times.value=ev_time_list;document.forms["ev_ids_form"].list_origin.value="HR_EV_LIST_TV";document.forms["ev_ids_form"].submit()}}
function hr_pn_set_more_less_button(){if(_hr_pn_display_all){$j('#pn_main_tools a.sh').html('<span class="up">'+pn_show_less+'<span class="tooltip">'+pn_show_less_click+'</span></span>')}else $j('#pn_main_tools a.sh').html('<span class="down">'+pn_show_more+'<span class="tooltip">'+pn_show_more_click+'</span></span>')}
function hr_pn_view_more_less(){_hr_pn_display_all=!_hr_pn_display_all;_view_less_count=0;hr_pn_set_more_less_button();var type_scones=scone_get_items(_hr_pn_types_area_id);for(var t=0;t<type_scones.length;t++){var type_elem_name=type_scones[t],ev_type_id=type_elem_name.substring(_hr_pn_type_id_prefix.length,type_elem_name.length),info=_hr_pn_type_hash[ev_type_id];if(info)_hr_pn_got_TYPE(info,true);if(_hr_pn_cfg.region_code=="VI"&&ev_type_id!=-2)build_ev_for_type(ev_type_id,"rebuild")};pnav_current_type=null;powernav_rebind();tooltip_init()}
function hr_pn_reload(pnav_region_id,pnav_when){var clientdata={id:_hr_pn_js_elem_id},url=_hr_pn_cfg.reload_url+"&pnav_region_id="+pnav_region_id+"&pnav_when="+pnav_when;_hr_pn_make_ajax_get_request(url,clientdata,_hr_pn_got_ajax_content)}
function _hr_pn_make_ajax_get_request(url,clientdata,callback){if(document.PollingAjaxHelper.checkSemaphore()){document.PollingAjaxHelper.setTimeout("_hr_pn_make_ajax_get_request",function(){_hr_pn_got_ajax_content(url,clientdata,callback)},300);return};document.PollingAjaxHelper.aquireSemaphore();var req=null;if(window.XMLHttpRequest){req=new XMLHttpRequest()}else if(window.ActiveXObject)req=new ActiveXObject('Microsoft.XMLHTTP');if(req){req.onreadystatechange=function(){if(req.readyState!=4)return;var reqStatus;try{reqStatus=req.status}catch(e){reqStatus=''};if(reqStatus!=200){document.PollingAjaxHelper.releaseSemaphore();callback(url,clientdata,false,'HTTP')}else{document.PollingAjaxHelper.releaseSemaphore();callback(url,clientdata,true,req.responseText)}};try{req.open('GET',url,true);req.send(null)}catch(e){document.PollingAjaxHelper.releaseSemaphore();callback(url,clientdata,false,'UNSUPPORTED')}}else{document.PollingAjaxHelper.releaseSemaphore();callback(url,clientdata,false,'UNSUPPORTED')}}
function _hr_pn_got_ajax_content(url,clientdata,ok,response){var holder_el=document.getElementById(clientdata.id);if(ok){var parts=_hr_pn_parse_script_tags(response);if(holder_el)holder_el.innerHTML=parts[0];if(parts[1].length)try{_hr_pn_global_eval(parts[1])}catch(e){ok=false};tooltip_init()}}
function _hr_pn_parse_script_tags(str){var html='',js='',i=0,state='HTML',script_re=new RegExp('<(/?)script([^>]*)>','gi');while((mtch=script_re.exec(str))!=null){mS=mtch.index;if(state=='HTML'){html+=str.substring(i,mS)}else js+=str.substring(i,mS)+';\n';var closer=mtch[1],attrs=mtch[2];if(closer=='/'){state='HTML'}else if(attrs.charAt(attrs.length-1)!='/'&&attrs.indexOf('src=')==-1)state='JS';i=script_re.lastIndex};if(state=='HTML'){html+=str.substring(i)}else js+=str.substring(i);return[html,js]};var _hr_pn_global_eval=function(src){if(window.execScript){window.execScript(src);return};var fn=function(){window.eval.call(window,src)};fn()}
function hr_qp_do_selection_popup(id_name,operation,silk_src){if(operation=="SHOW"){var silk_container=document.getElementById("silk_"+id_name);document.getElementById(id_name).style.display='';if(silk_container){var imgs=silk_container.getElementsByTagName('img');if(!imgs.length){var img=document.createElement('img');img.src=silk_src;silk_container.appendChild(img)}}}else if(operation=="HIDE")document.getElementById(id_name).style.display='none'}
function hr_qp_go_region(region_id,when){var url=qp_url+"&pnav_region_id="+region_id+"&pnav_when="+when;window.location=url}
function hr_qp_go_when(region_id,when){var url=qp_url+"&pnav_region_id="+region_id+"&pnav_when="+when;window.location=url}
function hr_qp_reset_selections(){var selections=document.getElementsByName("qp_selns");for(i=0;i<selections.length;i++)if(selections[i].checked)selections[i].checked=false;return}
function hr_qp_submit_slip(){var ev_oc_ids=document.getElementsByName("qp_selns"),page_type="hr_quickpick";for(i=0;i<ev_oc_ids.length;i++)if(ev_oc_ids[i].checked){BS_set_leg('selections',ev_oc_ids[i].value);BS_set_leg('bet_origin',page_type.toUpperCase());BS_select_bet(ev_oc_ids[i].value)};hr_qp_reset_selections();BS_go_bets()}
function toggleQPEventForm(ev_id){var the_button_span=document.getElementById('event_overview_button_'+ev_id),the_div=document.getElementById('event_overview_'+ev_id);if(the_div.style.display=='block'){the_div.style.display='none';the_button_span.innerHTML=qp_spotlight_open}else{the_div.style.display='block';the_button_span.innerHTML=qp_spotlight_close}}
function hr_pn_go_region(pnav_region_name,pnav_region_id){if(current_pnav_region_id!=pnav_region_id||!document.getElementById("pnav_today").checked){current_pnav_when="today";document.getElementById('pnav_today').className='pressed';document.getElementById('pnav_today_lbl').className='pressed';document.getElementById('pnav_tomorrow').className='';document.getElementById('pnav_tomorrow_lbl').className='';document.getElementById("region_tab_"+pnav_region_id).className="default-tab active";document.getElementById("region_tab_"+current_pnav_region_id).className="";if(pnav_is_quickpick){hr_qp_go_region(pnav_region_id,current_pnav_when)}else hr_pn_reload(pnav_region_id,current_pnav_when)};current_pnav_region_id=pnav_region_id}
function hr_pn_fix_ie_hover(action){if(action=='hover'){if(document.getElementById('pnav_tomorrow').className=='')document.getElementById('pnav_tomorrow_lbl').className='pressed'}else if(document.getElementById('pnav_today').className=='pressed')document.getElementById('pnav_tomorrow_lbl').className=''}
function hr_pn_go_when(day){if(day=='today'){var pnav_when="today";document.getElementById('pnav_today').className='pressed';document.getElementById('pnav_today_lbl').className='pressed';document.getElementById('pnav_tomorrow').className='';document.getElementById('pnav_tomorrow_lbl').className=''}else{var pnav_when="tomorrow";document.getElementById('pnav_today').className='';document.getElementById('pnav_today_lbl').className='';document.getElementById('pnav_tomorrow').className='pressed';document.getElementById('pnav_tomorrow_lbl').className='pressed'};if(current_pnav_when!=pnav_when)if(pnav_is_quickpick){hr_qp_go_when(current_pnav_region_id,pnav_when)}else{pn_day_changed=true;hr_pn_reload(current_pnav_region_id,pnav_when)};current_pnav_when=pnav_when}
function expand_all(){try{document.getElementById('selection_box_cnt').style.display='';document.getElementById('selection_box_mini').style.display='none'}catch(e){};try{document.getElementById('steamers_cnt').style.display='';document.getElementById('steamers_mini').style.display='none'}catch(e){};try{document.getElementById('cnt_TRAINER').style.display='';document.getElementById('mini_TRAINER').style.display='none'}catch(e){};try{document.getElementById('cnt_JOCKEY').style.display='';document.getElementById('mini_JOCKEY').style.display='none'}catch(e){};try{document.getElementById('horses_for_courses_cnt').style.display='';document.getElementById('horses_for_courses_mini').style.display='none'}catch(e){};try{document.getElementById('travellers_cnt').style.display='';document.getElementById('travellers_mini').style.display='none'}catch(e){}}
function selection_box_ajax_call(cgi_url){var sel=document.getElementById("selection_box_meetings"),meeting_id=sel.options[sel.selectedIndex].value,meeting_id=document.getElementById("selection_box_meetings").value,url=cgi_url+"?action=do_hr_tips_selection_box_AJAX&meeting_id="+meeting_id,req=null;if(window.XMLHttpRequest){req=new XMLHttpRequest()}else if(window.ActiveXObject)req=new ActiveXObject('Microsoft.XMLHTTP');if(req){req.onreadystatechange=function(){if(req.readyState!=4)return;var reqStatus;try{reqStatus=req.status}catch(e){reqStatus=''};if(reqStatus!=200){got_selection_box_content(url,false,"HTML")}else got_selection_box_content(url,true,req.responseText)};try{req.open('GET',url,true);req.send(null)}catch(e){}}}
function hr_tips_parse_script_tags(str){var html='',js='',i=0,state='HTML',script_re=new RegExp('<(/?)script([^>]*)>','gi');while((mtch=script_re.exec(str))!=null){mS=mtch.index;if(state=='HTML'){html+=str.substring(i,mS)}else js+=str.substring(i,mS)+';\n';var closer=mtch[1],attrs=mtch[2];if(closer=='/'){state='HTML'}else if(attrs.charAt(attrs.length-1)!='/'&&attrs.indexOf('src=')==-1)state='JS';i=script_re.lastIndex};if(state=='HTML'){html+=str.substring(i)}else js+=str.substring(i);return[html,js]}
function got_selection_box_content(url,ok,response){if(ok){var holding_el=document.getElementById("selection_box_cnt"),parts=hr_tips_parse_script_tags(response);if(holding_el)holding_el.innerHTML=parts[0];if(parts[1].length)try{_hr_tips_eval(parts[1])}catch(e){ok=false}}};var _hr_tips_eval=function(src){if(window.execScript){window.execScript(src);return};var fn=function(){window.eval.call(window,src)};fn()}
function selection_box_next(){var new_position=current_position+1;get_selection_box_data(new_position);current_position=new_position}
function selection_box_prev(){var new_position=current_position-1;get_selection_box_data(new_position);current_position=new_position};var sc_price_maps=new Array(),wc_price_maps=new Array()
function sc_get_dropdowns(ev_id,mkt_grp_idx){var selectFS=null,selectCS=null;try{selectFS=document.scorecast_form.elements["goalscorer"+ev_id];selectCS=document.scorecast_form.elements["correctscore"+ev_id]}catch(e){};if(selectFS==null||selectCS==null){selectFS=document.getElementById('sc_fs_'+ev_id+'_mkt_grp_idx_'+mkt_grp_idx);selectCS=document.getElementById('sc_cs_'+ev_id+'_mkt_grp_idx_'+mkt_grp_idx)};return[selectFS,selectCS]}
function sc_update_odds(ev_id,mkt_grp_idx){var dropdowns=sc_get_dropdowns(ev_id,mkt_grp_idx),selectFS=dropdowns[0],selectCS=dropdowns[1],fs_idx=selectFS.selectedIndex,cs_idx=selectCS.selectedIndex,price=sc_price(ev_id,fs_idx,cs_idx),link=document.getElementById('sc_'+ev_id+'_mkt_grp_idx_'+mkt_grp_idx);if(price==false){price=sc_impossible;link.href='javascript:void(0)'}else link.href='javascript:BS_go_sc_bets('+ev_id+','+mkt_grp_idx+')';link.innerHTML=price}
function sc_price(ev_id,fs_idx,cs_idx){var price=sc_price_maps[ev_id]["p"+fs_idx+"_"+cs_idx];if(!price){return false}else if(sc_price_type=="ODDS"){return""+price+"-1"}else{price=1+parseInt(price,10);return""+price+".00"}}
function BS_go_sc_bets(ev_id,mkt_grp_idx){var dropdowns=sc_get_dropdowns(ev_id,mkt_grp_idx),selectFS=dropdowns[0],selectCS=dropdowns[1],fs_evocid=selectFS.value,cs_evocid=selectCS.value,fs_idx=selectFS.selectedIndex,cs_idx=selectCS.selectedIndex,lp_num=sc_price_maps[ev_id]["p"+fs_idx+"_"+cs_idx],lp_den=1;BS_set_leg('leg_sort','SC');BS_set_leg('price_type','L');BS_set_leg('lp_num',lp_num);BS_set_leg('lp_den',lp_den);BS_set_leg('selections',fs_evocid+'c'+cs_evocid);BS_go_bet()}
function wc_update_teams(ev_id,mkt_grp_idx){var dropdowns=wc_get_dropdowns(ev_id,mkt_grp_idx),teams=dropdowns[0],players=dropdowns[1],opt=players.options,t_idx=teams.options[teams.selectedIndex].value;opt.length=0;var nm=nms[''+ev_id][t_idx],id=ids[''+ev_id][t_idx];for(i=0;i<nm.length;i++)opt[opt.length]=new Option(nm[i],id[i]);opt.selectedIndex=0}
function wc_update_odds(ev_id,mkt_grp_idx){var dropdowns=wc_get_dropdowns(ev_id,mkt_grp_idx),teams=dropdowns[0],players=dropdowns[1],t_idx=teams.options[teams.selectedIndex].value,p_idx=players.options[players.selectedIndex].value,selection=wc_lookup(ev_id,t_idx,p_idx),link=document.getElementById('wc_'+ev_id+'_mkt_grp_idx_'+mkt_grp_idx);link.href='javascript:BS_go_wc_bets('+ev_id+','+mkt_grp_idx+')';link.innerHTML=selection.price_str}
function wc_get_dropdowns(ev_id,mkt_grp_idx){var teams=null,players=null;try{teams="document.wc_form_"+ev_id+".wc_team_"+ev_id+"_mkt_grp_idx_"+mkt_grp_idx;teams=eval(teams);players="document.wc_form_"+ev_id+".wc_player_"+ev_id+"_mkt_grp_idx_"+mkt_grp_idx;players=eval(players)}catch(e){};if(teams==null||players==null){teams=document.getElementById('wc_team_'+ev_id+'_mkt_grp_idx_'+mkt_grp_idx);players=document.getElementById('wc_player_'+ev_id+'_mkt_grp_idx_'+mkt_grp_idx)};return[teams,players]}
function wc_lookup(ev_id,t_idx,p_idx){var selection=wc_price_maps[ev_id]["p"+p_idx+"_"+t_idx];if(!selection){return false}else return selection}
function BS_go_wc_bets(ev_id,mkt_grp_idx){var dropdowns=wc_get_dropdowns(ev_id,mkt_grp_idx),teams=dropdowns[0],players=dropdowns[1],t_idx=teams.options[teams.selectedIndex].value,p_idx=players.options[players.selectedIndex].value,selection=wc_lookup(ev_id,t_idx,p_idx);BS_set_leg('price_type','L');BS_set_leg('lp_num',selection.lp_num);BS_set_leg('lp_den',selection.lp_den);BS_set_leg('selections',selection.ev_oc_id);BS_set_leg('hcap_value',selection.hcap_value);BS_go_bet()}
function ocv_changed(s){var id_data=s.id.split('_'),mkt=id_data[1],seln,hcap=s.value.split('_')[2],selns=variant[mkt].selns;for(var i=0;i<selns.length;i++){seln=selns[i];var key='sel_'+mkt+'_'+seln,elem=document.getElementById(key);if(!elem)continue;var v,found='false',options=elem.childNodes;for(var j=0;j<options.length;j++){v=options[j].value;if(!v)continue;if(v.split('_')[2]==hcap){found=v;break}};if(found!='false')elem.value=found};seln=id_data[2];ocv_go_bet(mkt,seln)}
function ocv_go_bet(mkt,seln){var key='sel_'+mkt+'_'+seln,elem=document.getElementById(key);if(!elem||elem.value=='none')return;var ocv_data=elem.value.split('_'),ev_oc_id=ocv_data[0],mkt_tags=ocv_data[5],ocv_id=ocv_data[1],ocv_hcap_value=ocv_data[2],ocv_lp_num=ocv_data[3],ocv_lp_den=ocv_data[4];BS_set_leg('price_type','L');BS_set_leg('lp_num',ocv_lp_num);BS_set_leg('lp_den',ocv_lp_den);BS_set_leg('ocv_id',ocv_id);BS_set_leg('hcap_value',ocv_hcap_value);BS_set_leg('selections',ev_oc_id);BS_set_leg('market_tags',mkt_tags);BS_go_bet()}
function do_type_markets_switch(proc_id,arg_id,from_config_item){var type_markets_div=document.getElementById('type_markets_div'),button_text=document.getElementById('nonfbm_show_mo');if(type_markets_div.style.display=='none'){button_text.innerHTML=dd_hide_msg;type_markets_div.style.display='block';if(!from_config_item)addExpandedMarketPageCookie(proc_id,arg_id)}else{button_text.innerHTML=dd_show_msg;type_markets_div.style.display='none';if(!from_config_item)removeExpandedMarketPageCookie(proc_id,arg_id)}}
function nonfbm_toggle(id){var div_element=document.getElementById('div_'+id),div_element_blurb=document.getElementById('div_'+id+'_blurb'),span_element=document.getElementById('span_'+id);if(div_element.style.display=='none'){div_element.style.display='block';div_element_blurb.style.display='block';span_element.innerHTML=dd_hide_msg;span_element.className='remove'}else{div_element.style.display='none';div_element_blurb.style.display='none';span_element.innerHTML=dd_show_msg;span_element.className='show'};return}
function show_conditions(id){$j(function(){$j("#"+id).dialog({autoOpen:false,height:307,width:704,modal:true,closeText:"Close",dialogClass:'team-info-modal',buttons:{},close:function(){$j("#"+id).val("").removeClass("ui-state-error")}});$j(document).ready(function(){$j("#"+id).dialog("open");$j(".team-info-modal").css("height","307px")})})};var nnr_cfg={lang:"en",price_str_type:"ODDS",price_str_type_ah:"DECIMAL",price_str_type_hl:"DECIMAL",price_str_sep:"-"},nnr_ev_ids={},nnr_ev_oc_ids={},nnr_ev_mkt_info={},nnr_mkt_for_oc={}
function nnr_object(){return};nnr_object.prototype.getConfig=function(){return nnr_cfg};nnr_object.prototype.gotPushData=function(identifier,data){switch(identifier){case"PRICE":nnr_got_price(data);break;case"SELCN":nnr_got_selcn(data);break;case"MHCAP":break;case"EVMKT":nnr_got_evmkt(data);break;case"EVENT":nnr_got_event(data);break;default:};return};var nnr_obj=new nnr_object()
function nnr_store_templates(){tmpl_store('nnr_event','<a href="<%ev_url%>">  <strong><%ev_type_name%></strong><br />  <%name%></a>');tmpl_store('nnr_market','<li id="nnr_market_<%ev_mkt_id%>">  Market: <%name%>  <ul id="scone_outcomes_<%ev_mkt_id%>"></ul></li>');tmpl_store('nnr_outcome','<tr id="nnr_outcome_<%ev_oc_id%>">  <td>    <div>      <div class="left">        <%name%>      </div>      <%IF bettable%>      <div class="right">        <a href="javascript:void(0)" onclick="BS_set_leg(\'selections\', <%ev_oc_id%>); BS_go_bet()">          <strong><span id="price_for_<%ev_oc_id%>"><%price%></span></strong>        </a>      </div>      <%ELSE%>      <div class="suspended"></div>      <%END%>    </div>  </td></tr>')}
function nnr_init(lang){nnr_cfg.lang=lang;nnr_store_templates()}
function nnr_got_msg(msg){bir_got_msg(nnr_obj,msg);return}
function nnr_have_received_ev(ev_id){if(nnr_ev_ids[ev_id]){return true}else return false}
function nnr_mark_received_ev(ev_id){nnr_ev_ids[ev_id]=true}
function nnr_have_received_ev_oc(ev_oc_id){if(nnr_ev_oc_ids[ev_oc_id]){return true}else return false}
function nnr_mark_received_ev_oc(ev_oc_id){nnr_ev_oc_ids[ev_oc_id]=true}
function nnr_handle_ev_id(ev_id){return true}
function nnr_comp_selns(cmpMode,selnA,selnB){return 0}
function nnr_event_el_id(ev_id){return'nnr_event_'+ev_id}
function nnr_outcome_el_id(oc_id){return'nnr_outcome_'+oc_id}
function nnr_got_event(data){if(!nnr_handle_ev_id(data.ev_id))return;var info=null;info=data;if(typeof info.names=='undefined'||info.names==null){info.name=''}else try{info.name=info.names[nnr_cfg.lang]}catch(err){info.name=''};info.ev_type_name=info.ev_type_names[nnr_cfg.lang];info.ev_type_name_trunc=info.ev_type_names_trunc[nnr_cfg.lang];info.ev_url=info.ev_urls[nnr_cfg.lang];var event_el=document.getElementById(nnr_event_el_id(info.ev_id)),html=tmpl_play('nnr_event',info),is_new=!nnr_have_received_ev(info.ev_id);event_el.innerHTML=html;if(is_new){scone_create('nnr_selns_'+info.ev_id,{},nnr_comp_selns,null);nnr_mark_received_ev(info.ev_id)}}
function nnr_got_evmkt(data){var ev_mkt_id=data.ev_mkt_id,lp_avail=data.lp_avail,sp_avail=data.sp_avail,mkt_sort=data.mkt_sort;nnr_ev_mkt_info[ev_mkt_id]=[lp_avail,sp_avail,mkt_sort]}
function nnr_got_selcn(data){var info=null;info=data;if(typeof info.names=='undefined'||info.names==null){info.name=''}else info.name=info.names[nnr_cfg.lang];info.bettable=(info.status=='A');nnr_mkt_for_oc[info.ev_oc_id]=info.ev_mkt_id;if(!info.price)info.price=nnr_calc_price(data);var pscone_id='nnr_selns_'+info.ev_id,scitem_id=nnr_outcome_el_id(info.ev_oc_id),html=tmpl_play('nnr_outcome',info),sort_info={lp_price:parseFloat(info.lp_num/info.lp_den),disporder:info.disporder,ev_oc_id:info.ev_oc_id},is_new=!nnr_have_received_ev_oc(info.ev_oc_id);if(is_new){if(!scone_exists(pscone_id))return;scone_add_item(pscone_id,scitem_id,html,sort_info,true);nnr_mark_received_ev_oc(info.ev_oc_id)}else scone_replace_item(scitem_id,html,sort_info,true)}
function nnr_calc_price(info){var ev_mkt_id=info.ev_mkt_id;if(nnr_ev_mkt_info[ev_mkt_id]){var mkt_info=nnr_ev_mkt_info[ev_mkt_id],lp_avail=mkt_info[0],sp_avail=mkt_info[1],mkt_sort=mkt_info[2],price_str=get_price_str(nnr_obj,info.lp_num,info.lp_den,lp_avail,mkt_sort);if(price_str=='-'&&sp_avail=='Y')price_str='SP';return price_str}else return"-"}
function nnr_got_price(data){var info=null;info=data;if(!info.ev_mkt_id)info.ev_mkt_id=nnr_mkt_for_oc[info.ev_oc_id];var price_str=nnr_calc_price(data),elem=document.getElementById('price_for_'+info.ev_oc_id);if(elem)elem.innerHTML=price_str};document.pre_bir_listeners={}
function pre_bir_listen(ev_id,init_msg_id,redirect,redirect_popup_id,bids_container,bids_inner){document.pre_bir_listeners['redirect,'+ev_id]=redirect;document.pre_bir_listeners['bids_container,'+ev_id]=bids_container;document.pre_bir_listeners['bids_inner,'+ev_id]=bids_inner;document.pre_bir_listeners['redirect_popup_id,'+ev_id]=redirect_popup_id;var padded_ev_id=ps_connect_lpad_id(ev_id),channels=["sEVENT"+padded_ev_id];ps_connect_register("pre_bir_listen_"+ev_id,pre_bir_listen_handle_msg,channels,init_msg_id)}
function pre_bir_listen_handle_msg(msg){var data={};if(msg.subject_level=="sEVENT"){eval("data = "+msg.data+";");data.ev_id=msg.subject_id;bids_status_update(data);if(document.pre_bir_listeners['redirect,'+data.ev_id]==true)setup_bir_redirect(data)}}
function bids_status_xl(bids_status){if(document.bids_status_xlations&&document.bids_status_xlations[bids_status]){return document.bids_status_xlations[bids_status]}else return''}
function bids_status_update(data){var ev_id=data.ev_id,container=document.pre_bir_listeners['bids_container,'+ev_id],inner=document.pre_bir_listeners['bids_inner,'+ev_id];if(inner)inner.innerHTML=bids_status_xl(data.bids_status);if(container)if(inner.innerHTML!=''){container.style.display=''}else container.style.display='none'};document.showEventStartTimer=-1
function setup_bir_redirect(ev_msg){if(document.lb_pre_bir_no_check_redirect)return;var ms_before_start=-1,ev_id=ev_msg.ev_id,current_time_ms=Date.parse(Date());if(ev_msg.status=='S'&&ev_msg.displayed=='N'&&ev_msg.is_off=='-'){ms_before_start=0}else if(typeof ev_msg.suspend_at=='string'&&ev_msg.suspend_at!=''){ms_before_start=_time_in_milliseconds(ev_msg.suspend_at)-current_time_ms}else if(ev_msg.is_off=='Y'){ms_before_start=0}else if(ev_msg.is_off!='N'&&typeof ev_msg.start_time=='string'&&ev_msg.start_time!='')ms_before_start=_time_in_milliseconds(ev_msg.start_time)-current_time_ms;clearTimeout(document.showEventStartTimer);if(document.show_popup)if(ms_before_start==0||ms_before_start<-1){showEventStartNotification(ev_id)}else if(ms_before_start!=-1)document.showEventStartTimer=setTimeout('showEventStartNotification('+ev_id+')',ms_before_start)}
function showEventStartNotification(ev_id){var redirect_popup=null;if(document.pre_bir_listeners['redirect_popup_id,'+ev_id])redirect_popup=document.getElementById(document.pre_bir_listeners['redirect_popup_id,'+ev_id]);if(!redirect_popup)redirect_popup=document.getElementById('event_link_popup');if(redirect_popup)redirect_popup.style.display='';if(document.pre_bir_redirect_link_only==true);else{max_wait=document.pre_bir_redirect_max_wait;random_timeout=Math.floor(Math.random()*max_wait);setTimeout('goBIREvent()',random_timeout)}}
function _time_in_milliseconds(time_frm){return Date.parse(new Date(parseInt(time_frm.substring(0,4),10),(parseInt(time_frm.substring(5,7),10)-1),parseInt(time_frm.substring(8,10),10),parseInt(time_frm.substring(11,13),10),parseInt(time_frm.substring(14,16),10),parseInt(time_frm.substring(17),10)))}
function pre_bir_lb_listen(pre_bir_ev_id,event_only,init_msg_id){var padded_ev_id=ps_connect_lpad_id(pre_bir_ev_id),channels=[];if(event_only){var channels=["sEVENT"+padded_ev_id]}else var channels=["sEVENT"+padded_ev_id,"SEVENT"+padded_ev_id];ps_connect_register("pre_bir_lb_listen_"+pre_bir_ev_id,pre_bir_lb_got_msg,channels,init_msg_id)}
function pre_bir_lb_got_msg(msg){var data={};if(msg.subject_level=="sEVENT"){eval("data = "+msg.data+";");data.ev_id=msg.subject_id;_lb_evt_got_EVENT(data);setup_bir_redirect(data)}else if(msg.subject_level=="sEVMKT"){eval("data = "+msg.data+";");data.ev_id=_lb_evt_event.ev_id;data.ev_mkt_id=msg.subject_id;try{_lb_evt_got_EVMKT(data)}catch(err){}}else if(msg.subject_level=="sPRICE"){eval("data = "+msg.data+";");data.ev_oc_id=msg.subject_id;try{_lb_evt_got_PRICE(data)}catch(err){}}else if(msg.subject_level=="sSELCN"){eval("data = "+msg.data+";");data.ev_oc_id=msg.subject_id;try{_lb_evt_got_SELCN(data)}catch(err){}};return}
function pre_bir_lb_set_bids_status(msg){new_bids_status=bids_status_xl(msg.bids_status);if(new_bids_status!=''){_lb_hr_evt_event.BIDS_status=new_bids_status}else _lb_hr_evt_event.BIDS_status=''}
function goBIREvent(){if(document.show_popup==true)window.document.location=cgi_bir_post_ev_url;return}
function goBIRNextEvent(){window.document.location=cgi_bir_post_next_url;return}
function update_prices(){location.reload()}
function do_racecard_bet(ev_oc_id,price_string,bet_origin){var price_terms=price_string.split('_'),P=new Object();P.price_type=price_terms[0];P.lp_num=price_terms[1];P.lp_den=price_terms[2];P.mkt_tags=price_terms[3];P.ew_fac_num=price_terms[4];P.ew_fac_den=price_terms[5];P.ew_places=price_terms[6];for(var i=2;i<arguments.length;i+=2){var key=arguments[i],val=arguments[i+1];P[key]=val};if(P.price_type=='S'){P.lp_num='';P.lp_den=''};BS_set_leg('selections',ev_oc_id);BS_set_leg('price_type',P.price_type);BS_set_leg('lp_num',P.lp_num);BS_set_leg('lp_den',P.lp_den);BS_set_leg('market_tags',P.mkt_tags);BS_set_leg('ew_fac_num',P.ew_fac_num);BS_set_leg('ew_fac_den',P.ew_fac_den);BS_set_leg('ew_places',P.ew_places);if((typeof bet_origin!='undefined')&&(bet_origin!=undefined)&&(bet_origin!=""))BS_set_leg('bet_origin',bet_origin);BS_go_bet()}
function go_racecard(){var ev_id_list="",ev_time_list="",num_selected=0,ev_id_checkboxes=document.getElementsByName('checkbox_ev_id'),ev_start_times=document.getElementsByName('ev_start_time');for(i=0;i<ev_id_checkboxes.length;i++)if(ev_id_checkboxes[i].checked){if(ev_id_list!=""){ev_id_list=ev_id_list+"|";ev_time_list=ev_time_list+"|"};ev_id_list=ev_id_list+ev_id_checkboxes[i].value;ev_time_list=ev_time_list+ev_start_times[i].value;num_selected=num_selected+1};if(num_selected==0){alert(noRacesSelected)}else if(num_selected>racecardLimit){alert(racesSelectedLimit+': '+racecardLimit)}else{document.forms["ev_ids_form"].ev_ids.value=ev_id_list;document.forms["ev_ids_form"].ev_times.value=ev_time_list;document.forms["ev_ids_form"].submit()}}
function checkLimits(tf,seln_row,seln_col,num_selections,ev_id){var col_max;if(tf=="t"){col_max=3}else col_max=2;if(seln_col=="A"){checkLimitsAny(tf,col_max,seln_row,seln_col,num_selections,ev_id)}else checkLimits123(tf,col_max,seln_row,seln_col,num_selections,ev_id);return}
function checkLimits123(tf,col_max,seln_row,seln_col,num_selections,ev_id){var chkbx_name;for(var j=1;j<=num_selections;j++){chkbx_name="tfcast"+tf+"_"+j+"_A_"+ev_id;clear(chkbx_name)};var this_name="tfcast"+tf+"_"+seln_row+"_"+seln_col+"_"+ev_id;for(var j=1;j<=num_selections;j++){chkbx_name="tfcast"+tf+"_"+j+"_"+seln_col+"_"+ev_id;if(chkbx_name!=this_name)clear(chkbx_name)};for(var i=1;i<=col_max;i++){chkbx_name="tfcast"+tf+"_"+seln_row+"_"+i+"_"+ev_id;if(chkbx_name!=this_name)clear(chkbx_name)};return};var last_1="",last_2="",last_3=""
function checkLimitsAny(tf,col_max,seln_row,seln_col,num_selections,ev_id){var chkbx_name,this_name="tfcast"+tf+"_"+seln_row+"_"+seln_col+"_"+ev_id;for(var i=1;i<=col_max;i++)for(var j=1;j<=num_selections;j++){chkbx_name="tfcast"+tf+"_"+j+"_"+i+"_"+ev_id;clear(chkbx_name)};return}
function clear(name){if(document.getElementById){obj=document.getElementsByName(name).item(0)}else if(document.all){obj=document.all[name]}else if(document.layers)obj=getObjNN4(document,name);if(obj)obj.checked=false}
function getObj(sname){if(document.getElementById){obj=document.getElementsByName(sname).item(0)}else if(document.all){obj=document.all[sname]}else if(document.layers)obj=getObjNN4(document,sname);return obj}
function getObjNN4(obj,name){var x=obj.layers,thereturn;for(var i=0;i<x.length;i++){if(x[i].id==name){thereturn=x[i]}else if(x[i].layers.length)var tmp=getObjNN4(x[i],name);if(tmp)thereturn=tmp};return thereturn}
function prepXCast(num_selections,ev_id){var badXCast=true;for(var col_max=2;col_max<=3;col_max++){var selns=new Array(),tf=col_max==2?'f':'t',combi=false,leg_sort='BAD';for(var i=1;i<=(col_max+1);i++)for(var j=1;j<=num_selections;j++){if(i>col_max){chkbx_name="tfcast"+tf+"_"+j+"_A_"+ev_id}else chkbx_name="tfcast"+tf+"_"+j+"_"+i+"_"+ev_id;obj=getObj(chkbx_name);if(obj.checked!=true)continue;selns.push(obj.value);if(i>col_max)combi=true};if(selns.length<col_max)continue;if(col_max==2){leg_sort=combi?'RF':'SF'}else leg_sort=combi?'CT':'TC';if(leg_sort=='BAD')continue;var ev_oc_ids=selns.join('c');BS_set_leg('leg_sort',leg_sort);BS_set_leg('price_type','D');BS_set_leg('selections',ev_oc_ids);BS_select_bet(leg_sort+'_'+ev_oc_ids);badXCast=false};return badXCast}
function createInput(sname,svalue){var x=getObj(sname);if(!x){var oInput=document.createElement("INPUT");oInput.name=sname;oInput.type="HIDDEN";oInput.id=sname;oInput.value=svalue;oForm=getObj("betform");oForm.appendChild(oInput)}else x.value=svalue}
function place_fore_tricast(num_selections,ev_id){if(prepXCast(num_selections,ev_id)){alert(notEnoughSelections);return};BS_go_bets()}
function toggleRaceDetails(ev_id){var the_div=document.getElementById('race_details_'+ev_id),the_span=document.getElementById('remove_return_'+ev_id);if(the_div.style.display=='block'){the_div.style.display='none';the_span.innerHTML='<a href="javascript:toggleRaceDetails('+ev_id+');" class="remove"></a>';the_span.className="remove isCompressed"}else{the_div.style.display='block';the_span.innerHTML='<a href="javascript:toggleRaceDetails('+ev_id+');" class="remove"></a>';the_span.className="remove isExpanded"}}
function toggleHiddenRunners(ev_id){var the_span=document.getElementById('remove_return_'+ev_id),filtered_list=filtered_hash[ev_id],row=null,show=0;for(var r=0;r<filtered_list.length;r++){row=document.getElementById("seln_row_"+ev_id+"_"+filtered_list[r]);links=row.getElementsByTagName("a");if(row.style.display==''){row.style.display='none';forceToggleLinks(row,'none');show=0}else{row.style.display='';forceToggleLinks(row,'');show=1}};if(show){the_span.innerHTML='<a href="javascript:toggleHiddenRunners('+ev_id+');" class="hidehiddenrunners">'+hide_filtered+'</a>';if(document.getElementById('unnamed_first_'+ev_id)!=null){document.getElementById('unnamed_first_'+ev_id).style.display="";forceToggleLinks(document.getElementById('unnamed_first_'+ev_id),"")};if(document.getElementById('unnamed_second_'+ev_id)!=null){document.getElementById('unnamed_second_'+ev_id).style.display="";forceToggleLinks(document.getElementById('unnamed_second_'+ev_id),"")}}else{the_span.innerHTML='<a href="javascript:toggleHiddenRunners('+ev_id+');" class="showhiddenrunners">'+show_filtered+'</a>';if(document.getElementById('unnamed_first_'+ev_id)!=null){document.getElementById('unnamed_first_'+ev_id).style.display="none";forceToggleLinks(document.getElementById('unnamed_first_'+ev_id),"none")};if(document.getElementById('unnamed_second_'+ev_id)!=null){document.getElementById('unnamed_second_'+ev_id).style.display="none";forceToggleLinks(document.getElementById('unnamed_second_'+ev_id),"none")}}}
function forceToggleLinks(row,display){links=row.getElementsByTagName("a");for(var l=0;l<links.length;l++)links[l].style.display=display}
function toggleForm(ev_type_id){var the_title_box,the_title,the_button_span,the_div,open_form=document.getElementById('open_form'),open_form_input=open_form.value;if(open_form.value!='-'){the_title_box=document.getElementById('ev_type_title_box_'+open_form.value);the_title=document.getElementById('ev_type_title_'+open_form.value);the_button_span=document.getElementById('form_button_'+open_form.value);the_div=document.getElementById('form_'+open_form.value);the_div.style.display='none';the_title_box.style.background='#EFEFEF';the_title.style.color='#000';the_button_span.innerHTML=formButton;open_form.value='-'};if(open_form_input!=ev_type_id){the_title_box=document.getElementById('ev_type_title_box_'+ev_type_id);the_title=document.getElementById('ev_type_title_'+ev_type_id);the_button_span=document.getElementById('form_button_'+ev_type_id);the_div=document.getElementById('form_'+ev_type_id);the_div.style.display='block';the_title_box.style.background='#018539';the_title.style.color='#fff';the_button_span.innerHTML=closeButton;open_form.value=ev_type_id}}
function toggleEventForm(ev_id){var event_form_exists=document.getElementById('event_form_exists_'+ev_id),the_button_span=document.getElementById('event_form_button_'+ev_id),the_div=document.getElementById('event_form_'+ev_id);if(event_form_exists!=null&&event_form_exists.value=='Y')if(the_div.style.display=='block'){the_div.style.display='none';the_button_span.innerHTML=formButton}else{the_div.style.display='block';the_button_span.innerHTML=closeButton}}
function do_foretricasts_reset(num_selections,ev_id){var tf,id_string="",count=0;createInput("f_selected_leg_sort","");createInput("t_selected_leg_sort","");for(var col_max=2;col_max<=3;col_max++){id_string="";count=0;if(col_max==2){tf="f"}else tf="t";var combination=0,straight=0;for(var i=1;i<=(col_max+1);i++)for(var j=1;j<=num_selections;j++){if(i>col_max){chkbx_name="tfcast"+tf+"_"+j+"_A_"+ev_id}else chkbx_name="tfcast"+tf+"_"+j+"_"+i+"_"+ev_id;if(document.getElementById){obj=document.getElementsByName(chkbx_name).item(0)}else if(document.all){obj=document.all[chkbx_name]}else if(document.layers)obj=getObjNN4(document,chkbx_name);obj.checked=false}}}
function update_prices2(ev_id){var tabs=document.getElementsByTagName("li"),tabs_string="";for(var i=0;i<tabs.length;i++)if(tabs[i].className=="on"&&tabs[i].id.indexOf("li_")>-1){if(tabs_string!="")tabs_string=tabs_string+"|";tabs_string=tabs_string+tabs[i].id};document.update_prices_form.tabs.value=tabs_string;if(filter_type=="J"){document.update_prices_form.jockey.value=filter_text}else if(filter_type=="T")document.update_prices_form.trainer.value=filter_text;document.update_prices_form.action=document.update_prices_form.action+'#'+ev_id;document.getElementById("action_update_prices").name="action";document.getElementById("action_update_prices").value="go_racing";document.update_prices_form.submit()}
function do_tabs(ev_id){var li_markets=document.getElementById('li_markets_'+ev_id+'_'),li_forecast=document.getElementById('li_forecast_'+ev_id+'_'),li_match=document.getElementById('li_match_'+ev_id+'_');if(li_markets!=null)li_markets.style.display='none';if(li_forecast!=null)li_forecast.style.display='none';if(li_match!=null)li_match.style.display='none';document.getElementById('li_full_'+ev_id+'_').style.display=''}
function switcher(action,ev_id,num_runners,num_markets){var td_element;if(action=='markets')if(document.getElementById('li_racecard_'+ev_id+'_'+num_runners+'_'+num_markets)!=null)if(document.getElementById('li_markets_'+ev_id+'_'+num_runners+'_'+num_markets)==null){switcher('racecard',ev_id,num_runners,num_markets);return};if(action=='racecard')if(document.getElementById('li_racecard_'+ev_id+'_'+num_runners+'_'+num_markets)==null)if(document.getElementById('li_markets_'+ev_id+'_'+num_runners+'_'+num_markets)==null){document.getElementById('singles_'+ev_id).style.display=""}else{switcher('markets',ev_id,num_runners,num_markets);return};var tabs=document.getElementsByTagName("li");for(var i=0;i<tabs.length;i++)if(tabs[i].id.indexOf("_"+ev_id+"_")>-1)tabs[i].className="";if(document.getElementById('match_'+ev_id+'_')!=null)document.getElementById('match_'+ev_id+'_').style.display='none';if(document.getElementById('li_match_'+ev_id+'_')!=null)document.getElementById('li_match_'+ev_id+'_').className="";if(action=="racecard"){if(document.getElementById('cell_number_'+ev_id)!=null)document.getElementById('cell_number_'+ev_id).style.display="";if(document.getElementById('cell_silk_'+ev_id)!=null)document.getElementById('cell_silk_'+ev_id).style.display="";if(document.getElementById('cell_horse_'+ev_id)!=null)document.getElementById('cell_horse_'+ev_id).style.display="";if(document.getElementById('cell_trainer_'+ev_id)!=null)document.getElementById('cell_trainer_'+ev_id).style.display="";if(document.getElementById('cell_form_'+ev_id)!=null)document.getElementById('cell_form_'+ev_id).style.display="";if(document.getElementById('cell_age_'+ev_id)!=null)document.getElementById('cell_age_'+ev_id).style.display="";if(document.getElementById('cell_previous_'+ev_id)!=null)document.getElementById('cell_previous_'+ev_id).style.display="";if(document.getElementById('cell_markets_'+ev_id+'_0')!=null)document.getElementById('cell_markets_'+ev_id+'_0').style.display="";for(i=1;i<num_markets;i++)if(document.getElementById('cell_markets_'+ev_id+'_'+i)!=null)document.getElementById('cell_markets_'+ev_id+'_'+i).style.display="none";if(document.getElementById('cell_fctc_odds_'+ev_id)!=null)document.getElementById('cell_fctc_odds_'+ev_id).style.display="none";if(document.getElementById('cell_fore_tricast_'+ev_id)!=null)document.getElementById('cell_fore_tricast_'+ev_id).style.display="none";for(i=0;i<num_runners;i++){if(document.getElementById('cell_number_'+ev_id+'_'+i)!=null)document.getElementById('cell_number_'+ev_id+'_'+i).style.display="";if(document.getElementById('cell_silk_'+ev_id+'_'+i)!=null)document.getElementById('cell_silk_'+ev_id+'_'+i).style.display="";if(document.getElementById('cell_horse_'+ev_id+'_'+i)!=null)document.getElementById('cell_horse_'+ev_id+'_'+i).style.display="";if(document.getElementById('cell_trainer_'+ev_id+'_'+i)!=null)document.getElementById('cell_trainer_'+ev_id+'_'+i).style.display="";if(document.getElementById('cell_form_'+ev_id+'_'+i)!=null)document.getElementById('cell_form_'+ev_id+'_'+i).style.display="";if(document.getElementById('cell_age_'+ev_id+'_'+i)!=null)document.getElementById('cell_age_'+ev_id+'_'+i).style.display="";if(document.getElementById('cell_previous_'+ev_id+'_'+i)!=null)document.getElementById('cell_previous_'+ev_id+'_'+i).style.display="";if(document.getElementById('cell_market_'+ev_id+'_'+i+'_0')!=null)document.getElementById('cell_market_'+ev_id+'_'+i+'_0').style.display="";for(j=1;j<num_markets;j++)if(document.getElementById('cell_market_'+ev_id+'_'+i+'_'+j)!=null)document.getElementById('cell_market_'+ev_id+'_'+i+'_'+j).style.display="none";if(document.getElementById('cell_fctc_odds_'+ev_id+'_'+i)!=null)document.getElementById('cell_fctc_odds_'+ev_id+'_'+i).style.display="none";if(document.getElementById('cell_fore_tricast_'+ev_id+'_'+i)!=null)document.getElementById('cell_fore_tricast_'+ev_id+'_'+i).style.display="none"};if(document.getElementById('li_racecard_'+ev_id+'_'+num_runners+'_'+num_markets)!=null)document.getElementById('li_racecard_'+ev_id+'_'+num_runners+'_'+num_markets).className="on";if(document.getElementById('singles_'+ev_id)!=null)document.getElementById('singles_'+ev_id).style.display="none";if(document.getElementById('bet_now_button_'+ev_id)!=null)document.getElementById('bet_now_button_'+ev_id).style.display="none";if(document.getElementById('unnamed_first_'+ev_id)!=null)document.getElementById('unnamed_first_'+ev_id).style.display="";if(document.getElementById('unnamed_second_'+ev_id)!=null)document.getElementById('unnamed_second_'+ev_id).style.display="";var markets_ew=document.getElementById('markets_ew_'+ev_id);if(markets_ew!=null)markets_ew.style.display="none";var racecard_ew=document.getElementById('racecard_ew_'+ev_id);if(racecard_ew!=null)racecard_ew.style.display=""};if(action=="markets"){if(document.getElementById('cell_number_'+ev_id)!=null)document.getElementById('cell_number_'+ev_id).style.display="";if(document.getElementById('cell_silk_'+ev_id)!=null)document.getElementById('cell_silk_'+ev_id).style.display="";if(document.getElementById('cell_horse_'+ev_id)!=null)document.getElementById('cell_horse_'+ev_id).style.display="";if(document.getElementById('cell_trainer_'+ev_id)!=null)document.getElementById('cell_trainer_'+ev_id).style.display="none";if(document.getElementById('cell_form_'+ev_id)!=null)document.getElementById('cell_form_'+ev_id).style.display="none";if(document.getElementById('cell_age_'+ev_id)!=null)document.getElementById('cell_age_'+ev_id).style.display="none";if(document.getElementById('cell_previous_'+ev_id)!=null)document.getElementById('cell_previous_'+ev_id).style.display="none";for(i=0;i<num_markets;i++)if(document.getElementById('cell_markets_'+ev_id+'_'+i)!=null)document.getElementById('cell_markets_'+ev_id+'_'+i).style.display="";if(document.getElementById('cell_fctc_odds_'+ev_id)!=null)document.getElementById('cell_fctc_odds_'+ev_id).style.display="none";if(document.getElementById('cell_fore_tricast_'+ev_id)!=null)document.getElementById('cell_fore_tricast_'+ev_id).style.display="none";for(i=0;i<num_runners;i++){if(document.getElementById('cell_number_'+ev_id+'_'+i)!=null)document.getElementById('cell_number_'+ev_id+'_'+i).style.display="";if(document.getElementById('cell_silk_'+ev_id+'_'+i)!=null)document.getElementById('cell_silk_'+ev_id+'_'+i).style.display="";if(document.getElementById('cell_horse_'+ev_id+'_'+i)!=null)document.getElementById('cell_horse_'+ev_id+'_'+i).style.display="";if(document.getElementById('cell_trainer_'+ev_id+'_'+i)!=null)document.getElementById('cell_trainer_'+ev_id+'_'+i).style.display="none";if(document.getElementById('cell_form_'+ev_id+'_'+i)!=null)document.getElementById('cell_form_'+ev_id+'_'+i).style.display="none";if(document.getElementById('cell_age_'+ev_id+'_'+i)!=null)document.getElementById('cell_age_'+ev_id+'_'+i).style.display="none";if(document.getElementById('cell_previous_'+ev_id+'_'+i)!=null)document.getElementById('cell_previous_'+ev_id+'_'+i).style.display="none";for(j=0;j<num_markets;j++)if(document.getElementById('cell_market_'+ev_id+'_'+i+'_'+j)!=null)document.getElementById('cell_market_'+ev_id+'_'+i+'_'+j).style.display="";if(document.getElementById('cell_fctc_odds_'+ev_id+'_'+i)!=null)document.getElementById('cell_fctc_odds_'+ev_id+'_'+i).style.display="none";if(document.getElementById('cell_fore_tricast_'+ev_id+'_'+i)!=null)document.getElementById('cell_fore_tricast_'+ev_id+'_'+i).style.display="none"};if(document.getElementById('li_markets_'+ev_id+'_'+num_runners+'_'+num_markets)!=null)document.getElementById('li_markets_'+ev_id+'_'+num_runners+'_'+num_markets).className="on";if(filter_type!="J"&&filter_type!="T")if(document.getElementById('singles_'+ev_id)!=null)document.getElementById('singles_'+ev_id).style.display="block";if(document.getElementById('bet_now_button_'+ev_id)!=null)document.getElementById('bet_now_button_'+ev_id).style.display="none";if(document.getElementById('unnamed_first_'+ev_id)!=null)document.getElementById('unnamed_first_'+ev_id).style.display="";if(document.getElementById('unnamed_second_'+ev_id)!=null)document.getElementById('unnamed_second_'+ev_id).style.display="";var markets_ew=document.getElementById('markets_ew_'+ev_id);if(markets_ew!=null)markets_ew.style.display="";var racecard_ew=document.getElementById('racecard_ew_'+ev_id);if(racecard_ew!=null)racecard_ew.style.display="none"};if(action=="forecast"){if(document.getElementById('cell_number_'+ev_id)!=null)document.getElementById('cell_number_'+ev_id).style.display="";if(document.getElementById('cell_silk_'+ev_id)!=null)document.getElementById('cell_silk_'+ev_id).style.display="";if(document.getElementById('cell_horse_'+ev_id)!=null)document.getElementById('cell_horse_'+ev_id).style.display="";if(document.getElementById('cell_trainer_'+ev_id)!=null)document.getElementById('cell_trainer_'+ev_id).style.display="none";if(document.getElementById('cell_form_'+ev_id)!=null)document.getElementById('cell_form_'+ev_id).style.display="none";if(document.getElementById('cell_age_'+ev_id)!=null)document.getElementById('cell_age_'+ev_id).style.display="none";if(document.getElementById('cell_previous_'+ev_id)!=null)document.getElementById('cell_previous_'+ev_id).style.display="none";for(i=0;i<num_markets;i++)if(document.getElementById('cell_markets_'+ev_id+'_'+i)!=null)document.getElementById('cell_markets_'+ev_id+'_'+i).style.display="none";if(document.getElementById('cell_fctc_odds_'+ev_id)!=null)document.getElementById('cell_fctc_odds_'+ev_id).style.display="";if(document.getElementById('cell_fore_tricast_'+ev_id)!=null)document.getElementById('cell_fore_tricast_'+ev_id).style.display="";for(i=0;i<num_runners;i++){if(document.getElementById('cell_number_'+ev_id+'_'+i)!=null)document.getElementById('cell_number_'+ev_id+'_'+i).style.display="";if(document.getElementById('cell_silk_'+ev_id+'_'+i)!=null)document.getElementById('cell_silk_'+ev_id+'_'+i).style.display="";if(document.getElementById('cell_horse_'+ev_id+'_'+i)!=null)document.getElementById('cell_horse_'+ev_id+'_'+i).style.display="";if(document.getElementById('cell_trainer_'+ev_id+'_'+i)!=null)document.getElementById('cell_trainer_'+ev_id+'_'+i).style.display="none";if(document.getElementById('cell_form_'+ev_id+'_'+i)!=null)document.getElementById('cell_form_'+ev_id+'_'+i).style.display="none";if(document.getElementById('cell_age_'+ev_id+'_'+i)!=null)document.getElementById('cell_age_'+ev_id+'_'+i).style.display="none";if(document.getElementById('cell_previous_'+ev_id+'_'+i)!=null)document.getElementById('cell_previous_'+ev_id+'_'+i).style.display="none";for(j=0;j<num_markets;j++)if(document.getElementById('cell_market_'+ev_id+'_'+i+'_'+j)!=null)document.getElementById('cell_market_'+ev_id+'_'+i+'_'+j).style.display="none";if(document.getElementById('cell_fctc_odds_'+ev_id+'_'+i)!=null)document.getElementById('cell_fctc_odds_'+ev_id+'_'+i).style.display="";if(document.getElementById('cell_fore_tricast_'+ev_id+'_'+i)!=null)document.getElementById('cell_fore_tricast_'+ev_id+'_'+i).style.display=""};if(document.getElementById('li_forecast_'+ev_id+'_'+num_runners+'_'+num_markets)!=null)document.getElementById('li_forecast_'+ev_id+'_'+num_runners+'_'+num_markets).className="on";if(document.getElementById('singles_'+ev_id)!=null)document.getElementById('singles_'+ev_id).style.display="none";if(document.getElementById('bet_now_button_'+ev_id)!=null)document.getElementById('bet_now_button_'+ev_id).style.display="";if(document.getElementById('unnamed_first_'+ev_id)!=null)document.getElementById('unnamed_first_'+ev_id).style.display="none";if(document.getElementById('unnamed_second_'+ev_id)!=null)document.getElementById('unnamed_second_'+ev_id).style.display="none";var markets_ew=document.getElementById('markets_ew_'+ev_id);if(markets_ew!=null)markets_ew.style.display="none";var racecard_ew=document.getElementById('racecard_ew_'+ev_id);if(racecard_ew!=null)racecard_ew.style.display="none"};if(action=="greyhounds"){if(document.getElementById('cell_horse_'+ev_id)!=null)document.getElementById('cell_horse_'+ev_id).style.display="";if(document.getElementById('cell_fore_tricast_'+ev_id)!=null)document.getElementById('cell_fore_tricast_'+ev_id).style.display="";for(i=0;i<num_markets;i++)if(document.getElementById('cell_markets_'+ev_id+'_'+i)!=null)document.getElementById('cell_markets_'+ev_id+'_'+i).style.display="";if(document.getElementById('cell_number_'+ev_id)!=null)document.getElementById('cell_number_'+ev_id).style.display="none";if(document.getElementById('cell_trainer_'+ev_id)!=null)document.getElementById('cell_trainer_'+ev_id).style.display="none";if(document.getElementById('cell_form_'+ev_id)!=null)document.getElementById('cell_form_'+ev_id).style.display="none";if(document.getElementById('cell_age_'+ev_id)!=null)document.getElementById('cell_age_'+ev_id).style.display="none";if(document.getElementById('cell_silk_'+ev_id)!=null)document.getElementById('cell_silk_'+ev_id).style.display="none";if(document.getElementById('cell_fctc_odds_'+ev_id)!=null)document.getElementById('cell_fctc_odds_'+ev_id).style.display="none";if(document.getElementById('cell_previous_'+ev_id)!=null)document.getElementById('cell_previous_'+ev_id).style.display="none";for(i=0;i<num_runners;i++){if(document.getElementById('cell_horse_'+ev_id+'_'+i)!=null)document.getElementById('cell_horse_'+ev_id+'_'+i).style.display="";if(document.getElementById('cell_fore_tricast_'+ev_id+'_'+i)!=null)document.getElementById('cell_fore_tricast_'+ev_id+'_'+i).style.display="";for(j=0;j<num_markets;j++)if(document.getElementById('cell_market_'+ev_id+'_'+i+'_'+j)!=null)document.getElementById('cell_market_'+ev_id+'_'+i+'_'+j).style.display="";if(document.getElementById('cell_number_'+ev_id+'_'+i)!=null)document.getElementById('cell_number_'+ev_id+'_'+i).style.display="none";if(document.getElementById('cell_fctc_odds_'+ev_id+'_'+i)!=null)document.getElementById('cell_fctc_odds_'+ev_id+'_'+i).style.display="none";if(document.getElementById('cell_trainer_'+ev_id+'_'+i)!=null)document.getElementById('cell_trainer_'+ev_id+'_'+i).style.display="none";if(document.getElementById('cell_form_'+ev_id+'_'+i)!=null)document.getElementById('cell_form_'+ev_id+'_'+i).style.display="none";if(document.getElementById('cell_age_'+ev_id+'_'+i)!=null)document.getElementById('cell_age_'+ev_id+'_'+i).style.display="none";if(document.getElementById('cell_silk_'+ev_id+'_'+i)!=null)document.getElementById('cell_silk_'+ev_id+'_'+i).style.display="none";if(document.getElementById('cell_previous_'+ev_id+'_'+i)!=null)document.getElementById('cell_previous_'+ev_id+'_'+i).style.display="none"};if(document.getElementById('li_forecast_'+ev_id+'_'+num_runners+'_'+num_markets)!=null)document.getElementById('li_forecast_'+ev_id+'_'+num_runners+'_'+num_markets).className="on";if(document.getElementById('singles_'+ev_id)!=null)document.getElementById('singles_'+ev_id).style.display="none";if(document.getElementById('bet_now_button_'+ev_id)!=null)document.getElementById('bet_now_button_'+ev_id).style.display="";if(document.getElementById('unnamed_first_'+ev_id)!=null)document.getElementById('unnamed_first_'+ev_id).style.display="";if(document.getElementById('unnamed_second_'+ev_id)!=null)document.getElementById('unnamed_second_'+ev_id).style.display="";var markets_ew=document.getElementById('markets_ew_'+ev_id);if(markets_ew!=null)markets_ew.style.display="none"};if(action=="match"){document.getElementById('myracecard_'+ev_id+'_').style.display='none';document.getElementById('singles_'+ev_id).style.display="none";document.getElementById('match_'+ev_id+'_').style.display='block';document.getElementById('li_match_'+ev_id+'_').className="on"}else if(document.getElementById('myracecard_'+ev_id+'_')!=null)document.getElementById('myracecard_'+ev_id+'_').style.display='block';if(filter_type=="J"||filter_type=="T"){if(document.getElementById('li_match_'+ev_id+'_')!=null)document.getElementById('li_match_'+ev_id+'_').style.display="none";if(document.getElementById('match_'+ev_id+'_')!=null)document.getElementById('match_'+ev_id+'_').style.display="none";if(document.getElementById("li_forecast_"+ev_id+"_"+num_runners+"_"+num_markets)!=null)document.getElementById("li_forecast_"+ev_id+"_"+num_runners+"_"+num_markets).style.display="none";if(document.getElementById("li_quickpick_"+ev_id+"_"+num_runners+"_"+num_markets)!=null)document.getElementById("li_quickpick_"+ev_id+"_"+num_runners+"_"+num_markets).style.display="none";if(document.getElementById("li_tote_"+ev_id+"_"+num_runners+"_"+num_markets)!=null)document.getElementById("li_tote_"+ev_id+"_"+num_runners+"_"+num_markets).style.display="none";if(document.getElementById('unnamed_first_'+ev_id)!=null)document.getElementById('unnamed_first_'+ev_id).style.display="none";if(document.getElementById('unnamed_second_'+ev_id)!=null)document.getElementById('unnamed_second_'+ev_id).style.display="none"}}
function do_runner(is_greyhounds,is_american,is_virtual,force_market_tab,ev_id,runner_idx,runner_num,stall,silk,horse,jockey,jockey_url,trainer,trainer_url,form,age,weight,num_multi,race_status,jockey_hover_text,trainer_hover_text,fc_avail,tc_avail,runner_status,num_runners,ev_oc_id_0,fb_result_0,runner_odds_0,runner_previous_odds_0,mkt_cell_class_0,runner_cell_class_0,runner_odds_class_0,shp_avail_0,sp_avail_0,lp_avail_0,price_string_0,ev_oc_id_1,fb_result_1,runner_odds_1,runner_previous_odds_1,mkt_cell_class_1,runner_cell_class_1,runner_odds_class_1,shp_avail_1,sp_avail_1,lp_avail_1,price_string_1,ev_oc_id_2,fb_result_2,runner_odds_2,runner_previous_odds_2,mkt_cell_class_2,runner_cell_class_2,runner_odds_class_2,shp_avail_2,sp_avail_2,lp_avail_2,price_string_2,ev_oc_id_3,fb_result_3,runner_odds_3,runner_previous_odds_3,mkt_cell_class_3,runner_cell_class_3,runner_odds_class_3,shp_avail_3,sp_avail_3,lp_avail_3,price_string_3,ev_oc_id_4,fb_result_4,runner_odds_4,runner_previous_odds_4,mkt_cell_class_4,runner_cell_class_4,runner_odds_class_4,shp_avail_4,sp_avail_4,lp_avail_4,price_string_4,ev_oc_id_5,fb_result_5,runner_odds_5,runner_previous_odds_5,mkt_cell_class_5,runner_cell_class_5,runner_odds_class_5,shp_avail_5,sp_avail_5,lp_avail_5,price_string_5,ev_oc_id_6,fb_result_6,runner_odds_6,runner_previous_odds_6,mkt_cell_class_6,runner_cell_class_6,runner_odds_class_6,shp_avail_6,sp_avail_6,lp_avail_6,price_string_6,ev_oc_id_7,fb_result_7,runner_odds_7,runner_previous_odds_7,mkt_cell_class_7,runner_cell_class_7,runner_odds_class_7,shp_avail_7,sp_avail_7,lp_avail_7,price_string_7,ev_oc_id_8,fb_result_8,runner_odds_8,runner_previous_odds_8,mkt_cell_class_8,runner_cell_class_8,runner_odds_class_8,shp_avail_8,sp_avail_8,lp_avail_8,price_string_8,ev_oc_id_9,fb_result_9,runner_odds_9,runner_previous_odds_9,mkt_cell_class_9,runner_cell_class_9,runner_odds_class_9,shp_avail_9,sp_avail_9,lp_avail_9,price_string_9){var runner_idx_incr=runner_idx+1,row=document.createElement('tr');row.id="seln_row_"+ev_id+"_"+ev_oc_id_0;var show_row=1;if(filter_type=="J"){if(filter_text!=jockey)show_row=0}else if(filter_type=="T")if(filter_text!=trainer)show_row=0;if(show_row!=1&&fb_result_0!=1&&fb_result_0!=2){var filtered_list=filtered_hash[ev_id];if(filtered_list!=null){filtered_list.push(ev_oc_id_0);filtered_hash[ev_id]=filtered_list}else{filtered_list=[];filtered_list.push(ev_oc_id_0);filtered_hash[ev_id]=filtered_list};row.style.display="none"};if(fb_result_0==1){row.id='unnamed_first_'+ev_id}else if(fb_result_0==2)row.id='unnamed_second_'+ev_id;if(force_market_tab!='Y'||is_virtual=='Y'){row.appendChild(do_runner_num(ev_id,runner_idx,fb_result_0,runner_num,stall));if(is_virtual=='N')row.appendChild(do_silk(ev_id,silk,runner_idx,horse,jockey))};row.appendChild(do_horse(ev_id,horse,jockey,runner_idx,fb_result_0,is_greyhounds,runner_num,jockey_url,jockey_hover_text));if(is_virtual=='N'){row.appendChild(do_trainer(ev_id,trainer,runner_idx,fb_result_0,trainer_url,trainer_hover_text));row.appendChild(do_form(ev_id,runner_idx,fb_result_0,form));row.appendChild(do_age(ev_id,runner_idx,fb_result_0,age,weight));row.appendChild(do_previous_odds(ev_id,runner_idx,fb_result_0,runner_previous_odds_0))};for(var i=0;i<num_multi;i++)row.appendChild(do_market(ev_id,runner_idx,i,eval('fb_result_'+i),eval('runner_cell_class_'+i),eval('runner_odds_class_'+i),eval('shp_avail_'+i),eval('sp_avail_'+i),eval('lp_avail_'+i),runner_status,race_status,eval('ev_oc_id_'+i),eval('price_string_'+i),eval('runner_odds_'+i),is_american,eval('mkt_cell_class_'+i),eval('runner_previous_odds_'+i),is_greyhounds));row.appendChild(do_fore_tricast_odds(ev_id,runner_idx,mkt_cell_class_0,runner_odds_0,runner_status,fb_result_0));row.appendChild(do_fore_tricasts(ev_id,runner_idx,fb_result_0,runner_idx_incr,ev_oc_id_0,runner_status,fc_avail,tc_avail,num_runners,is_greyhounds));if(fb_result_0==1||fb_result_0==2||fb_result_0=='N'||fb_result_0=='V'||fb_result_0=='W'||fb_result_0=='R'||fb_result_0=='D'){document.getElementById('unsortable_body_'+ev_id).appendChild(row)}else document.getElementById('sortable_body_'+ev_id).appendChild(row)}
function do_runner_num(ev_id,runner_idx,fb_result,runner_num,stall){var td=document.createElement('td');td.id='cell_number_'+ev_id+'_'+runner_idx;td.className='jky no dg';td.style.display='none';if(fb_result!=1&&fb_result!=2){td.appendChild(document.createTextNode(runner_num));td.appendChild(document.createElement('br'));if(stall!='')td.appendChild(document.createTextNode('('+stall+')'))}else td.appendChild(document.createTextNode(' '));return td}
function do_silk(ev_id,silk,runner_idx,horse,jockey){var td=document.createElement('td');td.id='cell_silk_'+ev_id+'_'+runner_idx;td.className='jky dg';td.style.display='none';var img=document.createElement('img');img.alt=horse+' - '+jockey;img.width=29;img.height=21;if(silk==''){img.src=racing_url_silk+'silks/default.png'}else img.src=racing_url_silk+'silks/'+silk;td.appendChild(img);return td}
function do_horse(ev_id,horse,jockey,runner_idx,fb_result,is_greyhounds,runner_num,jockey_url,jockey_hover_text){var td=document.createElement('td');td.id='cell_horse_'+ev_id+'_'+runner_idx;td.className='jky dg';td.style.display='none';if(is_greyhounds=="Y"){var dog_div=document.createElement('div');if(fb_result==1){dog_div.className="trap trapf"}else if(fb_result==2){dog_div.className="trap trapf2"}else dog_div.className="trap trap"+runner_num;dog_div.appendChild(document.createTextNode(horse));td.appendChild(dog_div);return td};if(fb_result!=1&&fb_result!=2){var strong=document.createElement('strong');strong.appendChild(document.createTextNode(horse));td.appendChild(strong);td.appendChild(document.createElement('br'));if(jockey_url!=''){var ja=document.createElement('a');ja.href=jockey_url;ja.title=jockey_hover_text;ja.innerHTML=jockey;td.appendChild(ja)}else td.appendChild(document.createTextNode(jockey))}else td.appendChild(document.createTextNode(horse));return td}
function do_trainer(ev_id,trainer,runner_idx,fb_result,trainer_url,trainer_hover_text){var td=document.createElement('td');td.id='cell_trainer_'+ev_id+'_'+runner_idx;td.className='jky dg';td.style.display='none';if(fb_result!=1&&fb_result!=2&&trainer!=''){if(trainer_url!=''){var ta=document.createElement('a');ta.href=trainer_url;ta.title=trainer_hover_text;ta.innerHTML=trainer;td.appendChild(ta)}else td.appendChild(document.createTextNode(trainer))}else td.appendChild(document.createTextNode(' '));return td}
function do_form(ev_id,runner_idx,fb_result,form){var td=document.createElement('td');td.id='cell_form_'+ev_id+'_'+runner_idx;td.className='dg';td.style.display='none';if(fb_result!=1&&fb_result!=2&&form!=''){td.className='jky dg';td.appendChild(document.createTextNode(form))}else td.appendChild(document.createTextNode(' '));return td}
function do_age(ev_id,runner_idx,fb_result,age,weight){var td=document.createElement('td');td.id='cell_age_'+ev_id+'_'+runner_idx;td.className='dg';td.style.display='none';if(fb_result!=1&&fb_result!=2&&age!=''){td.appendChild(document.createTextNode(age));if(weight!=''){td.appendChild(document.createElement('br'));td.appendChild(document.createTextNode(weight))}}else td.appendChild(document.createTextNode(' '));return td}
function do_previous_odds(ev_id,runner_idx,fb_result,previous_odds){var td=document.createElement('td');td.id='cell_previous_'+ev_id+'_'+runner_idx;td.className='dg';td.style.display='none';if(fb_result!='N'&&fb_result!='V'&&fb_result!='W'&&previous_odds!=''){td.appendChild(document.createTextNode(previous_odds))}else td.appendChild(document.createTextNode(' '));return td}
function do_market(ev_id,runner_idx,mkt_idx,fb_result,runner_cell_class,runner_odds_class,shp_avail,sp_avail,lp_avail,runner_status,race_status,ev_oc_id,price_string,runner_odds,is_american,mkt_cell_class,previous_odds,is_greyhounds){var td=document.createElement('td');td.id='cell_market_'+ev_id+'_'+runner_idx+'_'+mkt_idx;td.style.display='none';if(is_greyhounds=='Y')if(lp_avail=='Y')td.colSpan=2;if(fb_result=='N'||fb_result=='V'||fb_result=='W'){td.className=mkt_cell_class+' c';td.appendChild(document.createTextNode(racing_msg_non_runner))}else{td.className=runner_cell_class+' cellfix nostyle';var table=document.createElement('table');table.style.width='100%';table.style.height='100%';table.cellspacing=0;table.cellpadding=0;table.border=0;var tbody=document.createElement('tbody'),tr=document.createElement('tr');if(is_american=='N'){var td1=document.createElement('td');td1.style.width='60%';td1.className=runner_odds_class;var ul=document.createElement('ul');ul.className='dd-tv';var li=document.createElement('li');if(shp_avail=='Y'){if(runner_status!='S'&&race_status==1){var li_a=document.createElement('a');li_a.href="javascript:do_racecard_bet("+ev_oc_id+",'"+price_string+"');";if(is_greyhounds!='Y')li_a.className='blue';li_a.appendChild(document.createTextNode(runner_odds));li.appendChild(li_a)}else{var li_font=document.createElement('font');li_font.color='gray';li_font.appendChild(document.createTextNode(runner_odds));li.appendChild(li_font)}}else if(fb_result=='X'){li.appendChild(document.createTextNode(racing_msg_betting_without))}else if(fb_result=='R'||fb_result=='D'){var li_font=document.createElement('font');li_font.color='gray';li_font.appendChild(document.createTextNode(runner_odds));li.appendChild(li_font)}else if(runner_status!='S'&&race_status==1){var li_a=document.createElement('a');li_a.href="javascript:do_racecard_bet("+ev_oc_id+",'"+price_string+"');";li_a.appendChild(document.createTextNode(runner_odds));li.appendChild(li_a)}else{var li_font=document.createElement('font');li_font.color='gray';li_font.appendChild(document.createTextNode(runner_odds));li.appendChild(li_font)};if(lp_avail=='Y'&&previous_odds!=''&&mkt_idx==0){var ul_prev=document.createElement('ul'),li_prev=document.createElement('li');if(shp_avail=='Y'&&is_greyhounds!='Y')li_prev.className='blue';li_prev.appendChild(document.createTextNode(racing_msg_odds_history+': '+previous_odds));ul_prev.appendChild(li_prev);li.appendChild(ul_prev)};ul.appendChild(li);td1.appendChild(ul);tr.appendChild(td1)};if(sp_avail=='Y'&&(is_american=='Y'||lp_avail=='Y')){var td2=document.createElement('td');td2.style.borderLeft='1px solid #ccc';var ul_sp=document.createElement('ul');ul_sp.className='dd-tv';var li_sp=document.createElement('li');if(runner_status!='S'&&race_status==1){var li_sp_a=document.createElement('a');li_sp_a.href="javascript:do_racecard_bet("+ev_oc_id+",'S');";li_sp_a.appendChild(document.createTextNode('SP'));li_sp.appendChild(li_sp_a)}else{var li_sp_f=document.createElement('font');li_sp_f.color='gray';li_sp_f.appendChild(document.createTextNode('SP'));li_sp.appendChild(li_sp_f)};ul_sp.appendChild(li_sp);td2.appendChild(ul_sp);tr.appendChild(td2)};tbody.appendChild(tr);table.appendChild(tbody);td.appendChild(table)};return td}
function do_fore_tricast_odds(ev_id,runner_idx,mkt_cell_class,runner_odds,runner_status,fb_result){var td=document.createElement('td');td.id='cell_fctc_odds_'+ev_id+'_'+runner_idx;td.className=mkt_cell_class;td.style.display='none';if(fb_result!=1&&fb_result!=2&&fb_result!='N'&&fb_result!='V'&&fb_result!='W'&&runner_status!='S'&&runner_odds!='SP'&&runner_status!='S'&&runner_odds!=''){td.appendChild(document.createTextNode(runner_odds))}else td.appendChild(document.createTextNode(' '));return td}
function do_fore_tricasts(ev_id,runner_idx,fb_result,runner_idx_incr,ev_oc_id,runner_status,fc_avail,tc_avail,num_runners,is_greyhounds){var ft_td=document.createElement('td');ft_td.id='cell_fore_tricast_'+ev_id+'_'+runner_idx;ft_td.className='nostyle';ft_td.style.width='255px';ft_td.style.display='none';ft_td.style.fontSize='9px';var ft_table=document.createElement('table');ft_table.style.borderCollapse='separate';ft_table.style.borderSpacing='1px 0';ft_table.width='100%';ft_table.cellspacing=0;ft_table.cellpadding=0;ft_table.border=0;var ft_tbody=document.createElement('tbody'),ft_tr=document.createElement('tr'),fc_td1=document.createElement('td');fc_td1.style.padding=0;fc_td1.style.width='32px';fc_td1.className='c';var fc_td2=document.createElement('td');fc_td2.style.padding=0;fc_td2.style.width='32px';fc_td2.className='c';var fc_tdA=document.createElement('td');fc_tdA.style.padding=0;fc_tdA.style.width='35px';fc_tdA.className='c';var tc_td1=document.createElement('td');tc_td1.style.padding=0;tc_td1.style.width='32px';tc_td1.className='c ddg';var tc_td2=document.createElement('td');tc_td2.style.padding=0;tc_td2.style.width='32px';tc_td2.className='c ddg';var tc_td3=document.createElement('td');tc_td3.style.padding=0;tc_td3.style.width='32px';tc_td3.className='c ddg';var tc_tdA=document.createElement('td');tc_tdA.style.padding=0;tc_tdA.style.width='35px';tc_tdA.className='c ddg';var fc_input1_hidden='<input type=hidden name=tfcastf_'+runner_idx_incr+'_1_'+ev_id+' id=tfcastf_'+runner_idx_incr+'_1_'+ev_id+' value='+ev_oc_id+'>',fc_input2_hidden='<input type=hidden name=tfcastf_'+runner_idx_incr+'_2_'+ev_id+' id=tfcastf_'+runner_idx_incr+'_2_'+ev_id+' value='+ev_oc_id+'>',fc_inputA_hidden='<input type=hidden name=tfcastf_'+runner_idx_incr+'_A_'+ev_id+' id=tfcastf_'+runner_idx_incr+'_A_'+ev_id+' value='+ev_oc_id+'>',tc_input1_hidden='<input type=hidden name=tfcastt_'+runner_idx_incr+'_1_'+ev_id+' id=tfcastt_'+runner_idx_incr+'_1_'+ev_id+' value='+ev_oc_id+'>',tc_input2_hidden='<input type=hidden name=tfcastt_'+runner_idx_incr+'_2_'+ev_id+' id=tfcastt_'+runner_idx_incr+'_2_'+ev_id+' value='+ev_oc_id+'>',tc_input3_hidden='<input type=hidden name=tfcastt_'+runner_idx_incr+'_3_'+ev_id+' id=tfcastt_'+runner_idx_incr+'_3_'+ev_id+' value='+ev_oc_id+'>',tc_inputA_hidden='<input type=hidden name=tfcastt_'+runner_idx_incr+'_A_'+ev_id+' id=tfcastt_'+runner_idx_incr+'_A_'+ev_id+' value='+ev_oc_id+'>',fc_input1_check='<input type=checkbox name=tfcastf_'+runner_idx_incr+'_1_'+ev_id+' id=tfcastf_'+runner_idx_incr+'_1_'+ev_id+' value='+ev_oc_id+' onclick="checkLimits(\'f\','+runner_idx_incr+',\'1\','+num_runners+','+ev_id+');">',fc_input2_check='<input type=checkbox name=tfcastf_'+runner_idx_incr+'_2_'+ev_id+' id=tfcastf_'+runner_idx_incr+'_2_'+ev_id+' value='+ev_oc_id+' onclick="checkLimits(\'f\','+runner_idx_incr+',\'2\','+num_runners+','+ev_id+');">',fc_inputA_check='<input type=checkbox name=tfcastf_'+runner_idx_incr+'_A_'+ev_id+' id=tfcastf_'+runner_idx_incr+'_A_'+ev_id+' value='+ev_oc_id+' onclick="checkLimits(\'f\','+runner_idx_incr+',\'A\','+num_runners+','+ev_id+');">',tc_input1_check='<input type=checkbox name=tfcastt_'+runner_idx_incr+'_1_'+ev_id+' id=tfcastt_'+runner_idx_incr+'_1_'+ev_id+' value='+ev_oc_id+' onclick="checkLimits(\'t\','+runner_idx_incr+',\'1\','+num_runners+','+ev_id+');">',tc_input2_check='<input type=checkbox name=tfcastt_'+runner_idx_incr+'_2_'+ev_id+' id=tfcastt_'+runner_idx_incr+'_2_'+ev_id+' value='+ev_oc_id+' onclick="checkLimits(\'t\','+runner_idx_incr+',\'2\','+num_runners+','+ev_id+');">',tc_input3_check='<input type=checkbox name=tfcastt_'+runner_idx_incr+'_3_'+ev_id+' id=tfcastt_'+runner_idx_incr+'_3_'+ev_id+' value='+ev_oc_id+' onclick="checkLimits(\'t\','+runner_idx_incr+',\'3\','+num_runners+','+ev_id+');">',tc_inputA_check='<input type=checkbox name=tfcastt_'+runner_idx_incr+'_A_'+ev_id+' id=tfcastt_'+runner_idx_incr+'_A_'+ev_id+' value='+ev_oc_id+' onclick="checkLimits(\'t\','+runner_idx_incr+',\'A\','+num_runners+','+ev_id+');">';if(fb_result==1||fb_result==2){ft_td.innerHTML=fc_input1_hidden+fc_input2_hidden+fc_inputA_hidden+tc_input1_hidden+tc_input2_hidden+tc_input3_hidden+tc_inputA_hidden;ft_td.appendChild(document.createTextNode(racing_msg_fc_tc_unamed_fav));return ft_td}else if(fb_result=='N'||fb_result=='V'||fb_result=='W'||runner_status=='S')if(is_greyhounds=='Y'){var fc_input1_check='<input type=checkbox DISABLED name=tfcastf_'+runner_idx_incr+'_1_'+ev_id+' id=tfcastf_'+runner_idx_incr+'_1_'+ev_id+' value='+ev_oc_id+'>',fc_input2_check='<input type=checkbox DISABLED name=tfcastf_'+runner_idx_incr+'_2_'+ev_id+' id=tfcastf_'+runner_idx_incr+'_2_'+ev_id+' value='+ev_oc_id+'>',fc_inputA_check='<input type=checkbox DISABLED name=tfcastf_'+runner_idx_incr+'_A_'+ev_id+' id=tfcastf_'+runner_idx_incr+'_A_'+ev_id+' value='+ev_oc_id+'>',tc_input1_check='<input type=checkbox DISABLED name=tfcastt_'+runner_idx_incr+'_1_'+ev_id+' id=tfcastt_'+runner_idx_incr+'_1_'+ev_id+' value='+ev_oc_id+'>',tc_input2_check='<input type=checkbox DISABLED name=tfcastt_'+runner_idx_incr+'_2_'+ev_id+' id=tfcastt_'+runner_idx_incr+'_2_'+ev_id+' value='+ev_oc_id+'>',tc_input3_check='<input type=checkbox DISABLED name=tfcastt_'+runner_idx_incr+'_3_'+ev_id+' id=tfcastt_'+runner_idx_incr+'_3_'+ev_id+' value='+ev_oc_id+'>',tc_inputA_check='<input type=checkbox DISABLED name=tfcastt_'+runner_idx_incr+'_A_'+ev_id+' id=tfcastt_'+runner_idx_incr+'_A_'+ev_id+' value='+ev_oc_id+'>';ft_td.innerHTML=fc_input1_hidden+fc_input2_hidden+fc_inputA_hidden+tc_input1_hidden+tc_input2_hidden+tc_input3_hidden+tc_inputA_hidden}else{ft_td.innerHTML=fc_input1_hidden+fc_input2_hidden+fc_inputA_hidden+tc_input1_hidden+tc_input2_hidden+tc_input3_hidden+tc_inputA_hidden;ft_td.appendChild(document.createTextNode(racing_msg_non_runner));return ft_td};if(fc_avail=='Y'){fc_td1.innerHTML=fc_input1_check;fc_td2.innerHTML=fc_input2_check;fc_tdA.innerHTML=fc_inputA_check;ft_tr.appendChild(fc_td1);ft_tr.appendChild(fc_td2);ft_tr.appendChild(fc_tdA)}else{fc_td1.innerHTML=fc_input1_hidden+fc_input2_hidden+fc_inputA_hidden;fc_td1.style.width='101px';ft_tr.appendChild(fc_td1)};if(tc_avail=='Y'){tc_td1.innerHTML=tc_input1_check;tc_td2.innerHTML=tc_input2_check;tc_td3.innerHTML=tc_input3_check;tc_tdA.innerHTML=tc_inputA_check;ft_tr.appendChild(tc_td1);ft_tr.appendChild(tc_td2);ft_tr.appendChild(tc_td3);ft_tr.appendChild(tc_tdA)}else{tc_td1.innerHTML=tc_input1_hidden+tc_input2_hidden+tc_input3_hidden+tc_inputA_hidden;tc_td1.style.width='143px';ft_tr.appendChild(tc_td1)};ft_tbody.appendChild(ft_tr);ft_table.appendChild(ft_tbody);ft_td.appendChild(ft_table);return ft_td}
function do_runner_single(ev_id,ev_oc_id,fb_result,jockey,trainer){var show_row=1;if(filter_type=="J"){if(filter_text!=jockey)show_row=0}else if(filter_type=="T")if(filter_text!=trainer)show_row=0;row=document.getElementById("seln_row_"+ev_id+"_"+ev_oc_id);if(show_row!=1&&fb_result!=1&&fb_result!=2){var filtered_list=filtered_hash[ev_id];if(filtered_list!=null){filtered_list.push(ev_oc_id);filtered_hash[ev_id]=filtered_list}else{filtered_list=[];filtered_list.push(ev_oc_id);filtered_hash[ev_id]=filtered_list};row.style.display="none"}};var PriceMap_Data={},HomeAway_Scores={},CorrectScoreLpNum={},CorrectScoreLpDen={},CorrectScoreEvOcs={},ScorecastCsEvOcs={},ScorecastFsEvOcs={},FirstScorerNames={},LastScorerNames={},FirstScorerValues={},LastScorerValues={},ScorecastFsNames={},CorrectScoreMBSChoices={},LastScorerMBSChoices={},FirstScorerMBSChoices={},ScorecastMBSChoices={},_fb_cfg={},_current_mbs_type="",maximum_score_limit=-1
function setMaximumScoreLimit(m_score_value){var tmp_score_limit=parseInt(m_score_value,10);if(!isNaN(tmp_score_limit))maximum_score_limit=tmp_score_limit}
function increase_score(field_id,homeaway,ev_name){if($j('.score_toggle').hasClass('disabled'))return;var field=document.getElementById(field_id);if(!field)return;if((maximum_score_limit>=0)&&((parseInt(field.value,10)+1)>maximum_score_limit))return;field.value=parseInt(field.value,10)+1}
function decrease_score(field_id,homeaway,ev_name){if($j('.score_toggle').hasClass('disabled'))return;var field=document.getElementById(field_id);if(!field)return;var val=parseInt(field.value,10);if(val>0)field.value=val-1}
function update_odds(ev_id,ev_name){var type=document.getElementById('selected_mbs_market_'+ev_id).value;switch(type){case'SC':get_scorecast_odds(ev_id,ev_name);break;case'CS':get_correct_score_odds(ev_id);break;case'FS':get_first_scorer_odds(ev_id,ev_name);break;case'LS':get_last_scorer_odds(ev_id,ev_name);break;default:document.getElementById('bet_now_odds'+ev_id).innerHTML=na;break}}
function get_scorecast_odds(ev_id,ev_name){var player=document.getElementById('scorer_details_'+ev_id).value,home_score=document.getElementById('home_score_'+ev_id).value,away_score=document.getElementById('away_score_'+ev_id).value,player_name=ScorecastFsNames[ev_id][player],home_away_idx=home_score+'-'+away_score,score_idx=HomeAway_Scores[ev_id][home_away_idx];player='p'+player+'_'+score_idx;if(PriceMap_Data[ev_id][player]==undefined){document.getElementById('bet_now_odds_'+ev_id).innerHTML=na}else{var player_odds=PriceMap_Data[ev_id][player];document.getElementById('bet_now_odds_'+ev_id).innerHTML=_fb_get_price_str(_fb_cfg,player_odds,'1','Y','SC')}}
function get_first_scorer_odds(ev_id,ev_name){var first_scorer_details=document.getElementById('scorer_details_'+ev_id).value,first_scorer_details_array=first_scorer_details.split('::'),first_scorer_ev_oc_id=first_scorer_details_array[0],first_scorer_lp_num=first_scorer_details_array[1],first_scorer_lp_den=first_scorer_details_array[2],first_scorer_sort=first_scorer_details_array[3],first_scorer_index=first_scorer_details_array[4],player_name=FirstScorerNames[ev_id][first_scorer_index];document.getElementById('bet_now_odds_'+ev_id).innerHTML=_fb_get_price_str(_fb_cfg,first_scorer_lp_num,first_scorer_lp_den,'Y',first_scorer_sort)}
function get_last_scorer_odds(ev_id,ev_name){var last_scorer_details=document.getElementById('scorer_details_'+ev_id).value,last_scorer_details_array=last_scorer_details.split('::'),last_scorer_ev_oc_id=last_scorer_details_array[0],last_scorer_lp_num=last_scorer_details_array[1],last_scorer_lp_den=last_scorer_details_array[2],last_scorer_sort=last_scorer_details_array[3],last_scorer_index=last_scorer_details_array[4],player_name=LastScorerNames[ev_id][last_scorer_index];document.getElementById('bet_now_odds_'+ev_id).innerHTML=_fb_get_price_str(_fb_cfg,last_scorer_lp_num,last_scorer_lp_den,'Y',last_scorer_sort)}
function get_correct_score_odds(ev_id){var correct_home_score=document.getElementById('home_score_'+ev_id).value,correct_away_score=document.getElementById('away_score_'+ev_id).value,score=correct_home_score+'-'+correct_away_score;if((CorrectScoreLpDen[ev_id][score]==undefined)||(CorrectScoreLpNum[ev_id][score]==undefined)){document.getElementById('bet_now_odds_'+ev_id).innerHTML=na}else document.getElementById('bet_now_odds_'+ev_id).innerHTML=_fb_get_price_str(_fb_cfg,CorrectScoreLpNum[ev_id][score],CorrectScoreLpDen[ev_id][score],'Y','CS')}
function place_mbs_bet(ev_id,is_event_page){var type=document.getElementById('selected_mbs_market_'+ev_id).value,odds=document.getElementById('bet_now_odds_'+ev_id).innerHTML,scorer_details,ev_oc_id,lp_num,lp_den,price_type='';if(typeof na=='undefined')var na='N/A';if(odds==na)return false;if(type=='FS'){scorer_details=document.getElementById('scorer_details_'+ev_id).value;var scorer_details_array=scorer_details.split('::');ev_oc_id=scorer_details_array[0];lp_num=scorer_details_array[1];lp_den=scorer_details_array[2]}else if(type=='LS'){scorer_details=document.getElementById('scorer_details_'+ev_id).value;var scorer_details_array=scorer_details.split('::');ev_oc_id=scorer_details_array[0];lp_num=scorer_details_array[1];lp_den=scorer_details_array[2]}else if(type=='CS'||type=='CS_accordion'){var correct_home_score=document.getElementById('home_score_'+ev_id).value,correct_away_score=document.getElementById('away_score_'+ev_id).value,score=correct_home_score+'-'+correct_away_score;ev_oc_id=CorrectScoreEvOcs[ev_id][score];lp_num=CorrectScoreLpNum[ev_id][score];lp_den=CorrectScoreLpDen[ev_id][score]}else if(type=='SC'){var player_idx=document.getElementById('scorer_details_'+ev_id).value,home_score=document.getElementById('home_score_'+ev_id).value,away_score=document.getElementById('away_score_'+ev_id).value,home_away_idx=home_score+'-'+away_score,score_idx=HomeAway_Scores[ev_id][home_away_idx];player='p'+player_idx+'_'+score_idx;var lp_num=PriceMap_Data[ev_id][player];lp_den=1;ev_oc_id=ScorecastFsEvOcs[ev_id][player_idx]+'c'+ScorecastCsEvOcs[ev_id][home_away_idx];price_type='L';BS_set_leg('leg_sort','SC')};BS_set_leg('price_type',price_type);BS_set_leg('lp_num',lp_num);BS_set_leg('lp_den',lp_den);BS_set_leg('selections',ev_oc_id);if(!is_event_page)if(typeof collate_name!=='undefined')BS_set_leg('bet_origin',collate_name+'-MKT');var choices_elem=document.getElementById("mbs_multichoice_select_"+ev_id);if(typeof choices_elem!="undefined"&&choices_elem!=null&&choices_elem!=""){var selected_choice=choices_elem.options[choices_elem.selectedIndex].value;BS_set_leg('link_list','SOC-'+selected_choice);BS_set_leg('bet_origin','MC_MBS_FB_EV_'+ev_id)};BS_go_bet()}
function mbs_display(ev_id,ev_name,cfg){for(var f in cfg)_fb_cfg[f]=cfg[f];var MarketSorts=_fb_cfg.mbs_mkt_sorts;MarketSorts=MarketSorts.replace(/\s+/g,' ');var marketsorts=MarketSorts.split(' ');for(i=0;i<marketsorts.length;i++){var radio_button=marketsorts[i]+'_radio_'+ev_id,radio_button_id=marketsorts[i]+'_r_'+ev_id;document.getElementById(radio_button).style.display='inline';if(i==0){var field=document.getElementById(radio_button_id);field.checked=true;toggle_mbs(field,ev_id,ev_name)}};document.getElementById('home_score_'+ev_id).value=1;document.getElementById('away_score_'+ev_id).value=1;update_odds(ev_id,ev_name)}
function toggle_mbs(mbs_type,ev_id,ev_name){var score_toggle_field=document.getElementById('score_toggle_'+ev_id),goalscorer_field=document.getElementById('score_dropdown_'+ev_id),player_dropdown=document.getElementById('scorer_details_'+ev_id),goalscorer_text=document.getElementById('goalscorer_text_'+ev_id);document.getElementById('selected_mbs_market_'+ev_id).value=mbs_type.value;if(mbs_type.value=='SC'||mbs_type.value=='CS'){score_toggle_field.className='score_toggle enabled';score_toggle_field.disabled=false}else{score_toggle_field.className='score_toggle disabled';score_toggle_field.disabled=true};if(mbs_type.value=='SC'){player_dropdown.disabled=false;player_dropdown.options.length=0;for(i=0;i<ScorecastFsNames[ev_id].length;i++){var option=document.createElement('option'),textNode=document.createTextNode(ScorecastFsNames[ev_id][i]);option.appendChild(textNode);option.value=i;player_dropdown.appendChild(option)};goalscorer_text.innerHTML=first_scorer;goalscorer_field.className='score_dropdown enabled';_current_mbs_type="scorecast";fb_mbs_build_choices(ScorecastMBSChoices[ev_id],ev_id)}else if(mbs_type.value=='FS'){player_dropdown.disabled=false;player_dropdown.options.length=0;for(i=0;i<FirstScorerNames[ev_id].length;i++){var option=document.createElement('option'),textNode=document.createTextNode(FirstScorerNames[ev_id][i]);option.appendChild(textNode);option.value=FirstScorerValues[ev_id][i]+"::"+i;player_dropdown.appendChild(option)};var default_seln_id=_fb_cfg.default_seln_fs;player_dropdown.selectedIndex=default_seln_id;goalscorer_text.innerHTML=first_scorer;goalscorer_field.className='score_dropdown enabled';_current_mbs_type="firstgoalscorer";fb_mbs_build_choices(FirstScorerMBSChoices[ev_id],ev_id)}else if(mbs_type.value=='LS'){player_dropdown.disabled=false;player_dropdown.options.length=0;for(i=0;i<LastScorerNames[ev_id].length;i++){var option=document.createElement('option'),textNode=document.createTextNode(LastScorerNames[ev_id][i]);option.appendChild(textNode);option.value=LastScorerValues[ev_id][i]+"::"+i;player_dropdown.appendChild(option)};var default_seln_id=_fb_cfg.default_seln_ls;player_dropdown.selectedIndex=default_seln_id;goalscorer_text.innerHTML=last_scorer;goalscorer_field.className='score_dropdown enabled';_current_mbs_type="lastgoalscorer";fb_mbs_build_choices(LastScorerMBSChoices[ev_id],ev_id)}else{player_dropdown.disabled=true;player_dropdown.options[0]=new Option(na,0,true,true);player_dropdown.options.length=1;goalscorer_field.className='score_dropdown disabled';_current_mbs_type="correctscore";fb_mbs_build_choices(CorrectScoreMBSChoices[ev_id],ev_id)};var MarketSorts=_fb_cfg.mbs_mkt_sorts;MarketSorts=MarketSorts.replace(/\s+/g,' ');var marketsorts=MarketSorts.split(' ');for(var i=0;i<marketsorts.length;i++)if(mbs_type.value==marketsorts[i]){document.getElementById(marketsorts[i]+'_li_'+ev_id).className='current-mbs-cat'}else document.getElementById(marketsorts[i]+'_li_'+ev_id).className='';update_odds(ev_id,ev_name)}
function fb_mbs_build_choices(choices,ev_id){if(typeof choices=="undefined"||choices.length==0)return;var choices_select=document.getElementById("mbs_multichoice_select_"+ev_id);if(typeof choices_select=="undefined")return;choices_select.options.length=0;for(var i=0;i<choices.length;i++){var option=document.createElement("option");option.text=choices[i].desc;option.value=choices[i].id;choices_select.add(option,i)}}
function fb_mbs_mkts_generic_lightbox(id){$j(function(){$j("#"+id).dialog({autoOpen:false,height:307,width:704,modal:true,closeText:fb_mbs_mkts_dialog_close_txt,dialogClass:'team-info-modal',buttons:{},close:function(){$j("#"+id).val("").removeClass("ui-state-error")}});$j(document).ready(function(){$j("#"+id).dialog("open");$j(".team-info-modal").css("height","307px")})})};var fb_hp_upper_acc=function(){var getDate=function(){var current_time=new Date(),diff=current_time-page_load_time,current_server_time=new Date();current_server_time.setTime(server_clock_timejs.getTime()+diff);return Date.parse(current_server_time)},cfg={lang:""},data={items:[{type:"PROMOS"},{type:"QUICK_LINKS"},{type:"TOP_BETS"},{type:"CORRECT_SCORE"},{type:"REC_BETS"}]},hash={events:{},markets:{},selns:{}},getData=function(){return $j.extend(true,{},data)},setCfg=function(cfg_vals){for(var f in cfg_vals)cfg[f]=cfg_vals[f]},_hashDataInit=function(events,markets,selections){for(var i=0;i<selections.length;i++)_hashSeln(selections[i]);for(var i=0;i<markets.length;i++)_hashMarket(markets[i]);for(var i=0;i<events.length;i++)_hashEvent(events[i])},_hashEvent=function(event){var ev_id=event.ev_id,ev_hash=hash.events[ev_id];if(!ev_hash){hash.events[ev_id]={data:{},refs:{}};for(var f in event)hash.events[ev_id].data[f]=event[f];hash.events[ev_id].data.js_start_time=time_in_milliseconds(hash.events[ev_id].data.start_time);var live_channels=[];live_channels.push("sEVENT"+ps_connect_lpad_id(ev_id));live_channels.push("SEVENT"+ps_connect_lpad_id(ev_id));var msg_id=event.msg_id;ps_connect_register("fb_uacc_event_"+ev_id,gotPushData,live_channels,msg_id);return 0};return 1},_hashMarket=function(market){var ev_mkt_id=market.ev_mkt_id,mkt_hash=hash.markets[ev_mkt_id];if(!mkt_hash){hash.markets[ev_mkt_id]={data:{},refs:{}};for(var f in market)hash.markets[ev_mkt_id].data[f]=market[f];return 0};return 1},_hashSeln=function(seln){var ev_oc_id=seln.ev_oc_id,seln_hash=hash.selns[ev_oc_id];if(!seln_hash){hash.selns[ev_oc_id]={data:{},refs:{}};for(var f in seln)hash.selns[ev_oc_id].data[f]=seln[f];return 0};return 1},_isEmpty=function(obj){for(var i in obj)return false;return true},_wipeRefs=function(){for(var ev_id in hash.events)hash.events[ev_id].refs={};for(var ev_mkt_id in hash.markets)hash.markets[ev_mkt_id].refs={};for(var ev_oc_id in hash.selns)hash.selns[ev_oc_id].refs={}},_cleanHash=function(){for(var ev_id in hash.events)if(_isEmpty(hash.events[ev_id].refs)){delete hash.events[ev_id];ps_connect_deregister('fb_uacc_event_'+ev_id)};for(var ev_mkt_id in hash.markets)if(_isEmpty(hash.markets[ev_mkt_id].refs))delete hash.markets[ev_mkt_id];for(var ev_oc_id in hash.selns)if(_isEmpty(hash.selns[ev_oc_id].refs))delete hash.selns[ev_oc_id]},gotPushData=function(msg){var push_data={};switch(msg.subject_level){case"sPRICE":case"sSELCN":eval("push_data = "+msg.data+";");var ev_oc_id=msg.subject_id;gotSelectionData(ev_oc_id,push_data);break;case"sMHCAP":case"sEVMKT":eval("push_data = "+msg.data+";");var ev_mkt_id=msg.subject_id;gotMarketData(ev_mkt_id,push_data);break;case"sEVENT":eval("push_data = "+msg.data+";");var ev_id=msg.subject_id;gotEventData(ev_id,push_data);break;default:};return},gotEventData=function(ev_id,event_data){var ev_hash=hash.events[ev_id];if(!ev_hash){ps_connect_deregister('fb_uacc_event_'+ev_id);return};for(var f in event_data)ev_hash.data[f]=event_data[f];ev_hash.data.js_start_time=time_in_milliseconds(ev_hash.data.start_time);for(var ref_key in ev_hash.refs)switch(ref_key.substr(0,2)){case"PR":gotPromosEventData(ev_hash.refs[ref_key]);break;case"QL":gotQuicklinkEvent(ev_hash.refs[ref_key]);break;case"TB":switch(ref_key.substr(2,3)){case"TRE":gotTopBetsSimpleSeln(ev_hash.refs[ref_key],"TREND");break;case"SGL":gotTopBetsSimpleSeln(ev_hash.refs[ref_key],"SGL");break;case"DBL":case"ACC":gotTopBetsMult(ev_hash.refs[ref_key]);break;default:continue};break;case"CS":gotCScoreEventData(ev_hash.refs[ref_key]);break;default:continue};notifyUpdate()},gotMarketData=function(ev_mkt_id,mkt_data){var mkt_hash=hash.markets[ev_mkt_id];if(!mkt_hash){mkt_data.ev_mkt_id=ev_mkt_id;_hashMarket(mkt_data);return};for(var f in mkt_data)mkt_hash.data[f]=mkt_data[f];for(var ref_key in mkt_hash.refs)switch(ref_key.substr(0,2)){case"PR":continue;case"QL":gotQuicklinkMarket(mkt_hash.refs[ref_key]);break;case"TB":switch(ref_key.substr(2,3)){case"TRE":gotTopBetsSimpleSeln(mkt_hash.refs[ref_key],"TREND");break;case"SGL":gotTopBetsSimpleSeln(mkt_hash.refs[ref_key],"SGL");break;case"DBL":case"ACC":gotTopBetsMult(mkt_hash.refs[ref_key]);break;default:continue};break;case"CS":gotCScoreMarketData(mkt_hash.refs[ref_key]);break;default:continue};notifyUpdate()},gotSelectionData=function(ev_oc_id,seln_data){var seln_hash=hash.selns[ev_oc_id];if(!seln_hash){seln_data.ev_oc_id=ev_oc_id;_hashSeln(seln_data);return};for(var f in seln_data)seln_hash.data[f]=seln_data[f];for(var ref_key in seln_hash.refs)switch(ref_key.substr(0,2)){case"PR":continue;case"QL":continue;case"TB":switch(ref_key.substr(2,3)){case"TRE":gotTopBetsSimpleSeln(seln_hash.refs[ref_key],"TREND");break;case"SGL":gotTopBetsSimpleSeln(seln_hash.refs[ref_key],"SGL");break;case"DBL":case"ACC":gotTopBetsMult(seln_hash.refs[ref_key]);break;default:continue};break;case"CS":continue;default:continue};notifyUpdate()},initPromotions=function(events,promo_items,common_data){var promo_data=data.items[0];for(var f in common_data)promo_data[f]=common_data[f];_hashDataInit(events,"","");promo_data.promo_items=promo_items;for(var i=0;i<promo_data.promo_items.length;i++)if(promo_data.promo_items[i].link_level=='EVENT')gotPromosEventData(promo_data.promo_items[i]);promo_data.last_update=Date.parse(Date())/1e3},gotPromosEventData=function(promo){var promo_data=data.items[0],ev_id=promo.link_id,event=hash.events[ev_id],promo_hash=event.refs["PR"+ev_id+promo.order];if(!promo_hash){hash.events[ev_id].refs["PR"+ev_id+promo.order]=promo}else promo_data.last_update=Date.parse(Date())/1e3;if(event.data.displayed=="Y"&&event.data.status=="A"&&(event.data.js_start_time>=getDate()||event.data.is_off=="Y")){promo.displayed="Y"}else promo.displayed="N"},initQuickLinks=function(basic_data,link_data,events,markets){var ql_data=data.items[1];for(var f in basic_data)ql_data[f]=basic_data[f];_hashDataInit(events,markets,"");ql_data.quick_links=link_data;for(var i=0;i<ql_data.quick_links.length;i++){if(ql_data.quick_links[i].ev_id)gotQuicklinkEvent(ql_data.quick_links[i]);if(ql_data.quick_links[i].ev_mkt_id)gotQuicklinkMarket(ql_data.quick_links[i])};ql_data.last_update=Date.parse(Date())/1e3},isMoneyBackSpecial=function(event_data){var suspend_date=Date.parse(new Date(event_data.suspend_at.replace(/-/g,"/")));return((event_data.suspend_at==""||suspend_date>=getDate())&&(((event_data.special_type=="MBR"||event_data.special_type=="MBS")&&event_data.is_off=="Y")||((event_data.special_type=="MBN"||event_data.special_type=="MBS")&&event_data.is_off!="Y"&&event_data.js_start_time>=getDate())))},isMBSForTopBets=function(event_data){var suspend_date=Date.parse(new Date(event_data.suspend_at.replace(/-/g,"/")));return((event_data.suspend_at==""||suspend_date>=getDate())&&(event_data.special_type=="MBN"||event_data.special_type=="MBS")&&event_data.is_off!="Y"&&event_data.js_start_time>=getDate())},gotQuicklinkEvent=function(link){var links_data=data.items[1],ev_id=link.ev_id,event=hash.events[ev_id],link_hash=event.refs["QL"+link.disporder];if(!link_hash){hash.events[ev_id].refs["QL"+link.disporder]=link}else links_data.last_update=Date.parse(Date())/1e3;if(isMoneyBackSpecial(event.data)){link.category="MBS"}else link.category="SOCCER";link.title=event.data.names[cfg.lang];link.start_time=event.data.start_time;if(event.data.displayed=="Y"&&event.data.status=="A"&&(event.data.js_start_time>=getDate()||event.data.is_off=="Y")){link.displayed="Y"}else link.displayed="N"},gotQuicklinkMarket=function(link){var links_data=data.items[1],ev_mkt_id=link.ev_mkt_id,market=hash.markets[ev_mkt_id],ev_id=market.data.ev_id,event=hash.events[ev_id],link_hash=market.refs["QL"+link.disporder];if(!link_hash){hash.events[ev_id].refs["QL"+link.disporder]=link;hash.markets[ev_mkt_id].refs["QL"+link.disporder]=link}else links_data.last_update=Date.parse(Date())/1e3;link.category="SOCCER";link.title=market.data.names[cfg.lang];link.sub_title=event.data.names[cfg.lang];link.start_time=event.data.start_time;if(event.data.displayed=="Y"&&event.data.status=="A"&&(event.data.js_start_time>=getDate()||event.data.is_off=="Y")&&market.data.displayed=="Y"&&market.data.status=="A"){link.displayed="Y"}else link.displayed="N"},initTopBets=function(basic_data,trending_data,singles_data,doubles_data,accums_data){var topbet_data=data.items[2];for(var f in basic_data)topbet_data[f]=basic_data[f];delete topbet_data.trend_bets;delete topbet_data.single_bets;delete topbet_data.double_bets;delete topbet_data.accum_bets;if(trending_data.length!=0){topbet_data.trend_bets=[];initTopBetsSimple(trending_data,"TREND")};if(singles_data.length!=0){topbet_data.single_bets=[];initTopBetsSimple(singles_data,"SGL")};if(doubles_data.length!=0){topbet_data.double_bets=[];initTopBetsMults(doubles_data)};if(accums_data.length!=0){topbet_data.accum_bets=[];initTopBetsMults(accums_data)};topbet_data.last_update=Date.parse(Date())/1e3},initTopBetsSimple=function(simple_data,type){var topbet_data=data.items[2];switch(type){case"TREND":bet_data=topbet_data.trend_bets;break;case"SGL":bet_data=topbet_data.single_bets;break;default:return};var events=simple_data[0],markets=simple_data[1],selns=simple_data[2],bets=simple_data[3];_hashDataInit(events,markets,selns);for(var i=0;i<bets.length;i++)gotTopBetsSimpleSeln(bets[i],type)},gotTopBetsSimpleSeln=function(simple_data,type){var topbet_data=data.items[2];switch(type){case"TREND":bet_data=topbet_data.trend_bets;break;case"SGL":bet_data=topbet_data.single_bets;break;default:return};var ev_oc_id=simple_data.ev_oc_id,seln=hash.selns[ev_oc_id],market=hash.markets[seln.data.ev_mkt_id],event=hash.events[seln.data.ev_id],seln_hash=seln.refs["TB"+type+ev_oc_id];if(!seln_hash){seln_hash={};seln_hash.ev_oc_id=simple_data.ev_oc_id;seln_hash.order=simple_data.order;bet_data.push(seln_hash);hash.selns[ev_oc_id].refs["TB"+type+ev_oc_id]=seln_hash;hash.markets[seln.data.ev_mkt_id].refs["TB"+type+ev_oc_id]=seln_hash;hash.events[seln.data.ev_id].refs["TB"+type+ev_oc_id]=seln_hash}else topbet_data.last_update=Date.parse(Date())/1e3;seln_hash.ev_id=seln.data.ev_id;seln_hash.ev_mkt_id=seln.data.ev_mkt_id;seln_hash.live_on_tv=event.data.live_on_tv;seln_hash.ev_type=event.data.ev_type_name;if(isMBSForTopBets(event.data)){seln_hash.specials="MBS"}else seln_hash.specials="";seln_hash.special_blurb=event.data.special_blurb;seln_hash.ev_name=event.data.names[cfg.lang];seln_hash.ev_start_time=event.data.start_time;seln_hash.mkt_name=market.data.names[cfg.lang];seln_hash.hcap_value=market.data.raw_hcap;seln_hash.name=seln.data.names[cfg.lang];seln_hash.price_num=seln.data.lp_num;seln_hash.price_den=seln.data.lp_den;seln_hash.price_dec=frac_to_dec(seln.data.lp_num,seln.data.lp_den);if(event.data.displayed=="Y"&&event.data.status=="A"&&(event.data.js_start_time>=getDate()||event.data.is_off=="Y")&&market.data.displayed=="Y"&&market.data.status=="A"&&seln.data.displayed=="Y"&&seln.data.status=="A"){seln_hash.displayed="Y"}else seln_hash.displayed="N"},initTopBetsMults=function(mult_data){var topbet_data=data.items[2],events=mult_data[0],markets=mult_data[1],selns=mult_data[2],combinations=mult_data[3];switch(combinations[0].ev_oc_ids.length){case 2:var htype="DBL",bet_data=topbet_data.double_bets;break;case 3:case 4:var htype="ACC",bet_data=topbet_data.accum_bets;break;default:return};_hashDataInit(events,markets,selns);for(var i=0;i<combinations.length;i++)gotTopBetsMult(combinations[i])},gotTopBetsMult=function(combination){var topbet_data=data.items[2];switch(combination.ev_oc_ids.length){case 2:var htype="DBL",bet_data=topbet_data.double_bets;break;case 3:case 4:var htype="ACC",bet_data=topbet_data.accum_bets;break;default:return};var ev_oc_id_1=combination.ev_oc_ids[0],combination_id=combination.ev_oc_ids.join("|"),comb_hash=hash.selns[ev_oc_id_1].refs["TB"+htype+combination_id],is_new=0;if(!comb_hash){var is_new=1;comb_hash={};comb_hash.id=combination_id;comb_hash.ev_oc_ids=combination.ev_oc_ids;comb_hash.order=combination.order;comb_hash.displayed="Y";comb_hash.selections=[];bet_data.push(comb_hash)}else topbet_data.last_update=Date.parse(Date())/1e3;var combination_displayed="Y";for(var i=0;i<combination.ev_oc_ids.length;i++){var ev_oc_id=combination.ev_oc_ids[i];if(i>0&&ev_oc_id==ev_oc_id_1)continue;var seln=hash.selns[ev_oc_id],market=hash.markets[seln.data.ev_mkt_id],event=hash.events[seln.data.ev_id];seln.refs["TB"+htype+combination_id]=comb_hash;market.refs["TB"+htype+combination_id]=comb_hash;event.refs["TB"+htype+combination_id]=comb_hash;if(is_new){var selection={};selection.ev_oc_id=seln.data.ev_oc_id;selection.order=i;comb_hash.selections.push(selection)}else var selection=comb_hash.selections[i];selection.live_on_tv=event.data.live_on_tv;selection.ev_type=event.data.ev_type_name;selection.specials=event.data.specials;selection.special_blurb=event.data.special_blurb;selection.ev_name=event.data.names[cfg.lang];selection.ev_start_time=event.data.start_time;selection.mkt_name=market.data.names[cfg.lang];selection.hcap_value=market.data.raw_hcap;selection.name=seln.data.names[cfg.lang];selection.price_num=seln.data.lp_num;selection.price_den=seln.data.lp_den;selection.price_dec=frac_to_dec(seln.data.lp_num,seln.data.lp_den);if(event.data.displayed=="Y"&&event.data.status=="A"&&(event.data.js_start_time>=getDate()||event.data.is_off=="Y")&&market.data.displayed=="Y"&&market.data.status=="A"&&seln.data.displayed=="Y"&&seln.data.status=="A");else combination_displayed="N"};comb_hash.displayed=combination_displayed},initCorrectScore=function(cs_common_data,cs_items,events,markets){cs_data=data.items[3];for(var attr in cs_common_data)cs_data[attr]=cs_common_data[attr];_hashDataInit(events,markets,"");cs_data.events=cs_items;cs_data.price_str_type=cfg.price_type;cs_data.price_str_sep=cfg.price_str_sep;cs_data.price_str_type_ah=cfg.price_str_type_ah;cs_data.price_str_type_hl=cfg.price_str_type_hl;for(var i=0;i<cs_data.events.length;i++){gotCScoreEventData(cs_data.events[i]);gotCScoreMarketData(cs_data.events[i])};cs_data.last_update=Date.parse(Date())/1e3},gotCScoreEventData=function(cs_item){var cs_data=data.items[3],ev_id=cs_item.ev_id,event=hash.events[ev_id],cs_hash=event.refs["CS"+ev_id];if(!cs_hash){hash.events[ev_id].refs["CS"+ev_id]=cs_item}else cs_data.last_update=Date.parse(Date())/1e3;if(event.data.displayed=="Y"&&event.data.status=="A"&&(event.data.js_start_time>=getDate()||event.data.is_off=="Y")){cs_item.displayed="Y"}else cs_item.displayed="N"},gotCScoreMarketData=function(cs_item){var cs_data=data.items[3],ev_mkt_id=null;if(typeof cs_item.mkt_id=="undefined"){var ev_mkt_id=cs_item.ev_mkt_id}else var ev_mkt_id=cs_item.mkt_id;var market=hash.markets[ev_mkt_id],cs_hash=market.refs["CS"+ev_mkt_id];if(!cs_hash){hash.markets[ev_mkt_id].refs["CS"+ev_mkt_id]=cs_item}else cs_data.last_update=Date.parse(Date())/1e3;if(market.data.displayed=="Y"&&market.data.status=="A"){cs_item.displayed="Y"}else cs_item.displayed="N"},initRecommendedBets=function(rec_bets_data){data.items[4]=rec_bets_data},startAjaxPoll=function(){document.PollingAjaxHelper.setTimeout("fb_home_upper_startAjaxPoll",doAjaxPoll,cfg.ajax_poll_freq*1e3)},doAjaxPoll=function(){var gotAjaxResponse=function(url,clientdata,ok,response){_wipeRefs();got_ajax_content_updater(url,clientdata,ok,response);_cleanHash();notifyUpdate()};make_ajax_get_request("fb_home_upper_doAjaxPoll",cfg.ajax_url,"",gotAjaxResponse);document.PollingAjaxHelper.setTimeout("fb_home_upper_doAjaxPoll",doAjaxPoll,cfg.ajax_poll_freq*1e3)},notifyUpdate=function(){notifyPPChangeToObject(fb_hp_upper_acc.getData())};return{getData:getData,setCfg:setCfg,initPromotions:initPromotions,initQuickLinks:initQuickLinks,initTopBets:initTopBets,initCorrectScore:initCorrectScore,initRecommendedBets:initRecommendedBets,startAjaxPoll:startAjaxPoll,doAjaxPoll:doAjaxPoll}}();ob.fb.fb_mkts={};ob.fb.fb_mkts.initPushLite=function(){pushLite.onPriceChange(function(ev_oc_id,lp_num,lp_den){var price_node=$j(this).find(".odds-value"),conatainer_node=$j(this),current_price=ob.util.parseCurrentPrice(price_node.text()),direction=current_price-(lp_num/lp_den+1);ob.fb.fb_mkts.highlightPrice(conatainer_node,direction);price_node.text(format_price(lp_num,lp_den))},'.fb-odds-group');pushLite.onSuspendSelection(function(ev_oc_id){$j(this).addClass('suspended')},'.fb-odds-group');pushLite.onUnsuspendSelection(function(ev_oc_id){$j(this).removeClass('suspended')},'.fb-odds-group');pushLite.onSuspendMarket(function(){$j(this).find('.odd').addClass('suspended')});pushLite.onUnsuspendMarket(function(){$j(this).find('.odd').removeClass('suspended')});pushLite.onSuspendEvent(function(){$j(this).find('.odd').addClass('suspended')});pushLite.onUnsuspendEvent(function(){$j(this).find('.odd').removeClass('suspended')});pushLite.onHideMarket(function(){$j(this).hide()});pushLite.onShowMarket(function(){$j(this).show()})};ob.fb.fb_mkts.highlightPrice=function(node,direction){ob.fb.fb_mkts.clearHighlight(node);if(direction>0){node.addClass('odd_d')}else if(direction<0)node.addClass('odd_i');setTimeout(function(){ob.fb.fb_mkts.clearHighlight(node)},4e3)};ob.fb.fb_mkts.clearHighlight=function(node){node.removeClass('odd_i');node.removeClass('odd_d')};ob.fb.fun_cpn={};ob.fb.fun_cpn.init=function(){var data=$j.parseJSON($j("#event_json").html());ob.fb.fun_cpn.events=data.events;ob.fb.fun_cpn.markets=data.markets;ob.fb.fun_cpn.selections=data.selections;ob.fb.fun_cpn.config=data.config;ob.fb.fun_cpn.config.tooltip_delay=500;ob.fb.fun_cpn.content_area=$j(".fbc-wrapper");ob.fb.fun_cpn.storeTemplates();ob.fb.fun_cpn.initTooltips();ob.fb.fun_cpn.initHelpModal();ob.fb.fun_cpn.initEvents();ob.fb.fun_cpn.initPushLite();ob.fb.fun_cpn.initTeamResults();ob.fb.fun_cpn.slip.init()};ob.fb.fun_cpn.storeTemplates=function(){var tmp=[];tmp.push('<div class="fbc-evnt-full-stats ob-stats-inline">');tmp.push('	<div class="fbc-box-close">');tmp.push('		<a href="javascript:void(0)" class="ob-stats-inline-close">'+ob.fb.fun_cpn.config.xlations.fb_fun_cpn_close_stats+'</a>');tmp.push('	</div>');tmp.push('	<iframe id="fb_fun_cpn_stats_<%ev_id%>" src="<%stats_url%>"></iframe>');tmp.push('	<div class="fbc-box-viewstats">');tmp.push('		<a href="javascript:void(0);" onclick="open(\'<%stats_url_all%>\',\'Stats2\',\'scrollbars=1,height=721 width=730,left=10,top=10,titlebar=0,status=0,toolbar=0,menubar=0,location=0\');">'+ob.fb.fun_cpn.config.xlations.fb_fun_cpn_view_all_stats+'</a>');tmp.push('	</div>');tmp.push('</div>');tmpl_store("fb_fun_cpn_stats_inline",tmp.join("\n"));tmp=[];tmp.push('<div class="fbc-evnt fbc-evnt-stats <%right%> ob-stats-overlay">');tmp.push('	<div class="fbc-box-header">');tmp.push('		<div class="fbc-box-evnt-title"<%IF desc != full_desc %>data-full-text="<%full_desc%>"<%END%>><%desc%></div>');tmp.push('		<div class="fbc-box-evnt-time"><%start_time%></div>');tmp.push('	</div>');tmp.push('	<div class="fbc-box-close"><a href="javascript:void(0)" class="ob-stats-overlay-close">'+ob.fb.fun_cpn.config.xlations.fb_fun_cpn_close_stats+'</a></div>');tmp.push('	<div class="clear"></div>');tmp.push('	<iframe id="fb_fun_cpn_stats_<%ev_id%>" src="<%stats_url%>"></iframe>');tmp.push('	<div class="fbc-box-viewstats">');tmp.push('		<a href="javascript:void(0);" onclick="open(\'<%stats_url_all%>\',\'Stats2\',\'scrollbars=1,height=721 width=730,left=10,top=10,titlebar=0,status=0,toolbar=0,menubar=0,location=0\');">'+ob.fb.fun_cpn.config.xlations.fb_fun_cpn_view_all_stats+'</a>');tmp.push('	</div>');tmp.push('</div>');tmpl_store("fb_fun_cpn_stats_overlay",tmp.join("\n"))};ob.fb.fun_cpn.initTooltips=function(){ob.fb.fun_cpn.setTooltip("#cpn_header_help","",ob.fb.fun_cpn.config.xlations.fb_fun_cpn_help_tt);ob.fb.fun_cpn.setTooltip(ob.fb.fun_cpn.content_area,".ob-evnt .ob-seln.inactive",ob.fb.fun_cpn.config.xlations.fb_fun_cpn_seln_inactive_tt);ob.fb.fun_cpn.setTooltip(ob.fb.fun_cpn.content_area,".ob-evnt .ob-stats-inline-open, .ob-evnt .ob-stats-overlay-open",ob.fb.fun_cpn.config.xlations.fb_fun_cpn_view_statistics);ob.fb.fun_cpn.setTooltip(ob.fb.fun_cpn.content_area,".ob-evnt .fbc-flb-stream, .ob-evnt .fbc-evnt-stream",ob.fb.fun_cpn.config.xlations.bir_stream_vid_title);var timeout_id;ob.fb.fun_cpn.content_area.on("mouseenter",".fbc-flb-view, .fbc-evnt-tv",function(){var ev_id=$j(this).closest(".ob-evnt").attr("data-ev-id"),tt_text=ob.fb.fun_cpn.config.xlations.fb_tt_liveon;for(var i=0;i<ob.fb.fun_cpn.events[ev_id].station_icons.length;i++)if(ob.fb.fun_cpn.events[ev_id].station_icons[i]!=="")tt_text+='&nbsp;<img src="'+ob.fb.fun_cpn.config.img_url+'/'+ob.fb.fun_cpn.events[ev_id].station_icons[i]+'">';var that=this;timeout_id=setTimeout(function(){ob.fb.fun_cpn.showTooltip(that,tt_text)},ob.fb.fun_cpn.config.tooltip_delay)}).on("mouseleave",".fbc-flb-view, .fbc-evnt-tv",function(){clearTimeout(timeout_id);ob.fb.fun_cpn.hideTooltip()});ob.fb.fun_cpn.content_area.on("mouseenter",".ob-evnt .fbc-flb-mbs, .ob-evnt .fbc-evnt-mbs",function(){var ev_id=$j(this).closest(".ob-evnt").attr("data-ev-id"),tt_text=ob.fb.fun_cpn.config.xlations.football_mbs;if(ob.fb.fun_cpn.events[ev_id].live_on_tv==1){tt_text+='<br/>'+ob.fb.fun_cpn.config.xlations.fb_tt_liveon;for(var i=0;i<ob.fb.fun_cpn.events[ev_id].station_icons.length;i++)if(ob.fb.fun_cpn.events[ev_id].station_icons[i]!=="")tt_text+='&nbsp;<img src="'+ob.fb.fun_cpn.config.img_url+'/'+ob.fb.fun_cpn.events[ev_id].station_icons[i]+'">'};var that=this;timeout_id=setTimeout(function(){ob.fb.fun_cpn.showTooltip(that,tt_text)},ob.fb.fun_cpn.config.tooltip_delay)}).on("mouseleave",".ob-evnt .fbc-flb-mbs, .ob-evnt .fbc-evnt-mbs",function(){clearTimeout(timeout_id);ob.fb.fun_cpn.hideTooltip()});ob.fb.fun_cpn.content_area.on("mouseenter","[data-full-text]",function(){var that=this;timeout_id=setTimeout(function(){ob.fb.fun_cpn.showTooltip(that,$j(that).attr("data-full-text"))},ob.fb.fun_cpn.config.tooltip_delay)}).on("mouseleave","[data-full-text]",function(){clearTimeout(timeout_id);ob.fb.fun_cpn.hideTooltip()})};ob.fb.fun_cpn.setTooltip=function(area,selector,text){var timeout_id;$j(area).on("mouseenter",selector,function(){var that=this;timeout_id=setTimeout(function(){ob.fb.fun_cpn.showTooltip(that,text)},ob.fb.fun_cpn.config.tooltip_delay)}).on("mouseleave",selector,function(){clearTimeout(timeout_id);ob.fb.fun_cpn.hideTooltip()})};ob.fb.fun_cpn.initHelpModal=function(){$j("#cpn_header_help_blurb").dialog({modal:true,autoOpen:false,height:699,width:917,title:"",closeText:"",dialogClass:'select-your-team',buttons:{},close:function(){}});$j("#cpn_header_help").on("click",function(){$j("#cpn_header_help_blurb").dialog("open")});$j("#cpn_header_help_blurb").on("click",".help_overlay_close a",function(){$j("#cpn_header_help_blurb").dialog("close")})};ob.fb.fun_cpn.initEvents=function(){$j("#cpn_header_blurb_toggle").on("click",function(){ob.fb.fun_cpn.toggleBlurb()});ob.fb.fun_cpn.content_area.on("click",".ob-evnt .ob-seln",function(){if(ob.fb.fun_cpn.slip.isOnSlip(this)){ob.fb.fun_cpn.slip.remove(this)}else ob.fb.fun_cpn.slip.add(this)});ob.fb.fun_cpn.content_area.on("click",".ob-evnt .ob-stats-inline-open, .ob-evnt .ob-stats-inline-close",function(){ob.fb.fun_cpn.toggleInlineStats(this)});ob.fb.fun_cpn.content_area.on("click",".ob-evnt .ob-stats-overlay-open",function(){ob.fb.fun_cpn.openOverlayStats(this)});ob.fb.fun_cpn.content_area.on("click",".fbc-evnt-stats .ob-stats-overlay-close",function(){ob.fb.fun_cpn.closeOverlayStats(this)});ob.fb.fun_cpn.content_area.on("click",".fbc-print",function(){window.print()})};ob.fb.fun_cpn.initPushLite=function(){pushLite.onPriceChange(function(ev_oc_id,lp_num,lp_den){var selection_node=$j(this),price_node=selection_node.find('.ob-price'),current_price=ob.fb.fun_cpn.parseCurrentPrice(price_node.text()),direction=current_price-(lp_num/lp_den+1);ob.fb.fun_cpn.highlightPrice(selection_node,direction);price_node.text(format_price(lp_num,lp_den));ob.fb.fun_cpn.selections[ev_oc_id].lp_num=lp_num;ob.fb.fun_cpn.selections[ev_oc_id].lp_den=lp_den;ob.fb.fun_cpn.selections[ev_oc_id].price=format_price(lp_num,lp_den)},'.ob-evnt');pushLite.onSuspendSelection(function(ev_oc_id){$j(this).addClass('suspended');ob.fb.fun_cpn.selections[ev_oc_id].status='S'},'.ob-evnt');pushLite.onUnsuspendSelection(function(ev_oc_id){$j(this).removeClass('suspended');ob.fb.fun_cpn.selections[ev_oc_id].status='A'},'.ob-evnt');pushLite.onSuspendMarket(function(ev_mkt_id){$j(this).find('.ob-seln').addClass('suspended');ob.fb.fun_cpn.markets[ev_mkt_id].status='S'});pushLite.onUnsuspendMarket(function(ev_mkt_id){$j(this).find('.ob-seln').removeClass('suspended');ob.fb.fun_cpn.markets[ev_mkt_id].status='A'});pushLite.onSuspendEvent(function(ev_id){$j(this).find('.ob-seln').addClass('suspended')});pushLite.onUnsuspendEvent(function(ev_id){$j(this).find('.ob-seln').removeClass('suspended')});pushLite.onHideMarket(function(ev_mkt_id){ob.fb.fun_cpn.markets[ev_mkt_id].displayed='N';$j(this).hide()});pushLite.onShowMarket(function(ev_mkt_id){ob.fb.fun_cpn.markets[ev_mkt_id].displayed='Y';if(ob.fb.fun_cpn.config.display_bir_events!==1&&ob.fb.fun_cpn.events[ev_id].is_off==='Y')return;$j(this).show()});pushLite.onHideEvent(function(ev_id){ob.fb.fun_cpn.events[ev_id].displayed='N';$j(this).hide()});pushLite.onShowEvent(function(ev_id){ob.fb.fun_cpn.events[ev_id].displayed='Y';if(ob.fb.fun_cpn.config.display_bir_events!==1&&ob.fb.fun_cpn.events[ev_id].is_off==='Y')return;$j(this).show();ob.fb.fun_cpn.slip.setLuckyDips()});pushLite.onEventOff(function(ev_id){ob.fb.fun_cpn.events[ev_id].is_off='Y';if(ob.fb.fun_cpn.config.display_bir_events!==1){$j(this).hide();ob.fb.fun_cpn.slip.setLuckyDips()}})};ob.fb.fun_cpn.parseCurrentPrice=function(price){var decimal_re=/(\d+)\.(\d+)/,fraction_re=/(\d+)\s*\/\s*(\d+)/;if(price.toLowerCase()==="evens"){return 2.0}else if(decimal_re.match(price)){return parseFloat(price)}else if(fraction_re.match(price)){var parts=fraction_re.exec(price),lp_num=parseInt(parts[1]),lp_den=parseInt(parts[2]);return(lp_num/lp_den)+1}};ob.fb.fun_cpn.highlightPrice=function(node,direction){ob.fb.fun_cpn.clearHighlight(node);if(direction>0){node.addClass('odds-decrement')}else if(direction<0)node.addClass('odds-increment');setTimeout(function(){ob.fb.fun_cpn.clearHighlight(node)},4e3)};ob.fb.fun_cpn.clearHighlight=function(node){node.removeClass('odds-increment');node.removeClass('odds-decrement')};ob.fb.fun_cpn.toggleBlurb=function(){$j("#cpn_header_blurb").toggle()};ob.fb.fun_cpn.showTooltip=function(e,text){ob.fb.fun_cpn.clearTooltip();var obj=$j(e),tooltip_holder=$j("#tooltip-holder");tooltip_holder.find("p").html(text);tooltip_holder.show();var offset=obj.offset(),top=offset.top-tooltip_holder.find(".tooltipWrapper").height()-$j(".main_content").offset().top,left=offset.left+(obj.width()/2-23)-$j('.main_content').offset().left;tooltip_holder.css("top",top+"px").css("left",left+"px");tooltip_holder.hide();tooltip_holder.stop(true,true).fadeIn(100)};ob.fb.fun_cpn.clearTooltip=function(){var tooltip_holder=$j("#tooltip-holder");tooltip_holder.find("p").html("");tooltip_holder.css("top","-1000px").css("left","0px").hide()};ob.fb.fun_cpn.hideTooltip=function(){ob.fb.fun_cpn.clearTooltip();$j("#tooltip-holder").hide()};ob.fb.fun_cpn.toggleInlineStats=function(e){var ev_container=$j(e).closest(".ob-evnt"),ev_id=ev_container.attr("data-ev-id"),stats_frame=ev_container.children(".ob-stats-inline");if(stats_frame.length>0){if(stats_frame.is(":hidden")){stats_frame.slideDown()}else stats_frame.slideUp();return};var ev_info={};ev_info.ev_id=ev_id;ev_info.stats_url=ob.fb.fun_cpn.events[ev_id].stats_url;ev_info.stats_url_all=ob.fb.fun_cpn.events[ev_id].stats_url_all;var stats_html=$j(tmpl_play("fb_fun_cpn_stats_inline",ev_info));$j(stats_html).css("height","auto").hide().slideDown().find("#fb_fun_cpn_stats_"+ev_id).attr({frameBorder:0,scrolling:"no",width:"100%",height:"98px"});$j(stats_html).appendTo(ev_container)};ob.fb.fun_cpn.openOverlayStats=function(e){var ev_container=$j(e).closest(".ob-evnt"),ev_id=ev_container.attr("data-ev-id"),stats_frame=ev_container.next(".ob-stats-overlay");if(stats_frame.length>0){ev_container.hide();stats_frame.show().find("#fb_fun_cpn_stats_"+ev_id).slideDown();return};var ev_info={};ev_info.ev_id=ev_id;ev_info.desc=ob.fb.fun_cpn.events[ev_id].desc;ev_info.full_desc=ob.fb.fun_cpn.events[ev_id].full_desc;ev_info.start_time=ob.fb.fun_cpn.events[ev_id].formatted_start_time;ev_info.stats_url=ob.fb.fun_cpn.events[ev_id].stats_url;ev_info.stats_url_all=ob.fb.fun_cpn.events[ev_id].stats_url_all;ev_info.right=ev_container.hasClass("right")?"right":"";var stats_html=$j(tmpl_play("fb_fun_cpn_stats_overlay",ev_info)),container_height=ev_container.height();ev_container.hide();$j(stats_html).insertAfter(ev_container).css("height",container_height).find("#fb_fun_cpn_stats_"+ev_id).attr({frameborder:0,scrolling:"no",width:"100%",height:"245px"}).hide().slideDown()};ob.fb.fun_cpn.closeOverlayStats=function(e){var stats_frame=$j(e).closest(".ob-stats-overlay"),ev_container=stats_frame.prev(".ob-evnt"),ev_id=ev_container.attr("data-ev-id");stats_frame.find("#fb_fun_cpn_stats_"+ev_id).slideUp().promise().done(function(){stats_frame.hide();ev_container.show()})};ob.fb.fun_cpn.setActiveSelection=function(e){var ev_oc_id=$j(e).attr("data-ev-oc-id"),ev_id=ob.fb.fun_cpn.selections[ev_oc_id].ev_id,event_container=ob.fb.fun_cpn.content_area.find(".ob-evnt[data-ev-id='"+ev_id+"']");event_container.find(".ob-seln[data-ev-oc-id='"+ev_oc_id+"']").addClass("active").children(".small-red-sln-x").show();if(ob.fb.fun_cpn.config.cpn_sort!="FBHS")event_container.find(".ob-seln[data-ev-oc-id!='"+ev_oc_id+"']").addClass("inactive")};ob.fb.fun_cpn.setInactiveSelection=function(e){var ev_oc_id=$j(e).attr("data-ev-oc-id"),ev_id=ob.fb.fun_cpn.selections[ev_oc_id].ev_id,event_container=ob.fb.fun_cpn.content_area.find(".ob-evnt[data-ev-id='"+ev_id+"']");event_container.find(".ob-seln[data-ev-oc-id='"+ev_oc_id+"']").removeClass("active").children(".small-red-sln-x").hide();event_container.find(".ob-seln").removeClass("inactive")};ob.fb.fun_cpn.clearActiveSelections=function(){var selections=ob.fb.fun_cpn.content_area.find(".ob-evnt .ob-seln");selections.removeClass("active").children(".small-red-sln-x").hide();selections.removeClass("inactive")};ob.fb.fun_cpn.initTeamResults=function(){var teams_results_html=ob.fb.fun_cpn.content_area.find(".ob-stats-inline-open");if(typeof teams_results_html=='undefined'||teams_results_html==null||teams_results_html.length==0)return;var tl_team_comp_ids=[];for(i=0;i<teams_results_html.length;i++){var exists=$j.inArray(teams_results_html[i],tl_team_comp_ids);if(exists==-1)tl_team_comp_ids.push($j(teams_results_html[i]).attr("data-team-id")+"|"+$j(teams_results_html[i]).attr("data-comp-id"))};var callback="callback=ob.fb.fun_cpn.applyTeamStatsIcons",team_comp_ids="teamIds="+tl_team_comp_ids.join(","),postdata=callback+"&"+team_comp_ids,clientdata={};$j.ajax({url:ob.fb.fun_cpn.config.team_results_url,type:"POST",data:postdata,dataType:"jsonp",success:ob.fb.applyTeamStatsIcons})};ob.fb.fun_cpn.applyTeamStatsIcons=function(team_results){var cpn_sort=ob.fb.fun_cpn.config.cpn_sort;for(team in team_results){var ids=team.split("_"),team_id=ids[0].replace("team",""),comp_id=ids[1],elems=ob.fb.fun_cpn.content_area.find(".ob-stats-inline-open[data-team-id='"+team_id+"'][data-comp-id='"+comp_id+"']").children();if(cpn_sort=="FBSB"){var score_bore=team_results[team].score_bore;while(score_bore.length!=5)score_bore.push("-");score_bore=score_bore.reverse();var index=0;elems.each(function(){if(index>=5)index=0;$j(this).removeClass("fbc-flb-null-image");var new_class="";if(score_bore[index]=="s"){new_class="fbc-flb-yimage"}else if(score_bore[index]=="b"){new_class="fbc-flb-ximage"}else new_class="fbc-flb-null-image";$j(this).addClass(new_class);index++})}else{var results=team_results[team].results;while(results.length!=5)results.push("-");results=results.reverse();var index=0;elems.each(function(){if(index>=5)index=0;$j(this).removeClass("fbc-flb-null-image");var new_class="";if(results[index]=="l"){new_class="fbc-flb-lose-image"}else if(results[index]=="d"){new_class="fbc-flb-draw-image"}else if(results[index]=="w"){new_class="fbc-flb-win-image"}else new_class="fbc-flb-null-image";$j(this).addClass(new_class);index++})}}};ob.fb.fun_cpn.slip={};ob.fb.fun_cpn.slip.randomSelect={};ob.fb.fun_cpn.slip.init=function(){ob.fb.fun_cpn.slip.header=$j(".fbc-betslip-header");ob.fb.fun_cpn.slip.content_area=$j("#cpn_bs_container");ob.fb.fun_cpn.slip.ordered_selections=[];for(var ev_id in ob.fb.fun_cpn.events)for(var i=0;i<ob.fb.fun_cpn.events[ev_id].ordered_ev_oc_ids.length;i++){var ev_oc_id=ob.fb.fun_cpn.events[ev_id].ordered_ev_oc_ids[i];if(ev_oc_id!="")ob.fb.fun_cpn.slip.ordered_selections.push(ob.fb.fun_cpn.selections[ev_oc_id])};ob.fb.fun_cpn.slip.reorderSelections();ob.fb.fun_cpn.slip.storeTemplates();ob.fb.fun_cpn.slip.initTooltips();ob.fb.fun_cpn.slip.initEvents();ob.fb.fun_cpn.slip.initPushLite();ob.fb.fun_cpn.slip.setLuckyDips();ob.fb.fun_cpn.slip.updateCollapsedState();ob.fb.fun_cpn.slip.autoPopulate()};ob.fb.fun_cpn.slip.storeTemplates=function(){var tmp=[];tmp.push('<div id="fb_cpn_bs_seln_<%ev_oc_id%>" class="fbc-bs-sln-container" data-ev-oc-id="<%ev_oc_id%>">');tmp.push('	<div class="fbc-bs-optns">');tmp.push('		<div class="fbc-bs-optns-select fbc-bs-optns-chck"></div>');tmp.push('		<div class="fbc-bs-optns-rfrsh"></div>');tmp.push('		<div class="fbc-bs-optns-x"></div>');tmp.push('	</div>');tmp.push('	<div class="fbc-bs-sln">');tmp.push('		<div class="fbc-bs-sln-text"><%oc_desc%></div>');tmp.push('	</div>');tmp.push('	<div class="fbc-bs-evnt">');tmp.push('		<div class="fbc-bs-evnt-text"><%ev_desc%></div>');tmp.push('	</div>');tmp.push('	<div class="fbc-bs-price">');tmp.push('		<div class="fbc-bs-price-text"><%price_str%></div>');tmp.push('	</div>');tmp.push('</div>');tmpl_store("fb_fun_cpn_bs_seln",tmp.join("\n"))};ob.fb.fun_cpn.slip.initTooltips=function(){var timeout_id;$j("#cpn_bs_btn_bet").on("mouseenter",function(){var that=this;if(!$j(that).hasClass("inactive"))timeout_id=setTimeout(function(){ob.fb.fun_cpn.showTooltip(that,ob.fb.fun_cpn.config.xlations.fb_fun_cpn_slip_bet_tt)},ob.fb.fun_cpn.config.tooltip_delay)}).on("mouseleave",function(){clearTimeout(timeout_id);ob.fb.fun_cpn.hideTooltip()});ob.fb.fun_cpn.content_area.on("mouseenter",".fbc-bs-optns-select",function(){var that=this;timeout_id=setTimeout(function(){if($j(that).hasClass("fbc-bs-optns-chck")){ob.fb.fun_cpn.showTooltip(that,ob.fb.fun_cpn.config.xlations.fb_fun_cpn_slip_checked_tt)}else ob.fb.fun_cpn.showTooltip(that,ob.fb.fun_cpn.config.xlations.fb_fun_cpn_slip_unchecked_tt)},ob.fb.fun_cpn.config.tooltip_delay)}).on("mouseleave",".fbc-bs-optns-select",function(){clearTimeout(timeout_id);ob.fb.fun_cpn.hideTooltip()});ob.fb.fun_cpn.setTooltip(ob.fb.fun_cpn.slip.content_area,".fbc-bs-optns-rfrsh",ob.fb.fun_cpn.config.xlations.fb_fun_cpn_slip_refresh_tt);ob.fb.fun_cpn.setTooltip(ob.fb.fun_cpn.slip.content_area,".fbc-bs-optns-x",ob.fb.fun_cpn.config.xlations.fb_fun_cpn_slip_remove_tt)};ob.fb.fun_cpn.slip.initEvents=function(){ob.fb.fun_cpn.content_area.on("click",".btn-ldip",function(){ob.fb.fun_cpn.slip.getLuckyDip(this)});ob.fb.fun_cpn.content_area.on("click",".fbc-square-cs-odds",function(){ob.fb.fun_cpn.slip.toggleActiveLuckyDipOption(this)});ob.fb.fun_cpn.content_area.on("click",".btn-pyo",function(){ob.fb.fun_cpn.slip.PYO()});ob.fb.fun_cpn.slip.header.on("click","#cpn_bs_btn_bet.active",function(){ob.fb.fun_cpn.slip.placeBet()});ob.fb.fun_cpn.slip.header.on("click",".btn-qs",function(){ob.fb.fun_cpn.slip.useQuickStake(this)});ob.fb.fun_cpn.slip.header.on("change keyup","#cpn_bs_stake",function(){ob.fb.fun_cpn.slip.setActiveQuickStake(null);if(!ob.fb.fun_cpn.slip.validateStake($j(this).val())){$j(this).val("");alert(ob.fb.fun_cpn.config.xlations.fb_fun_cpn_invalid_stake);return};ob.fb.fun_cpn.slip.updatePotentialReturns()});ob.fb.fun_cpn.slip.content_area.on("click",".fbc-bs-optns-select",function(){ob.fb.fun_cpn.slip.toggleChecked(this)});ob.fb.fun_cpn.slip.content_area.on("click",".fbc-bs-optns-rfrsh",function(){ob.fb.fun_cpn.slip.repick($j(this).closest(".fbc-bs-sln-container"))});ob.fb.fun_cpn.slip.content_area.on("click",".fbc-bs-optns-x",function(){ob.fb.fun_cpn.slip.remove($j(this).closest(".fbc-bs-sln-container"))});ob.fb.fun_cpn.slip.content_area.on("click",".fbc-bs-clr-slns-btn",function(){ob.fb.fun_cpn.slip.clear()})};ob.fb.fun_cpn.slip.highlightPrice=function(node,direction){ob.fb.fun_cpn.slip.clearHighlight(node);if(direction>0){node.addClass('fbc-bs-price-shrtn')}else if(direction<0)node.addClass('fbc-bs-price-lngtn');setTimeout(function(){ob.fb.fun_cpn.slip.clearHighlight(node)},4e3)};ob.fb.fun_cpn.slip.clearHighlight=function(node){node.removeClass('fbc-bs-price-shrtn');node.removeClass('fbc-bs-price-lngtn')};ob.fb.fun_cpn.slip.initPushLite=function(){pushLite.onPriceChange(function(ev_oc_id,lp_num,lp_den){var button_node=$j(this).find('.fbc-bs-price'),price_node=button_node.find('.fbc-bs-price-text'),current_price=ob.fb.fun_cpn.parseCurrentPrice(price_node.text()),direction=current_price-(lp_num/lp_den+1);ob.fb.fun_cpn.slip.highlightPrice(button_node,direction);price_node.text(format_price(lp_num,lp_den))},'#cpn_bs_container')};ob.fb.fun_cpn.slip.reorderSelections=function(){ob.fb.fun_cpn.slip.ordered_selections.sort(function(a,b){var a_lp_dec=parseFloat(a.lp_dec),b_lp_dec=parseFloat(b.lp_dec);if(a_lp_dec<b_lp_dec)return-1;if(a_lp_dec>b_lp_dec)return 1;var a_ev_id=parseInt(a.ev_id),b_ev_id=parseInt(b.ev_id);if(a_ev_id<b_ev_id)return-1;if(a_ev_id>b_ev_id)return 1;if(a.desc<b.desc)return-1;if(a.desc>b.desc)return 1;return 0})};ob.fb.fun_cpn.slip.setLuckyDips=function(){ob.fb.fun_cpn.content_area.find(".btn-ldip").each(function(){var ldip=$j(this).attr("data-lucky-dip"),num_selns=ob.fb.fun_cpn.config.lucky_dip_settings[ldip].num_selns,seln_categories=ob.fb.fun_cpn.config.lucky_dip_settings[ldip].seln_categories;if(seln_categories.length===1){var accum=ob.fb.fun_cpn.slip.generateAccumulator(num_selns,seln_categories[0],false);if(typeof accum==='undefined'){$j(this).siblings(".fbc-square-odds").html("--");$j(this).addClass("inactive");return};var price=ob.fb.fun_cpn.slip.calcCombinedPrice(accum[1]);price+=ob.fb.fun_cpn.slip.getBonus(price);var lookup_price=ob.price_ladder.round(price,"down");ob.fb.fun_cpn.config.lucky_dip_settings[ldip].price=lookup_price.p_dec;$j(this).siblings(".fbc-square-odds").html(format_price(lookup_price.p_num,lookup_price.p_den))}else for(var i=0;i<seln_categories.length;i++){var accum=ob.fb.fun_cpn.slip.generateAccumulator(num_selns,seln_categories[i],false);if(typeof accum==='undefined'){$j(this).siblings(".fbc-square-cs-odds").eq(i).find(".fbc-square-cs-odd").html("--");return};var price=ob.fb.fun_cpn.slip.calcCombinedPrice(accum[1]);price+=ob.fb.fun_cpn.slip.getBonus(price);var lookup_price=ob.price_ladder.round(price,"down");if(typeof ob.fb.fun_cpn.config.lucky_dip_settings[ldip].price==='undefined')ob.fb.fun_cpn.config.lucky_dip_settings[ldip].price=[];ob.fb.fun_cpn.config.lucky_dip_settings[ldip].price[i]=lookup_price.p_dec;$j(this).siblings(".fbc-square-cs-odds").eq(i).find(".fbc-square-cs-odd").html(format_price(lookup_price.p_num,lookup_price.p_den))}})};ob.fb.fun_cpn.slip.getSelections=function(){return ob.fb.fun_cpn.slip.content_area.find(".fbc-bs-sln-container")};ob.fb.fun_cpn.slip.getSelectedSelections=function(){var selections=ob.fb.fun_cpn.slip.content_area.find(".fbc-bs-sln-container"),selected_selections=[];selections.each(function(){if(!($j(this).find(".fbc-bs-optns-unchck").length>0))selected_selections.push(this)});obj=jQuery(selected_selections);return obj};ob.fb.fun_cpn.slip.add=function(e,target){if(typeof e==="string"){var ev_oc_id=e;e=ob.fb.fun_cpn.content_area.find(".ob-evnt .ob-seln[data-ev-oc-id='"+ev_oc_id+"']")}else var ev_oc_id=$j(e).attr("data-ev-oc-id");if(!ob.fb.fun_cpn.slip.canAddToSlip(e))return false;var ev_id=ob.fb.fun_cpn.selections[ev_oc_id].ev_id,seln_info={};seln_info.ev_oc_id=ev_oc_id;seln_info.ev_desc=ob.fb.fun_cpn.events[ev_id].full_desc;seln_info.oc_desc=ob.fb.fun_cpn.selections[ev_oc_id].full_desc;seln_info.price_str=ob.fb.fun_cpn.selections[ev_oc_id].price;seln_html=tmpl_play("fb_fun_cpn_bs_seln",seln_info);if(typeof target==='undefined'||target=="")var target=ob.fb.fun_cpn.slip.content_area.find(".fbc-bs-clr-slns");$j(seln_html).insertBefore(target);ob.fb.fun_cpn.setActiveSelection(e);ob.fb.fun_cpn.slip.calculateActiveLuckyDip();ob.fb.fun_cpn.slip.updatePotentialReturns();ob.fb.fun_cpn.slip.updateCollapsedState()};ob.fb.fun_cpn.slip.remove=function(e){var ev_oc_id=$j(e).attr("data-ev-oc-id"),selection=ob.fb.fun_cpn.slip.content_area.find("#fb_cpn_bs_seln_"+ev_oc_id);selection.remove();ob.fb.fun_cpn.clearTooltip();ob.fb.fun_cpn.setInactiveSelection(e);ob.fb.fun_cpn.slip.calculateActiveLuckyDip();ob.fb.fun_cpn.slip.updatePotentialReturns();ob.fb.fun_cpn.slip.updateCollapsedState()};ob.fb.fun_cpn.slip.clear=function(){var selections=ob.fb.fun_cpn.slip.getSelections();selections.remove();ob.fb.fun_cpn.clearTooltip();ob.fb.fun_cpn.clearActiveSelections();ob.fb.fun_cpn.slip.calculateActiveLuckyDip();ob.fb.fun_cpn.slip.updatePotentialReturns();ob.fb.fun_cpn.slip.updateCollapsedState()};ob.fb.fun_cpn.slip.updateCollapsedState=function(e){if(ob.fb.fun_cpn.slip.getSelections().length>0){ob.fb.fun_cpn.slip.content_area.show();ob.fb.fun_cpn.slip.header.find("#cpn_bs_btn_bet").removeClass("inactive");ob.fb.fun_cpn.slip.header.find("#cpn_bs_btn_bet").addClass("active")}else{ob.fb.fun_cpn.slip.content_area.hide();ob.fb.fun_cpn.slip.header.find("#cpn_bs_btn_bet").addClass("inactive");ob.fb.fun_cpn.slip.header.find("#cpn_bs_btn_bet").removeClass("active")}};ob.fb.fun_cpn.slip.toggleChecked=function(e){$j(e).toggleClass("fbc-bs-optns-chck fbc-bs-optns-unchck");ob.fb.fun_cpn.slip.updatePotentialReturns();ob.fb.fun_cpn.slip.calculateActiveLuckyDip()};ob.fb.fun_cpn.slip.repick=function(e){var ev_oc_id=$j(e).attr("data-ev-oc-id"),next_seln=$j(e).next();ob.fb.fun_cpn.slip.remove(e);var selections=ob.fb.fun_cpn.content_area.find(".ob-seln"),r=get_random_number(0,selections.length-1),new_seln=selections.eq(r),new_ev_oc_id=new_seln.attr("data-ev-oc-id");while(!ob.fb.fun_cpn.slip.canAddToSlip(new_seln)||new_ev_oc_id==ev_oc_id){r=get_random_number(0,selections.length-1);new_seln=selections.eq(r);new_ev_oc_id=new_seln.attr("data-ev-oc-id")};ob.fb.fun_cpn.slip.add(new_seln,next_seln)};ob.fb.fun_cpn.slip.isOnSlip=function(e){var ev_oc_id=$j(e).attr("data-ev-oc-id");return(ob.fb.fun_cpn.slip.content_area.find("#fb_cpn_bs_seln_"+ev_oc_id).length>0)};ob.fb.fun_cpn.slip.canAddToSlip=function(e){if(ob.fb.fun_cpn.slip.isOnSlip(e))return false;var ev_oc_id=$j(e).attr("data-ev-oc-id"),selection=ob.fb.fun_cpn.selections[ev_oc_id],ev_mkt_id=selection.ev_mkt_id,can_add=true;if(ob.fb.fun_cpn.config.cpn_sort!="FBHS")ob.fb.fun_cpn.slip.getSelections().each(function(){var selected_ev_oc_id=$j(this).attr("data-ev-oc-id"),selected_selection=ob.fb.fun_cpn.selections[selected_ev_oc_id],selected_ev_mkt_id=selected_selection.ev_mkt_id;if(ev_mkt_id==selected_ev_mkt_id)can_add=false});if(!ob.fb.fun_cpn.slip.checkSelectionStatus(ev_oc_id))can_add=false;return can_add};ob.fb.fun_cpn.slip.checkSelectionStatus=function(ev_oc_id){var selection=ob.fb.fun_cpn.selections[ev_oc_id],market=ob.fb.fun_cpn.markets[selection.ev_mkt_id],event=ob.fb.fun_cpn.events[selection.ev_id],config=ob.fb.fun_cpn.config,check=true;if(selection.status=='S'||selection.displayed=='N'){check=false}else if(market.status=='S'||market.displayed=='N'){check=false}else if(event.status=='S'||event.displayed=='N'){check=false}else if(config.display_bir_events!==1&&event.is_off==='Y')check=false;return check};ob.fb.fun_cpn.slip.validateStake=function(value){var re=/^[0-9]{0,8}(\.[0-9]{0,2})?$/;return re.test(value)};ob.fb.fun_cpn.slip.placeBet=function(){if(ob.fb.fun_cpn.slip.getSelections().length===0)return;var stake=$j("#cpn_bs_stake").val();if(!ob.fb.fun_cpn.slip.validateStake(stake))alert(ob.fb.fun_cpn.config.xlations.fb_fun_cpn_invalid_stake);ob.fb.fun_cpn.slip.getSelections().each(function(){if(!ob.fb.fun_cpn.slip.canPlaceSeln(this))return;var ev_oc_id=$j(this).attr("data-ev-oc-id"),selection=ob.fb.fun_cpn.selections[ev_oc_id],bet_origin=ob.fb.fun_cpn.config.bet_origin;if(ob.fb.fun_cpn.config.cpn_sort==="FBS")bet_origin+="_"+selection.section;BS_set_leg("selections",ev_oc_id);BS_set_leg("price_type","L");BS_set_leg("lp_num",selection.lp_num);BS_set_leg("lp_den",selection.lp_den);BS_set_leg("market_tags","");BS_set_leg('bet_origin',bet_origin);BS_select_bet(ev_oc_id)});BS_set_extra_info("acc_stake",stake);BS_go_bets()};ob.fb.fun_cpn.slip.canPlaceSeln=function(e){var ev_oc_id=$j(e).attr("data-ev-oc-id");if(!ob.fb.fun_cpn.slip.checkSelectionStatus(ev_oc_id))return false;if($j(e).find(".fbc-bs-optns-unchck").length>0)return false;return true};ob.fb.fun_cpn.slip.updatePotentialReturns=function(){var textHolder=$j("#cpn_bs_potential_returns"),selections=ob.fb.fun_cpn.slip.getSelectedSelections();if(selections.length==0){textHolder.empty();return};var stake=$j("#cpn_bs_stake").val();if(stake==""){textHolder.empty();return};if(!ob.fb.fun_cpn.slip.checkSlipValidAccumulator(selections)){textHolder.empty();return};var price_num=1,price_den=1;selections.each(function(){var ev_oc_id=$j(this).attr("data-ev-oc-id");price_num=price_num*(parseInt(ob.fb.fun_cpn.selections[ev_oc_id].lp_num)+parseInt(ob.fb.fun_cpn.selections[ev_oc_id].lp_den));price_den=price_den*parseInt(ob.fb.fun_cpn.selections[ev_oc_id].lp_den)});var potential_returns=stake*price_num/price_den;if(ob.fb.fun_cpn.slip.getActiveLuckyDip().length>0&&ob.fb.fun_cpn.config.coupon_bonus_percent>0){var bonus_amount=ob.fb.fun_cpn.slip.getBonus(potential_returns);if(ob.fb.fun_cpn.config.coupon_bonus_max>0&&bonus_amount>ob.fb.fun_cpn.config.coupon_bonus_max)bonus_amount=ob.fb.fun_cpn.config.coupon_bonus_max;potential_returns+=bonus_amount};var ccy_symbol=ob.fb.fun_cpn.config.ccy_symbol;textHolder.html(print_ccy(stake,ccy_symbol)+" <span class='cpn_bs_potential_returns_text'>"+ob.fb.fun_cpn.config.xlations.fb_fun_cpn_bet_returns+"</span> "+print_ccy(potential_returns,ccy_symbol))};ob.fb.fun_cpn.slip.checkSlipValidAccumulator=function(selections){var tmp_arr={},valid=true;selections.each(function(){var ev_oc_id=$j(this).attr("data-ev-oc-id"),selection=ob.fb.fun_cpn.selections[ev_oc_id],ev_mkt_id=selection.ev_mkt_id;if(ev_mkt_id in tmp_arr){valid=false;return false}else tmp_arr[ev_mkt_id]=true});return valid};ob.fb.fun_cpn.slip.useQuickStake=function(e){var quick_stake=$j(e).attr("data-quick-stake-value");$j("#cpn_bs_stake").val(quick_stake);ob.fb.fun_cpn.slip.setActiveQuickStake(e);ob.fb.fun_cpn.slip.updatePotentialReturns()};ob.fb.fun_cpn.slip.setActiveQuickStake=function(e){ob.fb.fun_cpn.slip.header.find(".btn-qs").removeClass("active");$j(e).addClass("active")};ob.fb.fun_cpn.slip.setActiveLuckyDip=function(e){$j(e).closest(".fbc-square, .fbc-square-cs").addClass("active").children(".fbc-square-header, .fbc-square-cs-header").addClass("active")};ob.fb.fun_cpn.slip.clearActiveLuckyDip=function(e){ob.fb.fun_cpn.content_area.find(".fbc-square, .fbc-square-cs").removeClass("active").children(".fbc-square-header, .fbc-square-cs-header").removeClass("active")};ob.fb.fun_cpn.slip.getActiveLuckyDip=function(e){return ob.fb.fun_cpn.content_area.find(".fbc-square.active, .fbc-square-cs.active")};ob.fb.fun_cpn.slip.calculateActiveLuckyDip=function(){var selections=ob.fb.fun_cpn.slip.getSelectedSelections();ob.fb.fun_cpn.slip.clearActiveLuckyDip();if(!ob.fb.fun_cpn.slip.checkSlipValidAccumulator(selections))return false;var best_lucky_dip={id:-1,num_selns:-1},len=ob.fb.fun_cpn.config.lucky_dip_settings.length;for(var i=0;i<len;i++){var num_selns=ob.fb.fun_cpn.config.lucky_dip_settings[i].num_selns,ldip_categories=ob.fb.fun_cpn.config.lucky_dip_settings[i].seln_categories,selection_categories=ldip_categories[0];if(selections.length<(num_selns*selection_categories.length))continue;if(ldip_categories.length===1&&selection_categories.length===1&&selection_categories[0]==""){if(num_selns>best_lucky_dip.num_selns){best_lucky_dip.num_selns=num_selns;best_lucky_dip.id=i};continue};if(ldip_categories.length>1){var ev_oc_id=selections.first().attr("data-ev-oc-id");for(var j=0;j<ldip_categories.length;j++){for(var k=0;k<ldip_categories[j].length;k++){var category=ldip_categories[j][k],found=false;if(ob.fb.fun_cpn.selections[ev_oc_id][category]==1)var found=true};if(found){var ldip_option_num=j,selection_categories=ldip_categories[j];break}}};var correct_category=true,ev_oc_ids=[],used_selns=[];selections.each(function(){var ev_oc_id=$j(this).attr("data-ev-oc-id");ev_oc_ids.push(ev_oc_id)});for(var j=0;j<selection_categories.length;j++){var selection_category=selection_categories[j],seln_count=0;selections.each(function(){var ev_oc_id=$j(this).attr("data-ev-oc-id");if(ob.fb.fun_cpn.selections[ev_oc_id][selection_category]==1){seln_count++;used_selns.push(ev_oc_id)}});if(seln_count<num_selns){correct_category=false;break}};for(var k=0;k<ev_oc_ids.length;k++)if($j.inArray(ev_oc_ids[k],used_selns)==-1){correct_category=false;break};if(correct_category&&num_selns>best_lucky_dip.num_selns){best_lucky_dip.num_selns=num_selns;best_lucky_dip.id=i}};if(best_lucky_dip.id===-1)return false;var active_ldip=ob.fb.fun_cpn.content_area.find(".btn-ldip[data-lucky-dip='"+best_lucky_dip.id+"']");ob.fb.fun_cpn.slip.setActiveLuckyDip(active_ldip);if(ldip_categories.length>1){var active_ldip_option=active_ldip.siblings(".fbc-square-cs-odds[data-lucky-dip-option='"+ldip_option_num+"']");if(!active_ldip_option.hasClass("active"))ob.fb.fun_cpn.slip.toggleActiveLuckyDipOption(active_ldip_option)};return true};ob.fb.fun_cpn.slip.toggleActiveLuckyDipOption=function(e){var is_active=!($j(e).hasClass("active"));$j(".fbc-square-cs-odds").removeClass("active").children(".small-red-sln-x").hide();if(is_active){$j(e).addClass("active").children(".small-red-sln-x").toggle(is_active)}else $j(e).removeClass("active").children(".small-red-sln-x").toggle(is_active)};ob.fb.fun_cpn.slip.generateAccumulator=function(num_selns,selection_categories,randomise){var current_selns=[],current_prices=[];for(var i=0;i<selection_categories.length;i++){var selection_category=selection_categories[i],possible_selns=ob.fb.fun_cpn.slip.getSelectionsWithCategory(selection_category),j=0;while(possible_selns.length>0){if(randomise)var j=get_random_number(0,possible_selns.length-1);var ev_oc_id=possible_selns.splice(j,1)[0];if(!ob.fb.fun_cpn.slip.checkSelectionStatus(ev_oc_id))continue;current_selns.push(ev_oc_id);if(!ob.fb.fun_cpn.slip.checkCanCombine(current_selns)){current_selns.pop();continue};current_prices.push(parseFloat(ob.fb.fun_cpn.selections[ev_oc_id].lp_dec));if(current_selns.length===num_selns*(i+1))break};if(current_selns.length!==num_selns*(i+1))return};return[current_selns,current_prices]};ob.fb.fun_cpn.slip.getSelectionsWithCategory=function(selection_category,min_idx,max_idx){var possible_selns=[];if(typeof min_idx==="undefined")var min_idx=0;if(typeof max_idx==="undefined")var max_idx=ob.fb.fun_cpn.slip.ordered_selections.length;for(var i=min_idx;i<max_idx;i++){if(typeof selection_category!=="undefined"&&selection_category!==""&&ob.fb.fun_cpn.slip.ordered_selections[i][selection_category]!=1)continue;possible_selns.push(ob.fb.fun_cpn.slip.ordered_selections[i].ev_oc_id)};return possible_selns};ob.fb.fun_cpn.slip.calcCombinedPrice=function(price_array){var price=1;for(var i=0;i<price_array.length;i++)price*=price_array[i];return price};ob.fb.fun_cpn.slip.checkCanCombine=function(ev_oc_ids){var combinable=true,seen_selns={},seen_evs={},seen_mkts={};for(var i=0;i<ev_oc_ids.length;i++){var ev_oc_id=ev_oc_ids[i],selection=ob.fb.fun_cpn.selections[ev_oc_id],ev_mkt_id=selection.ev_mkt_id;if(ev_mkt_id in seen_mkts){combinable=false}else seen_mkts[ev_mkt_id]=true;if(ev_oc_id in seen_selns){combinable=false}else seen_selns[ev_oc_id]=true};return combinable};ob.fb.fun_cpn.slip.autoPopulate=function(){var qry_params=getQueryParams(),valid_arguments=[];switch(ob.fb.fun_cpn.config.cpn_sort){case"FBSM2":valid_arguments.push({name:"col1",category:"col1"});valid_arguments.push({name:"col2",category:"col2"});break;case"FBSM3":valid_arguments.push({name:"col1",category:"col1"});valid_arguments.push({name:"col2",category:"col2"});valid_arguments.push({name:"col3",category:"col3"});break;case"FBLL":valid_arguments.push({name:"home",category:"home"});valid_arguments.push({name:"draw",category:"draw"});valid_arguments.push({name:"away",category:"away"});break;case"FBS":break;case"FBHS":valid_arguments.push({name:"hotshots",category:"hotshot"});valid_arguments.push({name:"regulars",category:""});break;case"FBSB":valid_arguments.push({name:"yes",category:"Y"});valid_arguments.push({name:"no",category:"N"});break;case"FBCS":valid_arguments.push({name:"home",category:"home"});valid_arguments.push({name:"draw",category:"draw"});valid_arguments.push({name:"away",category:"away"});break;case"FBBN":valid_arguments.push({name:"bankers",category:"banker"});break;default:return};for(var i=0;i<valid_arguments.length;i++){var arg_name=valid_arguments[i].name,arg_value=qry_params[arg_name];if(typeof arg_value!=='undefined'&&/^\d+$/.test(arg_value)){arg_value=parseFloat(arg_value);var accum=ob.fb.fun_cpn.slip.generateAccumulator(arg_value,[valid_arguments[i].category],true);if(typeof accum==='undefined')return;var selns=accum[0];for(var i=0;i<selns.length;i++)ob.fb.fun_cpn.slip.add(selns[i]);return}};if(typeof qry_params.pickodds!=='undefined'){var pickodds_value=ob.fb.fun_cpn.slip.validatePriceInput(qry_params.pickodds);if(isFinite(pickodds_value.dec)&&pickodds_value.dec>1){if(pickodds_value.num!=""&&pickodds_value.den!=""){$j("#cpn_bs_pyo_input").val(format_price(pickodds_value.num,pickodds_value.den))}else $j("#cpn_bs_pyo_input").val(pickodds_value.dec);ob.fb.fun_cpn.slip.PYO();return}}};ob.fb.fun_cpn.slip.validatePriceInput=function(input_value){var ret={dec:-1,num:"",den:""};if(input_value.indexOf("/")!=-1){var re=/^[0-9]{1,4}\/[0-9]{1,4}$/;if(re.test(input_value)){ret.dec=parseFloat(frac_str_to_dec(input_value));var split_str=input_value.split("/");ret.num=split_str[0];ret.den=split_str[1]}}else{var re=/^[1-9][0-9]{0,3}(\.[0-9]{0,2})?$/;if(re.test(input_value))ret.dec=parseFloat(input_value)};return ret};ob.fb.fun_cpn.slip.getLuckyDip=function(e){var ldip=$j(e).attr("data-lucky-dip"),num_selns=ob.fb.fun_cpn.config.lucky_dip_settings[ldip].num_selns,selection_categories=ob.fb.fun_cpn.config.lucky_dip_settings[ldip].seln_categories;if(selection_categories.length===1){var target_odds=ob.fb.fun_cpn.config.lucky_dip_settings[ldip].price;selection_categories=selection_categories[0]}else{var ldip_option=$j(e).siblings(".fbc-square-cs-odds.active").attr("data-lucky-dip-option");if(typeof ldip_option==="undefined"){alert(ob.fb.fun_cpn.config.xlations.fb_fun_cpn_undefined_ldip);return};var target_odds=ob.fb.fun_cpn.config.lucky_dip_settings[ldip].price[ldip_option];selection_categories=selection_categories[ldip_option]};var min_acceptable_price=target_odds,max_acceptable_price=target_odds+ob.fb.fun_cpn.config.lucky_dip_settings[ldip].price_offset;ob.fb.fun_cpn.slip.randomSelect.generateBet(min_acceptable_price,max_acceptable_price,num_selns,true,selection_categories)};ob.fb.fun_cpn.slip.PYO=function(){var input_value=$j("#cpn_bs_pyo_input").val(),target_odds=ob.fb.fun_cpn.slip.validatePriceInput(input_value).dec;if(!isFinite(target_odds)||target_odds<=1){alert(ob.fb.fun_cpn.config.xlations.fb_fun_cpn_invalid_odds);return};var min_acceptable_price=target_odds*(1-ob.fb.fun_cpn.config.random_tolerance/100),max_acceptable_price=target_odds*(1+ob.fb.fun_cpn.config.random_tolerance/100),num_selns=ob.fb.fun_cpn.slip.randomSelect.getNumSelns(target_odds),selection_categories;if(ob.fb.fun_cpn.config.cpn_sort==="FBBN")selection_categories=["banker"];ob.fb.fun_cpn.slip.randomSelect.generateBet(min_acceptable_price,max_acceptable_price,num_selns,false,selection_categories)};ob.fb.fun_cpn.slip.randomSelect.generateBet=function(min_acceptable_price,max_acceptable_price,num_selns,apply_coupon_bonus_percentage,selection_categories){if(typeof apply_coupon_bonus_percentage==='undefined')var apply_coupon_bonus_percentage=false;if(typeof selection_categories==='undefined')var selection_categories=[""];var max_seln_idx=ob.fb.fun_cpn.slip.randomSelect.getUpperSelectionBound(max_acceptable_price);if(!ob.fb.fun_cpn.slip.randomSelect.checkPriceBounds(num_selns*selection_categories.length,max_seln_idx,min_acceptable_price,max_acceptable_price))return false;var start_point=ob.fb.fun_cpn.slip.generateAccumulator(num_selns,selection_categories,true);if(typeof start_point==='undefined'){alert(ob.fb.fun_cpn.config.xlations.fb_fun_cpn_insufficient_selns);return false};var current_selns=start_point[0],current_prices=start_point[1],combinations_tried={},combi_key=current_selns.join("|");combinations_tried[combi_key]=true;var current_price=ob.fb.fun_cpn.slip.calcCombinedPrice(current_prices);if(apply_coupon_bonus_percentage==true)current_price+=ob.fb.fun_cpn.slip.getBonus(current_price);while(current_price<min_acceptable_price||current_price>max_acceptable_price){if(current_price<min_acceptable_price){var direction="increase"}else var direction="decrease";var replaced_seln_idx=ob.fb.fun_cpn.slip.randomSelect.replaceRandomSeln(current_selns,max_seln_idx,direction,combinations_tried,selection_categories,num_selns);if(replaced_seln_idx==-1){alert(ob.fb.fun_cpn.config.xlations.fb_fun_cpn_no_price);return false};var new_seln_idx=ob.fb.fun_cpn.slip.randomSelect.getOrderedIndex(current_selns[replaced_seln_idx]);current_prices[replaced_seln_idx]=parseFloat(ob.fb.fun_cpn.slip.ordered_selections[new_seln_idx].lp_dec);var current_price=ob.fb.fun_cpn.slip.calcCombinedPrice(current_prices);if(apply_coupon_bonus_percentage==true)current_price+=ob.fb.fun_cpn.slip.getBonus(current_price)};ob.fb.fun_cpn.slip.clear();for(var j=0;j<current_selns.length;j++){var ev_oc_id=current_selns[j];ob.fb.fun_cpn.slip.add(ev_oc_id)};return true};ob.fb.fun_cpn.slip.randomSelect.getNumSelns=function(target_odds){var num_selns=-1,smallest_odds=-1;for(var odds in ob.fb.fun_cpn.config.pyo_num_selns){var config_odds=parseFloat(odds);if(target_odds<=config_odds&&(config_odds<smallest_odds||smallest_odds===-1)){num_selns=ob.fb.fun_cpn.config.pyo_num_selns[odds];smallest_odds=config_odds}};if(num_selns==-1)num_selns=ob.fb.fun_cpn.config.pyo_num_selns[odds];return num_selns};ob.fb.fun_cpn.slip.randomSelect.getUpperSelectionBound=function(max_acceptable_price){var max_seln_idx=ob.fb.fun_cpn.slip.ordered_selections.length-1;for(var i=0;i<ob.fb.fun_cpn.slip.ordered_selections.length;i++)if(parseFloat(ob.fb.fun_cpn.slip.ordered_selections[i].lp_dec)>max_acceptable_price){var max_seln_idx=i-1;break};return max_seln_idx};ob.fb.fun_cpn.slip.randomSelect.checkPriceBounds=function(num_selns,max_seln_idx,min_acceptable_price,max_acceptable_price){var min_prices=[];for(var j=0;j<num_selns;j++)min_prices.push(parseFloat(ob.fb.fun_cpn.slip.ordered_selections[j].lp_dec));var min_createable_price=ob.fb.fun_cpn.slip.calcCombinedPrice(min_prices);if(min_createable_price>max_acceptable_price){alert(ob.fb.fun_cpn.config.xlations.fb_fun_cpn_price_low);return false};var max_prices=[];for(var j=max_seln_idx;j>max_seln_idx-num_selns;j--)max_prices.push(parseFloat(ob.fb.fun_cpn.slip.ordered_selections[j].lp_dec));var max_createable_price=ob.fb.fun_cpn.slip.calcCombinedPrice(max_prices);if(max_createable_price<min_acceptable_price){alert(ob.fb.fun_cpn.config.xlations.fb_fun_cpn_price_high);return false};return true};ob.fb.fun_cpn.slip.randomSelect.replaceRandomSeln=function(current_selns,max_seln_idx,direction,combinations_tried,selection_categories,num_selns){var unchangeable_selns=[];while(unchangeable_selns.length!=current_selns.length){var r=get_random_number(0,current_selns.length-1);while(unchangeable_selns.indexOf(r)>-1)r=get_random_number(0,current_selns.length-1);var random_seln=current_selns[r],seln_idx=ob.fb.fun_cpn.slip.randomSelect.getOrderedIndex(random_seln);if(direction=="increase"){var min_idx=seln_idx,max_idx=max_seln_idx}else if(direction=="decrease"){var min_idx=0,max_idx=seln_idx};if(min_idx==max_idx){unchangeable_selns.push(r);continue};var selection_category=selection_categories[Math.floor(r/num_selns)];if(!ob.fb.fun_cpn.slip.randomSelect.replaceSeln(current_selns,r,min_idx,max_idx,combinations_tried,selection_category)){unchangeable_selns.push(r);continue};return r};return-1};ob.fb.fun_cpn.slip.randomSelect.replaceSeln=function(current_selns,r,min_idx,max_idx,combinations_tried,selection_category){var possible_selns=ob.fb.fun_cpn.slip.getSelectionsWithCategory(selection_category,min_idx,max_idx),original_seln=current_selns[r];while(possible_selns.length>0){var n=get_random_number(0,possible_selns.length-1);current_selns[r]=possible_selns[n];possible_selns.splice(n,1);if(!ob.fb.fun_cpn.slip.checkSelectionStatus(current_selns[r])){current_selns[r]=original_seln;continue};if(!ob.fb.fun_cpn.slip.checkCanCombine(current_selns)){current_selns[r]=original_seln;continue};var combi_key=current_selns.join("|");if(combi_key in combinations_tried){current_selns[r]=original_seln;continue};combinations_tried[combi_key]=true;return true};return false};ob.fb.fun_cpn.slip.randomSelect.getOrderedIndex=function(ev_oc_id){var index=-1;for(var i=0;i<ob.fb.fun_cpn.slip.ordered_selections.length;i++)if(ob.fb.fun_cpn.slip.ordered_selections[i].ev_oc_id==ev_oc_id){var index=i;break};return index};ob.fb.fun_cpn.slip.getBonus=function(value){return value*ob.fb.fun_cpn.config.coupon_bonus_percent/100};var Combined_bets={};Combined_bets.calc_cb_price=function(prices_array,rounding){if(prices_array.length%2!=0)return{success:false};var numOfPairs=prices_array.length/2,p_nums=[],p_dens=[],j=0;for(var i=0;i<prices_array.length;i=i+2){p_nums[j]=parseInt(prices_array[i]);p_dens[j]=parseInt(prices_array[i+1]);j++};if(numOfPairs==1){var p_num=p_nums[0],p_den=p_dens[0],price=1.0+(parseFloat(p_nums[0])/parseFloat(p_dens[0])),p_dec=price.toFixed(4),p_dec3dp=price.toFixed(3),p_dec2dp=price.toFixed(2)}else{var x=1,y=0;for(var i=0;i<numOfPairs;i++){var prev_x=x,prev_y=y;x=(p_nums[i]+p_dens[i])*prev_x;y=((p_nums[i]+p_dens[i])*prev_y)+(p_dens[i]*prev_x)};var calc_price=x/y,lookup_price=ob.price_ladder.round(calc_price,rounding.toLowerCase(),false);if(typeof lookup_price==="undefined")return{success:false};var p_dec=lookup_price.p_dec,p_dec3dp=lookup_price.p_dec3dp,p_dec2dp=lookup_price.p_dec2dp,p_num=lookup_price.p_num,p_den=lookup_price.p_den;return{success:true,p_dec:p_dec,p_dec3dp:p_dec3dp,p_dec2dp:p_dec2dp,p_num:p_num,p_den:p_den}}};Combined_bets.place_cb_bet=function(selections,combined_price_num,combined_price_den,ev_mkt_id,bet_origin){var ev_oc_ids="";for(var i=0;i<selections.length-1;i++)ev_oc_ids+=selections[i]+"c";ev_oc_ids+=selections[selections.length-1];BS_set_leg('leg_sort','CB');BS_set_leg('price_type','L');BS_set_leg('selections',ev_oc_ids);BS_set_leg('lp_num',combined_price_num);BS_set_leg('lp_den',combined_price_den);BS_set_leg('mult_incl',"N");if((typeof bet_origin!='undefined')&&(bet_origin!=undefined)&&(bet_origin!=""))BS_set_leg('bet_origin',bet_origin);BS_select_bet('CB_'+ev_oc_ids);BS_go_bets();return true};ob.price_ladder={};ob.price_ladder.loadData=function(){if(typeof ob.price_ladder.data==="undefined")ob.price_ladder.data=$j.parseJSON($j("#price_ladder_data").html())};ob.price_ladder.lookup=function(decimal_price){ob.price_ladder.loadData();for(i=0;i<ob.price_ladder.data.length;i++)if(ob.price_ladder.data[i].p_dec==decimal_price){index=i;break};return ob.price_ladder.data[index]};ob.price_ladder.round=function(decimal_price,rounding,allow_below_min,allow_above_max){ob.price_ladder.loadData();var index=-1;if(typeof rounding==="undefined"||rounding=="")rounding="nearest";if(typeof allow_below_min==="undefined"||allow_below_min=="")allow_below_min=true;if(typeof allow_above_max==="undefined"||allow_above_max=="")allow_above_max=true;if(ob.price_ladder.data[0].p_dec>decimal_price){if(allow_below_min)index=0;return ob.price_ladder.data[index]};for(i=0;i<ob.price_ladder.data.length;i++)if(ob.price_ladder.data[i].p_dec==decimal_price){index=i;break}else if(decimal_price<ob.price_ladder.data[i].p_dec){if(rounding=="up"){index=i}else if(rounding="down"){index=i-1}else if(ob.price_ladder.data[i].p_dec-decimal_price<decimal_price-ob.price_ladder.data[i-1].p_dec){index=i}else index=i-1;break};if(index==-1){var len=ob.price_ladder.data.length-1;if(ob.price_ladder.data[len].p_dec<decimal_price&&allow_above_max)index=len};return ob.price_ladder.data[index]}