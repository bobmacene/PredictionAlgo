function lb_betradar_init(ev_id,last_livescore_msg_id){_lb_betradar_ev_id=ev_id;_lb_betradar_last_msg_id=last_livescore_msg_id;var padded_ev_id=ps_connect_lpad_id(ev_id),channels=["sBREVT"+padded_ev_id];ps_connect_register("betradar",_lb_betradar_got_msg,channels,_lb_betradar_last_msg_id);return};var _lb_betradar_ev_id=-1,_lb_betradar_last_msg_id=""
function lb_betradar_cleanup(){ps_connect_deregister("betradar")}
function _lb_betradar_got_msg(msg){if(msg.subject_level=="sBREVT"&&msg.subject_id==_lb_betradar_ev_id){eval("betradar_json="+msg.data+";");betradar_json_str=msg.data;_lb_betradar_last_msg_id=msg.msg_id}}
function lb_calendar_live_init(new_data,call_type,classes,types,events,markets,selcns,server_time_year,server_time_month,server_time_day,server_time_hour,server_time_min,server_time_sec,is_fin,init_msg_id,cfg,is_news){if(new_data==0)return;_lb_cal_live_last_msg_id=init_msg_id;var f="";for(f in cfg)_lb_cal_live_cfg[f]=cfg[f];var channels=[],update_expanders=0,previous_data=0;_lb_cal_live_default_expanded_class="";lb_cal_live_obj.is_news=is_news;if(is_news)lb_cal_live_cmp_objects.cmpClasses=function(cmpMode,classA,classB){if(classA.ev_class_id==_lb_cal_live_cfg.default_class){return-1}else if(classB.ev_class_id==_lb_cal_live_cfg.default_class)return 1;var d=classA.disporder-classB.disporder;if(d)return d;return classA.ev_type_id-classB.ev_type_id};if(call_type=="http"){_lb_cal_live_store_templates();_lb_cal_live_class_hash={};_lb_cal_live_type_hash={};_lb_cal_live_event_hash={};_lb_cal_live_evmkt_hash={};_lb_cal_live_selcn_hash={};var first_build=true;scone_create(_lb_cal_live_class_area_id,{},lb_cal_live_cmp_objects.cmpClasses,null);initPeriodClocks(server_time_year,server_time_month,server_time_day,server_time_hour,server_time_min,server_time_sec,_lb_cal_live_cfg.lang);if(cfg.is_default_tab)$j("#"+_lb_cal_live_class_area_id).parent().show()}else{for(var i in _lb_cal_live_class_hash){previous_data=1;break};push_hash_prune_drilldown(lb_cal_live_obj,"CLASS","EVOC","CLASS",classes);push_hash_prune_drilldown(lb_cal_live_obj,"CLASS","EVOC","TYPE",types);var first_build=false};for(var i=0;i<classes.length;i++){update_expanders=1;if(is_fin==0){_lb_cal_live_got_CLASS(classes[i],first_build,i)}else _lb_cal_live_fin_got_CLASS(classes[i],first_build,i)};for(var i=0;i<types.length;i++)_lb_cal_live_got_TYPE(types[i],first_build,i,is_fin);for(var i=0;i<events.length;i++){if(call_type=="http"||(!_lb_cal_live_event_hash[events[i].ev_id])){_lb_cal_live_got_EVENT(events[i],first_build,is_fin,is_news)}else if(call_type=="js"&&_lb_cal_live_event_hash[events[i].ev_id]){var event_copy=_lb_cal_live_event_hash[events[i].ev_id],changed=false;if(event_copy.num_mkts!=events[i].num_mkts){event_copy.num_mkts=events[i].num_mkts;changed=true};if(event_copy.disporder!=events[i].disporder){event_copy.disporder=events[i].disporder;changed=true};if(event_copy.ev_stream_available!=events[i].ev_stream_available){event_copy.ev_stream_available=events[i].ev_stream_available;changed=true};if(changed)_lb_cal_live_got_EVENT(event_copy,first_build,is_fin,is_news)};if(!_lb_cal_live_channels["EVENT"+events[i].ev_id]){channels.push("sEVENT"+ps_connect_lpad_id(events[i].ev_id));_lb_cal_live_channels["EVENT"+events[i].ev_id]=true}};for(var i=0;i<markets.length;i++){if(call_type=="http"||(!_lb_cal_live_evmkt_hash[markets[i].ev_mkt_id]))if(is_fin==0){_lb_cal_live_got_EVMKT(markets[i],first_build,false,is_news)}else _lb_cal_live_fin_got_EVMKT(markets[i],first_build);if(!_lb_cal_live_channels["MARKET"+markets[i].ev_mkt_id]){channels.push("sEVMKT"+ps_connect_lpad_id(markets[i].ev_mkt_id));channels.push("SEVMKT"+ps_connect_lpad_id(markets[i].ev_mkt_id));_lb_cal_live_channels["MARKET"+markets[i].ev_mkt_id]=true}};for(var i=0;i<selcns.length;i++)if(call_type=="http"||(!_lb_cal_live_selcn_hash[selcns[i].ev_oc_id]))_lb_cal_live_got_SELCN(selcns[i],first_build,is_fin,is_news);if(update_expanders==1)if(first_build==1){cal_update_expanders(lb_cal_live_obj)}else if(previous_data==0)if(is_fin==0){lb_cal_expand_filtered_class(lb_cal_live_obj)}else lb_cal_expand_filtered_type(lb_cal_live_obj);if(channels.length>0){ps_connect_register("lb_cal_live"+live_cal_idx,_lb_cal_live_got_msg,channels,init_msg_id);live_cal_idx++};cal_update_num_ev_headers(lb_cal_live_obj,1);cal_update_display_div(lb_cal_live_obj,0);return}
function lb_calendar_live_filter_sports(){lb_cal_sync_hashes_and_display(lb_cal_live_obj,1);lb_cal_expand_filtered_class(lb_cal_live_obj);cal_update_num_ev_headers(lb_cal_live_obj,1);return}
function lb_calendar_live_filter_types(){lb_cal_sync_hashes_and_display(lb_cal_live_obj,1);lb_cal_expand_filtered_type(lb_cal_live_obj);return}
function lb_calendar_live_filter_stream(){lb_cal_sync_hashes_and_display(lb_cal_live_obj,1)};var live_cal_idx=0,_lb_cal_live_default_expanded_class="",_lb_cal_live_class_area_id="ifLiveCalCnt",_lb_cal_live_no_data_area_id="liveNow_no_bir_cal_data",_lb_cal_live_tab_num_evs_id="lb_cal_live_all_title",_lb_cal_live_class_num_evs_id_prefix="lb_cal_live_class_title_",_lb_cal_live_class_id_prefix="lb_cal_live_class_",_lb_cal_live_class_template_name="lb_cal_live_class",_lb_cal_live_types_id_prefix="lb_cal_live_types_",_lb_cal_live_type_id_prefix="lb_cal_live_type_",_lb_cal_live_type_template_name="lb_cal_live_type",_lb_cal_live_events_id_prefix="lb_cal_live_events_",_lb_cal_live_event_id_prefix="lb_cal_live_event_",_lb_cal_live_event_template_name="lb_cal_live_event",_lb_cal_live_markets_id_prefix="lb_cal_live_markets_",_lb_cal_live_market_id_prefix="lb_cal_live_market_",_lb_cal_live_selcns_id_prefix="lb_cal_live_selcns_",_lb_cal_live_selcn_item_id_prefix="lb_cal_live_selcn_item_",_lb_cal_live_selcn_id_prefix="lb_cal_live_selcn_",_lb_cal_live_selcn_highlight_id_prefix="lb_cal_live_selcn_hl_",_lb_cal_live_level_con_id_prefix="lb_cal_live_hcap_level_con_",_lb_cal_live_level_class_name="level",_lb_cal_live_event_clock_id_prefix="lb_cal_live_clock_",_lb_cal_live_price_class_name="odd",_lb_cal_live_new_item_id_prefix="lb_cal_live_new_item_",_lb_cal_live_channels={},_lb_cal_live_ev_count={},_lb_cal_live_highlight_timers={},_lb_cal_live_class_top_type={},_lb_cal_live_type_top_ev={},_lb_cal_live_category_class_map={},_lb_cal_live_class_category_map={}
function lb_cal_live_object(){return};lb_cal_live_object.prototype.getConfig=function(){return _lb_cal_live_cfg};lb_cal_live_object.prototype.getHash=function(identifier){var ret="";switch(identifier){case"CLASS":if(_lb_cal_live_class_hash)ret=_lb_cal_live_class_hash;break;case"TYPE":if(_lb_cal_live_type_hash)ret=_lb_cal_live_type_hash;break;case"EVENT":if(_lb_cal_live_event_hash)ret=_lb_cal_live_event_hash;break;case"EVMKT":if(_lb_cal_live_evmkt_hash)ret=_lb_cal_live_evmkt_hash;break;case"EVOC":if(_lb_cal_live_selcn_hash)ret=_lb_cal_live_selcn_hash;break;case"HL_TIMERS":if(_lb_cal_live_highlight_timers)ret=_lb_cal_live_highlight_timers;break;case"EV_COUNT":if(_lb_cal_live_ev_count)ret=_lb_cal_live_ev_count;break;default:ret=""};return ret};lb_cal_live_object.prototype.getHashId=function(identifier,id){var ret="";switch(identifier){case"CLASS":if(_lb_cal_live_class_hash&&_lb_cal_live_class_hash[id])ret=_lb_cal_live_class_hash[id];break;case"TYPE":if(_lb_cal_live_type_hash&&_lb_cal_live_type_hash[id])ret=_lb_cal_live_type_hash[id];break;case"EVENT":if(_lb_cal_live_event_hash&&_lb_cal_live_event_hash[id])ret=_lb_cal_live_event_hash[id];break;case"EVMKT":if(_lb_cal_live_evmkt_hash&&_lb_cal_live_evmkt_hash[id])ret=_lb_cal_live_evmkt_hash[id];break;case"EVOC":if(_lb_cal_live_selcn_hash&&_lb_cal_live_selcn_hash[id])ret=_lb_cal_live_selcn_hash[id];break;case"HL_TIMERS":if(_lb_cal_live_highlight_timers&&_lb_cal_live_highlight_timers[id])ret=_lb_cal_live_highlight_timers[id];break;case"EV_COUNT":if(_lb_cal_live_ev_count&&_lb_cal_live_ev_count[id])ret=_lb_cal_live_ev_count[id];break;case"TYPE_TOP_EVENT":if(_lb_cal_live_type_top_ev&&_lb_cal_live_type_top_ev[id])ret=_lb_cal_live_type_top_ev[id];break;case"CLASS_TOP_TYPE":if(_lb_cal_live_class_top_type&&_lb_cal_live_class_top_type[id])ret=_lb_cal_live_class_top_type[id];break;case"CATEGORY_CLASSES":if(_lb_cal_live_category_class_map&&_lb_cal_live_category_class_map[id])ret=_lb_cal_live_category_class_map[id];break;default:ret=""};return ret};lb_cal_live_object.prototype.getMiscInfo=function(identifier){var ret="";switch(identifier){case"PRICE_CLASS_NAME":if(_lb_cal_live_price_class_name)ret=_lb_cal_live_price_class_name;break;case"TAB_NUM_EVS_ID":if(_lb_cal_live_tab_num_evs_id)ret=_lb_cal_live_tab_num_evs_id;break;case"TAB_AREA_ID":if(_lb_cal_live_class_area_id)ret=_lb_cal_live_class_area_id;break;case"TAB_NO_DATA_AREA_ID":if(_lb_cal_live_no_data_area_id)ret=_lb_cal_live_no_data_area_id;break;case"DEFAULT_EXPANDED_CLASS":if(_lb_cal_live_default_expanded_class)ret=_lb_cal_live_default_expanded_class;break;case"LEVEL_CLASS_NAME":if(_lb_cal_live_level_class_name)ret=_lb_cal_live_level_class_name;break;default:ret=""};return ret};lb_cal_live_object.prototype.getIdPrefix=function(identifier){var ret="";switch(identifier){case"CLASS":if(_lb_cal_live_class_id_prefix)ret=_lb_cal_live_class_id_prefix;break;case"TYPE":if(_lb_cal_live_type_id_prefix)ret=_lb_cal_live_type_id_prefix;break;case"EVENT":if(_lb_cal_live_event_id_prefix)ret=_lb_cal_live_event_id_prefix;break;case"EVMKT":if(_lb_cal_live_market_id_prefix)ret=_lb_cal_live_market_id_prefix;break;case"EVOC":if(_lb_cal_live_selcn_item_id_prefix)ret=_lb_cal_live_selcn_item_id_prefix;break;case"NEW_ITEM":if(_lb_cal_live_new_item_id_prefix)ret=_lb_cal_live_new_item_id_prefix;break;case"SELCN_HL":if(_lb_cal_live_selcn_highlight_id_prefix)ret=_lb_cal_live_selcn_highlight_id_prefix;break;case"CLASS_NUM_EVS_ID":if(_lb_cal_live_class_num_evs_id_prefix)ret=_lb_cal_live_class_num_evs_id_prefix;break;case"LEVEL_CONTAINER":if(_lb_cal_live_level_con_id_prefix)ret=_lb_cal_live_level_con_id_prefix;break;default:ret=""};return ret};lb_cal_live_object.prototype.forceRebuildItem=function(identifier,data){switch(identifier){case"CLASS":if(data.is_fin){_lb_cal_live_fin_got_CLASS(data,false,"")}else _lb_cal_live_got_CLASS(data,false,"");break;case"TYPE":_lb_cal_live_got_TYPE(data,false,"",data.is_fin);break;case"EVENT":_lb_cal_live_got_EVENT(data,false,data.is_fin,data.is_news);break;default:};return};lb_cal_live_object.prototype.getTemplateName=function(identifier,is_fin){var ret="";switch(identifier){case"CLASS":ret=_lb_cal_live_class_template_name;break;case"TYPE":ret=_lb_cal_live_type_template_name;break;case"EVENT":ret=_lb_cal_live_event_template_name;break;default:ret=""};if(is_fin==1)ret=ret+"_fin";return ret};lb_cal_live_object.prototype.clearHash=function(identifier){switch(identifier){case"EV_COUNT":if(_lb_cal_live_ev_count)_lb_cal_live_ev_count={};break;default:}};lb_cal_live_object.prototype.gotPushData=function(identifier,data){switch(identifier){case"PRICE":_lb_cal_live_got_PRICE(data);break;case"SELCN":_lb_cal_live_got_SELCN(data,false,"","");break;case"MHCAP":_lb_cal_live_got_MHCAP(data,"");break;case"EVMKT":_lb_cal_live_got_EVMKT(data,false,false,"");break;case"EVENT":_lb_cal_live_got_EVENT(data,false,"","");break;default:};return};var lb_cal_live_obj=new lb_cal_live_object(),lb_cal_live_cmp_objects=new function(){}();lb_cal_live_cmp_objects=new push_hash_cmp_objects();lb_cal_live_cmp_objects.cmpEvents=function(cmpMode,evA,evB){var t=evA.start_time_disp_order-evB.start_time_disp_order;if(t)return t;var d=evA.disporder-evB.disporder;if(d)return d;return evA.ev_id-evB.ev_id}
function _lb_cal_live_store_templates(){var tmp=[];tmp.push('	<div id="lb_cal_live_class_<%ev_class_id%>" <%IF hidden%>style="display:none"<%END%>>\n');tmp.push('		<div class="itemHeader">\n');tmp.push('			<a href="javascript:void(0)" class="<%IF collapsed%>off<%ELSE%>on<%END%>" onclick="lb_cal_live_expand_class(this, <%ev_class_id%>);" title="<%XL BIR_LIVE_BETTING_TOGGLE_EXPAND%>"><%name%> <span class="cal_num_live_events" id="lb_cal_live_class_title_<%ev_class_id%>"></span></a>\n');tmp.push('		</div>\n');tmp.push('		<div class="itemContent" id="lb_cal_live_types_<%ev_class_id%>" <%IF collapsed%>style="display: none"<%END%>>\n');tmp.push('		</div>\n');tmp.push('	</div>\n');tmpl_store("lb_cal_live_class",tmp.join(""));var tmp=[];tmp.push('	<div class="subItem" id="lb_cal_live_type_<%ev_type_id%>" <%IF hidden%>style="display:none"<%END%>>\n');tmp.push('		<div class="itemHeader off">\n');tmp.push('			<a href="javascript:void(0)" class="<%IF collapsed%>off<%ELSE%>on<%END%>" onclick="lb_cal_live_expand_type(this, <%ev_type_id%>);" title="<%XL BIR_LIVE_BETTING_TOGGLE_EXPAND%>"><%name%></a>\n');tmp.push('		</div>\n');tmp.push('		<div class="itemContent" id="lb_cal_live_events_<%ev_type_id%>" <%IF collapsed%>style="display: none"<%END%>>\n');tmp.push('		</div>\n');tmp.push('	</div>\n');tmpl_store("lb_cal_live_type",tmp.join(""));var tmp=[];tmp.push('	<div class="subItem" id="lb_cal_live_event_<%ev_id%>" <%IF hidden%>style="display:none"<%END%>>\n');tmp.push('		<div class="itemHeader <%IF show_score%>score_visible_header<%ELSE%>score_hidden_header<%END%>">\n');tmp.push('			<a href="javascript:void(0)" class="<%IF collapsed%>off<%ELSE%>on<%END%> <%IF show_score%>score_visible<%ELSE%>score_hidden<%END%>" onclick="lb_cal_live_expand_event(this, <%ev_id%>);" title="<%XL BIR_LIVE_BETTING_TOGGLE_EXPAND%>">\n');tmp.push('				<span class="left lnkUrl" title="<%full_name%>">\n');tmp.push('					<span style="display:none"><%_lb_cal_live_cfg.event_url%><%ev_id%></span>\n');tmp.push('					<%name%>');tmp.push('				</span>');tmp.push(' 			<%IF venue !=""%>');tmp.push('					<span title="Neutral Venue: <%venue%>" class="venueIcon"></span>');tmp.push('    			<%END%>\n');tmp.push('				<%IF new_item %>\n');tmp.push('					<span class="new left" id="lb_cal_live_new_item_EVENT_<%ev_id%>"><%XL BIR_LIVE_BETTING_NEW%></span>\n');tmp.push('				<%END%>\n');tmp.push('				<span <%IF is_news%>class="left score"<%ELSE%>class="right"<%END%>>\n');tmp.push('					<%IF show_score%><%score_home%> - <%score_away%><%END%>\n');tmp.push('					<%IF period_id != "" && show_bir_clocks == "Y"%><span class="time" id="lb_cal_live_clock_<%ev_id%>"></span><%END%>\n');tmp.push('				</span>\n');tmp.push('			</a>\n');tmp.push('		</div>\n');tmp.push('		<div class="itemContent" <%IF collapsed%>style="display: none"<%END%> >\n');tmp.push('			<div id="lb_cal_live_markets_<%ev_id%>">\n');tmp.push('			</div>\n');tmp.push('		</div>\n');tmp.push('	</div>\n');tmpl_store("lb_cal_live_event",tmp.join(""));var tmp=[];tmp.push('	<div id="lb_cal_live_market_<%ev_mkt_id%>">\n');tmp.push('		<div<%IF !bettable%> style="display:none"<%END%> id="lb_cal_live_selcns_<%ev_mkt_id%>">\n');tmp.push('		</div>\n');tmp.push('		<%IF !bettable%>\n');tmp.push('			<table>\n');tmp.push('				<tr>\n');tmp.push('					<td>\n');tmp.push('						<div class="suspended">\n');tmp.push('							<%XL BIR_LIVE_BETTING_SUSPENDED%>\n');tmp.push('						</div>\n');tmp.push('					</td>\n');tmp.push('				</tr>\n');tmp.push('			</table>\n');tmp.push('		<%END%>\n');tmp.push('	</div>\n');tmpl_store("lb_cal_live_market",tmp.join(""));var tmp=[];tmp.push('	<div class="itemElt" id="lb_cal_live_selcn_item_<%ev_oc_id%>">\n');tmp.push('		<div class="name left">\n');tmp.push('			<%name%>\n');tmp.push('		</div>\n');tmp.push('		<div class="oddWp right">\n');tmp.push('			<div id="lb_cal_live_selcn_hl_<%ev_oc_id%>" <%IF bettable%>class="odd"<%ELSE%>class="oddsuspended"<%END%>>\n');tmp.push('				<a <%IF bettable%>title="<%price_str%>" href="javascript:void(0)" onclick="lb_cal_live_add_bet(<%ev_oc_id%>,<%IF is_news%>\'LB_CAL_NEWS\'<%ELSE%>\'LB_CAL\'<%END%>)"<%END%> id="lb_cal_live_selcn_<%ev_oc_id%>">\n');tmp.push('					<%price_str%>\n');tmp.push('				</a>\n');tmp.push('			</div>\n');tmp.push('		</div>\n');tmp.push('		<%IF hcap_value%>\n');tmp.push('		<div id="lb_cal_live_hcap_level_con_<%ev_oc_id%>" class="level right">\n');tmp.push('			<%hcap_value%>\n');tmp.push('		</div>\n');tmp.push('		<%END%>\n');tmp.push('		<div class="clear"></div>\n');tmp.push('	</div>\n');tmpl_store("lb_cal_live_selcn",tmp.join(""));var tmp=[];tmp.push('	<div id="lb_cal_live_class_<%ev_class_id%>" <%IF hidden%>style="display:none"<%END%>>\n');tmp.push('		<div id="lb_cal_live_types_<%ev_class_id%>">\n');tmp.push('		</div>\n');tmp.push('	</div>\n');tmpl_store("lb_cal_live_class_fin",tmp.join(""));var tmp=[];tmp.push('	<div class="subItem" id="lb_cal_live_type_<%ev_type_id%>" <%IF hidden%>style="display:none"<%END%>>\n');tmp.push('		<div class="itemHeader off">\n');tmp.push('			<a href="javascript:void(0)" class="<%IF collapsed%>off<%ELSE%>on<%END%>" onclick="lb_cal_live_expand_type(this, <%ev_type_id%>);" title="<%XL BIR_LIVE_BETTING_TOGGLE_EXPAND%>"><%name%></a>\n');tmp.push('		</div>\n');tmp.push('		<div class="itemContent" id="lb_cal_live_events_<%ev_type_id%>" <%IF collapsed%>style="display: none"<%END%>>\n');tmp.push('		</div>\n');tmp.push('	</div>\n');tmpl_store("lb_cal_live_type_fin",tmp.join(""));var tmp=[];tmp.push('	<div class="subItem" id="lb_cal_live_event_<%ev_id%>" <%IF hidden%>style="display:none"<%END%>>\n');tmp.push('		<div class="itemHeader">\n');tmp.push('			<a href="javascript:void(0)" class="default">\n');tmp.push('				<span class="left lnkUrl" title="<%full_name%>">\n');tmp.push('					<span style="display:none"><%_lb_cal_live_cfg.fin_event_url%><%ev_id%></span>\n');tmp.push('					<%name%>\n');tmp.push('				</span>\n');tmp.push('			</a>\n');tmp.push('		</div>\n');tmp.push('		<div id="lb_cal_live_markets_<%ev_id%>">\n');tmp.push('		</div>\n');tmp.push('	</div>\n');tmpl_store("lb_cal_live_event_fin",tmp.join(""));var tmp=[];tmp.push('	<div id="lb_cal_live_market_<%ev_mkt_id%>">\n');tmp.push('		<div<%IF !bettable%> style="display:none"<%END%> id="lb_cal_live_selcns_<%ev_mkt_id%>">\n');tmp.push('		</div>\n');tmp.push('		<%IF !bettable%>\n');tmp.push('		<table>\n');tmp.push('			<tr>\n');tmp.push('				<td>\n');tmp.push('					<div class="suspended">\n');tmp.push('						<%XL BIR_LIVE_BETTING_SUSPENDED%>\n');tmp.push('					</div>\n');tmp.push('				</td>\n');tmp.push('			</tr>\n');tmp.push('		</table>\n');tmp.push('		<%END%>\n');tmp.push('	</div>\n');tmpl_store("lb_cal_live_market_fin",tmp.join(""));var tmp=[];tmp.push('	<div class="itemElt" id="lb_cal_live_selcn_item_<%ev_oc_id%>">\n');tmp.push('		<div class="name left">\n');tmp.push('			<%name%>\n');tmp.push('		</div>\n');tmp.push('		<div class="oddWp right">\n');tmp.push('			<div id="lb_cal_live_selcn_hl_<%ev_oc_id%>" <%IF bettable%>class="odd"<%ELSE%>class="oddsuspended"<%END%>>\n');tmp.push('				<a <%IF bettable%>title="<%price_str%>" href="javascript:void(0)" onclick="lb_cal_live_add_bet(<%ev_oc_id%>,<%IF is_news%>\'LB_CAL_NEWS\'<%ELSE%>\'LB_CAL\'<%END%>")"<%END%> id="lb_cal_live_selcn_<%ev_oc_id%>">\n');tmp.push('					<%price_str%>\n');tmp.push('				</a>\n');tmp.push('			</div>\n');tmp.push('		</div>\n');tmp.push('		<%IF has_hcap%>\n');tmp.push('		<div id="lb_cal_live_hcap_level_con_<%ev_oc_id%>" class="level right">\n');tmp.push('			<%hcap_value%>\n');tmp.push('		</div>\n');tmp.push('		<%END%>\n');tmp.push('		<div class="clear"></div>\n');tmp.push('	</div>\n');tmpl_store("lb_cal_live_selcn_fin",tmp.join(""))};var _lb_cal_live_cfg={lang:"en",price_str_type:"ODDS",price_str_type_ah:"DECIMAL",price_str_type_hl:"DECIMAL",price_str_sep:"-",highlight_duration:4e3,event_url:"",fin_event_url:"",name_truncate_threshold:28,default_class:"",geo_stream_allowed:"N",hl_class_decrease:"_d",hl_class_increase:"_i",hl_class_same:"",event_is_expandable:1}
function _lb_cal_live_got_msg(msg){bir_got_msg(lb_cal_live_obj,msg);if(msg.subject_level=="sEVENT")cal_update_num_ev_headers(lb_cal_live_obj,1);return}
function _lb_cal_live_got_CLASS(data,first_build,position){var info=_lb_cal_live_class_hash[data.ev_class_id],is_new_item=!info;if(is_new_item){info=data;_lb_cal_live_class_hash[data.ev_class_id]=info;info.child_hash={};info.normal_disporder=position+0.5;info.is_fin=0;info.collapsed_backup_class="";info.collapsed_backup_type="";info.collapsed_backup_event="";if(!_lb_cal_live_class_category_map[info.ev_class_id]){_lb_cal_live_class_category_map[info.ev_class_id]=info.ev_class_category;if(!_lb_cal_live_category_class_map[info.ev_class_category])_lb_cal_live_category_class_map[info.ev_class_category]=new Array();_lb_cal_live_category_class_map[info.ev_class_category].push(info.ev_class_id)};if(!first_build){info.new_item=true;push_schedule_unhighlight_new_item(lb_cal_live_obj,"CLASS",data.ev_class_id)}else{info.new_item=false;if(_lb_cal_live_default_expanded_class=="")_lb_cal_live_default_expanded_class=info.ev_class_id};info.collapsed=true}else{for(var f in data)info[f]=data[f];info.new_item=false};info.name=info.names[_lb_cal_live_cfg.lang];info.full_name=info.name;info.name=trunc_string(info.name,_lb_cal_live_cfg.name_truncate_threshold,'...');if(first_build==false){info.hidden=cal_filter_sports_check_display(info.ev_class_id,info.ev_class_category);if(info.hidden==false){cal_calc_ev_counts(lb_cal_live_obj);if(push_get_ev_counts(lb_cal_live_obj,"CLASS",info.ev_class_id)>0){info.hidden=false}else info.hidden=true}}else info.hidden=false;var scitem_id=_lb_cal_live_class_id_prefix+data.ev_class_id,pscone_id=_lb_cal_live_class_area_id;if(!scone_exists(pscone_id)||document.getElementById(pscone_id).parentNode.style.display=="none")return;var html=tmpl_play("lb_cal_live_class",info),sort_info={disporder:info.normal_disporder,ev_class_id:info.ev_class_id},was_visible=scone_item_exists(scitem_id);if(!was_visible){scone_add_item(pscone_id,scitem_id,html,sort_info);var cscone_id=_lb_cal_live_types_id_prefix+data.ev_class_id;scone_create(cscone_id,{},lb_cal_live_cmp_objects.cmpTypes,null)}else scone_replace_item(scitem_id,html,sort_info,true);if(info.new_item==true)info.new_item=false}
function _lb_cal_live_fin_got_CLASS(data,first_build,position){var info=_lb_cal_live_class_hash[data.ev_class_id],is_new_item=!info;if(is_new_item){info=data;_lb_cal_live_class_hash[data.ev_class_id]=info;info.child_hash={};info.is_fin=1;info.collapsed_backup_class="";info.collapsed_backup_type="";info.collapsed_backup_event="";info.collapsed=false;info.normal_disporder=position+0.5;if(!_lb_cal_live_class_category_map[info.ev_class_id]){_lb_cal_live_class_category_map[info.ev_class_id]=info.ev_class_category;if(!_lb_cal_live_category_class_map[info.ev_class_category])_lb_cal_live_category_class_map[info.ev_class_category]=new Array();_lb_cal_live_category_class_map[info.ev_class_category].push(info.ev_class_id)};if(!first_build){info.new_item=true}else{info.new_item=false;if(_lb_cal_live_default_expanded_class=="")_lb_cal_live_default_expanded_class=info.ev_class_id}}else{for(var f in data)info[f]=data[f];info.new_item=false};info.hidden=false;var scitem_id=_lb_cal_live_class_id_prefix+data.ev_class_id,pscone_id=_lb_cal_live_class_area_id;if(!scone_exists(pscone_id)||document.getElementById(pscone_id).parentNode.style.display=="none")return;var html=tmpl_play("lb_cal_live_class_fin",info),sort_info={disporder:info.normal_disporder,ev_class_id:info.ev_class_id},was_visible=scone_item_exists(scitem_id);if(!was_visible){scone_add_item(pscone_id,scitem_id,html,sort_info);var cscone_id=_lb_cal_live_types_id_prefix+data.ev_class_id;scone_create(cscone_id,{},lb_cal_live_cmp_objects.cmpTypes,null)}else scone_replace_item(scitem_id,html,sort_info,true)}
function _lb_cal_live_got_TYPE(data,first_build,position,is_fin){var parent_info=_lb_cal_live_class_hash[data.ev_class_id];if(!parent_info)return;parent_info.child_hash[data.ev_type_id]=true;var info=_lb_cal_live_type_hash[data.ev_type_id],is_new_item=!info;if(is_new_item){info=data;_lb_cal_live_type_hash[data.ev_type_id]=info;info.child_hash={};info.normal_disporder=position+0.5;info.collapsed_backup_class="";info.collapsed_backup_type="";info.collapsed_backup_event="";info.is_fin=is_fin;if(!first_build){info.new_item=true;push_schedule_unhighlight_new_item(lb_cal_live_obj,"TYPE",data.ev_type_id)}else{info.new_item=false;if(!_lb_cal_live_class_top_type[info.ev_class_id])_lb_cal_live_class_top_type[info.ev_class_id]=info.ev_type_id};info.collapsed=true}else{for(var f in data)info[f]=data[f];info.new_item=false};info.name=info.names[_lb_cal_live_cfg.lang];info.full_name=info.name;info.name=trunc_string(info.name,_lb_cal_live_cfg.name_truncate_threshold,'...');if(first_build==false){if(info.is_fin==1){info.hidden=cal_filter_fin_check_display(info.ev_type_id)}else info.hidden=false;cal_calc_ev_counts(lb_cal_live_obj);if(push_get_ev_counts(lb_cal_live_obj,"TYPE",info.ev_type_id)>0){info.hidden=false}else info.hidden=true}else info.hidden=false;var scitem_id=_lb_cal_live_type_id_prefix+info.ev_type_id,pscone_id=_lb_cal_live_types_id_prefix+info.ev_class_id;if(!scone_exists(pscone_id))return;if(info.is_fin==0){var html=tmpl_play("lb_cal_live_type",info)}else var html=tmpl_play("lb_cal_live_type_fin",info);var sort_info={disporder:info.normal_disporder,ev_type_id:info.ev_type_id},was_visible=scone_item_exists(scitem_id),is_visible=!parent_info.collapsed;if(!was_visible){if(is_visible){scone_add_item(pscone_id,scitem_id,html,sort_info);var cscone_id=_lb_cal_live_events_id_prefix+data.ev_type_id;scone_create(cscone_id,{},lb_cal_live_cmp_objects.cmpEvents,null)}}else scone_replace_item(scitem_id,html,sort_info,true);if(info.new_item==true)info.new_item=false}
function _lb_cal_live_got_EVENT(data,first_build,is_fin,is_news){var check_filters=1;if(first_build==true)check_filters=0;var info=_lb_cal_live_event_hash[data.ev_id],is_new_item=!info,orig_bettable;if(is_new_item){var type_info=_lb_cal_live_type_hash[data.ev_type_id]}else var type_info=_lb_cal_live_type_hash[info.ev_type_id];if(!type_info)return;type_info.child_hash[data.ev_id]=true;var class_info=_lb_cal_live_class_hash[type_info.ev_class_id];if(is_new_item){info=data;_lb_cal_live_event_hash[info.ev_id]=info;info.child_hash={};info.hidden=false;info.is_fin=is_fin;info.collapsed_backup_class="";info.collapsed_backup_type="";info.collapsed_backup_event="";if(!first_build){info.new_item=true;push_schedule_unhighlight_new_item(lb_cal_live_obj,"EVENT",data.ev_id)}else{info.new_item=false;if(!_lb_cal_live_type_top_ev[info.ev_type_id])_lb_cal_live_type_top_ev[info.ev_type_id]=info.ev_id};info.collapsed=true;addClockEvent(data.ev_id,class_info.periods,_lb_cal_live_event_clock_id_prefix)}else{orig_bettable=info.bettable;for(var f in data)info[f]=data[f];info.new_item=false};var class_elem_name=_lb_cal_live_class_id_prefix+type_info.ev_class_id,class_sort_info=scone_get_item_info(class_elem_name),type_elem_name=_lb_cal_live_type_id_prefix+info.ev_type_id,type_sort_info=scone_get_item_info(type_elem_name),type_html="",class_html="",update_areas=0,current_hidden;info.name=info.names[_lb_cal_live_cfg.lang];info.full_name=info.name;info.name=trunc_string(info.name,_lb_cal_live_cfg.name_truncate_threshold,'...');info.venue=info.venues[_lb_cal_live_cfg.lang];info.start_time_xl=info.start_time_xls[_lb_cal_live_cfg.lang];info.start_time_disp_order=time_in_milliseconds(info.start_time);info.bettable=(info.status=="A");if(_lb_cal_live_cfg.geo_stream_allowed=="N")info.ev_stream_available=false;if(check_filters==1)info.hidden=cal_filter_stream_check_display(info.ev_stream_available);if(is_news){info.is_news=1}else info.is_news=0;if(info.score_home==""||info.score_away==""){info.show_score=0}else info.show_score=1;var scitem_id=_lb_cal_live_event_id_prefix+info.ev_id,pscone_id=_lb_cal_live_events_id_prefix+info.ev_type_id;if(!scone_exists(pscone_id))return;if(info.is_fin==0){var html=tmpl_play("lb_cal_live_event",info)}else var html=tmpl_play("lb_cal_live_event_fin",info);var sort_info={disporder:info.disporder,ev_id:info.ev_id,start_time_disp_order:info.start_time_disp_order},was_visible=scone_item_exists(scitem_id),now_visible=(info.displayed=="Y"&&!type_info.collapsed&&!class_info.collapsed);if(!was_visible&&now_visible){scone_add_item(pscone_id,scitem_id,html,sort_info);var cscone_id=_lb_cal_live_markets_id_prefix+info.ev_id;scone_create(cscone_id,{},null,null);cal_calc_ev_counts(lb_cal_live_obj);if(push_get_ev_counts(lb_cal_live_obj,"TYPE",info.ev_type_id)==1&&!first_build){if(type_info.hidden==true){current_hidden=true;type_info.hidden=false;if(type_info.is_fin==1)type_info.hidden=cal_filter_fin_check_display(type_info.ev_type_id);if(current_hidden!=type_info.hidden){if(type_info.is_fin==0){type_html=tmpl_play("lb_cal_live_type",type_info)}else type_html=tmpl_play("lb_cal_live_type_fin",type_info);scone_replace_item(type_elem_name,type_html,type_sort_info,true)}};if(class_info.hidden==true){current_hidden=true;class_info.hidden=false;if(class_info.is_fin==0)class_info.hidden=cal_filter_sports_check_display(class_info.ev_class_id,class_info.ev_class_category);if(current_hidden!=class_info.hidden){if(class_info.is_fin==0){class_html=tmpl_play("lb_cal_live_class",class_info)}else class_html=tmpl_play("lb_cal_live_class_fin",class_info);scone_replace_item(class_elem_name,class_html,class_sort_info,true);update_areas=1}}}}else if(was_visible&&now_visible){scone_replace_item(scitem_id,html,sort_info,true)}else if(was_visible&&!now_visible){scone_remove_item(scitem_id);cal_calc_ev_counts(lb_cal_live_obj);if(push_get_ev_counts(lb_cal_live_obj,"TYPE",info.ev_type_id)==0)if(type_info.hidden==false){type_info.hidden=true;if(type_info.is_fin==0){var type_html=tmpl_play("lb_cal_live_type",type_info)}else var type_html=tmpl_play("lb_cal_live_type_fin",type_info);scone_replace_item(type_elem_name,type_html,type_sort_info,true)};if(push_get_ev_counts(lb_cal_live_obj,"CLASS",type_info.ev_class_id)==0)if(class_info.hidden==false){class_info.hidden=true;if(class_info.is_fin==0){var class_html=tmpl_play("lb_cal_live_class",class_info)}else var class_html=tmpl_play("lb_cal_live_class_fin",class_info);scone_replace_item(class_elem_name,class_html,class_sort_info,true);update_areas=1}};updatePeriodClock(info);if(now_visible&&(!was_visible||orig_bettable!=info.bettable))for(var ev_mkt_id in info.child_hash)if(info.is_fin==0){_lb_cal_live_got_EVMKT({ev_mkt_id:ev_mkt_id,ev_id:info.ev_id},false,false,is_news)}else _lb_cal_live_fin_got_EVMKT({ev_mkt_id:ev_mkt_id,ev_id:info.ev_id},first_build);if(update_areas==1)cal_update_display_div(lb_cal_live_obj,1);if(info.new_item==true)info.new_item=false}
function _lb_cal_live_got_EVMKT(data,first_build,ignore_check,is_news){var parent_info=_lb_cal_live_event_hash[data.ev_id];if(!parent_info)return;var info=_lb_cal_live_evmkt_hash[data.ev_mkt_id],is_new_item=!info;if(info&&info.is_fin&&info.is_fin==1){_lb_cal_live_fin_got_EVMKT(data,false);return};parent_info.child_hash[data.ev_mkt_id]=true;var upd_mkt_display=1;if(!first_build&&!ignore_check)upd_mkt_display=_lb_cal_live_validate_EVMKTS(data);var orig_displayed,orig_status,orig_disporder,orig_name,orig_bettable,orig_hcap_values;if(is_new_item){info=data;_lb_cal_live_evmkt_hash[data.ev_mkt_id]=info;info.child_hash={};info.is_fin=0;info.deleted=0}else{orig_displayed=info.displayed;orig_status=info.status;orig_disporder=info.disporder;orig_name=info.name;orig_bettable=info.bettable;orig_hcap_values=info.hcap_values;for(var f in data)info[f]=data[f]};info.name=info.names[_lb_cal_live_cfg.lang];if(info.bet_in_run!='Y')info.displayed='N';info.bettable=(info.status=="A")&&parent_info.bettable;if(upd_mkt_display==0)return;var find_next_mkt=((info.status=="S"&&orig_status=="A")||(info.status=="A"&&info.displayed=="N"&&orig_displayed=="Y")),scitem_id=_lb_cal_live_market_id_prefix+info.ev_mkt_id,pscone_id=_lb_cal_live_markets_id_prefix+info.ev_id;if(!scone_exists(pscone_id))return;var html=tmpl_play("lb_cal_live_market",info),was_visible=scone_item_exists(scitem_id),now_visible=(info.displayed=="Y");if(!was_visible&&now_visible){scone_add_item(pscone_id,scitem_id,html,null);var cscone_id=_lb_cal_live_selcns_id_prefix+data.ev_mkt_id;scone_create(cscone_id,{},lb_cal_live_cmp_objects.cmpSelcns,null)}else if(was_visible&&now_visible){scone_replace_item(scitem_id,html,null,true)}else if(was_visible&&!now_visible)scone_remove_item(scitem_id);if(now_visible&&(!was_visible||orig_bettable!=info.bettable))for(var ev_oc_id in info.child_hash)_lb_cal_live_got_SELCN({ev_oc_id:ev_oc_id,ev_mkt_id:info.ev_mkt_id},false,"",is_news);if(find_next_mkt&&!first_build)setTimeout(function(){_lb_cal_live_find_top_mkt(info.ev_id,info.ev_mkt_id,is_news)},8e3)}
function _lb_cal_live_fin_got_EVMKT(data,first_build){var parent_info=_lb_cal_live_event_hash[data.ev_id];if(!parent_info)return;parent_info.child_hash[data.ev_mkt_id]=true;var upd_mkt_display=1;if(!first_build)upd_mkt_display=_lb_cal_live_validate_fin_EVMKTS(data);var info=_lb_cal_live_evmkt_hash[data.ev_mkt_id],is_new_item=!info,orig_displayed,orig_disporder,orig_name,orig_bettable,orig_hcap_values;if(is_new_item){info=data;_lb_cal_live_evmkt_hash[data.ev_mkt_id]=info;info.child_hash={};info.is_fin=1;info.deleted=0}else{orig_displayed=info.displayed;orig_disporder=info.disporder;orig_name=info.name;orig_bettable=info.bettable;orig_hcap_values=info.hcap_values;for(var f in data)info[f]=data[f]};if(info.bet_in_run!='Y')info.displayed='N';info.bettable=(info.status=="A")&&parent_info.bettable;if(upd_mkt_display==0)return;var scitem_id=_lb_cal_live_market_id_prefix+info.ev_mkt_id,pscone_id=_lb_cal_live_markets_id_prefix+info.ev_id;if(!scone_exists(pscone_id))return;var html=tmpl_play("lb_cal_live_market_fin",info),was_visible=scone_item_exists(scitem_id),now_visible=(info.displayed=="Y");if(!was_visible&&now_visible){scone_add_item(pscone_id,scitem_id,html,null);var cscone_id=_lb_cal_live_selcns_id_prefix+data.ev_mkt_id;scone_create(cscone_id,{},lb_cal_live_cmp_objects.cmpSelcns,null)}else if(was_visible&&now_visible){scone_replace_item(scitem_id,html,null,true)}else if(was_visible&&!now_visible)scone_remove_item(scitem_id);if(now_visible&&(!was_visible||orig_bettable!=info.bettable))for(var ev_oc_id in info.child_hash)_lb_cal_live_got_SELCN({ev_oc_id:ev_oc_id,ev_mkt_id:info.ev_mkt_id},false,"","")}
function _lb_cal_live_got_MHCAP(data,is_news){var info=_lb_cal_live_evmkt_hash[data.ev_mkt_id],parent_info=_lb_cal_live_event_hash[info.ev_id];if(!parent_info||!info)return;for(var f in data)info[f]=data[f];for(var ev_oc_id in info.child_hash)_lb_cal_live_got_SELCN({ev_oc_id:ev_oc_id,ev_mkt_id:info.ev_mkt_id},false,"",is_news);return}
function _lb_cal_live_got_SELCN(data,first_build,is_fin,is_news){var parent_info=_lb_cal_live_evmkt_hash[data.ev_mkt_id];if(!parent_info)return;var allow_ev_oc=1;if(!first_build)allow_ev_oc=lb_cal_live_check_add_ev_oc(data);if(allow_ev_oc==0)return;parent_info.child_hash[data.ev_oc_id]=true;var info=_lb_cal_live_selcn_hash[data.ev_oc_id],is_new_item=!info,orig_lp_num,orig_lp_den,orig_hcap_value;if(is_new_item){info=data;_lb_cal_live_selcn_hash[data.ev_oc_id]=info;info.is_fin=is_fin}else{orig_lp_num=info.lp_num;orig_lp_den=info.lp_den;orig_hcap_value=info.hcap_value;for(var f in data)info[f]=data[f]};info.name=info.names[_lb_cal_live_cfg.lang];info.has_hcap=false;info.hcap_value="";if(parent_info.hcap_values&&info.fb_result)if(parent_info.hcap_values[info.fb_result]){info.hcap_value=parent_info.hcap_values[info.fb_result];info.has_hcap=true};info.bettable=(info.status=="A")&&parent_info.bettable;var scitem_id=_lb_cal_live_selcn_item_id_prefix+data.ev_oc_id,pscone_id=_lb_cal_live_selcns_id_prefix+parent_info.ev_mkt_id;if(!scone_exists(pscone_id))return;info.price_str=get_price_str(lb_cal_live_obj,info.lp_num,info.lp_den,parent_info.lp_avail,parent_info.mkt_sort);if(is_news){info.is_news=1}else info.is_news=0;if(info.is_fin==0){var html=tmpl_play("lb_cal_live_selcn",info)}else var html=tmpl_play("lb_cal_live_selcn_fin",info);var sort_info={disporder:info.disporder,lp_num:info.lp_num,lp_den:info.lp_den,ev_oc_id:info.ev_oc_id},was_visible=scone_item_exists(scitem_id),now_visible=(info.displayed=="Y");if(!was_visible&&now_visible){scone_add_item(pscone_id,scitem_id,html,sort_info)}else if(was_visible&&now_visible){scone_replace_item(scitem_id,html,sort_info,true)}else if(was_visible&&!now_visible)scone_remove_item(scitem_id);if(!is_new_item&&now_visible){push_highlight_price_change(lb_cal_live_obj,info.ev_oc_id,info.lp_num,info.lp_den,orig_lp_num,orig_lp_den);push_highlight_level_change(lb_cal_live_obj,info.ev_oc_id,orig_hcap_value,info.hcap_value)}}
function _lb_cal_live_got_PRICE(data){var info=_lb_cal_live_selcn_hash[data.ev_oc_id];if(!info)return;var parent_info=_lb_cal_live_evmkt_hash[info.ev_mkt_id];if(!parent_info)return;var orig_lp_num=info.lp_num,orig_lp_den=info.lp_den;for(var f in data)info[f]=data[f];var scitem_id=_lb_cal_live_selcn_item_id_prefix+data.ev_oc_id;if(!scone_item_exists(scitem_id))return;var sort_info={disporder:info.disporder,lp_num:info.lp_num,lp_den:info.lp_den,ev_oc_id:info.ev_oc_id};scone_set_item_info(scitem_id,sort_info);var price_id=_lb_cal_live_selcn_id_prefix+info.ev_oc_id,price_el=document.getElementById(price_id);if(!price_el)return;info.price_str=get_price_str(lb_cal_live_obj,info.lp_num,info.lp_den,parent_info.lp_avail,parent_info.mkt_sort);price_el.innerHTML=info.price_str;push_highlight_price_change(lb_cal_live_obj,info.ev_oc_id,info.lp_num,info.lp_den,orig_lp_num,orig_lp_den);return}
function _lb_cal_live_validate_EVMKTS(data){var allowed=1,ev_info="",ev_mkt_id="",ev_mkt_info="",scitem_id=_lb_cal_live_market_id_prefix+data.ev_mkt_id;if(scone_item_exists(scitem_id))return allowed;if(_lb_cal_live_event_hash[data.ev_id]){ev_info=_lb_cal_live_event_hash[data.ev_id];for(ev_mkt_id in ev_info.child_hash)if(_lb_cal_live_evmkt_hash[ev_mkt_id]){ev_mkt_info=_lb_cal_live_evmkt_hash[ev_mkt_id];if(data.ev_mkt_id!=ev_mkt_id){if(data.displayed=="Y"){if(ev_mkt_info.displayed!="Y"){lb_cal_live_hide_EVMKT(ev_mkt_id);continue}}else if(ev_mkt_info.displayed=="Y"){allowed=0;break};if(data.status=="A"){if(ev_mkt_info.status!="A"){lb_cal_live_hide_EVMKT(ev_mkt_id);continue}}else if(ev_mkt_info.status=="A"){allowed=0;break};if(data.disporder==ev_mkt_info.disporder){if(data.ev_mkt_id<ev_mkt_info.ev_mkt_id){lb_cal_live_hide_EVMKT(ev_mkt_id);continue}else{allowed=0;break}}else if(data.disporder<ev_mkt_info.disporder){lb_cal_live_hide_EVMKT(ev_mkt_id);continue}else{allowed=0;break}}}};return allowed}
function _lb_cal_live_validate_fin_EVMKTS(data){var allowed=0,ev_info="",ev_mkt_id="",ev_mkt_info="",ev_oc_count=0,mkt_ev_oc_count=0,count_ev_mkt=0,scitem_id="",mkt_list_hash={},mkt_list_replaced={},mkt_list_disporders=new Array(),temp_mkt_list_replaced=new Array(),disporder_add=0.0001,new_disporder_add=0,cur_ev_mkt_id="",was_visible=false,i=0,j=0,mkt_position_found=0;if(data.displayed&&data.displayed=="N"){allowed=1;return allowed};if(_lb_cal_live_event_hash[data.ev_id]){ev_info=_lb_cal_live_event_hash[data.ev_id];for(ev_mkt_id in ev_info.child_hash){count_ev_mkt=0;if(_lb_cal_live_evmkt_hash[ev_mkt_id]){ev_mkt_info=_lb_cal_live_evmkt_hash[ev_mkt_id];if(!ev_mkt_info)continue;if(ev_mkt_info.displayed=="N")continue;scitem_id=_lb_cal_live_market_id_prefix+ev_mkt_id;if(scone_item_exists(scitem_id)&&ev_mkt_id!=data.ev_mkt_id&&ev_mkt_info.disporder<=data.disporder)if(ev_mkt_info.disporder==data.disporder){if(data.ev_mkt_id>ev_mkt_id)count_ev_mkt=1}else count_ev_mkt=1;if(mkt_list_hash[ev_mkt_info.disporder]){cur_ev_mkt_id=mkt_list_hash[ev_mkt_info.disporder];temp_mkt_list_replaced=mkt_list_replaced[ev_mkt_info.disporder].sort(sortNumAsc);mkt_list_replaced[ev_mkt_info.disporder]=[];if(cur_ev_mkt_id>ev_mkt_id){new_disporder_add=0;mkt_list_hash[ev_mkt_info.disporder]=ev_mkt_id;mkt_list_replaced[ev_mkt_info.disporder].push(ev_mkt_info.disporder+disporder_add);mkt_list_hash[ev_mkt_info.disporder+disporder_add]=cur_ev_mkt_id;mkt_list_disporders.push(ev_mkt_info.disporder+disporder_add);for(i=0;i<temp_mkt_list_replaced.length;i++){for(j=0;j<mkt_list_disporders.length;j++)if(mkt_list_disporders[j]==temp_mkt_list_replaced[i])mkt_list_disporders.splice(j,1);cur_ev_mkt_id=mkt_list_hash[temp_mkt_list_replaced[i]];mkt_list_hash[temp_mkt_list_replaced[i]+disporder_add]=cur_ev_mkt_id;mkt_list_replaced[ev_mkt_info.disporder].push(temp_mkt_list_replaced[i]+disporder_add);mkt_list_disporders.push(temp_mkt_list_replaced[i]+disporder_add);new_disporder_add=temp_mkt_list_replaced[i]+disporder_add;delete mkt_list_hash[temp_mkt_list_replaced[i]]};disporder_add+=new_disporder_add+0.0001}else{mkt_position_found=0;new_disporder_add=0;for(i=0;i<temp_mkt_list_replaced.length;i++)if(ev_mkt_id<mkt_list_hash[temp_mkt_list_replaced[i]]){for(j=0;j<mkt_list_disporders.length;j++)if(mkt_list_disporders[j]==temp_mkt_list_replaced[i])mkt_list_disporders.splice(j,1);cur_ev_mkt_id=mkt_list_hash[temp_mkt_list_replaced[i]];if(mkt_position_found==0){mkt_list_hash[temp_mkt_list_replaced[i]+disporder_add]=ev_mkt_id;mkt_list_replaced[ev_mkt_info.disporder].push(temp_mkt_list_replaced[i]+disporder_add);mkt_list_disporders.push(temp_mkt_list_replaced[i]+disporder_add);disporder_add+=0.0001;mkt_position_found=1};mkt_list_hash[temp_mkt_list_replaced[i]+disporder_add]=cur_ev_mkt_id;mkt_list_replaced[ev_mkt_info.disporder].push(temp_mkt_list_replaced[i]+disporder_add);mkt_list_disporders.push(temp_mkt_list_replaced[i]+disporder_add);delete mkt_list_hash[temp_mkt_list_replaced[i]];new_disporder_add=temp_mkt_list_replaced[i]+disporder_add}else mkt_list_replaced.push(temp_mkt_list_replaced[i]);if(mkt_position_found==0){mkt_list_hash[ev_mkt_info.disporder+disporder_add]=ev_mkt_id;mkt_list_replaced[ev_mkt_info.disporder].push(ev_mkt_info.disporder+disporder_add);mkt_list_disporders.push(ev_mkt_info.disporder+disporder_add)};disporder_add+=new_disporder_add+0.0001}}else{mkt_list_hash[ev_mkt_info.disporder]=ev_mkt_id;mkt_list_disporders.push(ev_mkt_info.disporder);mkt_list_replaced[ev_mkt_info.disporder]=new Array()}};if(count_ev_mkt==1)ev_oc_count+=lb_cal_live_count_selns_in_mkt(ev_mkt_id,"")}};if(ev_oc_count>=3)return allowed;allowed=1;if(_lb_cal_live_evmkt_hash[data.ev_mkt_id])was_visible=true;if(was_visible==true){mkt_list_disporders=mkt_list_disporders.sort(sortNumAsc);ev_oc_count=0;for(i-0;i<mkt_list_disporders.length;i++){ev_mkt_id=mkt_list_hash[mkt_list_disporders[i]];if(ev_oc_count==3)lb_cal_live_hide_EVMKT_and_SELCNS(ev_mkt_id);mkt_ev_oc_count=lb_cal_live_count_selns_in_mkt(ev_mkt_id,"");if(mkt_ev_oc_count+ev_oc_count<=3){ev_oc_count+=mkt_ev_oc_count;continue}else ev_oc_count+=lb_cal_live_check_mkt_ev_ocs(3,ev_oc_count,ev_mkt_id)}}else return allowed;return allowed}
function lb_cal_live_count_selns_in_mkt(ev_mkt_id,ev_oc_to_ignore){var count=0,ev_oc_id="",ev_oc_info="",scitem_id="";if(_lb_cal_live_evmkt_hash[ev_mkt_id])for(ev_oc_id in _lb_cal_live_evmkt_hash[ev_mkt_id].child_hash){if(ev_oc_id==ev_oc_to_ignore)continue;ev_oc_info=_lb_cal_live_selcn_hash[ev_oc_id];scitem_id=_lb_cal_live_selcn_item_id_prefix+ev_oc_id;if(ev_oc_info&&ev_oc_info.displayed=="Y"&&scone_item_exists(scitem_id))count++};return count}
function lb_cal_live_check_mkt_ev_ocs(max_selcns,count,ev_mkt_id){var num_selcns_kept=0,ev_oc_id="",ev_oc_info="",scitem_id="",ev_oc_list_hash={},ev_oc_id_list_hash={},ev_oc_list_replaced=new Array(),ev_oc_list_disporders=new Array(),disporder="",cur_ev_oc_id="",cur_ev_oc_id_loop="",cur_ev_oc_info="",new_ev_oc_info="",temp_ev_oc_list_replaced="",cur_ev_oc_odds="",new_ev_oc_odds="",disporder_add=0.0001,new_disporder_add=0,i=0,j=0,ev_oc_position_found=0,ev_oc_list_odds_ev_oc_ids={},odds_ev_oc=0,odds_pos="",ev_oc_insert_disporder=0,odds_array=new Array(),odds_val="",ev_oc_count=0;ev_mkt_info=_lb_cal_live_evmkt_hash[ev_mkt_id];if(ev_mkt_info&&ev_mkt_info.displayed=="Y")for(ev_oc_id in ev_mkt_info.child_hash){scitem_id=_lb_cal_live_selcn_item_id_prefix+ev_oc_id;if(scone_item_exists(scitem_id)){ev_oc_info=_lb_cal_live_selcn_hash[ev_oc_id];if(ev_oc_info&&ev_oc_info.displayed=="Y"){disporder=ev_oc_info.disporder;if(ev_oc_list_hash[disporder]){cur_ev_oc_id=ev_oc_list_hash[disporder];cur_ev_oc_info=_lb_cal_live_selcn_hash[cur_ev_oc_id];temp_ev_oc_list_replaced=ev_oc_list_replaced[disporder].sort(sortNumAsc);ev_oc_list_replaced[disporder]=[];cur_ev_oc_odds=cur_ev_oc_info.lp_num/cur_ev_oc_info.lp_den;new_ev_oc_odds=ev_oc_info.lp_num/ev_oc_info.lp_den;if(cur_ev_oc_odds>new_ev_oc_odds){new_disporder_add=0;ev_oc_list_hash[disporder]=ev_oc_id;ev_oc_id_list_hash[ev_oc_id]=disporder;ev_oc_list_replaced[disporder].push(disporder+disporder_add);ev_oc_list_hash[disporder+disporder_add]=cur_ev_oc_id;ev_oc_id_list_hash[cur_ev_oc_id]=disporder+disporder_add;ev_oc_list_disporders.push(disporder+disporder_add);if(!ev_oc_list_odds_ev_oc_ids[disporder][cur_ev_oc_odds]){ev_oc_list_odds_ev_oc_ids[disporder][cur_ev_oc_odds]=new Array();odds_array.push(cur_ev_oc_odds)};ev_oc_list_odds_ev_oc_ids[disporder][cur_ev_oc_odds].push(cur_ev_oc_id);for(i=0;i<temp_ev_oc_list_replaced.length;i++){for(j=0;j<ev_oc_list_disporders.length;j++)if(ev_oc_list_disporders[j]==temp_ev_oc_list_replaced[i])ev_oc_list_disporders.splice(j,1);cur_ev_oc_id_loop=ev_oc_list_hash[temp_ev_oc_list_replaced[i]];ev_oc_list_hash[temp_ev_oc_list_replaced[i]+disporder_add]=cur_ev_oc_id_loop;ev_oc_id_list_hash[cur_ev_oc_id_loop]=temp_ev_oc_list_replaced[i]+disporder_add;ev_oc_list_replaced[disporder].push(temp_ev_oc_list_replaced[i]+disporder_add);ev_oc_list_disporders.push(temp_ev_oc_list_replaced[i]+disporder_add);new_disporder_add=temp_ev_oc_list_replaced[i]+disporder_add;delete ev_oc_list_hash[temp_ev_oc_list_replaced[i]]};disporder_add+=new_disporder_add+0.0001}else if(cur_ev_oc_odds==new_ev_oc_odds){if(cur_ev_oc_id>ev_oc_id){new_disporder_add=0;ev_oc_list_hash[disporder]=ev_oc_id;ev_oc_id_list_hash[ev_oc_id]=disporder;ev_oc_list_replaced[disporder].push(disporder+disporder_add);ev_oc_list_hash[disporder+disporder_add]=cur_ev_oc_id;ev_oc_id_list_hash[cur_ev_oc_id]=disporder+disporder_add;ev_oc_list_disporders.push(disporder+disporder_add);for(i=0;i<temp_ev_oc_list_replaced.length;i++){for(j=0;j<ev_oc_list_disporders.length;j++)if(ev_oc_list_disporders[j]==temp_ev_oc_list_replaced[i])ev_oc_list_disporders.splice(j,1);cur_ev_oc_id_loop=ev_oc_list_hash[temp_ev_oc_list_replaced[i]];ev_oc_list_hash[temp_ev_oc_list_replaced[i]+disporder_add]=cur_ev_oc_id_loop;ev_oc_id_list_hash[cur_ev_oc_id_loop]=temp_ev_oc_list_replaced[i]+disporder_add;ev_oc_list_replaced[disporder].push(temp_ev_oc_list_replaced[i]+disporder_add);ev_oc_list_disporders.push(temp_ev_oc_list_replaced[i]+disporder_add);new_disporder_add=temp_ev_oc_list_replaced[i]+disporder_add;delete ev_oc_list_hash[temp_ev_oc_list_replaced[i]]};if(!ev_oc_list_odds_ev_oc_ids[disporder][cur_ev_oc_odds]){ev_oc_list_odds_ev_oc_ids[disporder][cur_ev_oc_odds]=new Array();odds_array.push(cur_ev_oc_odds)};ev_oc_list_odds_ev_oc_ids[disporder][cur_ev_oc_odds].push(cur_ev_oc_id);disporder_add+=new_disporder_add+0.0001}else{if(!ev_oc_list_odds_ev_oc_ids[disporder][cur_ev_oc_odds]){new_disporder_add=0;ev_oc_list_replaced[disporder].push(disporder+disporder_add);ev_oc_list_hash[disporder+disporder_add]=ev_oc_id;ev_oc_id_list_hash[ev_oc_id]=disporder+disporder_add;ev_oc_list_disporders.push(disporder+disporder_add);for(i=0;i<temp_ev_oc_list_replaced.length;i++){for(j=0;j<ev_oc_list_disporders.length;j++)if(ev_oc_list_disporders[j]==temp_ev_oc_list_replaced[i])ev_oc_list_disporders.splice(j,1);cur_ev_oc_id_loop=ev_oc_list_hash[temp_ev_oc_list_replaced[i]];ev_oc_list_hash[temp_ev_oc_list_replaced[i]+disporder_add]=cur_ev_oc_id_loop;ev_oc_id_list_hash[cur_ev_oc_id_loop]=temp_ev_oc_list_replaced[i]+disporder_add;ev_oc_list_replaced[disporder].push(temp_ev_oc_list_replaced[i]+disporder_add);ev_oc_list_disporders.push(temp_ev_oc_list_replaced[i]+disporder_add);new_disporder_add=temp_ev_oc_list_replaced[i]+disporder_add;delete ev_oc_list_hash[temp_ev_oc_list_replaced[i]]};disporder_add+=new_disporder_add+0.0001}else{new_disporder_add=0;ev_oc_list_odds_ev_oc_ids[disporder][cur_ev_oc_odds]=ev_oc_list_odds_ev_oc_ids[disporder][cur_ev_oc_odds].sort(sortNumAsc);odds_pos="";for(i=0;i<ev_oc_list_odds_ev_oc_ids[disporder][cur_ev_oc_odds].length;i++){odds_ev_oc=ev_oc_list_odds_ev_oc_ids[disporder][cur_ev_oc_odds][i];if(ev_oc_id<ev_oc_list_odds_ev_oc_ids[disporder][cur_ev_oc_odds][i]){odds_pos="BEFORE";break}};if(odds_pos=="")odds_pos="AFTER";ev_oc_insert_disporder=ev_oc_id_list_hash[odds_ev_oc];for(i=0;i<temp_ev_oc_list_replaced.length;i++)if(temp_ev_oc_list_replaced[i]<ev_oc_insert_disporder){ev_oc_list_replaced[disporder].push(temp_ev_oc_list_replaced[i])}else{for(j=0;j<ev_oc_list_disporders.length;j++)if(ev_oc_list_disporders[j]==temp_ev_oc_list_replaced[i])ev_oc_list_disporders.splice(j,1);cur_ev_oc_id_loop=ev_oc_list_hash[temp_ev_oc_list_replaced[i]];if(temp_ev_oc_list_replaced[i]==ev_oc_insert_disporder){if(odds_pos=="BEFORE"){ev_oc_list_hash[temp_ev_oc_list_replaced[i]+disporder_add]=ev_oc_id;ev_oc_id_list_hash[ev_oc_id]=temp_ev_oc_list_replaced[i]+disporder_add;ev_oc_list_replaced[disporder].push(temp_ev_oc_list_replaced[i]+disporder_add);ev_oc_list_disporders.push(temp_ev_oc_list_replaced[i]+disporder_add);disporder_add+=0.0001;ev_oc_list_hash[temp_ev_oc_list_replaced[i]+disporder_add]=cur_ev_oc_id_loop;ev_oc_id_list_hash[cur_ev_oc_id_loop]=temp_ev_oc_list_replaced[i]+disporder_add;ev_oc_list_replaced[disporder].push(temp_ev_oc_list_replaced[i]+disporder_add);ev_oc_list_disporders.push(temp_ev_oc_list_replaced[i]+disporder_add);delete ev_oc_list_hash[temp_ev_oc_list_replaced[i]];new_disporder_add=temp_ev_oc_list_replaced[i]+disporder_add}else{ev_oc_list_replaced[disporder].push(temp_ev_oc_list_replaced[i]);ev_oc_list_disporders.push(temp_ev_oc_list_replaced[i]);ev_oc_list_hash[temp_ev_oc_list_replaced[i]+disporder_add]=ev_oc_id;ev_oc_id_list_hash[ev_oc_id]=temp_ev_oc_list_replaced[i]+disporder_add;ev_oc_list_replaced[disporder].push(temp_ev_oc_list_replaced[i]+disporder_add);ev_oc_list_disporders.push(temp_ev_oc_list_replaced[i]+disporder_add);disporder_add+=0.0001}}else{ev_oc_list_hash[temp_ev_oc_list_replaced[i]+disporder_add]=cur_ev_oc_id_loop;ev_oc_id_list_hash[cur_ev_oc_id_loop]=temp_ev_oc_list_replaced[i]+disporder_add;ev_oc_list_replaced[disporder].push(temp_ev_oc_list_replaced[i]+disporder_add);ev_oc_list_disporders.push(temp_ev_oc_list_replaced[i]+disporder_add);delete ev_oc_list_hash[temp_ev_oc_list_replaced[i]]}};disporder_add+=new_disporder_add+0.0001};if(!ev_oc_list_odds_ev_oc_ids[disporder][cur_ev_oc_odds]){ev_oc_list_odds_ev_oc_ids[disporder][cur_ev_oc_odds]=new Array();odds_array.push(cur_ev_oc_odds)};ev_oc_list_odds_ev_oc_ids[disporder][cur_ev_oc_odds].push(ev_oc_id)}}else{if(!ev_oc_list_odds_ev_oc_ids[disporder][ev_oc_odds]){odds_array=odds_array.sort(sortNumAsc);odds_pos="";for(i=0;i<odds_array.length;i++){odds_val=odds_array[i];if(ev_oc_odds<odds_val){odds_pos="BEFORE";break}else odds_pos="AFTER"};if(odds_pos==""){ev_oc_insert_disporder=disporder;odds_pos="AFTER"}else{var sorted_odds_ev_ocs=ev_oc_list_odds_ev_oc_ids[disporder][odds_val].sort(sortNumAsc);if(odds_pos=="BEFORE"){odds_ev_oc=sorted_odds_ev_ocs[0]}else odds_ev_oc=sorted_odds_ev_ocs[sorted_odds_ev_ocs.length-1];ev_oc_insert_disporder=ev_oc_list_hash[odds_ev_oc]}}else{ev_oc_list_odds_ev_oc_ids[disporder][ev_oc_odds]=ev_oc_list_odds_ev_oc_ids[disporder][ev_oc_odds].sort(sortNumAsc);odds_pos="";for(i=0;i<ev_oc_list_odds_ev_oc_ids[disporder][ev_oc_odds].length;i++){odds_ev_oc=ev_oc_list_odds_ev_oc_ids[disporder][ev_oc_odds][i];if(ev_oc_id<ev_oc_list_odds_ev_oc_ids[disporder][ev_oc_odds][i]){odds_pos="BEFORE";break}};if(odds_pos=="")odds_pos="AFTER";ev_oc_insert_disporder=ev_oc_id_list_hash[odds_ev_oc]};new_disporder_add=0;for(i=0;i<temp_ev_oc_list_replaced.length;i++)if(temp_ev_oc_list_replaced[i]<ev_oc_insert_disporder){ev_oc_list_replaced[disporder].push(temp_ev_oc_list_replaced[i])}else{for(j=0;j<ev_oc_list_disporders.length;j++)if(ev_oc_list_disporders[j]==temp_ev_oc_list_replaced[i])ev_oc_list_disporders.splice(j,1);cur_ev_oc_id_loop=ev_oc_list_hash[temp_ev_oc_list_replaced[i]];if(temp_ev_oc_list_replaced[i]==ev_oc_insert_disporder){if(odds_pos=="BEFORE"){ev_oc_list_hash[temp_ev_oc_list_replaced[i]+disporder_add]=ev_oc_id;ev_oc_id_list_hash[ev_oc_id]=temp_ev_oc_list_replaced[i]+disporder_add;ev_oc_list_replaced[disporder].push(temp_ev_oc_list_replaced[i]+disporder_add);ev_oc_list_disporders.push(temp_ev_oc_list_replaced[i]+disporder_add);disporder_add+=0.0001;ev_oc_list_hash[temp_ev_oc_list_replaced[i]+disporder_add]=cur_ev_oc_id_loop;ev_oc_id_list_hash[cur_ev_oc_id_loop]=temp_ev_oc_list_replaced[i]+disporder_add;ev_oc_list_replaced[disporder].push(temp_ev_oc_list_replaced[i]+disporder_add);ev_oc_list_disporders.push(temp_ev_oc_list_replaced[i]+disporder_add);delete ev_oc_list_hash[temp_ev_oc_list_replaced[i]];new_disporder_add=temp_ev_oc_list_replaced[i]+disporder_add}else{ev_oc_list_replaced[disporder].push(temp_ev_oc_list_replaced[i]);ev_oc_list_disporders.push(temp_ev_oc_list_replaced[i]);ev_oc_list_hash[temp_ev_oc_list_replaced[i]+disporder_add]=ev_oc_id;ev_oc_id_list_hash[ev_oc_id]=temp_ev_oc_list_replaced[i]+disporder_add;ev_oc_list_replaced[disporder].push(temp_ev_oc_list_replaced[i]+disporder_add);ev_oc_list_disporders.push(temp_ev_oc_list_replaced[i]+disporder_add);disporder_add+=0.0001}}else{ev_oc_list_hash[temp_ev_oc_list_replaced[i]+disporder_add]=cur_ev_oc_id_loop;ev_oc_id_list_hash[cur_ev_oc_id_loop]=temp_ev_oc_list_replaced[i]+disporder_add;ev_oc_list_replaced[disporder].push(temp_ev_oc_list_replaced[i]+disporder_add);ev_oc_list_disporders.push(temp_ev_oc_list_replaced[i]+disporder_add);delete ev_oc_list_hash[temp_ev_oc_list_replaced[i]]}};disporder_add+=new_disporder_add+0.0001;if(!ev_oc_list_odds_ev_oc_ids[disporder][ev_oc_odds]){ev_oc_list_odds_ev_oc_ids[disporder][ev_oc_odds]=new Array();odds_array.push(ev_oc_odds)};ev_oc_list_odds_ev_oc_ids[disporder][ev_oc_odds].push(ev_oc_id)}}else{ev_oc_list_hash[disporder]=ev_oc_id;ev_oc_id_list_hash[ev_oc_id]=disporder;ev_oc_list_disporders.push(disporder);ev_oc_list_replaced[disporder]=new Array();ev_oc_list_odds_ev_oc_ids[disporder]={}}}}};ev_oc_list_disporders=ev_oc_list_disporders.sort(sortNumAsc);ev_oc_count=count;num_selcns_kept=0;for(i=0;i<ev_oc_list_disporders.length;i++){ev_oc_id=ev_oc_list_hash[ev_oc_list_disporders[i]];if(ev_oc_count==max_selcns){lb_cal_live_hide_SELCN(ev_oc_id);continue};ev_oc_count++;num_selcns_kept++};return num_selcns_kept}
function lb_cal_live_hide_EVMKT(ev_mkt_id){var scitem_id=_lb_cal_live_market_id_prefix+ev_mkt_id;if(scone_item_exists(scitem_id))scone_remove_item(scitem_id)}
function lb_cal_live_check_add_ev_oc(ev_oc_data){var ev_info="",ev_id="",allowed=0,ev_mkt_id="",ev_mkt_info="",ev_oc_count=0;if(!ev_oc_data)return allowed;if(ev_oc_data.displayed=="N"){allowed=1;return allowed};ev_id=_lb_cal_live_evmkt_hash[ev_oc_data.ev_mkt_id].ev_id;ev_info=_lb_cal_live_event_hash[ev_id];if(ev_info)for(ev_mkt_id in ev_info.child_hash){ev_mkt_info=_lb_cal_live_evmkt_hash[ev_mkt_id];if(ev_mkt_info.hidden==false)ev_oc_count+=lb_cal_live_count_selns_in_mkt(ev_mkt_id,ev_oc_data.ev_oc_id)};if(ev_oc_count<3)allowed=1;return allowed}
function lb_cal_live_hide_SELCN(ev_oc_id){var scitem_id=_lb_cal_live_selcn_item_id_prefix+ev_oc_id;if(scone_item_exists(scitem_id))scone_remove_item(scitem_id)}
function lb_cal_live_hide_EVMKT_and_SELCNS(ev_mkt_id){var ev_oc_id="",scitem_id="";if(_lb_cal_live_evmkt_hash[ev_mkt_id]){for(ev_oc_id in _lb_cal_live_evmkt_hash[ev_mkt_id].child_hash){ev_oc_info=_lb_cal_live_selcn_hash[ev_oc_id];scitem_id=_lb_cal_live_selcn_item_id_prefix+ev_oc_id;if(scone_item_exists(scitem_id))scone_remove_item(scitem_id)};scitem_id=_lb_cal_live_market_id_prefix+ev_mkt_id;if(scone_item_exists(scitem_id))scone_remove_item(scitem_id)}}
function lb_cal_live_add_bet(ev_oc_id,origin){bir_add_bet(lb_cal_live_obj,ev_oc_id,origin);return}
function lb_cal_live_expand_class(elem,ev_class_id){lb_cal_expand_class(elem,lb_cal_live_obj,ev_class_id,0,1);return}
function lb_cal_live_expand_type(elem,ev_type_id){lb_cal_expand_type(elem,lb_cal_live_obj,ev_type_id,0,1,0);return}
function lb_cal_live_expand_event(elem,ev_id){lb_cal_expand_event(elem,lb_cal_live_obj,ev_id);return}
function _lb_cal_live_find_top_mkt(ev_id,cur_ev_mkt_id,is_news){var ev_mkt_id="",ev_info="",ev_mkt_info="",new_ev_mkt_id="",mkt_allowed="",scitem_id="";if(_lb_cal_live_event_hash[ev_id]){ev_info=_lb_cal_live_event_hash[ev_id];for(ev_mkt_id in ev_info.child_hash){ev_mkt_info=_lb_cal_live_evmkt_hash[ev_mkt_id];mkt_allowed=_lb_cal_live_validate_EVMKTS(ev_mkt_info);if(mkt_allowed==1){new_ev_mkt_id=ev_mkt_id;scitem_id=_lb_cal_live_market_id_prefix+ev_mkt_id;if(!scone_item_exists(scitem_id))break}};if(new_ev_mkt_id!=cur_ev_mkt_id)_lb_cal_live_got_EVMKT(_lb_cal_live_evmkt_hash[new_ev_mkt_id],false,true,is_news)}}
function lb_calendar_scheduler_init(call_type,url,period,l_hash,u_hash,is_fin,is_news,default_class){bir_cal_reload_url=url;bir_cal_reload_period=period;bir_cal_live_hash=l_hash;bir_cal_upc_hash=u_hash;bir_cal_is_fin=is_fin;bir_cal_is_news=is_news;bir_cal_def_class=default_class;if(call_type=="http")lb_cal_schedule_reload();return}
function lb_cal_schedule_reload(){document.PollingAjaxHelper.setInterval("lb_cal_schedule_reload",_lb_cal_reload,bir_cal_reload_period)};var bir_cal_reload_url="",bir_cal_reload_period=9e4,bir_cal_upc_hash="",bir_cal_live_hash="",bir_cal_is_fin=0,bir_cal_is_news=0,bir_cal_def_class=""
function _lb_cal_reload(){if(bir_cal_reload_url=="")return;var clientdata={id:'calendar_js',retries:3},url=bir_cal_reload_url+"&bir_cal_live_hash="+bir_cal_live_hash+"&bir_cal_upc_hash="+bir_cal_upc_hash+"&bir_cal_is_fin="+bir_cal_is_fin+"&bir_cal_is_news="+bir_cal_is_news+"&bir_cal_def_class="+bir_cal_def_class;_lb_cal_make_ajax_get_request(url,clientdata,_lb_cal_got_ajax_content)}
function _lb_cal_make_ajax_get_request(url,clientdata,callback){if(document.PollingAjaxHelper.checkSemaphore()){document.PollingAjaxHelper.setTimeout("_lb_cal_make_ajax_get_request",function(){_lb_cal_make_ajax_get_request(url,clientdata,callback)},300);return};document.PollingAjaxHelper.aquireSemaphore();var req=null;if(window.XMLHttpRequest){req=new XMLHttpRequest()}else if(window.ActiveXObject)req=new ActiveXObject('Microsoft.XMLHTTP');if(req){req.onreadystatechange=function(){if(req.readyState!=4)return;var reqStatus;try{reqStatus=req.status}catch(e){reqStatus=''};if(reqStatus!=200){document.PollingAjaxHelper.releaseSemaphore();callback(url,clientdata,false,'HTTP')}else{document.PollingAjaxHelper.releaseSemaphore();callback(url,clientdata,true,req.responseText)}};try{req.open('GET',url,true);req.send(null)}catch(e){document.PollingAjaxHelper.releaseSemaphore();callback(url,clientdata,false,'UNSUPPORTED')}}else{document.PollingAjaxHelper.releaseSemaphore();callback(url,clientdata,false,'UNSUPPORTED')}}
function _lb_cal_got_ajax_content(url,clientdata,ok,response){var holder_el=document.getElementById(clientdata.id);if(ok){if(response=="")return;var parts=_lb_cal_parse_script_tags(response);if(holder_el)holder_el.innerHTML=parts[0];if(parts[1].length)try{_lb_cal_global_eval(parts[1])}catch(e){ok=false}}}
function _lb_cal_parse_script_tags(str){var html='',js='',i=0,state='HTML',script_re=new RegExp('<(/?)script([^>]*)>','gi');while((mtch=script_re.exec(str))!=null){mS=mtch.index;if(state=='HTML'){html+=str.substring(i,mS)}else js+=str.substring(i,mS)+';\n';var closer=mtch[1],attrs=mtch[2];if(closer=='/'){state='HTML'}else if(attrs.charAt(attrs.length-1)!='/'&&attrs.indexOf('src=')==-1)state='JS';i=script_re.lastIndex};if(state=='HTML'){html+=str.substring(i)}else js+=str.substring(i);return[html,js]};var _lb_cal_global_eval=function(src){if(window.execScript){window.execScript(src);return};var fn=function(){window.eval.call(window,src)};fn()}
function lb_calendar_upcoming_init(new_data,call_type,classes,types,events,is_fin,init_msg_id,cfg,is_news){if(new_data==0)return;_lb_cal_upc_last_msg_id=init_msg_id;var f="";for(f in cfg)_lb_cal_upc_cfg[f]=cfg[f];var channels=[],update_expanders=0,previous_data=0;_lb_cal_upc_default_expanded_class="";if(is_news)lb_cal_upc_cmp_objects.cmpClasses=function(cmpMode,classA,classB){if(classA.ev_class_id==_lb_cal_live_cfg.default_class){return-1}else if(classB.ev_class_id==_lb_cal_live_cfg.default_class)return 1;var d=classA.disporder-classB.disporder;if(d)return d;return classA.ev_type_id-classB.ev_type_id};if(call_type=="http"){_lb_cal_upc_store_templates();_lb_cal_upc_class_hash={};_lb_cal_upc_type_hash={};_lb_cal_upc_event_hash={};var first_build=true;scone_create(_lb_cal_upc_class_area_id,{},lb_cal_upc_cmp_objects.cmpClasses,null);if(cfg.is_default_tab)$j("#"+_lb_cal_upc_class_area_id).parent().show()}else{for(var i in _lb_cal_upc_class_hash){previous_data=1;break};push_hash_prune_drilldown(lb_cal_upc_obj,"CLASS","EVENT","CLASS",classes);push_hash_prune_drilldown(lb_cal_upc_obj,"CLASS","EVENT","TYPE",types);push_hash_prune_drilldown(lb_cal_upc_obj,"CLASS","EVENT","EVENT",events);var first_build=false};for(var i=0;i<classes.length;i++){update_expanders=1;if(is_fin==0){_lb_cal_upc_got_CLASS(classes[i],first_build,i)}else _lb_cal_upc_fin_got_CLASS(classes[i],first_build,i)};for(var i=0;i<types.length;i++)_lb_cal_upc_got_TYPE(types[i],first_build,i,is_fin);for(var i=0;i<events.length;i++){if(call_type=="http"||(!_lb_cal_upc_event_hash[events[i].ev_id])){_lb_cal_upc_got_EVENT(events[i],first_build,is_fin)}else if(call_type=="js"&&_lb_cal_upc_event_hash[events[i].ev_id]){var event_copy=_lb_cal_upc_event_hash[events[i].ev_id],changed=false;if(event_copy.disporder!=events[i].disporder){event_copy.disporder=events[i].disporder;changed=true};if(event_copy.ev_stream_available!=events[i].ev_stream_available){event_copy.ev_stream_available=events[i].ev_stream_available;changed=true};if(changed)_lb_cal_upc_got_EVENT(event_copy,first_build,is_fin)};if(!_lb_cal_upc_channels["EVENT"+events[i].ev_id]){channels.push("sEVENT"+ps_connect_lpad_id(events[i].ev_id));_lb_cal_upc_channels["EVENT"+events[i].ev_id]=true}};if(update_expanders==1)if(first_build==1){cal_update_expanders(lb_cal_upc_obj)}else if(previous_data==0)if(is_fin==0){lb_cal_expand_filtered_class(lb_cal_upc_obj)}else lb_cal_expand_filtered_type(lb_cal_upc_obj);if(channels.length>0){ps_connect_register("lb_cal_upc"+upc_cal_idx,_lb_cal_upc_got_msg,channels,init_msg_id);upc_cal_idx++};cal_update_num_ev_headers(lb_cal_upc_obj,1);cal_update_display_div(lb_cal_upc_obj,0);return}
function lb_calendar_upc_filter_sports(){lb_cal_sync_hashes_and_display(lb_cal_upc_obj,1);lb_cal_expand_filtered_class(lb_cal_upc_obj);cal_update_num_ev_headers(lb_cal_upc_obj,1);return}
function lb_calendar_upc_filter_types(){lb_cal_sync_hashes_and_display(lb_cal_upc_obj,1);lb_cal_expand_filtered_type(lb_cal_upc_obj);return}
function lb_calendar_upc_filter_stream(){lb_cal_sync_hashes_and_display(lb_cal_upc_obj,1)};var upc_cal_idx=0,_lb_cal_upc_default_expanded_class="",_lb_cal_upc_class_area_id="ifUpcCalCnt",_lb_cal_upc_no_data_area_id="upcoming_no_bir_cal_data",_lb_cal_upc_tab_num_evs_id="lb_cal_upc_all_title",_lb_cal_upc_class_num_evs_id_prefix="lb_cal_upc_class_title_",_lb_cal_upc_class_id_prefix="lb_cal_upc_class_",_lb_cal_upc_class_template_name="lb_cal_upc_class",_lb_cal_upc_types_id_prefix="lb_cal_upc_types_",_lb_cal_upc_type_id_prefix="lb_cal_upc_type_",_lb_cal_upc_type_template_name="lb_cal_upc_type",_lb_cal_upc_events_id_prefix="lb_cal_upc_events_",_lb_cal_upc_event_id_prefix="lb_cal_upc_event_",_lb_cal_upc_event_template_name="lb_cal_upc_event",_lb_cal_upc_new_item_id_prefix="lb_cal_upc_new_item_",_lb_cal_upc_channels={},_lb_cal_upc_ev_count={},_lb_cal_upc_category_class_map={},_lb_cal_upc_class_category_map={}
function lb_cal_upc_object(){return};lb_cal_upc_object.prototype.getConfig=function(){return _lb_cal_upc_cfg};lb_cal_upc_object.prototype.getHash=function(identifier){var ret="";switch(identifier){case"CLASS":if(_lb_cal_upc_class_hash)ret=_lb_cal_upc_class_hash;break;case"TYPE":if(_lb_cal_upc_type_hash)ret=_lb_cal_upc_type_hash;break;case"EVENT":if(_lb_cal_upc_event_hash)ret=_lb_cal_upc_event_hash;break;case"EV_COUNT":if(_lb_cal_upc_ev_count)ret=_lb_cal_upc_ev_count;break;default:ret=""};return ret};lb_cal_upc_object.prototype.getHashId=function(identifier,id){var ret="";switch(identifier){case"CLASS":if(_lb_cal_upc_class_hash&&_lb_cal_upc_class_hash[id])ret=_lb_cal_upc_class_hash[id];break;case"TYPE":if(_lb_cal_upc_type_hash&&_lb_cal_upc_type_hash[id])ret=_lb_cal_upc_type_hash[id];break;case"EVENT":if(_lb_cal_upc_event_hash&&_lb_cal_upc_event_hash[id])ret=_lb_cal_upc_event_hash[id];break;case"EV_COUNT":if(_lb_cal_upc_ev_count&&_lb_cal_upc_ev_count[id])ret=_lb_cal_upc_ev_count[id];break;case"CATEGORY_CLASSES":if(_lb_cal_upc_category_class_map&&_lb_cal_upc_category_class_map[id])ret=_lb_cal_upc_category_class_map[id];break;default:ret=""};return ret};lb_cal_upc_object.prototype.getMiscInfo=function(identifier){var ret="";switch(identifier){case"TAB_NUM_EVS_ID":if(_lb_cal_upc_tab_num_evs_id)ret=_lb_cal_upc_tab_num_evs_id;break;case"TAB_AREA_ID":if(_lb_cal_upc_class_area_id)ret=_lb_cal_upc_class_area_id;break;case"TAB_NO_DATA_AREA_ID":if(_lb_cal_upc_no_data_area_id)ret=_lb_cal_upc_no_data_area_id;break;case"DEFAULT_EXPANDED_CLASS":if(_lb_cal_upc_default_expanded_class)ret=_lb_cal_upc_default_expanded_class;break;default:ret=""};return ret};lb_cal_upc_object.prototype.getIdPrefix=function(identifier){var ret="";switch(identifier){case"CLASS":if(_lb_cal_upc_class_id_prefix)ret=_lb_cal_upc_class_id_prefix;break;case"TYPE":if(_lb_cal_upc_type_id_prefix)ret=_lb_cal_upc_type_id_prefix;break;case"EVENT":if(_lb_cal_upc_event_id_prefix)ret=_lb_cal_upc_event_id_prefix;break;case"NEW_ITEM":if(_lb_cal_upc_new_item_id_prefix)ret=_lb_cal_upc_new_item_id_prefix;break;case"CLASS_NUM_EVS_ID":if(_lb_cal_upc_class_num_evs_id_prefix)ret=_lb_cal_upc_class_num_evs_id_prefix;break;default:ret=""};return ret};lb_cal_upc_object.prototype.forceRebuildItem=function(identifier,data){switch(identifier){case"CLASS":if(data.is_fin){_lb_cal_upc_fin_got_CLASS(data,false,"")}else _lb_cal_upc_got_CLASS(data,false,"");break;case"TYPE":_lb_cal_upc_got_TYPE(data,false,"",data.is_fin);break;case"EVENT":_lb_cal_upc_got_EVENT(data,false,data.is_fin);break;default:};return};lb_cal_upc_object.prototype.getTemplateName=function(identifier,is_fin){var ret="";switch(identifier){case"CLASS":ret=_lb_cal_upc_class_template_name;break;case"TYPE":ret=_lb_cal_upc_type_template_name;break;case"EVENT":ret=_lb_cal_upc_event_template_name;break;default:ret=""};if(is_fin==1)ret=ret+"_fin";return ret};lb_cal_upc_object.prototype.clearHash=function(identifier){switch(identifier){case"EV_COUNT":if(_lb_cal_upc_ev_count)_lb_cal_upc_ev_count={};break;default:}};lb_cal_upc_object.prototype.gotPushData=function(identifier,data){switch(identifier){case"PRICE":break;case"SELCN":break;case"MHCAP":break;case"EVMKT":break;case"EVENT":_lb_cal_upc_got_EVENT(data,false,"");break;default:};return};var lb_cal_upc_obj=new lb_cal_upc_object(),lb_cal_upc_cmp_objects=new function(){}();lb_cal_upc_cmp_objects=new push_hash_cmp_objects();lb_cal_upc_cmp_objects.cmpEvents=function(cmpMode,evA,evB){var t=evA.start_time_disp_order-evB.start_time_disp_order;if(t)return t;var d=evA.disporder-evB.disporder;if(d)return d;return evA.ev_id-evB.ev_id}
function _lb_cal_upc_store_templates(){var tmp=[];tmp.push('	<div id="lb_cal_upc_class_<%ev_class_id%>" <%IF hidden%>style="display:none"<%END%>>\n');tmp.push('		<div class="itemHeader">\n');tmp.push('			<a href="javascript:void(0)" class="<%IF collapsed%>off<%ELSE%>on<%END%>" onclick="lb_cal_upc_expand_class(this, <%ev_class_id%>);" title="<%XL BIR_LIVE_BETTING_TOGGLE_EXPAND%>"><%name%> <span class="cal_num_upc_events" id="lb_cal_upc_class_title_<%ev_class_id%>"></span></a>\n');tmp.push('		</div>\n');tmp.push('		<div class="itemContent" id="lb_cal_upc_types_<%ev_class_id%>" <%IF collapsed%>style="display: none"<%END%>>\n');tmp.push('		</div>\n');tmp.push('	</div>\n');tmpl_store("lb_cal_upc_class",tmp.join(""));var tmp=[];tmp.push('	<div class="subItem" id="lb_cal_upc_type_<%ev_type_id%>" <%IF hidden%>style="display:none"<%END%>>\n');tmp.push('		<div class="itemHeader">\n');tmp.push('			<a href="javascript:void(0)" class="<%IF collapsed%>off<%ELSE%>on<%END%>" onclick="lb_cal_upc_expand_type(this, <%ev_type_id%>);" title="<%XL BIR_LIVE_BETTING_TOGGLE_EXPAND%>"><%name%></a>\n');tmp.push('		</div>\n');tmp.push('		<div class="itemContent" id="lb_cal_upc_events_<%ev_type_id%>" <%IF collapsed%>style="display: none"<%END%>>\n');tmp.push('		</div>\n');tmp.push('	</div>\n');tmpl_store("lb_cal_upc_type",tmp.join(""));var tmp=[];tmp.push('	<div id="lb_cal_upc_event_<%ev_id%>" <%IF hidden%>style="display:none"<%END%>>\n');tmp.push('		<span class="left"><%start_time_trunc%></span>\n');tmp.push('		<span class="left lnkUrl" title="<%full_name%>" onclick="location.href=\'<%_lb_cal_upc_cfg.event_url%><%ev_id%>\'">\n');tmp.push('			<span style="display:none"><%_lb_cal_upc_cfg.event_url%><%ev_id%></span>\n');tmp.push('			<%name%>\n');tmp.push('		</span>\n');tmp.push('		<%IF alert_popup_avail%>\n');tmp.push('			<span id="lb_cal_upc_alert_selector_<%ev_id%>" class="right <%IF alert_added%>checked<%ELSE%>alert<%END%>" onclick="lb_cal_upc_add_remove_event_alert(this);" title="<%IF alert_added%><%XL BIR_LIVE_BETTING_ALERT_REMINDER_MSG_SET%><%ELSE%><%XL BIR_LIVE_BETTING_ALERT_REMINDER_MSG_NOT_SET%><%END%>"></span>\n');tmp.push('		<%END%>\n');tmp.push('		<%IF ev_stream_available%>\n');tmp.push('		<span class="right liveStream" title="<%XL BIR_LIVE_BETTING_WATCH_LIVE%>"></span>\n');tmp.push('		<%END%>\n');tmp.push('	</div>\n');tmpl_store("lb_cal_upc_event",tmp.join(""));var tmp=[];tmp.push('	<div id="lb_cal_upc_class_<%ev_class_id%>" <%IF hidden%>style="display:none"<%END%>>\n');tmp.push('		<div id="lb_cal_upc_types_<%ev_class_id%>">\n');tmp.push('		</div>\n');tmp.push('	</div>\n');tmpl_store("lb_cal_upc_class_fin",tmp.join(""));var tmp=[];tmp.push('	<div class="subItem" id="lb_cal_upc_type_<%ev_type_id%>" <%IF hidden%>style="display:none"<%END%>>\n');tmp.push('		<div class="itemHeader">\n');tmp.push('			<a href="javascript:void(0)" class="<%IF collapsed%>off<%ELSE%>on<%END%>" onclick="lb_cal_upc_expand_type(this, <%ev_type_id%>);" title="<%name%>"><%name%></a>\n');tmp.push('		</div>\n');tmp.push('		<div class="itemContent" id="lb_cal_upc_events_<%ev_type_id%>" <%IF collapsed%>style="display: none"<%END%>>\n');tmp.push('		</div>\n');tmp.push('	</div>\n');tmpl_store("lb_cal_upc_type_fin",tmp.join(""));var tmp=[];tmp.push('	<div id="lb_cal_upc_event_<%ev_id%>" <%IF hidden%>style="display:none"<%END%>>\n');tmp.push('		<span class="left"><%start_time_trunc%></span>\n');tmp.push('		<span class="left lnkUrl" title="<%full_name%>" onclick="location.href=\'<%_lb_cal_upc_cfg.fin_event_url%><%ev_id%>\'">\n');tmp.push('			<span style="display:none"><%_lb_cal_upc_cfg.fin_event_url%><%ev_id%></span>\n');tmp.push('			<%name%>\n');tmp.push('		</span>\n');tmp.push('		<%IF ev_stream_available%>\n');tmp.push('		<span class="right liveStream" title="<%XL BIR_LIVE_BETTING_WATCH_LIVE%>"></span>\n');tmp.push('		<%END%>\n');tmp.push('		<%IF alert_popup_avail%>\n');tmp.push('			<span id="lb_cal_upc_alert_selector_<%ev_id%>" class="right <%IF alert_added%>checked<%ELSE%>alert<%END%>" onclick="lb_cal_upc_add_remove_event_alert(this);" title="<%IF alert_added%><%XL BIR_LIVE_BETTING_ALERT_REMINDER_MSG_SET%><%ELSE%><%XL BIR_LIVE_BETTING_ALERT_REMINDER_MSG_NOT_SET%><%END%>">alert/checked</span>\n');tmp.push('		<%END%>\n');tmp.push('	</div>\n');tmpl_store("lb_cal_upc_event_fin",tmp.join(""))};var _lb_cal_upc_cfg={lang:"en",highlight_duration:4e3,ev_collapse_threshold:10,name_truncate_threshold:28,default_expanded_ev:"",geo_stream_allowed:"N",alert_popup_avail:0,alert_type:"C",event_is_expandable:0,event_url:"",fin_event_url:"",default_class:""}
function _lb_cal_upc_got_msg(msg){bir_got_msg(lb_cal_upc_obj,msg);if(msg.subject_level=="sEVENT")cal_update_num_ev_headers(lb_cal_upc_obj,1);return}
function _lb_cal_upc_got_CLASS(data,first_build,position){var info=_lb_cal_upc_class_hash[data.ev_class_id],is_new_item=!info;if(is_new_item){info=data;_lb_cal_upc_class_hash[data.ev_class_id]=info;info.child_hash={};info.normal_disporder=position+0.5;info.is_fin=0;info.collapsed_backup_class="";info.collapsed_backup_type="";info.collapsed_backup_event="";if(!_lb_cal_upc_class_category_map[info.ev_class_id]){_lb_cal_upc_class_category_map[info.ev_class_id]=info.ev_class_category;if(!_lb_cal_upc_category_class_map[info.ev_class_category])_lb_cal_upc_category_class_map[info.ev_class_category]=new Array();_lb_cal_upc_category_class_map[info.ev_class_category].push(info.ev_class_id)};if(!first_build){info.new_item=true;push_schedule_unhighlight_new_item(lb_cal_upc_obj,"CLASS",data.ev_class_id)}else{info.new_item=false;if(_lb_cal_upc_default_expanded_class=="")_lb_cal_upc_default_expanded_class=info.ev_class_id};info.collapsed=true}else{for(var f in data)info[f]=data[f];info.new_item=false};info.name=info.names[_lb_cal_upc_cfg.lang];info.full_name=info.name;info.name=trunc_string(info.name,_lb_cal_upc_cfg.name_truncate_threshold,'...');if(first_build==false){info.hidden=cal_filter_sports_check_display(info.ev_class_id,info.ev_class_category);if(info.hidden==false){cal_calc_ev_counts(lb_cal_upc_obj);if(push_get_ev_counts(lb_cal_upc_obj,"CLASS",info.ev_class_id)>0){info.hidden=false}else info.hidden=true}}else info.hidden=false;var scitem_id=_lb_cal_upc_class_id_prefix+info.ev_class_id,pscone_id=_lb_cal_upc_class_area_id;if(!scone_exists(pscone_id)||document.getElementById(pscone_id).parentNode.style.display=="none")return;var html=tmpl_play("lb_cal_upc_class",info),sort_info={disporder:info.normal_disporder,ev_class_id:info.ev_class_id},was_visible=scone_item_exists(scitem_id);if(!was_visible){scone_add_item(pscone_id,scitem_id,html,sort_info);var cscone_id=_lb_cal_upc_types_id_prefix+info.ev_class_id;scone_create(cscone_id,{},lb_cal_upc_cmp_objects.cmpTypes,null)}else scone_replace_item(scitem_id,html,sort_info,true);if(info.new_item==true)info.new_item=false}
function _lb_cal_upc_fin_got_CLASS(data,first_build,position){var info=_lb_cal_upc_class_hash[data.ev_class_id],is_new_item=!info;if(is_new_item){info=data;_lb_cal_upc_class_hash[data.ev_class_id]=info;info.child_hash={};info.is_fin=1;info.collapsed_backup_class="";info.collapsed_backup_type="";info.collapsed_backup_event="";info.collapsed=false;info.normal_disporder=position+0.5;if(!_lb_cal_upc_class_category_map[info.ev_class_id]){_lb_cal_upc_class_category_map[info.ev_class_id]=info.ev_class_category;if(!_lb_cal_upc_category_class_map[info.ev_class_category])_lb_cal_upc_category_class_map[info.ev_class_category]=new Array();_lb_cal_upc_category_class_map[info.ev_class_category].push(info.ev_class_id)};if(!first_build){info.new_item=true}else{info.new_item=false;if(_lb_cal_upc_default_expanded_class=="")_lb_cal_upc_default_expanded_class=info.ev_class_id}}else{for(var f in data)info[f]=data[f];info.new_item=false};info.hidden=false;var scitem_id=_lb_cal_upc_class_id_prefix+info.ev_class_id,pscone_id=_lb_cal_upc_class_area_id;if(!scone_exists(pscone_id)||document.getElementById(pscone_id).parentNode.style.display=="none")return;var html=tmpl_play("lb_cal_upc_class_fin",info),sort_info={disporder:info.normal_disporder,ev_class_id:info.ev_class_id},was_visible=scone_item_exists(scitem_id);if(!was_visible){scone_add_item(pscone_id,scitem_id,html,sort_info);var cscone_id=_lb_cal_upc_types_id_prefix+info.ev_class_id;scone_create(cscone_id,{},lb_cal_upc_cmp_objects.cmpTypes,null)}else scone_replace_item(scitem_id,html,sort_info,true)}
function _lb_cal_upc_got_TYPE(data,first_build,position,is_fin){var parent_info=_lb_cal_upc_class_hash[data.ev_class_id];if(!parent_info)return;parent_info.child_hash[data.ev_type_id]=true;var info=_lb_cal_upc_type_hash[data.ev_type_id],is_new_item=!info;if(is_new_item){info=data;_lb_cal_upc_type_hash[data.ev_type_id]=info;info.child_hash={};info.normal_disporder=position+0.5;info.collapsed_backup_class="";info.collapsed_backup_type="";info.collapsed_backup_event="";info.is_fin=is_fin;if(!first_build){info.new_item=true;push_schedule_unhighlight_new_item(lb_cal_upc_obj,"TYPE",data.ev_type_id)}else info.new_item=false;info.collapsed=true}else{for(var f in data)info[f]=data[f];info.new_item=false};info.name=info.names[_lb_cal_upc_cfg.lang];info.full_name=info.name;info.name=trunc_string(info.name,_lb_cal_upc_cfg.name_truncate_threshold,'...');if(first_build==false){if(info.is_fin==1){info.hidden=cal_filter_fin_check_display(info.ev_type_id)}else info.hidden=false;cal_calc_ev_counts(lb_cal_upc_obj);if(push_get_ev_counts(lb_cal_upc_obj,"TYPE",info.ev_type_id)>0){info.hidden=false}else info.hidden=true}else info.hidden=false;var scitem_id=_lb_cal_upc_type_id_prefix+info.ev_type_id,pscone_id=_lb_cal_upc_types_id_prefix+info.ev_class_id;if(!scone_exists(pscone_id))return;if(info.is_fin==0){var html=tmpl_play("lb_cal_upc_type",info)}else var html=tmpl_play("lb_cal_upc_type_fin",info);var sort_info={disporder:info.normal_disporder,ev_type_id:info.ev_type_id},was_visible=scone_item_exists(scitem_id),is_visible=!parent_info.collapsed;if(!was_visible){if(is_visible){scone_add_item(pscone_id,scitem_id,html,sort_info);var cscone_id=_lb_cal_upc_events_id_prefix+data.ev_type_id;scone_create(cscone_id,{},lb_cal_upc_cmp_objects.cmpEvents,null)}}else scone_replace_item(scitem_id,html,sort_info,true);if(info.new_item==true)info.new_item=false}
function _lb_cal_upc_got_EVENT(data,first_build,is_fin){var check_filters=1;if(first_build==true)check_filters=0;var info=_lb_cal_upc_event_hash[data.ev_id],is_new_item=!info,orig_bettable;if(is_new_item){var type_info=_lb_cal_upc_type_hash[data.ev_type_id]}else var type_info=_lb_cal_upc_type_hash[info.ev_type_id];if(!type_info)return;type_info.child_hash[data.ev_id]=true;if(is_new_item){info=data;_lb_cal_upc_event_hash[info.ev_id]=info;info.child_hash={};info.is_fin=is_fin;info.hidden=false;var found_in_alerts_cookie=checkForEventInAlertCookie(info.ev_id,_lb_cal_upc_cfg.alert_type);if(found_in_alerts_cookie){info.alert_added=true}else info.alert_added=false;if(!first_build){info.new_item=true;push_schedule_unhighlight_new_item(lb_cal_upc_obj,"EVENT",data.ev_id)}else info.new_item=false}else{orig_bettable=info.bettable;for(var f in data)info[f]=data[f];info.new_item=false};var class_info=_lb_cal_upc_class_hash[type_info.ev_class_id],class_elem_name=_lb_cal_upc_class_id_prefix+type_info.ev_class_id,class_sort_info=scone_get_item_info(class_elem_name),type_elem_name=_lb_cal_upc_type_id_prefix+info.ev_type_id,type_sort_info=scone_get_item_info(type_elem_name),type_html="",class_html="",update_areas=0,current_hidden;info.name=info.names[_lb_cal_upc_cfg.lang];info.full_name=info.name;info.name=trunc_string(info.name,_lb_cal_upc_cfg.name_truncate_threshold,'...');info.venue=info.venues[_lb_cal_upc_cfg.lang];info.start_time_xl=info.start_time_xls[_lb_cal_upc_cfg.lang];info.start_time_disp_order=time_in_milliseconds(info.start_time);info.start_time_seconds=info.start_time_disp_order/1e3;info.start_time_trunc=info.start_time.substring(11,16);info.bettable=(info.status=="A");if(_lb_cal_upc_cfg.geo_stream_allowed=="N")info.ev_stream_available=false;if(_lb_cal_upc_cfg.alert_popup_avail==1){info.alert_popup_avail=true}else info.alert_popup_avail=false;if(check_filters==1)info.hidden=cal_filter_stream_check_display(info.ev_stream_available);var scitem_id=_lb_cal_upc_event_id_prefix+info.ev_id,pscone_id=_lb_cal_upc_events_id_prefix+info.ev_type_id;if(!scone_exists(pscone_id))return;if(info.is_fin==0){var html=tmpl_play("lb_cal_upc_event",info)}else var html=tmpl_play("lb_cal_upc_event_fin",info);var sort_info={disporder:info.disporder,ev_id:info.ev_id,start_time_disp_order:info.start_time_disp_order},was_visible=scone_item_exists(scitem_id),now_visible=(info.displayed=="Y"&&!type_info.collapsed&&!class_info.collapsed);if(!was_visible&&now_visible){scone_add_item(pscone_id,scitem_id,html,sort_info);cal_calc_ev_counts(lb_cal_upc_obj);if(push_get_ev_counts(lb_cal_upc_obj,"TYPE",info.ev_type_id)==1&&!first_build){if(type_info.hidden==true){current_hidden=true;type_info.hidden=false;if(type_info.is_fin==1)type_info.hidden=cal_filter_fin_check_display(type_info.ev_type_id);if(current_hidden!=type_info.hidden){if(info.is_fin==0){type_html=tmpl_play("lb_cal_upc_type",type_info)}else type_html=tmpl_play("lb_cal_upc_type_fin",type_info);scone_replace_item(type_elem_name,type_html,type_sort_info,true)}};if(class_info.hidden==true){current_hidden=true;class_info.hidden=false;if(class_info.is_fin==0)class_info.hidden=cal_filter_sports_check_display(class_info.ev_class_id,class_info.ev_class_category);if(current_hidden!=class_info.hidden){if(info.is_fin==0){class_html=tmpl_play("lb_cal_upc_class",class_info)}else class_html=tmpl_play("lb_cal_upc_class_fin",class_info);scone_replace_item(class_elem_name,class_html,class_sort_info,true);update_areas=1}}}}else if(was_visible&&now_visible){scone_replace_item(scitem_id,html,sort_info,true)}else if(was_visible&&!now_visible){scone_remove_item(scitem_id);cal_calc_ev_counts(lb_cal_upc_obj);if(push_get_ev_counts(lb_cal_upc_obj,"TYPE",info.ev_type_id)==0)if(type_info.hidden==false){type_info.hidden=true;if(info.is_fin==0){type_html=tmpl_play("lb_cal_upc_type",type_info)}else type_html=tmpl_play("lb_cal_upc_type_fin",type_info);scone_replace_item(type_elem_name,type_html,type_sort_info,true)};if(push_get_ev_counts(lb_cal_upc_obj,"CLASS",type_info.ev_class_id)==0)if(class_info.hidden==false){class_info.hidden=true;if(info.is_fin==0){class_html=tmpl_play("lb_cal_upc_class",class_info)}else class_html=tmpl_play("lb_cal_upc_class_fin",class_info);scone_replace_item(class_elem_name,class_html,class_sort_info,true);update_areas=1}};if(info.new_item==true)info.new_item=false;if(update_areas==1)cal_update_display_div(lb_cal_upc_obj,1)}
function lb_cal_upc_expand_class(elem,ev_class_id){lb_cal_expand_class(elem,lb_cal_upc_obj,ev_class_id,0,1);return}
function lb_cal_upc_expand_type(elem,ev_type_id){lb_cal_expand_type(elem,lb_cal_upc_obj,ev_type_id,0,1,0);return}
function lb_cal_upc_add_remove_event_alert(elem){if(!elem)return;var ev_id=elem.id.substring(26,elem.id.length),ev_info=_lb_cal_upc_event_hash[ev_id],start_time=ev_info.start_time_seconds,alert_type=_lb_cal_upc_cfg.alert_type,found_in_alerts_cookie=checkForEventInAlertCookie(ev_id,alert_type);if(found_in_alerts_cookie){add_or_remove="remove"}else add_or_remove="add";addRemoveEventAlert(ev_id,start_time,alert_type,add_or_remove);if(add_or_remove=="remove"){$j(elem).removeClass("checked").addClass("alert");$j(elem).attr("title",alertReminderNotSetMsg);ev_info.alert_added=false}else{$j(elem).removeClass("alert").addClass("checked");$j(elem).attr("title",alertReminderSetMsg);ev_info.alert_added=true};return}
function lb_calendar_update_dropdown(dropdown_data,is_fin){dropdown_data=dropdown_data.split("} {");var dd_id="",dd_name="",i=0,default_found=0,dropdown_pair="";if(is_fin==0){var elem_id="cal_filter_sports"}else var elem_id="cal_filter_fin";var dropdown_elem=document.getElementById(elem_id);for(i;i<dropdown_data.length;i++){dropdown_pair=dropdown_data[i].split(" ");dd_id=dropdown_pair[0];dd_name=dropdown_pair.slice(1).join(" ");dd_name=dd_name.replace(/[{}]/g,"");dd_id=dd_id.replace(/[{}]/g,"");if(is_fin==0){if(dd_id==_lb_cal_sports_filter_value){default_found=1;dropdown_elem.options[i]=new Option(dd_name,dd_id,true)}else dropdown_elem.options[i]=new Option(dd_name,dd_id)}else if(dd_id==_lb_cal_fin_filter_value){default_found=1;dropdown_elem.options[i]=new Option(dd_name,dd_id,true)}else dropdown_elem.options[i]=new Option(dd_name,dd_id)};if(default_found==0)if(is_fin==0&&_lb_cal_sports_filter_value!="_all_sports_"){cal_filter_sports_update(dropdown_elem)}else if(is_fin==1&&_lb_cal_fin_filter_value!="_all_types_")cal_filter_fin_update(dropdown_elem);return}
function cal_filter_sports_update(elem){_lb_cal_sports_filter_value=elem.value;if(_lb_cal_sports_filter_value!="_all_sports_"){if(_lb_cal_in_a_class_filter==0)_lb_cal_filters_applied.push("CLASS");_lb_cal_in_a_class_filter=1}else if(_lb_cal_in_a_class_filter==1)_lb_cal_restore_class_filter=1;lb_calendar_upc_filter_sports();lb_calendar_live_filter_sports();if(_lb_cal_restore_class_filter==1){_lb_cal_restore_class_filter=0;_lb_cal_in_a_class_filter=0;for(var i=0;i<_lb_cal_filters_applied.length;i++)if(_lb_cal_filters_applied[i]=="CLASS"){_lb_cal_filters_applied.splice(i,1);break}}}
function cal_filter_fin_update(elem){_lb_cal_fin_filter_value=elem.value;if(_lb_cal_fin_filter_value!="_all_types_"){if(_lb_cal_in_a_type_filter==0)_lb_cal_filters_applied.push("TYPE");_lb_cal_in_a_type_filter=1}else if(_lb_cal_in_a_type_filter==1)_lb_cal_restore_type_filter=1;lb_calendar_upc_filter_types();lb_calendar_live_filter_types();if(_lb_cal_restore_type_filter==1){_lb_cal_restore_type_filter=0;_lb_cal_in_a_type_filter=0;for(var i=0;i<_lb_cal_filters_applied.length;i++)if(_lb_cal_filters_applied[i]=="TYPE"){_lb_cal_filters_applied.splice(i,1);break}}}
function cal_filter_stream_update(elem){_lb_cal_stream_filter_value=elem.value;if(_lb_cal_stream_filter_value!="0"){if(_lb_cal_in_an_event_filter==0)_lb_cal_filters_applied.push("EVENT");_lb_cal_in_an_event_filter=1}else if(_lb_cal_in_an_event_filter==1)_lb_cal_restore_event_filter=1;lb_calendar_upc_filter_stream();lb_calendar_live_filter_stream();if(_lb_cal_restore_event_filter==1){_lb_cal_restore_event_filter=0;_lb_cal_in_an_event_filter=0;for(var i=0;i<_lb_cal_filters_applied.length;i++)if(_lb_cal_filters_applied[i]=="EVENT"){_lb_cal_filters_applied.splice(i,1);break}}}
function cal_filter_fin_check_display(ev_type_id){var fin_filter=_lb_cal_fin_filter_value,elem_hidden=false;if(fin_filter=="_all_types_");else if(ev_type_id!=fin_filter)elem_hidden=true;return elem_hidden}
function cal_filter_sports_check_display(ev_class_id,ev_class_category){var sports_filter=_lb_cal_sports_filter_value,elem_hidden=false;if(sports_filter=="_all_sports_");else if(sports_filter.substring(0,3)=="CL_"){sports_filter=sports_filter.substring(3);if(ev_class_id!=sports_filter)elem_hidden=true}else if(ev_class_category!=sports_filter)elem_hidden=true;return elem_hidden}
function cal_filter_stream_check_display(ev_stream_available){var streaming_filter=_lb_cal_stream_filter_value,elem_hidden=false;if(streaming_filter==1&&ev_stream_available==false)elem_hidden=true;return elem_hidden}
function lb_cal_sync_hashes_and_display(handler,calc_ev_counts){if(calc_ev_counts==1)cal_calc_ev_counts(handler);var handler_config=handler.getConfig(),event_is_expandable=handler_config.event_is_expandable,ev_class_id="",ev_type_id="",ev_id="",class_info="",class_html="",class_sort_info="",class_elem_name="",current_hidden="",type_info="",type_html="",type_sort_info="",type_elem_name="",type_displayed=0,ev_info="",ev_sort_info="",ev_elem_name="",ev_html="",class_hash=handler.getHash("CLASS"),type_hash=handler.getHash("TYPE"),event_hash=handler.getHash("EVENT"),class_id_prefix=handler.getIdPrefix("CLASS"),type_id_prefix=handler.getIdPrefix("TYPE"),ev_id_prefix=handler.getIdPrefix("EVENT"),class_expander_changes=0,type_expander_changes=0,ev_expander_changes=0;for(ev_class_id in class_hash)if(class_hash[ev_class_id]){type_displayed=0;class_expander_changes=lb_cal_set_collapsed_value(class_hash[ev_class_id],"CLASS");for(ev_type_id in class_hash[ev_class_id].child_hash)if(type_hash[ev_type_id]){type_info=type_hash[ev_type_id];type_expander_changes=lb_cal_set_collapsed_value(type_info,"TYPE");ev_displayed=0;for(ev_id in type_info.child_hash)if(event_hash[ev_id]){ev_info=event_hash[ev_id];current_hidden=ev_info.hidden;ev_info.hidden=cal_filter_stream_check_display(ev_info.ev_stream_available);if(event_is_expandable==1)ev_expander_changes=lb_cal_set_collapsed_value(ev_info,"EVENT");if(ev_info.hidden==false)ev_displayed=1;if(current_hidden==ev_info.hidden&&ev_expander_changes==0)continue;handler.forceRebuildItem("EVENT",ev_info)};if(ev_displayed==1){current_hidden=type_info.hidden;type_info.hidden=false;if(type_info.is_fin==1)type_info.hidden=cal_filter_fin_check_display(ev_type_id);if(type_info.hidden==false)type_displayed=1;if(current_hidden==type_info.hidden&&type_expander_changes==0)continue;handler.forceRebuildItem("TYPE",type_info)}else{if(type_info.hidden==true&&type_expander_changes==0)continue;type_info.hidden=true;handler.forceRebuildItem("TYPE",type_info)}};class_info=class_hash[ev_class_id];if(type_displayed==1){current_hidden=class_info.hidden;class_info.hidden=false;if(class_info.is_fin==0)class_info.hidden=cal_filter_sports_check_display(ev_class_id,class_info.ev_class_category);if(class_info.hidden==current_hidden&&class_expander_changes==0)continue;handler.forceRebuildItem("CLASS",class_info)}else{if(class_info.hidden==true&&class_expander_changes==0)continue;class_info.hidden=true;handler.forceRebuildItem("CLASS",class_info)}};cal_update_num_ev_headers(handler,1);cal_update_display_div(handler,0)}
function cal_update_num_ev_headers(handler,calc_ev_counts){if(calc_ev_counts==1)cal_calc_ev_counts(handler);var ev_class_id="",num_class_evs=0,class_hash=handler.getHash("CLASS"),num_evs=push_get_ev_counts(handler,"ALL","");bir_update_elem(handler.getMiscInfo("TAB_NUM_EVS_ID"),"("+num_evs+")",0);for(ev_class_id in class_hash){num_class_evs=push_get_ev_counts(handler,"CLASS",ev_class_id);bir_update_elem(handler.getIdPrefix("CLASS_NUM_EVS_ID")+ev_class_id,num_class_evs,0)}}
function cal_update_display_div(handler,calc_ev_counts){if(calc_ev_counts==1)cal_calc_ev_counts(handler);var num_evs=push_get_ev_counts(handler,"ALL",""),cal_area_elem=document.getElementById(handler.getMiscInfo("TAB_AREA_ID")),cal_no_data_elem=document.getElementById(handler.getMiscInfo("TAB_NO_DATA_AREA_ID"));if(num_evs==0){cal_area_elem.style.display="none";cal_no_data_elem.style.display=""}else{cal_area_elem.style.display="";cal_no_data_elem.style.display="none"}}
function cal_update_expanders(handler){var handler_config=handler.getConfig(),use_default_expansion=0,default_expanded_class="",class_info="",ev_type_id="",type_info="",ev_id="",ev_info="",default_expanded_ev="",default_class=handler_config.default_class,event_is_expandable=handler_config.event_is_expandable,num_events=0,ev_container_type="";if(default_class=="")use_default_expansion=1;if(use_default_expansion==0){cal_calc_ev_counts(handler);num_events=push_get_ev_counts(handler,"CLASS",default_class);if(num_events>1){default_expanded_class=default_class}else use_default_expansion=1};if(use_default_expansion==1)default_expanded_class=handler.getMiscInfo("DEFAULT_EXPANDED_CLASS");class_info=handler.getHashId("CLASS",default_expanded_class);if(class_info!=""&&class_info.is_fin==0){class_info.collapsed=false;handler.forceRebuildItem("CLASS",class_info)};var expand_types={};if(handler instanceof lb_cal_live_object&&handler.is_news){expand_types[handler.getHashId("CLASS_TOP_TYPE",default_expanded_class)]=true}else expand_types=class_info.child_hash;ev_container_type=handler.getHashId("CLASS_TOP_TYPE",default_expanded_class);if(event_is_expandable==1)default_expanded_ev=handler.getHashId("TYPE_TOP_EVENT",ev_container_type);for(ev_type_id in class_info.child_hash){type_info=handler.getHashId("TYPE",ev_type_id);if(type_info!=""){if(ev_type_id in expand_types)type_info.collapsed=false;handler.forceRebuildItem("TYPE",type_info);if(type_info.collapsed==false)for(ev_id in type_info.child_hash){ev_info=handler.getHashId("EVENT",ev_id);if(ev_info!=""){if(ev_id==default_expanded_ev)ev_info.collapsed=false;handler.forceRebuildItem("EVENT",ev_info);updatePeriodClock(ev_info)}}}}}
function cal_calc_ev_counts(handler){handler.clearHash("EV_COUNT");var count_hash=handler.getHash("EV_COUNT"),class_info="",class_hash=handler.getHash("CLASS"),type_info="",type_hash=handler.getHash("TYPE"),ev_info="",event_hash=handler.getHash("EVENT"),total_ev_count=0,class_ev_count=0,type_ev_count=0,ev_class_id="",ev_type_id="",ev_id="",class_hidden=false,type_hidden=false,ev_hidden=false,ev_displayed="Y";for(ev_class_id in class_hash)if(class_hash[ev_class_id]){class_ev_count=0;class_info=class_hash[ev_class_id];class_hidden=class_info.hidden;for(ev_type_id in class_info.child_hash)if(type_hash[ev_type_id]){type_ev_count=0;type_info=type_hash[ev_type_id];type_hidden=type_info.hidden;for(ev_id in type_info.child_hash)if(event_hash[ev_id]){ev_info=event_hash[ev_id];ev_hidden=ev_info.hidden;ev_displayed=ev_info.displayed;if(ev_hidden==false&&ev_displayed=="Y"){type_ev_count+=1;if(type_hidden==false){class_ev_count+=1;if(class_hidden==false)total_ev_count+=1}}};if(!count_hash["TYPE"+ev_type_id])count_hash["TYPE"+ev_type_id]={};count_hash["TYPE"+ev_type_id]=type_ev_count};if(!count_hash["CLASS"+ev_class_id])count_hash["CLASS"+ev_class_id]={};count_hash["CLASS"+ev_class_id]=class_ev_count};if(!count_hash.ALL)count_hash.ALL={};count_hash.ALL=total_ev_count}
function lb_cal_expand_category(handler,ev_class_category){var class_array=handler.getHashId("CATEGORY_CLASSES",ev_class_category),i=0;for(i=0;i<class_array.length;i++)lb_cal_expand_class("",handler,class_array[i],1,0)}
function lb_cal_get_top_class(handler){var top_ev_class_id="",top_type_disp="",class_info="",class_hash=handler.getHash("CLASS"),num_expanded_classes=lb_cal_count_displayed_expanded_classes(handler);for(ev_class_id in class_hash){class_info=handler.getHashId("CLASS",ev_class_id);if(class_info!="")if(top_ev_class_id==""||class_info.normal_disporder<top_class_disp){top_ev_class_id=ev_class_id;top_class_disp=class_info.normal_disporder}};return top_ev_class_id}
function lb_cal_get_top_type(handler,ev_class_id){var class_info=handler.getHashId("CLASS",ev_class_id),type_info="",top_type_disp="",top_ev_type_id="";for(ev_type_id in class_info.child_hash){type_info=handler.getHashId("TYPE",ev_type_id);if(type_info!="")if(top_type_disp==""||type_info.normal_disporder<=top_type_disp){if(top_type_disp===type_info.disporder)if(top_ev_type_id<type_info.ev_type_id)continue;top_type_disp=type_info.normal_disporder;top_ev_type_id=type_info.ev_type_id}};return top_ev_type_id}
function lb_cal_get_top_event(handler,ev_type_id){var type_info=handler.getHashId("TYPE",ev_type_id),ev_id="",ev_info="",top_ev_start_time="",top_ev_disp="",top_ev_id="";for(ev_id in type_info.child_hash){ev_info=handler.getHashId("EVENT",ev_id);if(ev_info!="")if(top_ev_start_time==""||ev_info.start_time_disp_order<=top_ev_start_time){if(top_ev_start_time===ev_info.start_time_disp_order)if(ev_info.disporder<=top_ev_disp){if(top_ev_disp===ev_info.disporder)if(top_ev_id<ev_info.ev_id)continue}else continue;top_ev_start_time=ev_info.start_time_disp_order;top_ev_disp=ev_info.disporder;top_ev_id=ev_info.ev_id}};return top_ev_id};var lb_cal_expand_class_processing=0,lb_cal_expand_class_queue=new Array()
function lb_cal_expand_class(elem,handler,ev_class_id,instant_expand_class,allow_compress){var expand_data=new Array();expand_data.push(elem,handler,ev_class_id,instant_expand_class,allow_compress);lb_cal_expand_class_queue.push(expand_data);if(lb_cal_expand_class_queue.length<2)lb_cal_expand_class_queue_poll()}
function lb_cal_expand_class_queue_poll(){if(lb_cal_expand_class_queue.length>0)if(lb_cal_expand_class_processing==0){lb_cal_expand_class_processing=1;var expand_data=lb_cal_expand_class_queue[0],elem=expand_data[0],handler=expand_data[1],ev_class_id=expand_data[2],instant_expand_class=expand_data[3],allow_compress=expand_data[4];lb_cal_expand_class_do(elem,handler,ev_class_id,instant_expand_class,allow_compress);lb_cal_expand_class_queue.shift();lb_cal_expand_class_processing=0;lb_cal_expand_class_queue_poll()}else setTimeout(lb_cal_expand_class_queue_poll,100)}
function lb_cal_expand_class_do(elem,handler,ev_class_id,instant_expand_class,allow_compress){if(elem==""&&(instant_expand_class==0||allow_compress==1))return;var top_ev_type_id="",top_ev_id="",handler_config=handler.getConfig(),event_is_expandable=handler_config.event_is_expandable,class_info=handler.getHashId("CLASS",ev_class_id),class_elem_name="",class_sort_info="",class_html="",class_id_prefix=handler.getIdPrefix("CLASS"),ev_type_id="",type_info="",type_elem_name="",type_sort_info="",type_html="",type_id_prefix=handler.getIdPrefix("TYPE"),ev_id="",ev_info="",ev_elem_name="",ev_sort_info="",ev_html="",ev_id_prefix=handler.getIdPrefix("EVENT"),num_expanded_events=0,num_expanded_types=0;if(!class_info)return;if(class_info.collapsed==false){if(allow_compress==1){class_info.collapsed=true;var targetContent=$j('div.itemContent:first',elem.parentNode.parentNode);$j('.li_content').hide();targetContent.slideUp(300);$j(elem).removeClass('on').removeClass('off');$j(elem).addClass('off')};return};class_info.collapsed=false;num_expanded_types=lb_cal_count_displayed_expanded_types(handler,ev_class_id);if(num_expanded_types==0){top_ev_type_id=lb_cal_get_top_type(handler,ev_class_id);num_expanded_events=lb_cal_count_displayed_expanded_events(handler,top_ev_type_id);if(top_ev_type_id!=""&&event_is_expandable==1&&num_expanded_events==0)top_ev_id=lb_cal_get_top_event(handler,top_ev_type_id);for(ev_type_id in class_info.child_hash){type_info=handler.getHashId("TYPE",ev_type_id);if(type_info!=""){type_info.collapsed=false;handler.forceRebuildItem("TYPE",type_info);for(var ev_id in type_info.child_hash){ev_info=handler.getHashId("EVENT",ev_id);if(ev_id==top_ev_id){ev_info.collapsed=false;handler.forceRebuildItem("EVENT",ev_info)}else if(!scone_item_exists(ev_id_prefix+ev_info.ev_id))handler.forceRebuildItem("EVENT",ev_info)}}}};if(instant_expand_class==1){handler.forceRebuildItem("CLASS",class_info)}else{var targetContent=$j('div.itemContent:first',elem.parentNode.parentNode);$j('.li_content').hide();targetContent.slideDown(300);$j(elem).removeClass('on').removeClass('off');$j(elem).addClass('on')};return};var lb_cal_expand_type_processing=0,lb_cal_expand_type_queue=new Array()
function lb_cal_expand_type(elem,handler,ev_type_id,instant_expand_type,allow_compress,force_defaults){var expand_data=new Array();expand_data.push(elem,handler,ev_type_id,instant_expand_type,allow_compress,force_defaults);lb_cal_expand_type_queue.push(expand_data);if(lb_cal_expand_type_queue.length<2)lb_cal_expand_type_queue_poll()}
function lb_cal_expand_type_queue_poll(){if(lb_cal_expand_type_queue.length>0)if(lb_cal_expand_type_processing==0){lb_cal_expand_type_processing=1;var expand_data=lb_cal_expand_type_queue[0],elem=expand_data[0],handler=expand_data[1],ev_type_id=expand_data[2],instant_expand_type=expand_data[3],allow_compress=expand_data[4],force_defaults=expand_data[5];lb_cal_expand_type_do(elem,handler,ev_type_id,instant_expand_type,allow_compress,force_defaults);lb_cal_expand_type_queue.shift();lb_cal_expand_type_processing=0;lb_cal_expand_type_queue_poll()}else setTimeout(lb_cal_expand_type_queue_poll,100)}
function lb_cal_expand_type_do(elem,handler,ev_type_id,instant_expand_type,allow_compress,force_defaults){if(elem==""&&(instant_expand_type==0||allow_compress==1))return;var handler_config=handler.getConfig(),event_is_expandable=handler_config.event_is_expandable,type_info=handler.getHashId("TYPE",ev_type_id),type_elem_name="",type_sort_info="",type_html="",type_id_prefix=handler.getIdPrefix("TYPE"),ev_id_prefix=handler.getIdPrefix("EVENT"),ev_id="",ev_info="",top_ev_id="",class_info="",num_expanded_events=0;if(!type_info)return;class_info=handler.getHashId("CLASS",type_info.ev_class_id);if(type_info.collapsed==false&&force_defaults==0){if(allow_compress==1){type_info.collapsed=true;var targetContent=$j('div.itemContent:first',elem.parentNode.parentNode);$j('.li_content').hide();targetContent.slideUp(300);$j(elem).removeClass('on').removeClass('off');$j(elem).addClass('off')};return};type_info.collapsed=false;if(force_defaults==0)num_expanded_events=lb_cal_count_displayed_expanded_events(handler,ev_type_id);if(num_expanded_events==0){top_ev_id=lb_cal_get_top_event(handler,ev_type_id);for(var ev_id in type_info.child_hash){ev_info=handler.getHashId("EVENT",ev_id);if(ev_info!="")if(ev_id==top_ev_id&&event_is_expandable==1){ev_info.collapsed=false;handler.forceRebuildItem("EVENT",ev_info)}else if(!scone_item_exists(ev_id_prefix+ev_id))handler.forceRebuildItem("EVENT",ev_info)}};if(instant_expand_type==1){handler.forceRebuildItem("TYPE",type_info)}else{var targetContent=$j('div.itemContent:first',elem.parentNode.parentNode);$j('.li_content').hide();targetContent.slideDown(300);$j(elem).removeClass('on').removeClass('off');$j(elem).addClass('on')}};var lb_cal_expand_event_processing=0,lb_cal_expand_event_queue=new Array()
function lb_cal_expand_event(elem,handler,ev_id){var expand_data=new Array();expand_data.push(elem,handler,ev_id);lb_cal_expand_event_queue.push(expand_data);if(lb_cal_expand_event_queue.length<2)lb_cal_expand_event_queue_poll()}
function lb_cal_expand_event_queue_poll(){if(lb_cal_expand_event_queue.length>0)if(lb_cal_expand_event_processing==0){lb_cal_expand_event_processing=1;var expand_data=lb_cal_expand_event_queue[0],elem=expand_data[0],handler=expand_data[1],ev_id=expand_data[2];lb_cal_expand_event_do(elem,handler,ev_id);lb_cal_expand_event_queue.shift();lb_cal_expand_event_processing=0;lb_cal_expand_event_queue_poll()}else setTimeout(lb_cal_expand_event_queue_poll,100)}
function lb_cal_expand_event_do(elem,handler,ev_id){var ev_id_prefix=handler.getIdPrefix("EVENT"),ev_info=handler.getHashId("EVENT",ev_id);if(!ev_info)return;if(ev_info.collapsed==false){ev_info.collapsed=true;var targetContent=$j('div.itemContent:first',elem.parentNode.parentNode);$j('.li_content').hide();targetContent.slideUp(300);$j(elem).removeClass('on').removeClass('off');$j(elem).addClass('off');return};ev_info.collapsed=false;if(!scone_item_exists(ev_id_prefix+ev_info.ev_id))handler.forceRebuildItem("EVENT",ev_info);var targetContent=$j('div.itemContent:first',elem.parentNode.parentNode);$j('.li_content').hide();targetContent.slideDown(300);$j(elem).removeClass('on').removeClass('off');$j(elem).addClass('on');return}
function lb_cal_count_displayed_expanded_events(handler,ev_type_id){var count=0,type_info=handler.getHashId("TYPE",ev_type_id),ev_id="",ev_info="";if(type_info!="")for(ev_id in type_info.child_hash){ev_info=handler.getHashId("EVENT",ev_id);if(ev_info!=""&&ev_info.hidden==false&&ev_info.collapsed==false)count++};return count}
function lb_cal_count_displayed_expanded_types(handler,ev_class_id){var count=0,class_info=handler.getHashId("CLASS",ev_class_id),ev_type_id="",type_info="";if(class_info!="")for(ev_type_id in class_info.child_hash){type_info=handler.getHashId("TYPE",ev_type_id);if(type_info!=""&&type_info.hidden==false&&type_info.collapsed==false)count++};return count}
function lb_cal_count_all_displayed_expanded_types(handler){var count=0,class_hash=handler.getHash("CLASS"),class_info="",ev_type_id="",type_info="",ev_class_id="";if(class_hash!="")for(ev_class_id in class_hash){class_info=class_hash[ev_class_id];for(ev_type_id in class_info.child_hash){type_info=handler.getHashId("TYPE",ev_type_id);if(type_info!=""&&type_info.hidden==false&&type_info.collapsed==false)count++}};return count}
function lb_cal_count_displayed_expanded_classes(handler){var count=0,class_hash=handler.getHash("CLASS"),ev_class_id="";if(class_hash!="")for(ev_class_id in class_hash){class_info=handler.getHashId("CLASS",ev_class_id);if(class_info!=""&&class_info.hidden==false&&class_info.collapsed==false)count++};return count}
function lb_cal_expand_filtered_class(handler){var sports_filter=_lb_cal_sports_filter_value,ev_class_id="",ev_class_category="";if(sports_filter=="_all_sports_"){var num_expanded_classes=lb_cal_count_displayed_expanded_classes(handler);if(num_expanded_classes==0){var top_class=lb_cal_get_top_class(handler);lb_cal_expand_class("",handler,top_class,1,0)}}else if(sports_filter.substring(0,3)=="CL_"){ev_class_id=sports_filter.substring(3);lb_cal_expand_class("",handler,ev_class_id,1,0)}else{ev_class_category=sports_filter;lb_cal_expand_category(handler,ev_class_category)};return}
function lb_cal_expand_filtered_type(handler){var expand_type_id=_lb_cal_fin_filter_value;if(expand_type_id=="_all_types_"){var num_expanded_types=lb_cal_count_all_displayed_expanded_types(handler);if(num_expanded_types==0){var top_class=lb_cal_get_top_class(handler);expand_type_id=lb_cal_get_top_type(handler,top_class)}};lb_cal_expand_type("",handler,expand_type_id,1,0,1)}
function lb_cal_set_collapsed_value(data,level){var changed=0,position=-1;if(_lb_cal_in_a_class_filter==1)if(_lb_cal_restore_class_filter==1){position==-1;for(var i=0;i<_lb_cal_filters_applied.length;i++)if(_lb_cal_filters_applied[i]=="CLASS"){var position=i;break};if(position===_lb_cal_filters_applied.length-1){if(data.collapsed_backup_class!=="")if(data.collapsed!==data.collapsed_backup_class){data.collapsed=data.collapsed_backup_class;changed=1}}else if(data.collapsed_backup_class!=="")lb_cal_update_next_filter_backup(data,position+1,data.collapsed_backup_class);data.collapsed_backup_class=""}else if(data.collapsed_backup_class==="")data.collapsed_backup_class=data.collapsed;if(_lb_cal_in_a_type_filter==1)if(_lb_cal_restore_type_filter==1){position==-1;for(var i=0;i<_lb_cal_filters_applied.length;i++)if(_lb_cal_filters_applied[i]=="TYPE"){var position=i;break};if(position===_lb_cal_filters_applied.length-1){if(data.collapsed_backup_type!=="")if(data.collapsed!==data.collapsed_backup_type){data.collapsed=data.collapsed_backup_type;changed=1}}else if(data.collapsed_backup_type!=="")lb_cal_update_next_filter_backup(data,position+1,data.collapsed_backup_type);data.collapsed_backup_type=""}else if(data.collapsed_backup_type==="")data.collapsed_backup_type=data.collapsed;if(_lb_cal_in_an_event_filter==1)if(_lb_cal_restore_event_filter==1){position==-1;for(var i=0;i<_lb_cal_filters_applied.length;i++)if(_lb_cal_filters_applied[i]=="EVENT"){var position=i;break};if(position===_lb_cal_filters_applied.length-1){if(data.collapsed_backup_event!=="")if(data.collapsed!==data.collapsed_backup_event){data.collapsed=data.collapsed_backup_event;changed=1}}else if(data.collapsed_backup_event!=="")lb_cal_update_next_filter_backup(data,position+1,data.collapsed_backup_event);data.collapsed_backup_event=""}else if(data.collapsed_backup_event==="")data.collapsed_backup_event=data.collapsed;return changed}
function lb_cal_update_next_filter_backup(data,filter_position,new_value){var filter_sort=_lb_cal_filters_applied[filter_position];switch(filter_sort){case"CLASS":data.collapsed_backup_class=new_value;break;case"TYPE":data.collapsed_backup_type=new_value;break;case"EVENT":data.collapsed_backup_event=new_value;break;default:};return}
function lb_cal_rebuild_tab(handler){var class_hash=handler.getHash("CLASS"),ev_class_id="",ev_type_id="",ev_id="",class_id_prefix=handler.getIdPrefix("CLASS"),type_id_prefix=handler.getIdPrefix("TYPE"),ev_id_prefix=handler.getIdPrefix("EVENT");if(class_hash!="")for(ev_class_id in class_hash){class_info=handler.getHashId("CLASS",ev_class_id);if(class_info!=""){if(!scone_item_exists(class_id_prefix+ev_class_id))handler.forceRebuildItem("CLASS",class_info);if(class_info.collapsed==false)for(ev_type_id in class_info.child_hash){type_info=handler.getHashId("TYPE",ev_type_id);if(type_info!=""){if(!scone_item_exists(type_id_prefix+ev_class_id))handler.forceRebuildItem("TYPE",type_info);if(type_info.collapsed==false)for(var ev_id in type_info.child_hash){ev_info=handler.getHashId("EVENT",ev_id);if(ev_info!=""&&!scone_item_exists(ev_id_prefix+ev_info.ev_id))handler.forceRebuildItem("EVENT",ev_info)}}}}};cal_update_num_ev_headers(handler,1)};var _lb_cal_sports_filter_value="_all_sports_",_lb_cal_fin_filter_value="_all_types_",_lb_cal_stream_filter_value="0",_lb_cal_in_a_class_filter=0,_lb_cal_restore_class_filter=0,_lb_cal_in_a_type_filter=0,_lb_cal_restore_type_filter=0,_lb_cal_in_an_event_filter=0,_lb_cal_restore_event_filter=0,_lb_cal_filters_applied=new Array()
function lb_evt_init(event,evmkts,selcns,init_msg_id,cfg,templates){_lb_evt_store_templates(templates);_lb_evt_ev_id=event.ev_id;lb_evt_ev_id=event.ev_id;event.markets=new Array();for(var f in cfg)_lb_evt_cfg[f]=cfg[f];_lb_evt_got_EVENT(event);for(var i=0;i<evmkts.length;i++){_lb_evt_got_EVMKT(evmkts[i],true);event.markets.push(evmkts[i].ev_mkt_id)};lb_evt_upd_market_orders();for(var i=0;i<selcns.length;i++)_lb_evt_got_SELCN(selcns[i]);_lb_evt_mkts_count_refresh();var padded_ev_id=ps_connect_lpad_id(_lb_evt_ev_id),channels=["sEVENT"+padded_ev_id,"SEVENT"+padded_ev_id];ps_connect_register("lb_evt",_lb_evt_got_msg,channels,init_msg_id);return};var _lb_evt_event_area_id="lb_evt_content",_lb_evt_mkts_id="markets",_lb_evt_mkt_id_prefix="market ",_lb_evt_selcns_id_prefix="mkt_selcns_",_lb_evt_selcn_id_prefix="selcn_",_lb_evt_price_class_name="odd",_lb_evt_selcn_highlight_id_prefix="lb_evt_price_con_",_lb_evt_price_str_id_prefix="lb_evt_price_str_",_lb_evt_stake_id_prefix="lb_evt_stake_",_lb_evt_fb_stake_id_prefix="lb_evt_fb_stake_",_lb_evt_num_avail_mkts_id="enum_avail_mkts",_lb_evt_highlight_timers={}
function lb_evt_object(){return};lb_evt_object.prototype.getConfig=function(){return _lb_evt_cfg};lb_evt_object.prototype.getHash=function(identifier){var ret="";switch(identifier){case"HL_TIMERS":if(_lb_evt_highlight_timers)ret=_lb_evt_highlight_timers;break;default:ret=""};return ret};lb_evt_object.prototype.getHashId=function(identifier,id){var ret="";switch(identifier){case"HL_TIMERS":if(_lb_evt_highlight_timers&&_lb_evt_highlight_timers[id])ret=_lb_evt_highlight_timers[id];break;default:ret=""};return ret};lb_evt_object.prototype.getMiscInfo=function(identifier){var ret="";switch(identifier){case"PRICE_CLASS_NAME":if(_lb_evt_price_class_name)ret=_lb_evt_price_class_name;break;default:ret=""};return ret};lb_evt_object.prototype.getIdPrefix=function(identifier){var ret="";switch(identifier){case"SELCN_HL":if(_lb_evt_selcn_highlight_id_prefix)ret=_lb_evt_selcn_highlight_id_prefix;break;default:ret=""};return ret};lb_evt_object.prototype.gotPushData=function(identifier,data){switch(identifier){case"PRICE":_lb_evt_got_PRICE(data);break;case"SELCN":_lb_evt_got_SELCN(data);break;case"MHCAP":_lb_evt_got_MHCAP(data);break;case"EVMKT":_lb_evt_got_EVMKT(data);break;case"EVENT":_lb_evt_got_EVENT(data);break;default:};return};var lb_evt_obj=new lb_evt_object(),lb_evt_cmp_objects=new function(){}();lb_evt_cmp_objects=new push_hash_cmp_objects();lb_evt_cmp_objects.cmpEvMkts=function(cmpMode,evmktA,evmktB){var d=evmktA.disporder-evmktB.disporder;if(d)return d;return evmktA.ev_mkt_id-evmktB.ev_mkt_id;return d};var _lb_evt_market_ordering={},_lb_evt_market_original_ordering={}
function _lb_evt_store_templates(templates){for(tmpl_name in templates){tmpl_value=templates[tmpl_name];tmpl_store(tmpl_name,tmpl_value)};return};var _lb_evt_cfg={lang:"en",price_str_type:"ODDS",price_str_type_ah:"DECIMAL",price_str_type_hl:"DECIMAL",price_str_sep:"-",quickbet_amounts:[10,25,50],highlight_duration:4e3,img_url:"/img",bir_sort:"--",hl_class_decrease:"_d",hl_class_increase:"_i",hl_class_same:""},_lb_evt_ev_id=-1,lb_evt_ev_id=-1,_lb_evt_event=null,_lb_evt_evmkt_hash={},_lb_evt_selcn_hash={},_lb_evt_new_mkt_timers={},_lb_hr_evt_last_msg_id=-1,_lb_hr_evt_event={};_lb_hr_evt_event.name='';_lb_hr_evt_event.BIDS_status='';var _lb_evt_lowest_disporder=9999999,_lb_evt_lowest_disporder_ev_mkt_id=-1,_lb_evt_redirect_timer=null
function _lb_evt_got_msg(msg){bir_got_msg(lb_evt_obj,msg);if(_lb_evt_cfg.bir_sort=='HR')_lb_hr_evt_last_msg_id=msg.subject_id;return}
function _lb_evt_got_EVENT(data){if(data.ev_id!=_lb_evt_ev_id){if(data.ev_id==document.lb_pre_bir_ev_id)_lb_evt_got_PREBIR_EVENT(data);return};var info=_lb_evt_event,is_new_item=!info,orig_bettable;if(is_new_item){info=data;_lb_evt_event=info}else{orig_bettable=info.bettable;for(var f in data)info[f]=data[f]};info.name=info.names[_lb_evt_cfg.lang];info.start_time_xl=info.start_time_xls[_lb_evt_cfg.lang];info.bettable=(info.status=="A");if(_lb_evt_cfg.bir_sort=='HR'){if(info.is_off=='N')info.bettable=false;if(info.is_off=='-'&&info.in_future&&info.in_future==1)info.bettable=false};var event_el=document.getElementById(_lb_evt_event_area_id);if(is_new_item){var html=tmpl_play("lb_evt_event",info);event_el.innerHTML=html;scone_create(_lb_evt_mkts_id,{},lb_evt_cmp_objects.cmpEvMkts);var pscone_id=_lb_evt_mkts_id;if(scone_exists(pscone_id)){var sort_info={disporder:2147483647,ev_mkt_id:0};_lb_evt_market_original_ordering[0]=2147483647;var scitem_id=_lb_evt_mkt_id_prefix+0,html='';if(_lb_evt_cfg.bir_sort=='HR'){html=$j('#next_n_races_container').html();$j('#next_n_races_container').empty()}else{html=$j('#linkedEvsContainer').html();$j('#linkedEvsContainer').empty()};html='<div class="ifItem" id="bir-mkt 0"> <div id="market 0">'+html+'</div></div>';scone_add_item(pscone_id,scitem_id,html,sort_info)}}else{j_event_el=$j(event_el);blurb_el=j_event_el.find("div.viewing-mkt");blurb_el.find("blurb-ev").html(info.blurb_ev);blurb_el.find("blurb-type").html(info.blurb_type);blurb_el.find("blurb-class").html(info.blurb_class);if(info.displayed="N"){j_event_el.find("div.ifCnt div#markets").hide()}else j_event_el.find("div.ifCnt div#markets").show()};if(!is_new_item&&orig_bettable!=info.bettable)for(var ev_mkt_id in _lb_evt_evmkt_hash)_lb_evt_got_EVMKT({ev_id:data.ev_id,ev_mkt_id:ev_mkt_id});if(_lb_evt_cfg.bir_sort=='HR'){_lb_hr_evt_event.name=info.name;if(info.pre_bir_bids_status&&info.pre_bir_bids_status!=''){_lb_hr_evt_event.BIDS_status=bids_status_xl(info.pre_bir_bids_status)}else if(info.bids_status&&info.bids_status!='')_lb_hr_evt_event.BIDS_status=bids_status_xl(info.bids_status)};_lb_evt_mkts_count_refresh();updatePeriodClock(data);return}
function _lb_evt_got_EVMKT(data,first_build){var parent_info=_lb_evt_event;if(data.ev_id!=parent_info.ev_id)return;var info=_lb_evt_evmkt_hash[data.ev_mkt_id],is_new_item=!info,orig_displayed,orig_disporder,orig_name,orig_bettable,orig_hcap_values,orig_settled;if(is_new_item){info=data;_lb_evt_evmkt_hash[data.ev_mkt_id]=info;info.child_hash={};if(info.disporder<_lb_evt_lowest_disporder){_lb_evt_lowest_disporder=info.disporder;_lb_evt_lowest_disporder_ev_mkt_id=info.ev_mkt_id}}else{orig_displayed=info.displayed;orig_disporder=info.disporder;orig_name=info.name;orig_bettable=info.bettable;orig_hcap_values=info.hcap_values;orig_settled=info.settled;for(var f in data)info[f]=data[f]};info.is_new=(is_new_item&&!first_build)||(!is_new_item&&orig_displayed!=info.displayed&&info.displayed=="Y");info.name=info.names[_lb_evt_cfg.lang];info.bettable=(info.status=="A")&&parent_info.bettable;if(info.blurb==undefined)info.blurb="";info.parent_cashout_avail=parent_info.cashout_avail;if(data.disporder!=undefined)_lb_evt_market_original_ordering[data.ev_mkt_id]=data.disporder;if(info.is_new){var normal_disporder=0;for(var ev_mkt_id in _lb_evt_market_ordering)if(_lb_evt_market_original_ordering[ev_mkt_id]<data.disporder)normal_disporder++;normal_disporder=normal_disporder+0.5;_lb_evt_market_original_ordering[data.ev_mkt_id]=data.disporder;info.disporder=normal_disporder};var cust_market_disporder=_lb_evt_market_ordering[data.ev_mkt_id];if(cust_market_disporder)info.disporder=cust_market_disporder;var scitem_id=_lb_evt_mkt_id_prefix+data.ev_mkt_id,pscone_id=_lb_evt_mkts_id;if(!scone_exists(pscone_id))return;var html=tmpl_play("lb_evt_evmkt",info),was_visible=scone_item_exists(scitem_id),now_visible=(info.displayed=="Y"),sort_info={disporder:info.disporder,ev_mkt_id:info.ev_mkt_id};if(!was_visible&&now_visible){scone_add_item(pscone_id,scitem_id,html,sort_info);var cscone_id=_lb_evt_selcns_id_prefix+data.ev_mkt_id;scone_create(cscone_id,{},lb_evt_cmp_objects.cmpSelcns)}else if(was_visible&&now_visible){scone_replace_item(scitem_id,html,sort_info,true)}else if(was_visible&&!now_visible)scone_remove_item(scitem_id);if(now_visible&&(!was_visible||orig_bettable!=info.bettable||_lb_evt_diff_objs_brief(orig_hcap_values,info.hcap_values)))for(var ev_oc_id in info.child_hash)_lb_evt_got_SELCN({ev_oc_id:ev_oc_id,ev_mkt_id:info.ev_mkt_id});if(!first_build&&(is_new_item||(orig_displayed!=info.displayed)||(orig_name!=info.name)||(orig_disporder!=info.disporder)||(orig_bettable!=info.bettable)))_lb_evt_mkts_count_refresh();if(info.is_new){_lb_evt_highlight_new_mkt(info.ev_mkt_id);lb_evt_upd_market_orders()};if(now_visible)$j("#toogle_live_events_wrap").html('<a href="javascript:void(0)" title="'+bir_collapse_all+'" class="expand"><span class="toggle_live_events_option">'+bir_collapse_all+'</span></a><span class="toggle_live_events_option">'+bir_expand_all+'</span>');if(_lb_evt_lowest_disporder_ev_mkt_id==info.ev_mkt_id&&_lb_evt_cfg.bir_sort!='HR'&&_lb_evt_cfg.use_ev_bir_redirect==1){var redirect_overlay=document.getElementById('event_redirect_overlay');if(info.settled=="Y"&&orig_settled=="N"&&_lb_evt_redirect_timer==null){var delay=Math.round(_lb_evt_cfg.ev_bir_redirect_time_window+Math.random()*2e3);_lb_evt_redirect_timer=window.setTimeout("_lb_evt_redirect()",delay);redirect_overlay.style.display=''}else if(info.settled=="N"&&orig_settled=="Y"&&_lb_evt_redirect_timer!=null){clearTimeout(_lb_evt_redirect_timer);_lb_evt_redirect_timer=null;redirect_overlay.style.display='none'}};return}
function _lb_evt_redirect(){_lb_evt_redirect_timer=null;goBIRNextEvent()}
function _lb_evt_highlight_new_mkt(ev_mkt_id){var duration=_lb_evt_cfg.highlight_duration*3;_lb_evt_show_global_new_mkt(true);var old_timer=_lb_evt_new_mkt_timers.global;if(old_timer!=null)window.clearTimeout(old_timer);var cmd="_lb_evt_show_global_new_mkt(false)";_lb_evt_new_mkt_timers.global=window.setTimeout(cmd,duration);var old_timer=_lb_evt_new_mkt_timers[ev_mkt_id];if(old_timer!=null)window.clearTimeout(old_timer);var cmd="_lb_evt_hide_new_mkt("+ev_mkt_id+")";_lb_evt_new_mkt_timers[ev_mkt_id]=window.setTimeout(cmd,duration)}
function _lb_evt_show_global_new_mkt(show){var el=document.getElementById("new_market_img_div");if(el)el.style.display=show?"":"none";var el=document.getElementById("new_market_img_div2");if(el)el.style.display=show?"":"none"}
function _lb_evt_hide_new_mkt(ev_mkt_id){var el=document.getElementById("new_market_img_"+ev_mkt_id);if(el)el.parentNode.removeChild(el);var info=_lb_evt_evmkt_hash[ev_mkt_id];if(info&&info.is_new){info.is_new=false;_lb_evt_mkts_count_refresh()}}
function _lb_evt_got_MHCAP(data){var parent_info=_lb_evt_event,info=_lb_evt_evmkt_hash[data.ev_mkt_id];if(!parent_info||!info)return;for(var f in data)info[f]=data[f];for(var ev_oc_id in info.child_hash)_lb_evt_got_SELCN({ev_oc_id:ev_oc_id,ev_mkt_id:info.ev_mkt_id});return}
function _lb_evt_got_SELCN(data){var parent_info=_lb_evt_evmkt_hash[data.ev_mkt_id];if(!parent_info)return;parent_info.child_hash[data.ev_oc_id]=true;var info=_lb_evt_selcn_hash[data.ev_oc_id],is_new_item=!info,orig_lp_num,orig_lp_den;if(is_new_item){info=data;_lb_evt_selcn_hash[data.ev_oc_id]=info;if(info.cashout_avail=='Y')cashout_selns.push(info)}else{orig_lp_num=info.lp_num;orig_lp_den=info.lp_den;orig_hcap_values=info.hcap_values;for(var f in data)info[f]=data[f]};info.name=info.names[_lb_evt_cfg.lang];if(info.fb_result&&parent_info.hcap_values)info.hcap_value=parent_info.hcap_values[info.fb_result];info.bettable=(info.status=="A")&&parent_info.bettable;if(parent_info.start_collapse==1)return;var scitem_id=_lb_evt_selcn_id_prefix+data.ev_oc_id,pscone_id=_lb_evt_selcns_id_prefix+info.ev_mkt_id;if(!scone_exists(pscone_id))return;info.price_str=get_price_str(lb_evt_obj,info.lp_num,info.lp_den,parent_info.lp_avail,parent_info.mkt_sort);var html=tmpl_play("lb_evt_selcn",info),was_visible=scone_item_exists(scitem_id),now_visible=(info.displayed=="Y"),sort_info={disporder:info.disporder,lp_num:info.lp_num,lp_den:info.lp_den,ev_oc_id:info.ev_oc_id},saved_stake=["",""];if(was_visible){var el1=document.getElementById(_lb_evt_stake_id_prefix+info.ev_oc_id);if(el1)saved_stake[0]=el1.value;var el2=document.getElementById(_lb_evt_fb_stake_id_prefix+info.ev_oc_id);if(el2)saved_stake[1]=el2.value};if(!was_visible&&now_visible){scone_add_item(pscone_id,scitem_id,html,sort_info)}else if(was_visible&&now_visible){scone_replace_item(scitem_id,html,sort_info,false)}else if(was_visible&&!now_visible)scone_remove_item(scitem_id);if(now_visible&&(saved_stake[0]!=""||saved_stake[1]!="")){var el1=document.getElementById(_lb_evt_stake_id_prefix+info.ev_oc_id);if(el1)el1.value=saved_stake[0];var el2=document.getElementById(_lb_evt_fb_stake_id_prefix+info.ev_oc_id);if(el2)el2.value=saved_stake[1]};if(!is_new_item&&now_visible)push_highlight_price_change(lb_evt_obj,info.ev_oc_id,info.lp_num,info.lp_den,orig_lp_num,orig_lp_den);return}
function _lb_evt_got_PRICE(data){var info=_lb_evt_selcn_hash[data.ev_oc_id];if(!info)return;var parent_info=_lb_evt_evmkt_hash[info.ev_mkt_id];if(!parent_info)return;var orig_lp_num=info.lp_num,orig_lp_den=info.lp_den;for(var f in data)info[f]=data[f];var scitem_id=_lb_evt_selcn_id_prefix+data.ev_oc_id;if(!scone_item_exists(scitem_id))return;var sort_info={disporder:info.disporder,lp_num:info.lp_num,lp_den:info.lp_den,ev_oc_id:info.ev_oc_id};scone_set_item_info(scitem_id,sort_info);var price_id=_lb_evt_price_str_id_prefix+info.ev_oc_id,price_el=document.getElementById(price_id);if(!price_el)return;info.price_str=get_price_str(lb_evt_obj,info.lp_num,info.lp_den,parent_info.lp_avail,parent_info.mkt_sort);price_el.innerHTML=info.price_str;push_highlight_price_change(lb_evt_obj,info.ev_oc_id,info.lp_num,info.lp_den,orig_lp_num,orig_lp_den);return}
function lb_evt_add_bet(ev_oc_id,stake,fast_bet){var fb=typeof fast_bet==='boolean'&&fast_bet;if(!stake){var el='';if(fb){el=document.getElementById(_lb_evt_fb_stake_id_prefix+ev_oc_id)}else el=document.getElementById(_lb_evt_stake_id_prefix+ev_oc_id);if(el){stake=el.value;if(fb){el.value="";if(isNaN(stake)||isNaN(parseFloat(stake)))if(get_pref('BETSLIP_STYLE')=="Detached"){try{popped_out_betslip.BS_display_error(betslipbody.msg.BS_FASTBET_STAKE_INVALID_TITLE,betslipbody.msg.BS_FASTBET_STAKE_INVALID_TXT);popped_out_betslip.focus()}catch(e){BS_pop_out("DisplayError=FASTBET_STAKE_INVALID")};return}else{BS_display_error(betslipbody.msg.BS_FASTBET_STAKE_INVALID_TITLE,betslipbody.msg.BS_FASTBET_STAKE_INVALID_TXT,'BS_close_betslip()');BS_open_betslip();return}}}};var selcn=_lb_evt_selcn_hash[ev_oc_id],evmkt=_lb_evt_evmkt_hash[selcn.ev_mkt_id];BS_set_leg("selections",ev_oc_id);BS_set_leg("price_type","L");BS_set_leg("stake",stake);BS_set_leg("lp_num",selcn.lp_num);BS_set_leg("lp_den",selcn.lp_den);BS_set_leg("hcap_value",evmkt.raw_hcap);BS_set_leg("bir_index",evmkt.bir_index);BS_set_leg("market_tags","");BS_set_leg('bet_origin','LB_EVENT');BS_go_bet(fb);return}
function _lb_evt_mkts_count_refresh(){var num_mkts_avail=0;for(ev_mkt_id in _lb_evt_evmkt_hash){var mkt=_lb_evt_evmkt_hash[ev_mkt_id];if(mkt.displayed=="Y")num_mkts_avail++};var el=document.getElementById(_lb_evt_num_avail_mkts_id);if(el)el.innerHTML=num_mkts_avail;return}
function lb_evt_mk_ew_terms(ew_places,ew_fac_num,ew_fac_den){if(ew_places==""||ew_places==1)return"";return tmpl_ml_printf("BET_EW_TERMS_EW",ew_fac_num+"/"+ew_fac_den,ew_places)}
function _lb_evt_diff_objs_brief(a,b){for(var f in a)if(b[f]==undefined)return true;for(var f in b)if(a[f]==undefined)return true;for(var f in a){if(b[f]==undefined)continue;var va=a[f],vb=b[f];if(typeof va!=typeof vb){return true}else if(typeof va=="object"){if(_lb_evt_diff_objs_brief(va,vb))return true}else if(va!=vb)return true};return false}
function _lb_evt_got_PREBIR_EVENT(data){if(_lb_evt_cfg.bir_sort=='HR'){var BIDS_status='';if(data.bids_status)BIDS_status=data.bids_status;_lb_evt_event.pre_bir_bids_status=BIDS_status;_lb_hr_evt_event.BIDS_status=bids_status_xl(BIDS_status)}}
function lb_evt_get_BIDS_status(){return _lb_hr_evt_event.BIDS_status}
function lb_evt_upd_market_orders(){_lb_evt_market_ordering={};var market_container=document.getElementById(_lb_evt_mkts_id),m_disporder=0;for(var c=0;c<market_container.childNodes.length;c++){var market_name=market_container.childNodes[c].id,market_matches=market_name.match("bir-mkt*");if(market_matches){m_disporder++;var market_id=market_name.substring("bir-mkt ".length,market_name.length);_lb_evt_market_ordering[market_id]=m_disporder}};for(var market_id in _lb_evt_market_ordering){var market_elem_name=_lb_evt_mkt_id_prefix+market_id,market_sort_info={disporder:_lb_evt_market_ordering[market_id],ev_mkt_id:market_id};scone_set_item_info(market_elem_name,market_sort_info,true)}}
function get_clock_string(){var clock={clock:_lb_evt_event.clock,period_xl:_lb_evt_event.period_xl};if(clockList[_lb_evt_event.ev_id].active){return clock}else return null}
function get_event_info(){var event_info={start_time_xls:_lb_evt_event.start_time_xls,name:evt_type_name,class_name:evt_class_name,score_home:_lb_evt_event.score_home,score_away:_lb_evt_event.score_away,score_extra_info:_lb_evt_event.score_extra_info,venue:_lb_evt_event.venue};return event_info}
function create_selections(ev_mkt_id){var mkt_info=_lb_evt_evmkt_hash[ev_mkt_id];if(mkt_info.start_collapse==0){return}else mkt_info.start_collapse=0;if(!mkt_info)return;for(var s=0;s<mkt_info.mkt_selns.length;s++)_lb_evt_got_SELCN(_lb_evt_selcn_hash[mkt_info.mkt_selns[s]])}
function collapse_all_markets(){for(var m=0;m<_lb_evt_event.markets.length;m++)create_selections(_lb_evt_event.markets[m])}
function lb_evt_templates_get_templates(){var templates={},tmpl=[];tmpl.push('	<div class="opts">');tmpl.push('		<div class="left">');tmpl.push('			<p class="avail_mkts"><strong><span id="enum_avail_mkts"></span>&nbsp;<%XL MKTS_AVAIL%></strong></p>');tmpl.push('			<div id="toogle_live_events_wrap" class="left">');tmpl.push('			<a href="javascript:void(0)" title="<%XL BIR_COLLAPSE_ALL%>" class="expand"><%XL COLLAPSE_ALL_ITEMS%></a> | <%XL EXPAND_ALL_ITEMS%>');tmpl.push('			</div>');tmpl.push('			<div id="icon-new-mkt-red"></div>');tmpl.push('			<div id="new_market_img_div" class="mkt-new-<%_lb_evt_cfg.lang%>" style="display:none"></div>');tmpl.push('		</div>');tmpl.push('		<div class="right">');tmpl.push('		<p id="FastBetInput" <%IF fast_bet_status == "HIDDEN"%>style="display:none"<%ELSE%>style="display:none"<%END%> >');tmpl.push('			<strong><%XL FAST_BET%>:</strong> <a title="<%XL FAST_BET_HELP%>" href="javascript:void(0)"><img src="<%_lb_evt_cfg.img_url%>/sb/betlive/home/qmark.png" alt="<%XL FAST_BET_HELP%>" style="position: relative; top: 3px" /></a><br />');tmpl.push('			<input type="radio" class="radio" name="FastBet" value="Y" onchange="update_bir_prefs(this)" <%IF fast_bet_status == "DISABLED"%>disabled<%END%> /> <%XL BIR_PREF_YES%> &nbsp; <input type="radio" class="radio" name="FastBet" value="N" onchange="update_bir_prefs(this)" <%IF fast_bet_status == "DISABLED"%>disabled<%END%> /> <%XL BIR_PREF_NO%>');tmpl.push('		</p>');tmpl.push('		</div>');tmpl.push('		<div class="clear"></div>');tmpl.push('	</div>');tmpl.push('	<div class="viewing-mkt disclaimer">');tmpl.push('		<div class="blurb-ev"><%blurb_ev%></div>');tmpl.push('		<div class="blurb-type"><%blurb_type%></div>');tmpl.push('		<div class="blurb-class"><%blurb_class%></div>');tmpl.push('	</div>');tmpl.push('	<div id="ifCnt">');tmpl.push('		<div id="markets" class="groupWrapperIf" <%IF displayed == "N"%>style="display:none"<%END%>>');tmpl.push('		</div>');tmpl.push('	</div>');tmpl.push('	<div class="tandcs"><%XL BETLIVE_EVENT_DISCLAIMER%></div>');tmpl.push('	<div class="bir-mkt-floor"></div>');templates.lb_evt_event=tmpl.join('\n');tmpl=[];tmpl.push('	<div class="ifItem" id="bir-mkt <%ev_mkt_id%>" <%IF displayed == "N"%>style="display:none"<%END%>>');tmpl.push('		<div id="market <%ev_mkt_id%>">');tmpl.push('			<div class="itemHeader <%IF bettable%>toogexHd<%END%> mktHeader">');tmpl.push('				<%IF bettable%>');tmpl.push('				<a href="javascript:void(0)" onclick="javascript:create_selections(<%ev_mkt_id%>);" class="closeEl <%IF start_collapse == 1%> off <%END%>"><%XL CLOSE%></a>');tmpl.push('				<%ELSE%>');tmpl.push('				<a href="javascript:void(0)" class="disCloseEl"><%XL CLOSE%></a>');tmpl.push('				<%END%>');tmpl.push('				<div class="favourite"><a href="javascript:void(0)" class="addFav" title="<%XL FAVOURITES%>" onclick="lb_fav_add_new(<%ev_mkt_id%>, \'M\')"><%XL FAVOURITE%></a></div>');tmpl.push('				<div class="left" style="font-size: 12px; text-indent: 10px; padding-right: 10px">');tmpl.push('					<%name%>');tmpl.push('				</div>');tmpl.push('				<%IF is_new%>');tmpl.push('					<span class="new left" id="new_market_img_<%ev_mkt_id%>"><%XL BIR_LIVE_BETTING_NEW%></span>');tmpl.push('				<%END%>');tmpl.push('			<%IF bettable%>');tmpl.push('				<div class="right b" style="<%IF fast_bet_status == "ON" || fast_bet_status == "DISABLED" %>display:none;<%END%>width:94px; font-size: 11px; text-indent: 11px">');tmpl.push('					<%XL BET_NOW%>');tmpl.push('				</div>');tmpl.push('				<div class="right fb" style="<%IF fast_bet_status == "HIDDEN" || fast_bet_status == "OFF" %>display:none;<%END%>width:123px; font-size: 11px; text-indent: 11px">');tmpl.push('					<%XL BET_NOW%>');tmpl.push('				</div>');tmpl.push('				<div class="right fbd" style="<%IF fast_bet_status == "HIDDEN" || fast_bet_status == "OFF" || fast_bet_status == "ON" %>display:none;<%END%>width:123px; font-size: 11px; text-indent: 11px">');tmpl.push('					<%XL BET_NOW%>');tmpl.push('				</div>');tmpl.push('				<div class="right b" style="<%IF fast_bet_status == "ON" || fast_bet_status == "DISABLED" %>display:none;<%END%>width:78px; font-size: 11px; text-align: center">');tmpl.push('					<%XL QUICK_BET%>');tmpl.push('				</div>');tmpl.push('				<div class="right" style="width:53px; font-size: 11px; text-align: center">');tmpl.push('					<%XL ODDS%>');tmpl.push('				</div>');tmpl.push('				<div class="clear"></div>');tmpl.push('			<%ELSE%>');tmpl.push('				<div class="right suspended"><%XL SUSPENDED%></div>');tmpl.push('				<div class="clear"></div>');tmpl.push('			<%END%>');tmpl.push('			</div>');tmpl.push('			<div class="itemContent <%IF bettable%>toogex<%END%> mktContent" <%IF !bettable || start_collapse == 1%>style="display:none"<%END%>>');tmpl.push('				<%IF (has_oc_cashout == "Y") && (cashout_avail == "Y") && (parent_cashout_avail == "Y") %>');tmpl.push('					<div>');tmpl.push('						<p>');tmpl.push('							<a class="fb-cash-in-available" onclick="toggle_cashout_overlay()" href="javascript:void(0)"><%XL CASHOUT_AVAIL%></a>');tmpl.push('						</p>');tmpl.push('					</div>');tmpl.push('				<%END%>');tmpl.push('				<%IF (blurb != "") || (score != "")%>');tmpl.push('					<div>');tmpl.push('						<p>');tmpl.push('							<%IF blurb != ""%><%blurb%><%END%>');tmpl.push('							<%IF (blurb != "") && (score != "")%><br/><%END%>');tmpl.push('							<%IF score != ""%><%score%><%END%>');tmpl.push('						</p>');tmpl.push('					</div>');tmpl.push('				<%END%>');tmpl.push('				<table summary="">');tmpl.push('					<tbody id="mkt_selcns_<%ev_mkt_id%>">');tmpl.push('					</tbody>');tmpl.push('				</table>');tmpl.push('				<%IF (ew_places != "") && (ew_places != 1)%>');tmpl.push('				<div class="viewing-mkt"><%lb_evt_mk_ew_terms(ew_places, ew_fac_num, ew_fac_den)%></div>');tmpl.push('				<%END%>');tmpl.push('				<%IF (has_oc_cashout == "Y") && (cashout_avail == "Y") && (parent_cashout_avail == "Y") %>');tmpl.push('					<div id="cashout-<%ev_mkt_id%>" class="lb-cash-in-wrapper cashout" style="display: none;"></div>');tmpl.push('				<%END%>');tmpl.push('			</div>');tmpl.push('		</div>');tmpl.push('	</div>');templates.lb_evt_evmkt=tmpl.join('\n');tmpl=[];tmpl.push('	<tr id="selcn_<%ev_oc_id%>">');tmpl.push('		<%IF bettable%>');tmpl.push('		<td>');tmpl.push('			<div class="title"><%name%><%IF hcap_value%> <%hcap_value%><%END%></div>');tmpl.push('			<div class="quickBet b" <%IF fast_bet_status == "ON" || fast_bet_status == "DISABLED" %>style="display:none"<%END%>>');tmpl.push('				<table summary="">');tmpl.push('					<tr>');tmpl.push('					<%LOOP qb_idx _lb_evt_cfg.quickbet_amounts.length%>');tmpl.push('						<td><a href="javascript:void(0)" onclick="lb_evt_add_bet(<%ev_oc_id%>,<%_lb_evt_cfg.quickbet_amounts[qb_idx]%>)" title="Add <%_lb_evt_cfg.quickbet_amounts[qb_idx]%> stake to your betslip"><%_lb_evt_cfg.quickbet_amounts[qb_idx]%></a></td>');tmpl.push('					<%END%>');tmpl.push('					</tr>');tmpl.push('				</table>');tmpl.push('			</div>');tmpl.push('			<div class="odd" id="lb_evt_price_con_<%ev_oc_id%>">');tmpl.push('				<a href="javascript:void(0)" id="lb_evt_price_str_<%ev_oc_id%>" name="livebet_odds" onclick="lb_evt_add_bet(<%ev_oc_id%>)" title="Add selection to betslip">');tmpl.push('					<%price_str%>');tmpl.push('				</a>');tmpl.push('			</div>');tmpl.push('		</td>');tmpl.push('		<td class="Bet b" <%IF fast_bet_status == "ON" || fast_bet_status == "DISABLED" %>style="display:none"<%END%>>');tmpl.push('			<div>');tmpl.push('				<input id="lb_evt_stake_<%ev_oc_id%>" class="amount" type="text" onkeypress="if (event.keyCode==13) {lb_evt_add_bet(<%ev_oc_id%>)}" onchange="BS_stake_changed(this.id, false)" value="">');tmpl.push('				<a href="javascript:void(0)" onclick="lb_evt_add_bet(<%ev_oc_id%>)" title="Add selection to betslip"><%XL BET%></a>');tmpl.push('			</div>');tmpl.push('		</td>');tmpl.push('		<td class="fBet fb" <%IF fast_bet_status != "ON"%>style="display:none"<%END%>>');tmpl.push('			<div>');tmpl.push('				<input id="lb_evt_fb_stake_<%ev_oc_id%>" class="amount" type="text" onkeypress="if (event.keyCode==13) {lb_evt_add_bet(<%ev_oc_id%>,\'\',true)}" onchange="BS_stake_changed(this.id, false)" value="">');tmpl.push('				<a href="javascript:void(0)" onclick="lb_evt_add_bet(<%ev_oc_id%>,\'\',true)" title="<%XL FAST_BET%>"><%XL FAST_BET%></a>');tmpl.push('			</div>');tmpl.push('		</td>');tmpl.push('		<td class="fBetDisable fbd" <%IF fast_bet_status != "DISABLED"%>style="display:none"<%END%>>');tmpl.push('			<div>');tmpl.push('				<input class="amount" type="text" value="">');tmpl.push('				<a href="javascript:void(0)" title="<%XL FAST_BET%>"><%XL FAST_BET%></a>');tmpl.push('			</div>');tmpl.push('		</td>');tmpl.push('		<%ELSE%>');tmpl.push('		<td colspan="2">');tmpl.push('			<div class="title"><%name%></div>');tmpl.push('			<div class="right suspended b" style="margin-right: 123px"><%XL SUSPENDED%></div>');tmpl.push('			<div class="right suspended fb" style="margin-right: 73px"><%XL SUSPENDED%></div>');tmpl.push('		</td>');tmpl.push('		<%END%>');tmpl.push('	</tr>');templates.lb_evt_selcn=tmpl.join('\n');return templates}
function lb_evt_templates_hr_get_templates(){var templates={},tmpl=[];tmpl.push('	<div class="opts">\n');tmpl.push('		<p class="left">\n');tmpl.push('			<strong><span id="enum_avail_mkts"></span>&nbsp;<%XL MKTS_AVAIL%></strong>\n');tmpl.push('		</p>\n');tmpl.push('		<div id="icon-new-mkt-red"></div>\n');tmpl.push('		<div id="new_market_img_div" class="mkt-new-<%_lb_evt_cfg.lang%>" style="display:none"></div>\n');tmpl.push('		<p id="FastBetInput" class="right" <%IF fast_bet_status == "HIDDEN"%>style="display:none"<%END%> >\n');tmpl.push('			<strong><%XL FAST_BET%>:</strong> <a title="<%XL FAST_BET_HELP%>" href="javascript:void(0)"><img src="<%_lb_evt_cfg.img_url%>/sb/betlive/home/qmark.png" alt="" style="position: relative; top: 3px" /></a><br />\n');tmpl.push('			<input type="radio" class="radio" name="FastBet" value="Y" onchange="update_bir_prefs(this)" <%IF fast_bet_status == "DISABLED"%>disabled<%END%> /> <%XL BIR_PREF_YES%> &nbsp; <input type="radio" class="radio" name="FastBet" value="N" onchange="update_bir_prefs(this)" <%IF fast_bet_status == "DISABLED"%>disabled<%END%> /> <%XL BIR_PREF_NO%>\n');tmpl.push('		</p>\n');tmpl.push('		<div class="clear"></div>\n');tmpl.push('	</div>\n');tmpl.push('	<div class="viewing-mkt disclaimer">\n');tmpl.push('		<div class="blurb-ev"><%blurb_ev%></div>\n');tmpl.push('		<div class="blurb-type"><%blurb_type%></div>\n');tmpl.push('		<div class="blurb-class"><%blurb_class%></div>\n');tmpl.push('	</div>\n');tmpl.push('	<div id="ifCnt">\n');tmpl.push('		<div id="markets" class="groupWrapperIf" <%IF displayed == "N"%>style="display:none"<%END%>>\n');tmpl.push('		</div>\n');tmpl.push('	</div>\n');tmpl.push('	<div class="tandcs"><%XL BETLIVE_EVENT_DISCLAIMER%></div>\n');templates.lb_evt_event=tmpl.join("");var tmpl=[];tmpl.push('<div id="bir-mkt <%ev_mkt_id%>" <%IF displayed == "N"%>style="display:none"<%END%>>\n');tmpl.push('	<div id="market <%ev_mkt_id%>" <%IF bettable%><%ELSE%>class="suspendedMarket"<%END%>>\n');tmpl.push('		<div class="ifItem">\n');tmpl.push('			<div <%IF bettable%>class="itemHeader"<%ELSE%>class="itemHeader suspendedMarketHdr"<%END%>>\n');tmpl.push('				<%IF bettable%>');tmpl.push('					<a href="javascript:void(0)" class="closeEl"><%XL CLOSE%></a>\n');tmpl.push('				<%ELSE%>');tmpl.push('					<a href="javascript:void(0)" class="disCloseEl"><%XL CLOSE%></a>\n');tmpl.push('				<%END%>');tmpl.push('				<div class="favourite"><a href="javascript:void(0)" class="addFav" title="<%XL FAVOURITES%>" onclick="lb_fav_add_new(<%ev_mkt_id%>, \'M\')"><%XL FAVOURITE%></a></div>\n');tmpl.push('				<div class="left" style="width:200px; font-size: 12px; text-indent: 10px">\n');tmpl.push('					<%name%>\n');tmpl.push('				</div>\n');tmpl.push('				<div class="clear"></div>\n');tmpl.push('			</div>\n');tmpl.push('			<div <%IF bettable%>class="itemContent"<%ELSE%>class="itemContent suspendedMarket"<%END%>>\n');tmpl.push('				<table summary="">\n');tmpl.push('					<thead>\n');tmpl.push('						<tr>\n');tmpl.push('							<td colspan="2" class="hdH">\n');tmpl.push('								<div class="left" style="width:53px; font-size: 11px; text-align: center">\n');tmpl.push('									<strong><%XL LB_HR_OC_NUMBER%></strong>\n');tmpl.push('								</div>\n');tmpl.push('								<div class="left" style="width:46px; font-size: 11px; text-align: center">\n');tmpl.push('									<strong><%XL LB_HR_OC_SILK%></strong>\n');tmpl.push('								</div>\n');tmpl.push('								<div class="left" style="width:53px; font-size: 11px; text-align: left">\n');tmpl.push('									<strong><%XL LB_HR_OC_HORSE_JOCKEY%></strong>\n');tmpl.push('								</div>\n');tmpl.push('								<div class="right b" style="<%IF fast_bet_status == "ON" || fast_bet_status == "DISABLED" %>display:none;<%END%>width:94px; font-size: 11px; text-indent: 11px">\n');tmpl.push('									<%XL LB_HR_OC_BET_NOW%>\n');tmpl.push('								</div>\n');tmpl.push('								<div class="right fb" style="<%IF fast_bet_status == "HIDDEN" || fast_bet_status == "OFF" %>display:none;<%END%>width:123px; font-size: 11px; text-indent: 11px">\n');tmpl.push('									<%XL LB_HR_OC_BET_NOW%>\n');tmpl.push('								</div>\n');tmpl.push('								<div class="right fbd" style="<%IF fast_bet_status == "HIDDEN" || fast_bet_status == "OFF" || fast_bet_status == "ON" %>display:none;<%END%>width:123px; font-size: 11px; text-indent: 11px">\n');tmpl.push('									<%XL LB_HR_OC_BET_NOW%>\n');tmpl.push('								</div>\n');tmpl.push('								<div class="right b" style="<%IF fast_bet_status == "ON" || fast_bet_status == "DISABLED" %>display:none;<%END%>width:80px; font-size: 11px; text-align: center">\n');tmpl.push('									<%XL LB_HR_OC_QBET%>\n');tmpl.push('								</div>\n');tmpl.push('								<div class="right" style="width:53px; font-size: 11px; text-align: center">\n');tmpl.push('									<%XL LB_HR_OC_ODDS%>\n');tmpl.push('								</div>\n');tmpl.push('							</td>\n');tmpl.push('						</tr>\n');tmpl.push('					</thead>\n');tmpl.push('					<tbody id="mkt_selcns_<%ev_mkt_id%>">\n');tmpl.push('					</tbody>\n');tmpl.push('				</table>\n');tmpl.push('			</div>\n');tmpl.push('		</div>\n');tmpl.push('	</div>\n');templates.lb_evt_evmkt=tmpl.join("");var tmpl=[];tmpl.push('	<tr id="selcn_<%ev_oc_id%>" <%IF fb_result != "-"%> style="display:none" <%END%>>\n');tmpl.push('		<%IF bettable%>\n');tmpl.push('		<td>\n');tmpl.push('			<div class="number"><%IF desc != "|The Field|"%><%selcn_num%><%END%><%IF stall != ""%> (<%stall%>)<%END%></div>\n');tmpl.push('			<div class="silk"><img src="<%_lb_evt_cfg.silk_url%>/silks/<%jockey_silks_filename%>" alt="Silk" /></div>\n');tmpl.push('			<div class="jockHorse"  <%IF bettable%><%ELSE%>class="level-suspended"<%END%>>');tmpl.push('				<strong><%name%></strong><%IF jockey_name == ""%><%ELSE%>/ <%jockey_name%><%END%>');tmpl.push('			</div>\n');tmpl.push('			<div class="quickBet b" <%IF fast_bet_status == "ON" || fast_bet_status == "DISABLED" %>style="display:none"<%END%>>\n');tmpl.push('				<table summary="">\n');tmpl.push('					<tr>\n');tmpl.push('					<%LOOP qb_idx _lb_evt_cfg.quickbet_amounts.length%>');tmpl.push('						<td><a href="javascript:void(0)" onclick="lb_evt_add_bet(<%ev_oc_id%>,<%_lb_evt_cfg.quickbet_amounts[qb_idx]%>)" title="Add <%_lb_evt_cfg.quickbet_amounts[qb_idx]%> stake to your betslip"><%_lb_evt_cfg.quickbet_amounts[qb_idx]%></a></td>\n');tmpl.push('					<%END%>');tmpl.push('					</tr>\n');tmpl.push('				</table>\n');tmpl.push('			</div>\n');tmpl.push('			<div class="odd" id="lb_evt_price_con_<%ev_oc_id%>">\n');tmpl.push('				<a href="javascript:void(0)" id="lb_evt_price_str_<%ev_oc_id%>" name="livebet_odds" onclick="lb_evt_add_bet(<%ev_oc_id%>)" title="Add selection to betslip">\n');tmpl.push('					<%price_str%>\n');tmpl.push('				</a>\n');tmpl.push('			</div>\n');tmpl.push('		</td>\n');tmpl.push('			<td class="Bet b"  <%IF fast_bet_status == "ON" || fast_bet_status == "DISABLED" %>style="display:none"<%END%>>\n');tmpl.push('				<div>\n');tmpl.push('					<input id="lb_evt_stake_<%ev_oc_id%>" class="amount" type="text" onkeypress="if (event.keyCode==13) {lb_evt_add_bet(<%ev_oc_id%>)}" onchange="BS_stake_changed(this.id, false)" value="">');tmpl.push('					<a href="javascript:void(0)" onclick="lb_evt_add_bet(<%ev_oc_id%>)" title="Add selection to betslip"><%XL BET%></a>\n');tmpl.push('				</div>\n');tmpl.push('			</td>\n');tmpl.push('			<td class="fBet fb" <%IF fast_bet_status != "ON" %>style="display:none"<%END%>>\n');tmpl.push('				<div>\n');tmpl.push('					<input id="lb_evt_fb_stake_<%ev_oc_id%>" class="amount" type="text" onkeypress="if (event.keyCode==13) {lb_evt_add_bet(<%ev_oc_id%>,\'\',true)}" onchange="BS_stake_changed(this.id, false)" value="">');tmpl.push('					<a href="javascript:void(0)" onclick="lb_evt_add_bet(<%ev_oc_id%>,\'\',true)" title="<%XL FAST_BET%>"><%XL FAST_BET%></a>\n');tmpl.push('				</div>\n');tmpl.push('			</td>\n');tmpl.push('			<td class="fBetDisable fbd" <%IF fast_bet_status != "DISABLED" %>style="display:none"<%END%>>\n');tmpl.push('				<div>\n');tmpl.push('					<input class="amount" type="text" value="">\n');tmpl.push('					<a href="javascript:void(0)" title="<%XL FAST_BET%>"><%XL FAST_BET%></a>\n');tmpl.push('				</div>\n');tmpl.push('			</td>\n');tmpl.push('		<%ELSE%>\n');tmpl.push('		<td colspan="2">\n');tmpl.push('			<div class="number"><%IF desc != "|The Field|"%><%selcn_num%><%END%><%IF stall != ""%> (<%stall%>)<%END%></div>\n');tmpl.push('			<div class="silk"><img src="<%_lb_evt_cfg.silk_url%>/silks/<%jockey_silks_filename%>" alt="Silk" /></div>\n');tmpl.push('			<div class="jockHorse"  <%IF bettable%><%ELSE%>class="level-suspended"<%END%>>');tmpl.push('				<strong><%name%></strong><%IF jockey_name == ""%><%ELSE%>/ <%jockey_name%><%END%>');tmpl.push('			</div>\n');tmpl.push('			<div class="right suspended" style="margin-right: 15px"><%XL SUSPENDED%></div>\n');tmpl.push('		</td>\n');tmpl.push('		<%END%>\n');tmpl.push('	</tr>\n');templates.lb_evt_selcn=tmpl.join("");return templates}
function lb_fav_init(call_type,events,markets,selcns,server_time_year,server_time_month,server_time_day,server_time_hour,server_time_min,server_time_sec,init_msg_id,cfg){_lb_fav_last_msg_id=init_msg_id;for(var f in cfg)_lb_fav_cfg[f]=cfg[f];var channels=[];if(call_type=="cookie"){_lb_fav_store_templates();_lb_fav_event_hash={};_lb_fav_evmkt_hash={};_lb_fav_selcn_hash={};_lb_fav_mkt_count={};_lb_fav_init_collapsed_hash(markets);var first_build=true;scone_create(_lb_fav_events_id,{},null,null);initPeriodClocks(server_time_year,server_time_month,server_time_day,server_time_hour,server_time_min,server_time_sec,_lb_fav_cfg.lang)}else var first_build=false;for(var i=0;i<events.length;i++){if(!_lb_fav_event_hash[events[i].ev_id])_lb_fav_got_EVENT(events[i],false);if(!_lb_fav_channels["EVENT"+events[i].ev_id]){channels.push("sEVENT"+ps_connect_lpad_id(events[i].ev_id));_lb_fav_channels["EVENT"+events[i].ev_id]=true;if(events[i].is_financial=="Y")channels.push("SEVENT"+ps_connect_lpad_id(events[i].ev_id))}};for(var i=0;i<markets.length;i++){if(!_lb_fav_evmkt_hash[markets[i].ev_mkt_id])_lb_fav_got_EVMKT(markets[i],false);if(markets[i].is_financial=="N")if(!_lb_fav_channels["MARKET"+markets[i].ev_mkt_id]){channels.push("sEVMKT"+ps_connect_lpad_id(markets[i].ev_mkt_id));channels.push("SEVMKT"+ps_connect_lpad_id(markets[i].ev_mkt_id));_lb_fav_channels["MARKET"+markets[i].ev_mkt_id]=true}};for(var i=0;i<selcns.length;i++)if(!_lb_fav_selcn_hash[selcns[i].ev_oc_id])_lb_fav_got_SELCN(selcns[i],false);if(channels.length>0){ps_connect_register("lb_fav"+fav_idx,_lb_fav_got_msg,channels,init_msg_id);fav_idx++};_lb_fav_upd_count_displays(1);var fav_events_elem=document.getElementById(_lb_fav_events_id);fav_events_elem.style.display="";if(call_type=="cookie")_lb_fav_init_display(events,markets);if(_lb_fav_tot_markets>0)$j(_lb_fav_show).click();return};var fav_idx=0,_lb_fav_events_id="lb_fav_events",_lb_fav_event_id_prefix="lb_fav_event_",_lb_fav_markets_id_prefix="lb_fav_markets_",_lb_fav_market_id_prefix="lb_fav_market_",_lb_fav_selcns_id_prefix="lb_fav_selcns_",_lb_fav_selcn_id_prefix="lb_fav_selcn_",_lb_fav_selcn_highlight_id_prefix="lb_fav_selcn_odd_hl_",_lb_fav_selcn_odd_id_prefix="lb_fav_selcn_odd_",_lb_fav_level_con_id_prefix="lb_fav_hcap_level_con_",_lb_fav_level_class_name="level",_lb_fav_price_class_name="odd",_lb_fav_event_clock_id_prefix="lb_fav_clock_",_lb_fav_market_num="lb_fav_title",_lb_fav_show="#lb_fav_show",_lb_fav_highlight_timers={},_lb_fav_channels={},_lb_fav_mkt_count={},_lb_fav_tot_markets=0,_lb_fav_events_collapsed={},_lb_fav_markets_collapsed={}
function lb_fav_object(){return};lb_fav_object.prototype.getConfig=function(){return _lb_fav_cfg};lb_fav_object.prototype.getHash=function(identifier){var ret="";switch(identifier){case"HL_TIMERS":if(_lb_fav_highlight_timers)ret=_lb_fav_highlight_timers;break;default:ret=""};return ret};lb_fav_object.prototype.getHashId=function(identifier,id){var ret="";switch(identifier){case"HL_TIMERS":if(_lb_fav_highlight_timers&&_lb_fav_highlight_timers[id])ret=_lb_fav_highlight_timers[id];break;default:ret=""};return ret};lb_fav_object.prototype.getMiscInfo=function(identifier){var ret="";switch(identifier){case"PRICE_CLASS_NAME":if(_lb_fav_price_class_name)ret=_lb_fav_price_class_name;break;default:ret=""};return ret};lb_fav_object.prototype.getIdPrefix=function(identifier){var ret="";switch(identifier){case"SELCN_HL":if(_lb_fav_selcn_highlight_id_prefix)ret=_lb_fav_selcn_highlight_id_prefix;break;default:ret=""};return ret};lb_fav_object.prototype.gotPushData=function(identifier,data){switch(identifier){case"PRICE":_lb_fav_got_PRICE(data);break;case"SELCN":_lb_fav_got_SELCN(data,true);break;case"MHCAP":_lb_fav_got_MHCAP(data);break;case"EVMKT":_lb_fav_got_EVMKT(data,true);break;case"EVENT":_lb_fav_got_EVENT(data,true);break;default:};return};var lb_fav_obj=new lb_fav_object(),lb_fav_cmp_objects=new function(){}();lb_fav_cmp_objects=new push_hash_cmp_objects()
function _lb_fav_store_templates(){tmpl_store("lb_fav_event",'<div id="lb_fav_event_<%ev_id%>">\n	<div class="itemHeader">\n		<a id="lb_fav_event_class_t_<%ev_id%>" href="javascript:void(0)" class="closeEl <%IF collapsed %>off<%ELSE%>on<%END%>" onclick="lb_fav_toggle_collapse(<%ev_id%>,\'E\')" title="<%XL BIR_LIVE_BETTING_TOGGLE_EXPAND%>">\n			<span class="left lnkUrl" title="<%full_name%>"><span style="display:none"><%IF is_fin%><%_lb_fav_cfg.fin_event_url%><%ELSE%><%_lb_fav_cfg.event_url%><%END%><%ev_id%></span><%name%><%IF !is_fin%>&nbsp;(<%mar_num%>)&nbsp;<%IF score_home != "" && score_away != ""%> <%score_home%> - <%score_away%>&nbsp;<%END%><%IF period_id!="" && show_bir_clocks == "Y"%><span class="time" id="lb_fav_clock_<%ev_id%>"></span><%END%><%END%></span>\n			<%IF is_fin%><span title="<%XL BIR_LIVE_BETTING_REM_FROM_FAVE%>" href="javascript:void(0)" class="right favRed" onclick="lb_fav_remove_EVENT(<%ev_id%>)"><%XL BIR_LIVE_BETTING_FAVE%></span><%END%>\n		</a>\n	</div>\n	<div id="lb_fav_event_hide_<%ev_id%>" class="itemContent">\n		<div class="subItem">\n			<div class="itemContent">\n				<div id="lb_fav_markets_<%ev_id%>"<%IF collapsed %>style="display:none"<%END%>></div>\n			</div>\n		</div>\n	</div>\n</div>\n');tmpl_store("lb_fav_market",'<div id="lb_fav_market_<%ev_mkt_id%>">\n	<div class="subItem">\n	<%IF !is_fin%>\n		<div class="itemHeader on">\n			<a id="lb_fav_market_class_t_<%ev_mkt_id%>" href="javascript:void(0)" class="closeEl <%IF collapsed %>off<%ELSE%>on<%END%>" onclick="lb_fav_toggle_collapse(<%ev_mkt_id%>,\'M\')" title="<%XL BIR_LIVE_BETTING_TOGGLE_EXPAND%>">\n				<span class="left" title="<%name%>"><%name%></span>\n				<span title="<%XL BIR_LIVE_BETTING_REM_FROM_FAVE%>" class="right favRed" onclick="lb_fav_remove_EVMKT(<%ev_mkt_id%>)"><%XL BIR_LIVE_BETTING_FAVE%></span>\n			</a>\n		</div>\n	<%END%>\n		<div id="lb_fav_market_hide_<%ev_mkt_id%>" class="itemContent">\n			<%IF is_fin%>\n				<div id="lb_fav_selcns_<%ev_mkt_id%>">\n				<div>\n			<%ELSE%>\n				<div id="lb_fav_selcns_<%ev_mkt_id%>">\n				</div>\n			<%END%>\n		</div>\n	</div>\n</div>\n');tmpl_store("lb_fav_selcn",'<div class="itemElt" id="lb_fav_selcn_<%ev_oc_id%>">\n	<div class="name left"><%name%></div>\n	<div class="oddWp right">\n		<div id="lb_fav_selcn_odd_hl_<%ev_oc_id%>" <%IF bettable%>class="odd" <%ELSE%>class="oddsuspended"<%END%> >\n			<a <%IF bettable%>href="javascript:void(0)" onclick="lb_fav_add_bet(<%ev_oc_id%>)"<%END%> id="lb_fav_selcn_odd_<%ev_oc_id%>">\n				<%price_str%>\n			</a>\n		</div>\n	</div>\n	<%IF has_hcap%>\n	<div id="lb_fav_hcap_level_con_<%ev_oc_id%>" class="level right">\n		<%hcap_value%>\n	</div>\n	<%END%>\n	<div class="clear"></div>\n</div>\n');tmpl_store("lb_fav_selcn_fin",'<div class="itemElt" id="lb_fav_selcn_<%ev_oc_id%>">\n	<div class="name left"><%name%></div>\n	<div class="oddWp right">\n		<div id="lb_fav_selcn_odd_hl_<%ev_oc_id%>" <%IF bettable%>class="odd" <%ELSE%>class="oddsuspended"<%END%> >\n			<a <%IF bettable%>href="javascript:void(0)" onclick="lb_fav_add_bet(<%ev_oc_id%>)"<%END%> id="lb_fav_selcn_odd_<%ev_oc_id%>">\n				<%price_str%>\n			</a>\n		</div>\n	</div>\n	<%IF has_hcap%>\n	<div id="lb_fav_hcap_level_con_<%ev_oc_id%>" class="level right">\n		<%hcap_value%>\n	</div>\n	<%END%>\n	<div class="clear"></div>\n</div>\n')};var _lb_fav_cfg={lang:"en",price_str_type:"ODDS",price_str_type_ah:"DECIMAL",price_str_type_hl:"DECIMAL",price_str_sep:"-",highlight_duration:4e3,name_truncate_threshold:25,market_truncate_threshold:30,max_markets:10,hl_class_decrease:"_d",hl_class_increase:"_i",hl_class_same:""}
function _lb_fav_got_msg(msg){bir_got_msg(lb_fav_obj,msg);if(msg.subject_level=="sEVENT"||msg.subject_level=="sEVMKT")_lb_fav_upd_count_displays(1);return}
function _lb_fav_got_EVENT(data,push_msg){var info=_lb_fav_event_hash[data.ev_id],is_new_item=!info,orig_bettable;if(is_new_item){if(push_msg)return;info=data;_lb_fav_event_hash[data.ev_id]=info;info.child_hash={};addClockEvent(data.ev_id,data.periods,_lb_fav_event_clock_id_prefix)}else{orig_bettable=info.bettable;for(var f in data)info[f]=data[f]};info.name=info.names[_lb_fav_cfg.lang];info.full_name=info.name;info.name=trunc_string(info.name,_lb_fav_cfg.name_truncate_threshold,'...');info.start_time_xl=info.start_time_xls[_lb_fav_cfg.lang];info.bettable=(info.status=="A");info.is_fin=(info.is_financial=="Y");_lb_fav_cal_ev_counts();info.mar_num=_lb_fav_mkt_count[info.ev_id];if(_lb_fav_events_collapsed[info.ev_id]==undefined)_lb_fav_events_collapsed[info.ev_id]=false;info.collapsed=_lb_fav_events_collapsed[info.ev_id];var scitem_id=_lb_fav_event_id_prefix+info.ev_id,pscone_id=_lb_fav_events_id;if(!scone_exists(pscone_id))return;var html=tmpl_play("lb_fav_event",info),was_visible=scone_item_exists(scitem_id),now_visible=(info.displayed=="Y"&&info.settled=="N");if(!was_visible&&now_visible){scone_add_item(pscone_id,scitem_id,html,null);var cscone_id=_lb_fav_markets_id_prefix+data.ev_id;scone_create(cscone_id,{},null,null);if(info.is_fin)_lb_fav_add_id_to_cookie(info.ev_id,"E")}else if(was_visible&&now_visible){scone_replace_item(scitem_id,html,null,true)}else if(was_visible&&!now_visible)if(info.settled=="Y"){lb_fav_remove_EVENT(info.ev_id)}else scone_remove_item(scitem_id);updatePeriodClock(info);if(now_visible&&(!was_visible||orig_bettable!=info.bettable))for(var ev_mkt_id in info.child_hash)_lb_fav_got_EVMKT({ev_mkt_id:ev_mkt_id,ev_id:info.ev_id},false)}
function _lb_fav_got_EVMKT(data,push_msg){var parent_info=_lb_fav_event_hash[data.ev_id];if(!parent_info)return;parent_info.child_hash[data.ev_mkt_id]=true;var info=_lb_fav_evmkt_hash[data.ev_mkt_id],is_new_item=!info;if(is_new_item&&push_msg)return;var orig_displayed,orig_disporder,orig_name,orig_bettable,orig_hcap_values;if(is_new_item){info=data;_lb_fav_evmkt_hash[data.ev_mkt_id]=info;info.child_hash={};info.contains_hcaps=false}else{orig_displayed=info.displayed;orig_disporder=info.disporder;orig_name=info.name;orig_bettable=info.bettable;orig_hcap_values=info.hcap_values;for(var f in data)info[f]=data[f]};info.name=info.names[_lb_fav_cfg.lang];info.name=trunc_string(info.name,_lb_fav_cfg.market_truncate_threshold,'...');info.is_fin=(info.is_financial=="Y");var settled=info.settled;if(settled=='Y')info.displayed='N';info.bettable=(info.status=="A")&&parent_info.bettable;var scitem_id=_lb_fav_market_id_prefix+info.ev_mkt_id,pscone_id=_lb_fav_markets_id_prefix+info.ev_id;if(!scone_exists(pscone_id))return;info.collapsed=_lb_fav_markets_collapsed[info.ev_mkt_id];var html=tmpl_play("lb_fav_market",info),was_visible=scone_item_exists(scitem_id),now_visible=false;if(info.displayed=="Y")now_visible=true;if(!was_visible&&now_visible){scone_add_item(pscone_id,scitem_id,html,null);var cscone_id=_lb_fav_selcns_id_prefix+data.ev_mkt_id;scone_create(cscone_id,{},lb_fav_cmp_objects.cmpSelcns,null);var fav_event_elem=document.getElementById(_lb_fav_event_id_prefix+info.ev_id);fav_event_elem.style.display="";var fav_events_elem=document.getElementById(_lb_fav_events_id);fav_events_elem.style.display="";_lb_fav_cal_ev_counts();if(!info.is_fin){_lb_fav_add_id_to_cookie(info.ev_mkt_id,"M");_lb_fav_got_EVENT({ev_id:info.ev_id,mar_num:_lb_fav_mkt_count[info.ev_id]},true)}else if(_lb_fav_mkt_count[info.ev_id]==1){var fav_event_elem=document.getElementById(_lb_fav_event_id_prefix+info.ev_id);if(fav_event_elem&&fav_event_elem.style.display=="none")fav_event_elem.style.display=""}}else if(was_visible&&now_visible){scone_replace_item(scitem_id,html,null,true)}else if(was_visible&&!now_visible)if(info.settled=="Y"){lb_fav_remove_EVMKT(info.ev_mkt_id)}else{scone_remove_item(scitem_id);_lb_fav_cal_ev_counts();if(_lb_fav_mkt_count[info.ev_id]==0){var fav_event_elem=document.getElementById(_lb_fav_event_id_prefix+info.ev_id);if(fav_event_elem&&fav_event_elem.style.display!="none")fav_event_elem.style.display="none";if(_lb_fav_tot_markets==0){var fav_events_elem=document.getElementById(_lb_fav_events_id);fav_events_elem.style.display="none"}}};if(now_visible&&(!was_visible||orig_bettable!=info.bettable))for(var ev_oc_id in info.child_hash)_lb_fav_got_SELCN({ev_oc_id:ev_oc_id,ev_mkt_id:info.ev_mkt_id},false)}
function _lb_fav_got_SELCN(data,push_msg){var parent_info=_lb_fav_evmkt_hash[data.ev_mkt_id];if(!parent_info)return;parent_info.child_hash[data.ev_oc_id]=true;var info=_lb_fav_selcn_hash[data.ev_oc_id],is_new_item=!info;if(is_new_item&&push_msg)return;var orig_lp_num,orig_lp_den;if(is_new_item){info=data;_lb_fav_selcn_hash[data.ev_oc_id]=info}else{orig_lp_num=info.lp_num;orig_lp_den=info.lp_den;orig_hcap_value=info.hcap_value;for(var f in data)info[f]=data[f]};info.name=info.names[_lb_fav_cfg.lang];info.name=trunc_string(info.name,_lb_fav_cfg.name_truncate_threshold,'...');info.has_hcap=false;info.hcap_value="";if(info.fb_result&&parent_info.hcap_values)if(parent_info.hcap_values[info.fb_result]){info.hcap_value=parent_info.hcap_values[info.fb_result];info.has_hcap=true};info.bettable=(info.status=="A")&&parent_info.bettable;info.is_fin=(info.is_financial=="Y");var scitem_id=_lb_fav_selcn_id_prefix+data.ev_oc_id,pscone_id=_lb_fav_selcns_id_prefix+parent_info.ev_mkt_id;if(!scone_exists(pscone_id))return;info.price_str=get_price_str(lb_fav_obj,info.lp_num,info.lp_den,parent_info.lp_avail,parent_info.mkt_sort);if(info.is_fin){var html=tmpl_play("lb_fav_selcn_fin",info)}else var html=tmpl_play("lb_fav_selcn",info);var sort_info={disporder:info.disporder,lp_num:info.lp_num,lp_den:info.lp_den,ev_oc_id:info.ev_oc_id},was_visible=scone_item_exists(scitem_id),now_visible=(info.displayed=="Y"&&info.settled=="N");if(!was_visible&&now_visible){scone_add_item(pscone_id,scitem_id,html,sort_info)}else if(was_visible&&now_visible){scone_replace_item(scitem_id,html,sort_info,true)}else if(was_visible&&!now_visible)scone_remove_item(scitem_id);if(!is_new_item&&now_visible){push_highlight_price_change(lb_fav_obj,info.ev_oc_id,orig_lp_num,orig_lp_den,info.lp_num,info.lp_den);_lb_fav_highlight_level_change(info.ev_oc_id,orig_hcap_value,info.hcap_value)}}
function _lb_fav_highlight_level_change(ev_oc_id,old_hcap_str,new_hcap_str){if(old_hcap_str==new_hcap_str)return;var old_hcap=_lb_fav_extract_hcap(old_hcap_str),new_hcap=_lb_fav_extract_hcap(new_hcap_str);if(old_hcap==new_hcap)return;var level_id=_lb_fav_level_con_id_prefix+ev_oc_id;push_highlight(lb_fav_obj,level_id,_lb_fav_level_class_name,new_hcap-old_hcap)}
function _lb_fav_extract_hcap(hcap_str){return hcap_str.replace(/[ ()]/g,'')}
function _lb_fav_got_MHCAP(data){var info=_lb_fav_evmkt_hash[data.ev_mkt_id],parent_info=_lb_fav_event_hash[info.ev_id];if(!parent_info||!info)return;for(var f in data)info[f]=data[f];for(var ev_oc_id in info.child_hash)_lb_fav_got_SELCN({ev_oc_id:ev_oc_id,ev_mkt_id:info.ev_mkt_id},false);return}
function _lb_fav_got_PRICE(data){var info=_lb_fav_selcn_hash[data.ev_oc_id];if(!info)return;var parent_info=_lb_fav_evmkt_hash[info.ev_mkt_id];if(!parent_info)return;var orig_lp_num=info.lp_num,orig_lp_den=info.lp_den;for(var f in data)info[f]=data[f];var scitem_id=_lb_fav_selcn_id_prefix+data.ev_oc_id;if(!scone_item_exists(scitem_id))return;var price_id=_lb_fav_selcn_odd_id_prefix+info.ev_oc_id,price_el=document.getElementById(price_id);if(!price_el)return;info.price_str=get_price_str(lb_fav_obj,info.lp_num,info.lp_den,parent_info.lp_avail,parent_info.mkt_sort);price_el.innerHTML=info.price_str;push_highlight_price_change(lb_fav_obj,info.ev_oc_id,info.lp_num,info.lp_den,orig_lp_num,orig_lp_den);return}
function lb_fav_add_bet(ev_oc_id){bir_add_bet(lb_fav_obj,ev_oc_id,"");return}
function lb_fav_remove_EVENT(ev_id){var scitem_id="";scitem_id=_lb_fav_event_id_prefix+ev_id;scone_remove_item(scitem_id);var info="";if(_lb_fav_event_hash[ev_id]){for(var ev_mkt_id in _lb_fav_event_hash[ev_id].child_hash)if(_lb_fav_evmkt_hash[ev_mkt_id]){for(var ev_oc_id in _lb_fav_evmkt_hash[ev_mkt_id].child_hash)if(_lb_fav_selcn_hash[ev_oc_id])delete _lb_fav_selcn_hash[ev_oc_id];delete _lb_fav_evmkt_hash[ev_mkt_id]};var is_financial=_lb_fav_event_hash[ev_id].is_financial;delete _lb_fav_event_hash[ev_id]};delete _lb_fav_mkt_count[ev_id];delete _lb_fav_events_collapsed[ev_id];if(is_financial=="Y")_lb_fav_remove_id_from_cookie(ev_id,"E");_lb_fav_upd_count_displays(1);var fav_events_max_elem=document.getElementById("lb_fav_max_mkt_alert");fav_events_max_elem.style.display="none"}
function lb_fav_remove_EVMKT(ev_mkt_id){var scitem_id="",ev_id=_lb_fav_evmkt_hash[ev_mkt_id].ev_id;scitem_id=_lb_fav_market_id_prefix+ev_mkt_id;scone_remove_item(scitem_id);if(_lb_fav_evmkt_hash[ev_mkt_id]){for(var ev_oc_id in _lb_fav_evmkt_hash[ev_mkt_id].child_hash)if(_lb_fav_selcn_hash[ev_oc_id])delete _lb_fav_selcn_hash[ev_oc_id];var is_financial=_lb_fav_evmkt_hash[ev_mkt_id].is_financial;delete _lb_fav_evmkt_hash[ev_mkt_id];delete _lb_fav_markets_collapsed[ev_mkt_id];if(is_financial=="N"){_lb_fav_remove_id_from_cookie(ev_mkt_id,"M");var fav_events_max_elem=document.getElementById("lb_fav_max_mkt_alert");fav_events_max_elem.style.display="none"};_lb_fav_upd_count_displays(1);if(_lb_fav_mkt_count[ev_id]==0){lb_fav_remove_EVENT(ev_id)}else if(is_financial=="N")_lb_fav_got_EVENT({ev_id:ev_id},false)}}
function _lb_fav_add_id_to_cookie(id,type){var new_cookie="",c_status="",c_type="",c_id="",vals={},old_cookie=get_cookie('FAVOURITES');if(old_cookie==""){if(type=="M"){set_cookie('FAVOURITES',"ME|"+type+"|"+id,"","/","","")}else if(type=="E")set_cookie('FAVOURITES',"EE|"+type+"|"+id,"","/","","")}else{vals=old_cookie.split('|');if(!_lb_fav_check_id_exists(vals,id,type)){if(type=="M"){var ev_id=_lb_fav_evmkt_hash[id].ev_id;if(_lb_fav_events_collapsed[ev_id]){_lb_fav_markets_collapsed[id]=true;new_cookie=old_cookie+"|C|"+type+"|"+id}else{_lb_fav_markets_collapsed[id]=false;new_cookie=old_cookie+"|ME|"+type+"|"+id}}else if(type=="E")new_cookie=old_cookie+"|EE|"+type+"|"+id;set_cookie('FAVOURITES',new_cookie,"","/","","")}}}
function _lb_fav_remove_id_from_cookie(id,type){var new_cookie="",c_status="",c_type="",c_id="",vals={},old_cookie=get_cookie('FAVOURITES');vals=old_cookie.split('|');var i=0;while(i<vals.length){c_status=vals[i];c_type=vals[i+1];c_id=vals[i+2];if(c_id==id&&c_type==type);else if(new_cookie==""){new_cookie=c_status+"|"+c_type+"|"+c_id}else new_cookie=new_cookie+"|"+c_status+"|"+c_type+"|"+c_id;i=i+3};set_cookie('FAVOURITES',new_cookie,"","/","","")}
function _lb_fav_check_id_exists(vals,id,type){var i=0,c_status="",c_type="",c_id="";while(i<vals.length){c_status=vals[i];c_type=vals[i+1];c_id=vals[i+2];if(c_id==id&&c_type==type)return true;i=i+3};return false}
function _lb_fav_init_collapsed_hash(markets){var c_status="",c_type="",c_id="",vals={},old_cookie=get_cookie('FAVOURITES');vals=old_cookie.split('|');var i=0,market;while(i<vals.length){c_status=vals[i];c_type=vals[i+1];c_id=vals[i+2];market="";if(c_type=="E"){if(c_status=="EE"){_lb_fav_events_collapsed[c_id]=false}else _lb_fav_events_collapsed[c_id]=true}else if(c_type=="M"){var found=false,j;for(j=0;j<markets.length;j++)if(markets[j].ev_mkt_id==c_id){found=true;market=markets[j];break};if(found)if(c_status=="C"){_lb_fav_events_collapsed[market.ev_id]=true;_lb_fav_markets_collapsed[market.ev_mkt_id]=false}else if(c_status=="EE"){_lb_fav_events_collapsed[market.ev_id]=false;_lb_fav_markets_collapsed[market.ev_mkt_id]=true}else if(c_status=="ME"){_lb_fav_events_collapsed[market.ev_id]=false;_lb_fav_markets_collapsed[market.ev_mkt_id]=false}};i=i+3}}
function lb_fav_add_new(id,type){_lb_fav_cal_ev_counts();if(_lb_fav_cfg.max_markets<=_lb_fav_tot_markets){var max_mkt_alert=document.getElementById("lb_fav_max_mkt_alert");max_mkt_alert.style.display=""}else{if(_lb_fav_cfg.reload_url=="")return;var clientdata={id:'favourites_js'},id_string="";if(type=="M"){id_string="&ev_mkt_id="+id}else if(type=="E")id_string="&ev_id="+id;var url=_lb_fav_cfg.ajax_url+id_string;_lb_fav_make_ajax_get_request(url,clientdata,_lb_fav_got_ajax_content)}}
function _lb_fav_make_ajax_get_request(url,clientdata,callback){if(document.PollingAjaxHelper.checkSemaphore()){document.PollingAjaxHelper.setTimeout("_lb_fav_make_ajax_get_request",function(){_lb_fav_make_ajax_get_request(url,clientdata,callback)},300);return};document.PollingAjaxHelper.aquireSemaphore();var req=null;if(window.XMLHttpRequest){req=new XMLHttpRequest()}else if(window.ActiveXObject)req=new ActiveXObject('Microsoft.XMLHTTP');if(req){req.onreadystatechange=function(){if(req.readyState!=4)return;var reqStatus;try{reqStatus=req.status}catch(e){reqStatus=''};if(reqStatus!=200){document.PollingAjaxHelper.releaseSemaphore();callback(url,clientdata,false,'HTTP')}else{document.PollingAjaxHelper.releaseSemaphore();callback(url,clientdata,true,req.responseText)}};try{req.open('GET',url,true);req.send(null)}catch(e){document.PollingAjaxHelper.releaseSemaphore();callback(url,clientdata,false,'UNSUPPORTED')}}else{document.PollingAjaxHelper.releaseSemaphore();callback(url,clientdata,false,'UNSUPPORTED')}}
function _lb_fav_got_ajax_content(url,clientdata,ok,response){var holder_el=document.getElementById(clientdata.id);if(ok){if(response=="")return;var parts=_lb_fav_parse_script_tags(response);if(holder_el)holder_el.innerHTML=parts[0];if(parts[1].length)try{_lb_fav_global_eval(parts[1])}catch(e){ok=false}}}
function _lb_fav_parse_script_tags(str){var html='',js='',i=0,state='HTML',script_re=new RegExp('<(/?)script([^>]*)>','gi');while((mtch=script_re.exec(str))!=null){mS=mtch.index;if(state=='HTML'){html+=str.substring(i,mS)}else js+=str.substring(i,mS)+';\n';var closer=mtch[1],attrs=mtch[2];if(closer=='/'){state='HTML'}else if(attrs.charAt(attrs.length-1)!='/'&&attrs.indexOf('src=')==-1)state='JS';i=script_re.lastIndex};if(state=='HTML'){html+=str.substring(i)}else js+=str.substring(i);return[html,js]};var _lb_fav_global_eval=function(src){if(window.execScript){window.execScript(src);return};var fn=function(){window.eval.call(window,src)};fn()}
function lb_fav_toggle_collapse(id,type){var info;if(type=="E"){info=_lb_fav_event_hash[id];if(info==undefined)return;if(info.is_financial=="Y"){if(_lb_fav_events_collapsed[id]==true){lb_fav_set_cookie_id(id,type,"EE");_lb_fav_events_collapsed[id]=false}else{lb_fav_set_cookie_id(id,type,"C");_lb_fav_events_collapsed[id]=true}}else if(_lb_fav_events_collapsed[id]==true){_lb_fav_events_collapsed[id]=false;for(var ev_mkt_id in info.child_hash){_lb_fav_markets_collapsed[ev_mkt_id]=false;lb_fav_set_cookie_id(ev_mkt_id,"M","ME")}}else{_lb_fav_events_collapsed[id]=true;for(var ev_mkt_id in info.child_hash){_lb_fav_markets_collapsed[ev_mkt_id]=false;lb_fav_set_cookie_id(ev_mkt_id,"M","C")}}}else if(type=="M"){info=_lb_fav_evmkt_hash[id];if(info==undefined)return;if(info.is_financial=="N")if(_lb_fav_markets_collapsed[id]==false){_lb_fav_markets_collapsed[id]=true;lb_fav_set_cookie_id(id,type,"EE")}else{_lb_fav_markets_collapsed[id]=false;lb_fav_set_cookie_id(id,type,"ME")}}}
function lb_fav_set_cookie_id(id,type,status){var c_status="",c_type="",c_id="",vals={},new_cookie="",old_cookie=get_cookie('FAVOURITES');vals=old_cookie.split('|');var i=0;while(i<vals.length){c_status=vals[i];c_type=vals[i+1];c_id=vals[i+2];if(c_type==type&&c_id==id){if(new_cookie==""){new_cookie=status+"|"+type+"|"+id}else new_cookie=new_cookie+"|"+status+"|"+type+"|"+id}else if(new_cookie==""){new_cookie=c_status+"|"+c_type+"|"+c_id}else new_cookie=new_cookie+"|"+c_status+"|"+c_type+"|"+c_id;i=i+3};set_cookie('FAVOURITES',new_cookie,"","/","","")}
function _lb_fav_init_display(events,markets){var i=0,class_change="",elem_hide="",elem="";for(i=0;i<events.length;i++)if(_lb_fav_events_collapsed[events[i].ev_id]!=undefined)if(_lb_fav_events_collapsed[events[i].ev_id]){class_change=document.getElementById("lb_fav_event_class_t_"+events[i].ev_id);if(class_change)class_change.className="closeEl off";elem_hide=document.getElementById("lb_fav_event_hide_"+events[i].ev_id);if(elem_hide)elem_hide.style.display="none";var info=_lb_fav_event_hash[events[i].ev_id];for(var ev_mkt_id in info.child_hash){if(events[i].is_financial=="N"){class_change=document.getElementById("lb_fav_market_class_t_"+ev_mkt_id);if(class_change)class_change.className="closeEl on";elem_hide=document.getElementById("lb_fav_market_hide_"+ev_mkt_id);if(elem_hide)elem_hide.style.display=""};elem=document.getElementById("lb_fav_markets_"+events[i].ev_id);if(elem)elem.style.display=""}};for(i=0;i<markets.length;i++)if(markets[i].is_financial=="N")if(_lb_fav_markets_collapsed[markets[i].ev_mkt_id]!=undefined)if(_lb_fav_markets_collapsed[markets[i].ev_mkt_id]){class_change=document.getElementById("lb_fav_market_class_t_"+markets[i].ev_mkt_id);if(class_change)class_change.className="closeEl off";elem_hide=document.getElementById("lb_fav_market_hide_"+markets[i].ev_mkt_id);if(elem_hide)elem_hide.style.display="none"}}
function _lb_fav_cal_ev_counts(){var ev_info="",ev_id="",mkt_info="",ev_mkt_id="",mkt_scitem_id="",ev_scitem_id="",fav_event_elem="",fav_mkt_elem="";_lb_fav_tot_markets=0;for(ev_id in _lb_fav_event_hash){_lb_fav_mkt_count[ev_id]=0;if(_lb_fav_event_hash[ev_id]){ev_info=_lb_fav_event_hash[ev_id];ev_scitem_id=_lb_fav_event_id_prefix+ev_id;fav_event_elem=document.getElementById(ev_scitem_id);if(scone_item_exists(ev_scitem_id)&&fav_event_elem&&fav_event_elem.style.display!="none"){for(ev_mkt_id in _lb_fav_event_hash[ev_id].child_hash)if(_lb_fav_evmkt_hash[ev_mkt_id]){mkt_info=_lb_fav_evmkt_hash[ev_mkt_id];mkt_scitem_id=_lb_fav_market_id_prefix+ev_mkt_id;fav_mkt_elem=document.getElementById(mkt_scitem_id);if(scone_item_exists(mkt_scitem_id)&&fav_mkt_elem&&fav_mkt_elem.style.display!="none"){_lb_fav_mkt_count[ev_id]++;if(mkt_info.is_financial=="N")_lb_fav_tot_markets++}};if(ev_info.is_financial=="Y"&&_lb_fav_mkt_count[ev_id]>0)_lb_fav_tot_markets++}}};return}
function _lb_fav_upd_count_displays(calculate){if(calculate==1)_lb_fav_cal_ev_counts();var title_el=document.getElementById(_lb_fav_market_num);title_el.innerHTML="("+_lb_fav_tot_markets+")";if(_lb_fav_tot_markets>0){var fav_events_elem=document.getElementById("myFavouriteEmpty");fav_events_elem.style.display="none";var fav_events_elem=document.getElementById("myFavouriteFull");fav_events_elem.style.display=""}else{var fav_events_elem=document.getElementById("myFavouriteFull");fav_events_elem.style.display="none";var fav_events_elem=document.getElementById("myFavouriteEmpty");fav_events_elem.style.display=""}}
function lb_fb_cpn_init(tab_id,call_type,page_type,coupon,events,markets,selcns,server_time_year,server_time_month,server_time_day,server_time_hour,server_time_min,server_time_sec,init_msg_id,mode,change_mode,cfg){var force_time=false;if(coupon.coupon_sort==''||coupon.coupon_sort=='FM'||coupon.coupon_sort=='MM'||coupon.coupon_sort=='MR')force_time=true;if(change_mode==0)initPeriodClocks(server_time_year,server_time_month,server_time_day,server_time_hour,server_time_min,server_time_sec,cfg.lang,force_time);var lb_fb_cpn=_lb_fb_cpn_hash[page_type+coupon.coupon_id];if(!lb_fb_cpn){lb_fb_cpn=new lb_fb_cpn_object();lb_fb_cpn.page_type=page_type;_lb_fb_cpn_hash[page_type+coupon.coupon_id]=lb_fb_cpn;_lb_fb_cpn_tab_hash[tab_id]=page_type+coupon.coupon_id};lb_fb_cpn.mode=mode;if(change_mode==0)for(var f in cfg)lb_fb_cpn.cfg[f]=cfg[f];lb_fb_cpn.last_msg_id=init_msg_id;var live_channels=[];if(!_lb_fb_cpn_templates_prepared){_lb_fb_cpn_store_templates();_lb_fb_cpn_templates_prepared=true};if(call_type=="html"){if(change_mode==0){lb_fb_cpn.coupon=null;lb_fb_cpn.day_hash={};lb_fb_cpn.type_hash={};lb_fb_cpn.event_hash={};lb_fb_cpn.evmkt_hash={};lb_fb_cpn.selcn_hash={};lb_fb_cpn.channels={};lb_fb_cpn.ev_count={};lb_fb_cpn.selcn_count={};lb_fb_cpn.score_hash={}}else{events=[];markets=[];selcns=[];for(var i in lb_fb_cpn.event_hash)events.push(lb_fb_cpn.event_hash[i]);for(var i in lb_fb_cpn.evmkt_hash)markets.push(lb_fb_cpn.evmkt_hash[i]);for(var i in lb_fb_cpn.selcn_hash)selcns.push(lb_fb_cpn.selcn_hash[i])};if(scone_exists(_lb_fb_cpn_coupon_area_prefix+lb_fb_cpn.page_type))scone_delete(_lb_fb_cpn_coupon_area_prefix+lb_fb_cpn.page_type);scone_create(_lb_fb_cpn_coupon_area_prefix+lb_fb_cpn.page_type,{},null,null)};var rebuild_parents=false;if(call_type=="html")_lb_fb_cpn_got_COUPON(coupon,lb_fb_cpn,rebuild_parents);events=_lb_fb_cpn_sort_events(lb_fb_cpn,events);var max_num_events=lb_fb_cpn.cfg.max_num_events;if(typeof max_num_events==="undefined"){max_num_events=0;if(cfg.browser_event_limits){var limits=cfg.browser_event_limits[BrowserDetect.browser.toUpperCase()];if(limits)for(var i=0;i<limits.length;i++)if(limits[i].version.charAt(0)=="<"){var v=parseFloat(limits[i].version.substring(1));if(BrowserDetect.version<=v){max_num_events=limits[i].limit;break}}else{var v=parseFloat(limits[i].version);if(BrowserDetect.version==v){max_num_events=limits[i].limit;break}}};if(max_num_events>=events.length)max_num_events=0;lb_fb_cpn.cfg.max_num_events=max_num_events};lb_fb_cpn.prune_event_list={};for(var i=0;i<events.length;i++){if(events[i].is_off=="Y"&&change_mode==0)addClockEvent(events[i].ev_id,clockn_js,"fb_cpn_lb_clock_"+page_type+"_"+coupon.coupon_id);lb_fb_cpn.prune_event_list[events[i].ev_id]=true;if(max_num_events>0&&i>=max_num_events){var create_new_scones=false;events[i].buildable=0}else{var create_new_scones=true;events[i].buildable=1};if(call_type=="html"||call_type=="refresh"||(mode=="date"&&(!lb_fb_cpn.day_hash[events[i].day_id]))||(mode=="type"&&(!lb_fb_cpn.type_hash[events[i].ev_type_id])))if(mode=="date"){_lb_fb_cpn_got_DAY(events[i],lb_fb_cpn,rebuild_parents,create_new_scones)}else if(mode=="type")_lb_fb_cpn_got_TYPE(events[i],lb_fb_cpn,rebuild_parents,create_new_scones);if(call_type=="html"||call_type=="refresh"||(!lb_fb_cpn.event_hash[events[i].ev_id])){if(call_type=="js"&&page_type=="fb_hp_live_tab"){var ev_rebuild_parents=true}else var ev_rebuild_parents=false;_lb_fb_cpn_got_EVENT(events[i],lb_fb_cpn,ev_rebuild_parents,mode,create_new_scones)}else if(call_type=="js"&&lb_fb_cpn.event_hash[events[i].ev_id]){var event_copy=lb_fb_cpn.event_hash[events[i].ev_id];if(event_copy.more_bets!=events[i].more_bets){event_copy.more_bets=events[i].more_bets;_lb_fb_cpn_got_EVENT(event_copy,lb_fb_cpn,false,mode,create_new_scones)}};if(!lb_fb_cpn.channels["EVENT"+events[i].ev_id]){live_channels.push("sEVENT"+ps_connect_lpad_id(events[i].ev_id));lb_fb_cpn.channels["EVENT"+events[i].ev_id]=true};if(events[i].is_off=="Y"&&!lb_fb_cpn.channels["BRSCR"+events[i].ev_id]){live_channels.push("sBRSCR"+ps_connect_lpad_id(events[i].ev_id));lb_fb_cpn.channels["BRSCR"+events[i].ev_id]=true}};for(var i=0;i<markets.length;i++){if(call_type=="html"||call_type=="refresh"||(!lb_fb_cpn.evmkt_hash[markets[i].ev_mkt_id]))_lb_fb_cpn_got_EVMKT(markets[i],lb_fb_cpn,false,rebuild_parents,mode);if(!lb_fb_cpn.channels["MARKET"+markets[i].ev_mkt_id]){live_channels.push("sEVMKT"+ps_connect_lpad_id(markets[i].ev_mkt_id));live_channels.push("SEVMKT"+ps_connect_lpad_id(markets[i].ev_mkt_id));lb_fb_cpn.channels["MARKET"+markets[i].ev_mkt_id]=true}};for(var i=0;i<selcns.length;i++)if(call_type=="html"||call_type=="refresh"||(!lb_fb_cpn.selcn_hash[selcns[i].ev_oc_id]))_lb_fb_cpn_got_SELCN(selcns[i],lb_fb_cpn,rebuild_parents);_lb_fb_cpn_do_more_evs_link(lb_fb_cpn,mode);if(change_mode==0){if(coupon.pushed&&live_channels.length>0){var gotPushDataClosure=function(msg){return lb_fb_cpn.gotPushData(msg)};ps_connect_register("lb_fb_cpn_"+page_type+_lb_fb_cpn_idx,gotPushDataClosure,live_channels,init_msg_id);_lb_fb_cpn_idx++};if(call_type=="html"&&coupon.reload_url!=""&&coupon.pushed)_lb_fb_cpn_schedule_reload(page_type,coupon.coupon_id,lb_fb_cpn.cfg.reload_period)};if(coupon.showing_all){var show_all_el=document.getElementById(_lb_fb_cpn_show_all_id_prefix+page_type+"_"+coupon.coupon_id);if(show_all_el)show_all_el.style.display='none'};if(call_type=="js")_lb_fb_cpn_prune_events(lb_fb_cpn,lb_fb_cpn.prune_event_list);_lb_fb_cpn_calc_ev_counts(lb_fb_cpn)};var _lb_fb_cpn_templates_prepared=false,_lb_fb_cpn_idx=0,_lb_fb_cpn_coupon_area_prefix="lb_fb_coupon_area_",_lb_fb_cpn_coupon_area_no_selns_prefix="lb_fb_coupon_area_no_selns_",_lb_fb_cpn_coupon_id_prefix="lb_fb_coupon_",_lb_fb_cpn_show_all_id_prefix="lb_fb_show_all_",_lb_fb_cpn_coupon_static_col_count=5,_lb_fb_cpn_coupon_dyn_col_width=227,_lb_fb_cpn_name_col_width=160,_lb_fb_cpn_coupon_fat_col_pad=36,_lb_fb_cpn_coupon_no_link_name_col_pad=40,_lb_fb_cpn_coupon_no_link_dyn_col_pad=43,_lb_fb_cpn_coupon_col_id_prefix="lb_fb_coupon_col_",_lb_fb_cpn_days_id_prefix="lb_fb_daytype_",_lb_fb_cpn_day_id_prefix="lb_fb_day_",_lb_fb_cpn_types_id_prefix="lb_fb_daytype_",_lb_fb_cpn_type_id_prefix="lb_fb_type_",_lb_fb_cpn_events_id_prefix="lb_fb_events_",_lb_fb_cpn_event_id_prefix="lb_fb_event_",_lb_fb_cpn_more_evs_id="lb_fb_cpn_more_evs",_lb_fb_cpn_selcn_holder_id_prefix="lb_fb_selcn_holder_",_lb_fb_cpn_selcn_id_prefix="lb_fb_selcn_",_lb_fb_cpn_selcn_link_id_prefix="lb_fb_selcn_link_",_lb_fb_cpn_selcn_base_class="odd",_lb_fb_cpn_hash={},_lb_fb_cpn_tab_hash={},_lb_fb_cpn_hl_timers={},_lb_fb_cpn_countdown_timers={}
function lb_fb_cpn_object(){this.gotPushData=function(msg){var data={},mode=this.mode;if(!mode)mode="date";switch(msg.subject_level){case"sPRICE":eval("data = "+msg.data+";");data.ev_oc_id=msg.subject_id;_lb_fb_cpn_got_PRICE(data,this,true);break;case"sSELCN":eval("data = "+msg.data+";");data.ev_oc_id=msg.subject_id;_lb_fb_cpn_got_SELCN(data,this,true);break;case"sMHCAP":eval("data = "+msg.data+";");data.ev_mkt_id=msg.subject_id;_lb_fb_cpn_got_MHCAP(data,this,true);break;case"sEVMKT":eval("data = "+msg.data+";");data.ev_mkt_id=msg.subject_id;_lb_fb_cpn_got_EVMKT(data,this,false,true,mode);break;case"sEVENT":eval("data = "+msg.data+";");data.ev_id=msg.subject_id;_lb_fb_cpn_got_EVENT(data,this,true,mode,true);break;case"sBRSCR":eval("data = "+msg.data+";");data.ev_id=msg.subject_id;_lb_fb_cpn_got_SCORE(data,this);break;default:};tooltip_init();return};this.cfg={lang:"en",price_str_type:"ODDS",price_str_type_ah:"DECIMAL",price_str_type_hl:"DECIMAL",price_str_sep:"-",event_url:"",hl_class_decrease:"_d",hl_class_increase:"_i",hl_class_same:"",highlight_duration:4e3};return};var lb_fb_cpn_cmp_objects=new function(){}();lb_fb_cpn_cmp_objects=new push_hash_cmp_objects();lb_fb_cpn_cmp_objects.cmpEvents=function(cmp_mode,evA,evB){var handler=_lb_fb_cpn_hash[evA.page_type+evA.coupon_id];if(cmp_mode!="manual"){if(handler.mode=="type"){var d=evA.disporder-evB.disporder;if(d)return d;var t=evA.start_time_disp_order-evB.start_time_disp_order;if(t)return t;var n=(evA.name_full<=evB.name_full?-1:1);if(n)return n}else{var d=evA.disporder-evB.disporder;if(d)return d;var t=evA.start_time_disp_order-evB.start_time_disp_order;if(t)return t;var td=evA.ev_type_disporder-evB.ev_type_disporder;if(td)return td;var n=(evA.name_full<=evB.name_full?-1:1);if(n)return n}}else{var priceA=_lb_fb_cpn_get_col_price(handler,evA.ev_id,evA.parent_info.sort_col),priceB=_lb_fb_cpn_get_col_price(handler,evB.ev_id,evA.parent_info.sort_col);if(priceA.lp_den==0&&priceB.lp_den==0)return;if(priceA.lp_den==0)return-1*evA.parent_info.sort_direction;if(priceB.lp_den==0)return evA.parent_info.sort_direction;var d=priceA.lp_num*priceB.lp_den-priceB.lp_num*priceA.lp_den;return evA.parent_info.sort_direction*d}};lb_fb_cpn_cmp_objects.cmpDays=function(cmp_mode,evA,evB){var t=evA.day_id-evB.day_id;return t};lb_fb_cpn_cmp_objects.cmpTypes=function(cmp_mode,evA,evB){var t=evA.ev_type_disporder-evB.ev_type_disporder;if(t==0)t=(evA.ev_type_name===evB.ev_type_name?0:evA.ev_type_name<=evB.ev_type_name?-1:1);return t}
function _lb_fb_cpn_store_templates(){var tmp=[];tmp.push('	<div id="lb_fb_coupon_<%page_type%>_<%coupon_id%>">\n');tmp.push('		<div id="lb_fb_daytype_<%page_type%>_<%coupon_id%>">\n');tmp.push('		</div>\n');tmp.push('	</div>\n');tmpl_store("lb_fb_cpn_coupon",tmp.join(""));var tmp=[];tmp.push('	<div class="fb_day_type_wrapper" <%IF hidden %>style="display:none;"<%END%> id="lb_fb_day_<%page_type%>_<%coupon_id%>_<%day_id%>">\n');tmp.push('		<div class="fb_hdr">\n');tmp.push('			<h2><%day_name%> <span class="normal">- <%date_name%></span></h2>\n');tmp.push('			<ul class="list_header_odds <%IF coupon_sort == "SB"%>wider-list<%END%>">\n');tmp.push('			<%LOOP c_idx col_names.length%>');tmp.push('				<li><span onclick="lb_fb_cpn_do_sort(\'<%page_type%>\', \'<%mode%>\',\'<%coupon_id%>\',\'<%day_id%>\',\'<%col_keys[c_idx]%>\');"><%col_names[c_idx]%></span>\n');tmp.push('				<%IF col_keys[c_idx] == "H" %><span class="tooltip"><%XL FB_TT_HOME%></span><%END%>\n');tmp.push('				<%IF col_keys[c_idx] == "D" %><span class="tooltip"><%XL FB_TT_DRAW%></span><%END%>\n');tmp.push('				<%IF col_keys[c_idx] == "A" %><span class="tooltip"><%XL FB_TT_AWAY%></span><%END%>\n');tmp.push('				</li>\n');tmp.push('			<%END%>');tmp.push('			</ul>\n');tmp.push('		</div>\n');tmp.push('		<div id="lb_fb_events_<%page_type%>_<%coupon_id%>_<%day_id%>"></div>\n');tmp.push('	</div>\n');tmpl_store("lb_fb_cpn_day",tmp.join(""));var tmp=[];tmp.push('	<div class="fb_day_type_wrapper" <%IF hidden %>style="display:none;"<%END%> id="lb_fb_type_<%page_type%>_<%coupon_id%>_<%ev_type_id%>">\n');tmp.push('		<div class="fb_hdr">\n');tmp.push('			<h2><%ev_type_name%></h2>\n');tmp.push('			<ul class="list_header_odds <%IF coupon_sort == "SB"%>wider-list<%END%>">\n');tmp.push('			<%LOOP c_idx col_names.length%>');tmp.push('				<li><span onclick="lb_fb_cpn_do_sort(\'<%page_type%>\', \'<%mode%>\', \'<%coupon_id%>\',\'<%ev_type_id%>\',\'<%col_keys[c_idx]%>\');"><%col_names[c_idx]%></span>\n');tmp.push('				<%IF col_keys[c_idx] == "H" %><span class="tooltip"><%XL FB_TT_HOME%></span><%END%>\n');tmp.push('				<%IF col_keys[c_idx] == "D" %><span class="tooltip"><%XL FB_TT_DRAW%></span><%END%>\n');tmp.push('				<%IF col_keys[c_idx] == "A" %><span class="tooltip"><%XL FB_TT_AWAY%></span><%END%>\n');tmp.push('				</li>\n');tmp.push('			<%END%>');tmp.push('			</ul>\n');tmp.push('		</div>\n');tmp.push('		<div id="lb_fb_events_<%page_type%>_<%coupon_id%>_<%ev_type_id%>"></div>\n');tmp.push('	</div>\n');tmpl_store("lb_fb_cpn_type",tmp.join(""));var tmp=[];tmp.push('	<div id="lb_fb_event_<%page_type%>_<%coupon_id%>_<%ev_id%>"  class="pp_fb_event <%IF is_off == "Y" %>live<%END%>" <%IF hidden%>style="display:none;"<%END%> >\n');tmp.push('		<%IF is_off == "Y" %>');tmp.push('				<%IF score_away == "" && score_away_br == "" && score_home == "" && score_home_br == "" %>');tmp.push('					<div class="live_now"><a href="<%url%>"><span class="tooltip"><%XL FB_LIVE_BETTING_TT%> <%start_time_str%></span><%XL FB_LIVE_NOW%></a></div>\n');tmp.push('				<%ELSE%>');tmp.push('					<div class="live_now clock"><a href="<%url%>">\n');tmp.push('						<span class="scoreline" id="lb_fb_event_<%page_type%>_<%coupon_id%>_<%ev_id%>_scoretext" style="display:none;"><%XL FB_GOAL_TEXT%></span>\n');tmp.push('						<span class="scoreline" id="lb_fb_event_<%page_type%>_<%coupon_id%>_<%ev_id%>_scoreline"><%score_home%> - <%score_away%></span>\n');tmp.push('						<span class="time" id="fb_cpn_lb_clock_<%page_type%>_<%coupon_id%>_time_<%ev_id%>"></span>\n');tmp.push('						<span class="period" id="fb_cpn_lb_clock_<%page_type%>_<%coupon_id%>_period_<%ev_id%>"></span>\n');tmp.push('						</a></div>\n');tmp.push('				<%END%>');tmp.push('		<%ELSE%>');tmp.push('			<%IF countdown_enabled%>');tmp.push('				<div class="live_now countdown">\n');tmp.push('					<a href="<%url%>">\n');tmp.push('						<p><%XL FB_TIME_TO_START_TEXT%></p>\n');tmp.push('						<span id="lb_fb_event_<%page_type%>_<%coupon_id%>_<%ev_id%>_cd"><%startup_mins%><%XL FB_COUNTDOWN_MIN%></span>\n');tmp.push('					</a>\n');tmp.push('				</div>\n');tmp.push('			<%ELSE%>');tmp.push('				<div class="fb_event_time">\n');tmp.push('					<%IF mode == "type"%>');tmp.push('						<div class="fb_date_time_combo">\n');tmp.push('							<%start_time_str%><br />\n');tmp.push('						<span><%start_date_short%></span>\n');tmp.push('						</div>');tmp.push('					<%ELSE%>');tmp.push('						<p><%start_time_str%></p>\n');tmp.push('					<%END%>');tmp.push('				</div>\n');tmp.push('			<%END%>');tmp.push('		<%END%>');tmp.push('		<div class="fb_event_name"><p><a href="<%url%>"><%name%>');tmp.push('			<%IF disp_TT_name_full == 0%>');tmp.push('				<span class="tooltip"><%name_full%></span>');tmp.push('			<%END%>');tmp.push('		</a></p></div>\n');tmp.push('		<div class="fb_tools">\n');tmp.push('			<%IF has_mbs == 0%>');tmp.push('				<%IF has_stations%>');tmp.push('					<a class="fbc_tv">\n');tmp.push('						<span class="tooltip"><%XL FB_TT_LIVEON%>\n');tmp.push('							<%LOOP tv_idx tv_icons.length%>');tmp.push('								<img src="<%tv_image_url%>/<%tv_icons[tv_idx]%>">\n');tmp.push('							<%END%>\n');tmp.push('						</span>\n');tmp.push('					</a>\n');tmp.push('				<%END%>\n');tmp.push('				<%IF ev_stream_available%>');tmp.push('					<a class="fb_streaming"><span class="tooltip"><%XL STREAMING_VIDEO_AVAIL%></span></a>\n');tmp.push('				<%END%>\n');tmp.push('			<%ELSE%>');tmp.push('				<a class="fb_money-back-special">\n');tmp.push('					<span class="tooltip">\n');tmp.push('						<%XL MBS%>\n');tmp.push('						<%IF has_stations%>');tmp.push('							<br/><%XL FB_TT_LIVEON%>');tmp.push('							<%LOOP tv_idx tv_icons.length%>');tmp.push('								<img src="<%tv_image_url%>/<%tv_icons[tv_idx]%>">');tmp.push('							<%END%>\n');tmp.push('						<%END%>\n');tmp.push('						<%IF  ev_stream_available%>');tmp.push('							<br/><%XL STREAMING_VIDEO_AVAIL%>\n');tmp.push('						<%END%>\n');tmp.push('					</span>\n');tmp.push('				</a>\n');tmp.push('			<%END%>\n');tmp.push('		</div>\n');tmp.push('		<%IF coupon_sort != "SB"%>\n');tmp.push('			<div class="fb_statistics">');tmp.push('				<%IF touchline%>');tmp.push('					<a onclick="openInlineStats(this, \'<%touchline%>\', \'<%page_type%>_<%coupon_id%>_<%ev_id%>\', \'<%touchline_view_all%>\');return false;" href="#"></a>');tmp.push('				<%END%>');tmp.push('			</div>\n');tmp.push('		<%END%>\n');tmp.push('		<div class="fb_odds item">\n');tmp.push('			<%LOOP c_idx col_keys.length%>');tmp.push('			<div <%IF coupon_sort != "SB"%>class="oddssmall"<%END%> id="lb_fb_selcn_holder_<%page_type%>_<%coupon_id%>_<%ev_id%>_<%col_keys[c_idx]%>"></div>\n');tmp.push('			<%END%>');tmp.push('		</div>\n');tmp.push('		<div class="fb_more_event_bets">\n');tmp.push('			<%IF more_bets > 0 && coupon_sort != "SB"%>');tmp.push('				<a href="<%url%>">\n');tmp.push('					');tmp.push('					+<%more_bets%> <br/><span class="text"><%XL MORE_BETS%></span>\n');tmp.push('				</a>\n');tmp.push('			<%END%>');tmp.push('		</div>\n');tmp.push('	</div>\n');tmpl_store("lb_fb_cpn_event",tmp.join(""));var tmp=[];tmp.push('	<span <%IF bettable%>class="odds_selection<%IF coupon_sort == "SB"%>_yesno<%END%> <%IF coupon_sort == "SH"%>handicap<%END%> odd"<%ELSE%>class="oddsuspended"<%END%> id="lb_fb_selcn_<%page_type%>_<%coupon_id%>_<%ev_oc_id%>">\n');tmp.push('		<%IF displayed == "Y"%>');tmp.push('			<a href="javascript:void(0)" <%IF bettable%>onclick="lb_fb_cpn_add_bet(<%ev_oc_id%>, \'<%page_type%>\', \'<%coupon_id%>\')"<%END%> id="lb_fb_selcn_link_<%page_type%>_<%coupon_id%>_<%ev_oc_id%>">\n');tmp.push('				<%IF bettable%>');tmp.push('					<%IF hcap_value%>');tmp.push('						<span class="handicap-figure"><%hcap_value%></span><br/><%price_str%>\n');tmp.push('					<%ELSE%>');tmp.push('						<%price_str%>\n');tmp.push('					<%END%>');tmp.push('				<%END%>');tmp.push('			</a>\n');tmp.push('		<%ELSE%>');tmp.push('			<a href="javascript:void(0)" id="lb_fb_selcn_link_<%page_type%>_<%coupon_id%>_<%ev_oc_id%>"></a>\n');tmp.push('		<%END%>');tmp.push('	</span>\n');tmpl_store("lb_fb_cpn_selcn",tmp.join(""));var tmp=[];tmp.push('<div id="lb_fb_cpn_more_evs_<%page_type%>_<%coupon_id%>" class="fb-market-footer">\n');tmp.push('	<div id="fb-whopper-all-matches">\n');tmp.push('		<div class="fb-whopper-icon-expand"></div>\n');tmp.push('		<div class="fb-whopper-text">\n');tmp.push('			<a href="javascript:void(0)" onclick="lb_fb_cpn_view_all_events(\'<%page_type%>\',\'<%coupon_id%>\')"><%XL EVENT_LIMIT_VIEW_MORE%></a>\n');tmp.push('		</div>\n');tmp.push('		<div class="fb-whopper-all-inner"></div>\n');tmp.push('	</div>\n');tmp.push('</div>\n');tmpl_store("lb_fb_cpn_more_events",tmp.join(""))}
function _lb_fb_cpn_got_COUPON(data,handler,rebuild_parents){var info=handler.coupon,is_new_item=!info;if(is_new_item){info=data;handler.coupon=info;info.child_hash={};info.page_type=handler.page_type;info.col_count=info.col_keys.length+_lb_fb_cpn_coupon_static_col_count;info.name_col_width=_lb_fb_cpn_name_col_width;info.dyn_col_width=_lb_fb_cpn_coupon_dyn_col_width;if(info.coupon_sort=="SC"||info.coupon_sort=="SB"){info.name_col_width+=_lb_fb_cpn_coupon_no_link_name_col_pad;info.dyn_col_width+=_lb_fb_cpn_coupon_no_link_dyn_col_pad;info.col_count-=2};if(info.col_keys.length>3||(info.col_keys.length==3&&info.has_hcaps)){info.name_col_width-=_lb_fb_cpn_coupon_fat_col_pad;info.dyn_col_width+=_lb_fb_cpn_coupon_fat_col_pad};info.col_widths=[];var col_width=Math.round(info.dyn_col_width/info.col_keys.length);for(var c=0;c<info.col_keys.length;c++)info.col_widths[c]=col_width;info.col_widths[info.col_widths.length-1]+=(info.dyn_col_width-info.col_keys.length*col_width)}else for(var f in data)info[f]=data[f];var scitem_id=_lb_fb_cpn_coupon_id_prefix+handler.page_type+"_"+info.coupon_id,pscone_id=_lb_fb_cpn_coupon_area_prefix+handler.page_type;if(!scone_exists(pscone_id))return;var was_visible=scone_item_exists(scitem_id),html=tmpl_play("lb_fb_cpn_coupon",info);if(!was_visible){scone_add_item(pscone_id,scitem_id,html,null);if(handler.mode=="date"){var cscone_id=_lb_fb_cpn_days_id_prefix+handler.page_type+"_"+info.coupon_id;scone_create(cscone_id,{},lb_fb_cpn_cmp_objects.cmpDays,null)}else{var cscone_id=_lb_fb_cpn_types_id_prefix+handler.page_type+"_"+info.coupon_id;scone_create(cscone_id,{},lb_fb_cpn_cmp_objects.cmpTypes,null)}}else scone_replace_item(scitem_id,html,null,true)}
function _lb_fb_cpn_got_DAY(data,handler,rebuild_parents,create_new_scones){var info=handler.day_hash[data.day_id],is_new_item=!info;if(is_new_item){info={};info.child_hash={};info.day_id=data.day_id;info.page_type=handler.page_type;info.coupon_id=handler.coupon.coupon_id;info.day_name=data.start_day_xls;info.date_name=data.start_date_xls;info.col_count=handler.coupon.col_count;info.col_widths=handler.coupon.col_widths;info.col_names=handler.coupon.col_names;info.col_keys=handler.coupon.col_keys;info.coupon_sort=handler.coupon.coupon_sort;info.name_col_width=handler.coupon.name_col_width;info.mode=handler.mode;info.hidden=false;handler.day_hash[data.day_id]=info};info.sort_direction='';info.sort_col='';var scitem_id=_lb_fb_cpn_day_id_prefix+handler.page_type+"_"+info.coupon_id+"_"+info.day_id,pscone_id=_lb_fb_cpn_days_id_prefix+handler.page_type+"_"+info.coupon_id;if(!scone_exists(pscone_id))return;if(!create_new_scones)return;var html=tmpl_play("lb_fb_cpn_day",info),sort_info={day_id:info.day_id,page_type:handler.page_type,coupon_id:info.coupon_id},was_visible=scone_item_exists(scitem_id);if(!was_visible){scone_add_item(pscone_id,scitem_id,html,sort_info);var cscone_id=_lb_fb_cpn_events_id_prefix+handler.page_type+"_"+info.coupon_id+"_"+info.day_id;scone_create(cscone_id,{},lb_fb_cpn_cmp_objects.cmpEvents,null)}}
function _lb_fb_cpn_got_TYPE(data,handler,rebuild_parents,create_new_scones){var info=handler.type_hash[data.ev_type_id],is_new_item=!info;if(is_new_item){info={};info.child_hash={};info.ev_type_id=data.ev_type_id;info.ev_type_disporder=data.ev_type_disporder;info.ev_type_name=data.ev_type_name;info.page_type=handler.page_type;info.coupon_id=handler.coupon.coupon_id;info.day_name=data.start_day_xls;info.date_name=data.start_date_xls;info.col_count=handler.coupon.col_count;info.col_widths=handler.coupon.col_widths;info.col_names=handler.coupon.col_names;info.col_keys=handler.coupon.col_keys;info.coupon_sort=handler.coupon.coupon_sort;info.name_col_width=handler.coupon.name_col_width;info.mode=handler.mode;info.hidden=false;handler.type_hash[data.ev_type_id]=info};info.sort_direction='';info.sort_col='';var scitem_id=_lb_fb_cpn_type_id_prefix+handler.page_type+"_"+info.coupon_id+"_"+info.ev_type_id,pscone_id=_lb_fb_cpn_types_id_prefix+handler.page_type+"_"+info.coupon_id;if(!scone_exists(pscone_id))return;if(!create_new_scones)return;var html=tmpl_play("lb_fb_cpn_type",info),sort_info={ev_type_id:info.ev_type_id,ev_type_disporder:info.ev_type_disporder,ev_type_name:info.ev_type_name,page_type:handler.page_type,coupon_id:info.coupon_id},was_visible=scone_item_exists(scitem_id);if(!was_visible){scone_add_item(pscone_id,scitem_id,html,sort_info);var cscone_id=_lb_fb_cpn_events_id_prefix+handler.page_type+"_"+info.coupon_id+"_"+info.ev_type_id;scone_create(cscone_id,{},lb_fb_cpn_cmp_objects.cmpEvents,null)}}
function _lb_fb_cpn_got_EVENT(data,handler,rebuild_parents,mode,create_new_scones){var info=handler.event_hash[data.ev_id],is_new_item=!info,orig_bettable,goal=false;if(is_new_item){if(mode=="date"){var parent_info=handler.day_hash[data.day_id]}else var parent_info=handler.type_hash[data.ev_type_id]}else if(mode=="date"){var parent_info=handler.day_hash[info.day_id]}else var parent_info=handler.type_hash[info.ev_type_id];if(!parent_info)return;parent_info.child_hash[data.ev_id]=true;if(is_new_item){info=data;info.page_type=handler.page_type;info.mode=mode;info.coupon_id=handler.coupon.coupon_id;info.col_keys=handler.coupon.col_keys;info.coupon_sort=handler.coupon.coupon_sort;info.shown_selections_count=0;info.goal_score_highlight=handler.cfg.goal_score_highlight;info.startup_mins=0;info.hidden=false;info.col_hash={};info.child_hash={};info.countdown_enabled=false;info.process_countdown=false;if(info.coupon_sort==''||info.coupon_sort=='FM'||info.coupon_sort=='MM'||info.coupon_sort=='MR'){info.process_countdown=true;var time_to_start=(Date.parse(info.start_time.replace(/-/g,"/"))-getServerTimeNow().getTime())/1e3;if(time_to_start<handler.cfg.event_due_off_time&&time_to_start>0){var secs_to_min=time_to_start%60,cur_min=Math.floor(time_to_start/60);if(cur_min>1){if(cur_min>60){var rem_mins=cur_min%60,rem_hours=Math.floor(cur_min/60);info.startup_mins=rem_mins;info.startup_hours=rem_hours}else{info.startup_mins=cur_min;info.startup_hours=0};info.countdown_enabled=true}}else info.countdown_enabled=false};handler.event_hash[data.ev_id]=info}else{orig_bettable=info.bettable;if(typeof info.score_home!=='undefined'&&typeof info.score_away!=='undefined'&&typeof data.score_home!=='undefined'&&typeof data.score_away!=='undefined')goal=(info.score_home!=data.score_home)||(info.score_away!=data.score_away)&&(data.score_away!=0||data.score_home!=0);for(var f in data)info[f]=data[f];info.mode=mode};var current_time=new Date(),diff=current_time-page_load_time,current_server_time=new Date();current_server_time.setTime(server_clock_timejs.getTime()+diff);info.has_mbs=_lb_fb_cpn_chk_mbs(info.special_type,info.start_time,info.suspended_at,info.is_off,current_server_time);info.name_full=info.names[handler.cfg.lang];info.start_time_disp_order=time_in_milliseconds(info.start_time);info.start_time_xl=info.start_time_xls;info.start_time_str=info.start_time.substring(11,16);info.bettable=info.status=="A";info.name=trunc_string(info.name_full,handler.cfg.name_truncate_threshold,'...');info.disp_TT_name_full=(info.name==info.name_full);if(info.tv_icon!=""){info.tv_icon_url=fb_data['img_'+info.tv_icon];info.tv_icon_txt=fb_data['xl_'+info.tv_icon]};if(info.station_icons==""){info.has_stations=false}else{info.has_stations=true;var tv_icons=info.station_icons;info.tv_icons=tv_icons.split(" ");info.tv_image_url=handler.cfg.tv_image_url};if(info.is_off=="Y"){info.url=handler.cfg.event_url+info.ev_id;info.bir_hp_url=""}else info.bir_hp_url=handler.cfg.bir_hp_url;var scitem_id=_lb_fb_cpn_event_id_prefix+handler.page_type+"_"+info.coupon_id+"_"+info.ev_id;if(mode=="date"){var pscone_id=_lb_fb_cpn_events_id_prefix+handler.page_type+"_"+info.coupon_id+"_"+info.day_id}else var pscone_id=_lb_fb_cpn_events_id_prefix+handler.page_type+"_"+info.coupon_id+"_"+info.ev_type_id;if(!scone_exists(pscone_id))return;var was_visible=scone_item_exists(scitem_id),now_visible=(info.displayed=="Y"&&info.buildable);if(now_visible&&info.process_countdown){setTimeout(function(){_lb_fb_cpn_reduce_countdown(info)},secs_to_min*1e3)}else info.countdown_enabled=false;var html=tmpl_play("lb_fb_cpn_event",info),sort_info={disporder:info.disporder,ev_type_disporder:info.ev_type_disporder,ev_id:info.ev_id,name_full:info.name_full,start_time_disp_order:info.start_time_disp_order,page_type:handler.page_type,coupon_id:info.coupon_id,parent_info:parent_info},day_elem_name=_lb_fb_cpn_day_id_prefix+handler.page_type+"_"+info.coupon_id+"_"+info.day_id,day_sort_info=scone_get_item_info(day_elem_name),type_elem_name=_lb_fb_cpn_type_id_prefix+handler.page_type+"_"+info.coupon_id+"_"+info.ev_type_id,type_sort_info=scone_get_item_info(type_elem_name);if(!was_visible&&now_visible&&create_new_scones){scone_add_item(pscone_id,scitem_id,html,sort_info);for(var c=0;c<info.col_keys.length;c++){var cscone_id=_lb_fb_cpn_selcn_holder_id_prefix+handler.page_type+"_"+info.coupon_id+"_"+info.ev_id+"_"+info.col_keys[c];scone_create(cscone_id,{},null,null)};if(rebuild_parents){_lb_fb_cpn_calc_ev_counts(handler);if(mode=="date"){if(_lb_fb_cpn_get_ev_counts(handler,"DAY",info.day_id)==1){parent_info.hidden=false;var day_html=tmpl_play("lb_fb_cpn_day",parent_info);scone_replace_item(day_elem_name,day_html,day_sort_info,true)}}else if(_lb_fb_cpn_get_ev_counts(handler,"TYPE",info.ev_type_id)==1){parent_info.hidden=false;var type_html=tmpl_play("lb_fb_cpn_type",parent_info);scone_replace_item(type_elem_name,type_html,type_sort_info,true)}}}else if(was_visible&&now_visible){scone_replace_item(scitem_id,html,sort_info,true)}else if(was_visible&&!now_visible){scone_remove_item(scitem_id);if(rebuild_parents){_lb_fb_cpn_calc_ev_counts(handler);if(mode=="date"){if(_lb_fb_cpn_get_ev_counts(handler,"DAY",info.day_id)==0){parent_info.hidden=true;var day_html=tmpl_play("lb_fb_cpn_day",parent_info);scone_replace_item(day_elem_name,day_html,day_sort_info,true)}}else if(_lb_fb_cpn_get_ev_counts(handler,"TYPE",info.ev_type_id)==0){parent_info.hidden=true;var type_html=tmpl_play("lb_fb_cpn_type",parent_info);scone_replace_item(type_elem_name,type_html,type_sort_info,true)}}};if(now_visible&&(!was_visible||orig_bettable!=info.bettable)){var force_propogate=false;if(!was_visible)force_propogate=true;for(var ev_mkt_id in info.child_hash)_lb_fb_cpn_got_EVMKT({ev_mkt_id:ev_mkt_id,ev_id:info.ev_id},handler,force_propogate,rebuild_parents,mode)};if(info.is_off=="Y")addClockEvent(info.ev_id,clockn_js,"fb_cpn_lb_clock_"+info.page_type+"_"+info.coupon_id);if(info.is_off=="Y")updatePeriodClock(info);if(goal)_lb_fb_cpn_highlight_goal(info)}
function _lb_fb_cpn_got_SCORE(data,handler){var info=handler.event_hash[data.ev_id];if(!info){info=data}else for(var f in data)info[f]=data[f];if(info.is_off=="Y")_lb_fb_cpn_got_EVENT({ev_id:info.ev_id,day_id:info.day_id},handler,false,"date")}
function _lb_fb_cpn_highlight_goal(info){var scoreline_elem_id='lb_fb_event_'+info.page_type+'_'+info.coupon_id+'_'+info.ev_id+'_scoreline',scoreline_elem=document.getElementById(scoreline_elem_id),scoretext_elem_id='lb_fb_event_'+info.page_type+'_'+info.coupon_id+'_'+info.ev_id+'_scoretext',scoretext_elem=document.getElementById(scoretext_elem_id),score_highlight_elem_id='lb_fb_event_'+info.page_type+'_'+info.coupon_id+'_'+info.ev_id,score_highlight_elem=document.getElementById(score_highlight_elem_id);$j(score_highlight_elem).find('a').addClass('score_change');scoreline_elem.style.display='none';scoretext_elem.style.display='inline';setTimeout(function(){scoreline_elem.style.display='inline';scoretext_elem.style.display='none'},info.goal_text_disp_time*1e3);setTimeout(function(){$j(score_highlight_elem).find('a').removeClass('score_change')},info.goal_score_highlight*1e3)}
function _lb_fb_cpn_got_EVMKT(data,handler,force_propogate,rebuild_parents,mode){var parent_info=handler.event_hash[data.ev_id];if(!parent_info)return;parent_info.child_hash[data.ev_mkt_id]=true;var info=handler.evmkt_hash[data.ev_mkt_id],is_new_item=!info,orig_displayed,orig_bettable,orig_hcap_values;if(is_new_item){info=data;info.page_type=handler.page_type;info.coupon_id=handler.coupon.coupon_id;info.child_hash={};handler.evmkt_hash[data.ev_mkt_id]=info}else{orig_displayed=info.displayed;orig_bettable=info.bettable;orig_hcap_values=info.hcap_values;for(var f in data)info[f]=data[f]};info.bettable=(info.status=="A")&&parent_info.bettable;if(rebuild_parents)if(orig_displayed&&orig_displayed!=info.displayed){var ev_elem_name=_lb_fb_cpn_event_id_prefix+handler.page_type+"_"+info.coupon_id+"_"+info.ev_id,ev_sort_info=scone_get_item_info(ev_elem_name),day_info=handler.day_hash[parent_info.day_id],day_elem_name=_lb_fb_cpn_day_id_prefix+handler.page_type+"_"+info.coupon_id+"_"+parent_info.day_id,day_sort_info=scone_get_item_info(day_elem_name),type_info=handler.type_hash[parent_info.ev_type_id],type_elem_name=_lb_fb_cpn_type_id_prefix+handler.page_type+"_"+info.coupon_id+"_"+parent_info.ev_type_id,type_sort_info=scone_get_item_info(type_elem_name);if(scone_item_exists(ev_elem_name)){_lb_fb_cpn_calc_selcn_counts(handler);var ev_selcn_count=_lb_fb_cpn_get_selcn_counts(handler,info.ev_id);if(orig_displayed=="Y"){parent_info.hidden=true;var ev_html=tmpl_play("lb_fb_cpn_event",parent_info);scone_replace_item(ev_elem_name,ev_html,ev_sort_info,true)}else if(orig_displayed=="N"&&ev_selcn_count>0){parent_info.hidden=false;var ev_html=tmpl_play("lb_fb_cpn_event",parent_info);scone_replace_item(ev_elem_name,ev_html,ev_sort_info,true)}};_lb_fb_cpn_calc_ev_counts(handler);if(mode=="date"){if(_lb_fb_cpn_get_ev_counts(handler,"DAY",parent_info.day_id)==0){day_info.hidden=true}else day_info.hidden=false;var day_html=tmpl_play("lb_fb_cpn_day",day_info);scone_replace_item(day_elem_name,day_html,day_sort_info,true)}else{if(_lb_fb_cpn_get_ev_counts(handler,"TYPE",parent_info.ev_type_id)==0){type_info.hidden=true}else type_info.hidden=false;var type_html=tmpl_play("lb_fb_cpn_type",type_info);scone_replace_item(type_elem_name,type_html,type_sort_info,true)}};if(orig_displayed!=info.displayed||orig_bettable!=info.bettable||_lb_fb_cpn_diff_objs_brief(orig_hcap_values,info.hcap_values)||force_propogate)for(var ev_oc_id in info.child_hash)_lb_fb_cpn_got_SELCN({ev_oc_id:ev_oc_id,ev_mkt_id:info.ev_mkt_id},handler,rebuild_parents)}
function _lb_fb_cpn_got_MHCAP(data,handler,rebuild_parents){var parent_info=handler.event_hash[data.ev_id],info=handler.evmkt_hash[data.ev_mkt_id];if(!parent_info||!info)return;for(var f in data)info[f]=data[f];for(var ev_oc_id in info.child_hash)_lb_fb_cpn_got_SELCN({ev_oc_id:ev_oc_id,ev_mkt_id:info.ev_mkt_id},handler,rebuild_parents);return}
function _lb_fb_cpn_got_SELCN(data,handler,rebuild_parents){var parent_info=handler.evmkt_hash[data.ev_mkt_id];if(!parent_info)return;parent_info.child_hash[data.ev_oc_id]=true;var info=handler.selcn_hash[data.ev_oc_id],is_new_item=!info,orig_lp_num,orig_lp_den,orig_hcap_value;if(is_new_item){info=data;info.page_type=handler.page_type;info.mode=handler.mode;info.coupon_id=handler.coupon.coupon_id;info.coupon_sort=handler.coupon.coupon_sort;info.ev_id=parent_info.ev_id;handler.selcn_hash[data.ev_oc_id]=info}else{orig_lp_num=info.lp_num;orig_lp_den=info.lp_den;orig_hcap_value=info.hcap_value;for(var f in data)info[f]=data[f]};info.name_full=info.names[handler.cfg.lang];info.name=trunc_string(info.name_full,handler.cfg.name_truncate_threshold,'...');info.has_hcap=false;info.hcap_value="";if(parent_info.hcap_values&&info.fb_result)if(parent_info.hcap_values[info.fb_result]){var rounded_hcap=parent_info.hcap_values[info.fb_result];rounded_hcap=rounded_hcap.replace(/\(/g,"");rounded_hcap=rounded_hcap.replace(/\)/g,"");var is_fraction=(rounded_hcap%1);if(is_fraction==0)rounded_hcap=Math.round(rounded_hcap);if(rounded_hcap>0)rounded_hcap="+"+rounded_hcap;rounded_hcap='('+rounded_hcap+')';info.hcap_value=rounded_hcap;info.has_hcap=true};info.bettable=(info.status=="A")&&parent_info.bettable;var event_info=handler.event_hash[info.ev_id];if(info.fb_result)event_info.col_hash[info.fb_result]=info.ev_oc_id;var scitem_id=_lb_fb_cpn_selcn_id_prefix+handler.page_type+"_"+info.coupon_id+"_"+info.ev_oc_id,pscone_id=_lb_fb_cpn_selcn_holder_id_prefix+handler.page_type+"_"+info.coupon_id+"_"+info.ev_id+"_"+info.fb_result;if(!scone_exists(pscone_id))return;info.price_str=_lb_fb_cpn_get_price_str(handler,info.lp_num,info.lp_den,parent_info.lp_avail,parent_info.mkt_sort);var html=tmpl_play("lb_fb_cpn_selcn",info),was_visible=scone_item_exists(scitem_id),now_visible=(info.displayed=="Y")&&(parent_info.displayed=="Y");if(!was_visible){scone_add_item(pscone_id,scitem_id,html,null)}else scone_replace_item(scitem_id,html,null,true);if(rebuild_parents){var ev_elem_name=_lb_fb_cpn_event_id_prefix+handler.page_type+"_"+info.coupon_id+"_"+event_info.ev_id,ev_sort_info=scone_get_item_info(ev_elem_name),day_info=handler.day_hash[event_info.day_id],day_elem_name=_lb_fb_cpn_day_id_prefix+handler.page_type+"_"+info.coupon_id+"_"+event_info.day_id,day_sort_info=scone_get_item_info(day_elem_name);if(scone_item_exists(ev_elem_name)){_lb_fb_cpn_calc_selcn_counts(handler);var ev_selcn_count=_lb_fb_cpn_get_selcn_counts(handler,event_info.ev_id);if(ev_selcn_count==0){event_info.hidden=true;var ev_html=tmpl_play("lb_fb_cpn_event",event_info);scone_replace_item(ev_elem_name,ev_html,ev_sort_info,true)}else if(parent_info.displayed=="Y"){event_info.hidden=false;var ev_html=tmpl_play("lb_fb_cpn_event",event_info);scone_replace_item(ev_elem_name,ev_html,ev_sort_info,true)}};_lb_fb_cpn_calc_ev_counts(handler);if(info.mode=="date"){if(_lb_fb_cpn_get_ev_counts(handler,"DAY",event_info.day_id)==0){day_info.hidden=true}else day_info.hidden=false;var day_html=tmpl_play("lb_fb_cpn_day",day_info);scone_replace_item(day_elem_name,day_html,day_sort_info,true)}else{if(_lb_fb_cpn_get_ev_counts(handler,"TYPE",event_info.ev_type_id)==0){type_info.hidden=true}else type_info.hidden=false;var type_html=tmpl_play("lb_fb_cpn_type",type_info);scone_replace_item(type_elem_name,type_html,type_sort_info,true)}};if(!is_new_item&&now_visible&&info.bettable)_lb_fb_cpn_highlight_price_change(handler,info.ev_oc_id,info.lp_num,info.lp_den,orig_lp_num,orig_lp_den)}
function _lb_fb_cpn_got_PRICE(data,handler,rebuild_parents){var info=handler.selcn_hash[data.ev_oc_id];if(!info)return;var parent_info=handler.evmkt_hash[info.ev_mkt_id];if(!parent_info)return;var orig_lp_num=info.lp_num,orig_lp_den=info.lp_den;for(var f in data)info[f]=data[f];var price_id=_lb_fb_cpn_selcn_link_id_prefix+handler.page_type+"_"+info.coupon_id+"_"+info.ev_oc_id,price_el=document.getElementById(price_id);if(!price_el)return;if(info.displayed!="Y")return;if(info.status!="A")return;info.price_str=_lb_fb_cpn_get_price_str(handler,info.lp_num,info.lp_den,parent_info.lp_avail,parent_info.mkt_sort);if(info.has_hcap){price_el.innerHTML="<span class='handicap-figure'>"+info.hcap_value+"</span><br/>"+info.price_str}else price_el.innerHTML=info.price_str;if(info.bettable)_lb_fb_cpn_highlight_price_change(handler,info.ev_oc_id,info.lp_num,info.lp_den,orig_lp_num,orig_lp_den);return}
function _lb_fb_cpn_get_price_str(handler,lp_num,lp_den,lp_avail,mkt_sort){if(typeof lp_avail=="undefined")lp_avail="Y";if(typeof mkt_sort=="undefined")mkt_sort="--";var price_str_type=handler.cfg.price_str_type;if(mkt_sort=="AH"&&handler.cfg.price_str_type_ah!="")price_str_type=handler.cfg.price_str_type_ah;if(mkt_sort=="HL"&&handler.cfg.price_str_type_hl!="")price_str_type=handler.cfg.price_str_type_hl;if(lp_avail=="N")return"SP";if(lp_num==""&&lp_den=="")return"-";var price_str;if(price_str_type=="DECIMAL"){var dps=(lp_den>100)?3:2,dp=1.0+(lp_num/lp_den),scaled_dp=""+Math.round(dp*Math.pow(10,dps)-0.5),int_part=scaled_dp.substr(0,scaled_dp.length-dps),frac_part=scaled_dp.substr(scaled_dp.length-dps);if(int_part=="")int_part="";if(frac_part=="")frac_part="";var price_str=int_part+"."+frac_part}else{if(lp_den=="")lp_den=1;if(lp_num==lp_den){price_str="evens"}else price_str=lp_num+handler.cfg.price_str_sep+lp_den};return price_str}
function _lb_fb_cpn_highlight_price_change(handler,ev_oc_id,lp_num,lp_den,old_lp_num,old_lp_den){if(isNaN(lp_num)||isNaN(old_lp_num))return;var d=lp_num*old_lp_den-lp_den*old_lp_num;if(d==0)return;var price_id=_lb_fb_cpn_selcn_id_prefix+handler.page_type+"_"+handler.coupon.coupon_id+"_"+ev_oc_id;_lb_fb_cpn_highlight(handler,price_id,_lb_fb_cpn_selcn_base_class,d);return}
function _lb_fb_cpn_highlight(handler,id,base_class,dir){var el=document.getElementById(id);if(!el)return;var highlight_class="";if(dir<0){highlight_class=base_class+handler.cfg.hl_class_decrease}else if(dir>0){highlight_class=base_class+handler.cfg.hl_class_increase}else highlight_class=base_class+handler.cfg.hl_class_same;var classes=el.className.split(" "),found=false;for(var i=0;i<classes.length;i++)if(classes[i]==base_class+handler.cfg.hl_class_same||classes[i]==base_class+handler.cfg.hl_class_increase||classes[i]==base_class+handler.cfg.hl_class_decrease){classes[i]=highlight_class;found=true;break};if(!found)classes.push(highlight_class);el.className=classes.join(" ");if(_lb_fb_cpn_hl_timers[id]!=null){window.clearTimeout(_lb_fb_cpn_hl_timers[id]);delete _lb_fb_cpn_hl_timers[id]};var self=this;if(dir!=0)_lb_fb_cpn_hl_timers[id]=window.setTimeout(function(){self._lb_fb_cpn_highlight(handler,id,base_class,0)},handler.cfg.highlight_duration);return}
function lb_fb_cpn_add_bet(ev_oc_id,page_type,coupon_id){var handler=_lb_fb_cpn_hash[page_type+coupon_id],selcn=handler.selcn_hash[ev_oc_id];if(selcn.bettable){var evmkt=handler.evmkt_hash[selcn.ev_mkt_id];BS_set_leg("selections",ev_oc_id);BS_set_leg("price_type","L");BS_set_leg("lp_num",selcn.lp_num);BS_set_leg("lp_den",selcn.lp_den);BS_set_leg("hcap_value",evmkt.raw_hcap);BS_set_leg("bir_index",evmkt.bir_index);BS_set_leg("market_tags","");BS_set_leg('bet_origin',page_type.toUpperCase());BS_go_bet()};return}
function _lb_fb_cpn_calc_ev_counts(handler){handler.ev_count={};var total_ev_count=0;if(handler.mode=="date"){var handler_hash=handler.day_hash,mode_name="DAY"}else{var handler_hash=handler.type_hash,mode_name="TYPE"};for(var hash_id in handler_hash){var hash_ev_count=0,hash_elem_name=_lb_fb_cpn_events_id_prefix+handler.page_type+"_"+handler.coupon.coupon_id+"_"+hash_id;if(scone_exists(hash_elem_name)){var evs=scone_get_items(hash_elem_name);for(var e=0;e<evs.length;e++)if(document.getElementById(evs[e]).style.display=="")hash_ev_count++;total_ev_count+=hash_ev_count;handler.ev_count[mode_name+hash_id]=hash_ev_count}};handler.ev_count["ALL"]=total_ev_count;if(total_ev_count==0){document.getElementById(_lb_fb_cpn_coupon_area_no_selns_prefix+handler.page_type).style.display="";document.getElementById(_lb_fb_cpn_coupon_area_prefix+handler.page_type).style.display="none"}else{document.getElementById(_lb_fb_cpn_coupon_area_no_selns_prefix+handler.page_type).style.display="none";document.getElementById(_lb_fb_cpn_coupon_area_prefix+handler.page_type).style.display=""}}
function _lb_fb_cpn_get_ev_counts(handler,level,id){var count=handler.ev_count[level+id];if(count){return count}else return 0}
function _lb_fb_cpn_calc_selcn_counts(handler){handler.selcn_count={};for(var ev_oc_id in handler.selcn_hash){var selcn_info=handler.selcn_hash[ev_oc_id];if(selcn_info){var ev_id=selcn_info.ev_id;if(!handler.selcn_count[ev_id])handler.selcn_count[ev_id]=0;if(selcn_info.displayed=="Y")handler.selcn_count[ev_id]=handler.selcn_count[ev_id]+1}}}
function _lb_fb_cpn_get_selcn_counts(handler,ev_id){var count=handler.selcn_count[ev_id];if(count){return count}else return 0}
function _lb_fb_cpn_diff_objs_brief(a,b){for(var f in a)if(b[f]==undefined)return true;for(var f in b)if(a[f]==undefined)return true;for(var f in a){if(b[f]==undefined)continue;var va=a[f],vb=b[f];if(typeof va!=typeof vb){return true}else if(typeof va=="object"){if(_lb_fb_cpn_diff_objs_brief(va,vb))return true}else if(va!=vb)return true};return false}
function _lb_fb_cpn_chk_mbs(special_type,start_time,suspend_at,is_off,current_time){switch(special_type){case"MBR":case"MBC":case"MBN":case"MBS":if(typeof suspend_at!="undefined"&&new Date(suspend_at)<=current_time)return 0;if(special_type=="MBS")return 1;if(is_off=="Y")if(special_type=="MBR"){return 1}else return 0;var start_date=Date.parse(start_time.replace(/-/g,"/"));if(start_date>current_time)if(special_type=="MBN"||special_type=="MBC"){return 1}else return 0;break};return 0}
function _lb_fb_cpn_schedule_reload(page_type,coupon_id,reload_period){document.PollingAjaxHelper.clearInterval("_lb_fb_cpn_schedule_reload");document.PollingAjaxHelper.setInterval("_lb_fb_cpn_schedule_reload",function(){lb_fb_cpn_reload(page_type,coupon_id)},reload_period)}
function lb_fb_cpn_reload(page_type,coupon_id,show_all,refresh){var handler=_lb_fb_cpn_hash[page_type+coupon_id];if(show_all){var show_all=1}else var show_all=0;if(refresh){var play_type="refresh";if(handler.coupon.showing_all)show_all=1}else var play_type="js";var clientdata={id:'lb_fb_coupon_area_'+page_type+'_js'},url=handler.coupon.reload_url+"&cust_hash="+handler.cfg.reload_hash+"&page_type="+page_type+"&coupon_id="+coupon_id+"&play_type="+play_type+"&show_all="+show_all+"&mode="+handler.mode;_lb_fb_cpn_make_ajax_get_request(url,clientdata,_lb_fb_cpn_got_ajax_content)}
function _lb_fb_cpn_make_ajax_get_request(url,clientdata,callback){if(document.PollingAjaxHelper.checkSemaphore()){document.PollingAjaxHelper.setTimeout("_lb_fb_cpn_make_ajax_get_request"+clientdata.id,function(){_lb_fb_cpn_got_ajax_content(url,clientdata,callback)},300);return};document.PollingAjaxHelper.aquireSemaphore();var req=null;if(window.XMLHttpRequest){req=new XMLHttpRequest()}else if(window.ActiveXObject)req=new ActiveXObject('Microsoft.XMLHTTP');if(req){req.onreadystatechange=function(){if(req.readyState!=4)return;var reqStatus;try{reqStatus=req.status}catch(e){reqStatus=''};if(reqStatus!=200){document.PollingAjaxHelper.releaseSemaphore();callback(url,clientdata,false,'HTTP')}else{document.PollingAjaxHelper.releaseSemaphore();callback(url,clientdata,true,req.responseText)}};try{req.open('GET',url,true);req.send(null)}catch(e){document.PollingAjaxHelper.releaseSemaphore();callback(url,clientdata,false,'UNSUPPORTED')}}else{document.PollingAjaxHelper.releaseSemaphore();callback(url,clientdata,false,'UNSUPPORTED')}}
function _lb_fb_cpn_got_ajax_content(url,clientdata,ok,response){var holder_el=document.getElementById(clientdata.id);if(ok){if(response==""||response==null)return;var parts=_lb_fb_cpn_parse_script_tags(response);if(holder_el)holder_el.innerHTML=parts[0];if(parts[1].length)try{_lb_fb_cpn_global_eval(parts[1])}catch(e){ok=false}}}
function _lb_fb_cpn_parse_script_tags(str){var html='',js='',i=0,state='HTML',script_re=new RegExp('<(/?)script([^>]*)>','gi');while((mtch=script_re.exec(str))!=null){mS=mtch.index;if(state=='HTML'){html+=str.substring(i,mS)}else js+=str.substring(i,mS)+';\n';var closer=mtch[1],attrs=mtch[2];if(closer=='/'){state='HTML'}else if(attrs.charAt(attrs.length-1)!='/'&&attrs.indexOf('src=')==-1)state='JS';i=script_re.lastIndex};if(state=='HTML'){html+=str.substring(i)}else js+=str.substring(i);return[html,js]};var _lb_fb_cpn_global_eval=function(src){if(window.execScript){window.execScript(src);return};var fn=function(){window.eval.call(window,src)};fn()}
function _lb_fb_cpn_prune_events(handler,prune_events){var ev_hash=handler.event_hash;for(ev_id in ev_hash){var ev_exists=prune_events[ev_id];if(!ev_exists)_lb_fb_cpn_remove_EVENT(handler,ev_id)}}
function _lb_fb_cpn_remove_EVENT(handler,ev_id){var scitem_id="",info=handler.event_hash[ev_id],parent_info=handler.day_hash[info.day_id];scitem_id=_lb_fb_cpn_event_id_prefix+handler.page_type+"_"+info.coupon_id+"_"+info.ev_id;scone_remove_item(scitem_id);for(var ev_mkt_id in info.child_hash)if(handler.evmkt_hash[ev_mkt_id]){for(var ev_oc_id in handler.evmkt_hash[ev_mkt_id].child_hash)if(handler.selcn_hash[ev_oc_id])delete handler.selcn_hash[ev_oc_id];delete handler.evmkt_hash[ev_mkt_id]};delete handler.event_hash[ev_id];delete parent_info.child_hash[ev_id];delete handler.selcn_count[ev_id];if(handler.score_hash[ev_id])delete handler.score_hash[ev_id]}
function _lb_fb_cpn_do_more_evs_link(lb_fb_cpn,mode){var scitem_id=_lb_fb_cpn_more_evs_id+"_"+lb_fb_cpn.page_type+"_"+lb_fb_cpn.coupon.coupon_id;if(mode=="date"){var pscone_id=_lb_fb_cpn_days_id_prefix+lb_fb_cpn.page_type+"_"+lb_fb_cpn.coupon.coupon_id}else var pscone_id=_lb_fb_cpn_types_id_prefix+lb_fb_cpn.page_type+"_"+lb_fb_cpn.coupon.coupon_id;if(!scone_exists(pscone_id))return;var html=tmpl_play("lb_fb_cpn_more_events",{page_type:lb_fb_cpn.page_type,coupon_id:lb_fb_cpn.coupon.coupon_id}),was_visible=scone_item_exists(scitem_id),now_visible=(lb_fb_cpn.cfg.max_num_events!=0);if(!was_visible&&now_visible){scone_add_item(pscone_id,scitem_id,html,null,1)}else if(was_visible&&!now_visible)scone_remove_item(scitem_id)}
function _lb_fb_cpn_sort_events(handler,events){var tempscone={items:[],cmpFn:function(cmp_mode,evA,evB){var r;if(cmp_mode=="type"){r=lb_fb_cpn_cmp_objects.cmpTypes(cmp_mode,evA,evB)}else r=lb_fb_cpn_cmp_objects.cmpDays(cmp_mode,evA,evB);if(r==0)r=lb_fb_cpn_cmp_objects.cmpEvents(cmp_mode,evA,evB);return r},cmpMode:handler.mode},sorted_events=[];for(var i=0;i<events.length;i++){var info=events[i],sort_info={day_id:info.day_id,ev_type_disporder:info.ev_type_disporder,ev_type_name:info.ev_type_name,page_type:handler.page_type,coupon_id:handler.coupon.coupon_id,disporder:info.disporder,ev_id:info.ev_id,name_full:info.names[handler.cfg.lang],start_time_disp_order:time_in_milliseconds(info.start_time)},idx=_scone_find_ipos(tempscone,sort_info);tempscone.items.splice(idx,0,{info:sort_info});sorted_events.splice(idx,0,events[i])};return sorted_events}
function lb_fb_cpn_view_all_events(page_type,coupon_id){var lb_fb_cpn=_lb_fb_cpn_hash[page_type+coupon_id];lb_fb_cpn.cfg.max_num_events=0;lb_fb_cpn_init("","html",page_type,lb_fb_cpn.coupon,"","","","","","","","","",lb_fb_cpn_msg_id,lb_fb_cpn.mode,1,"");tooltip_init();event_betslip()}
function fb_pn_go_sort_by(mode,fb_tab_id,fb_page_type){if(mode=='date'){document.getElementById('pnav_date').className='pressed';document.getElementById('pnav_date_lbl').className='pressed';document.getElementById('pnav_type').className='';document.getElementById('pnav_type_lbl').className=''}else{document.getElementById('pnav_date').className='';document.getElementById('pnav_date_lbl').className='';document.getElementById('pnav_type').className='pressed';document.getElementById('pnav_type_lbl').className='pressed'};if(content_tab_modes[fb_tab_id]!=mode){lb_fb_cpn_init(fb_tab_id,"html",fb_page_type,content_tab_coupons[fb_tab_id],"","","","","","","","","",lb_fb_cpn_msg_id,mode,1,"");content_tab_modes[fb_tab_id]=mode;tooltip_init();event_betslip()}}
function fix_ie_hover_fb(action){if(action=='hover'){if(document.getElementById('pnav_date').className=='')document.getElementById('pnav_date_lbl').className='pressed'}else if(document.getElementById('pnav_type').className=='pressed')document.getElementById('pnav_type_lbl').className=''}
function change_coupon(coupon,loading_text,base_fb_url){if(active_coupon==coupon)return;if(tab_loaded);else document.getElementById("lb_fb_coupon_area_matches").innerHTML='<div class="notes"><p>'+loading_text+'</p></div>';if(coupon=="LiveMatches"){document.getElementById("todays_matches_cpn").className="";document.getElementById("live_matches_cpn").className="active";var url=base_fb_url+"?action=go_live_matches_ajax&mode="+content_tab_modes[coupon]}else{document.getElementById("todays_matches_cpn").className="active";document.getElementById("live_matches_cpn").className="";var url=base_fb_url+"?action=go_todays_matches_ajax&mode="+content_tab_modes[coupon]};active_coupon=coupon;var clientdata={id:"lb_fb_coupon_area_matches"};_lb_fb_cpn_make_ajax_get_request(url,clientdata,_lb_fb_cpn_got_ajax_content);set_pnav_button_pressed(coupon)}
function set_pnav_button_pressed(coupon){if(content_tab_modes[coupon]=='date'){document.getElementById('pnav_date').className='pressed';document.getElementById('pnav_date_lbl').className='pressed';document.getElementById('pnav_type').className='';document.getElementById('pnav_type_lbl').className=''}else{document.getElementById('pnav_date').className='';document.getElementById('pnav_date_lbl').className='';document.getElementById('pnav_type').className='pressed';document.getElementById('pnav_type_lbl').className='pressed'}}
function _lb_fb_cpn_get_col_price(cpn_handler,ev_id,col){var ev_info=cpn_handler.event_hash[ev_id],sel_info=cpn_handler.selcn_hash[ev_info.col_hash[col]],price_obj={};if(sel_info!=undefined){price_obj.lp_num=sel_info.lp_num;price_obj.lp_den=sel_info.lp_den}else{price_obj.lp_num=0;price_obj.lp_den=0};return price_obj}
function lb_fb_cpn_do_sort(page_type,mode,coupon_id,id,column){var cpn_info=_lb_fb_cpn_hash[page_type+coupon_id],info,elem='';if(mode=='date'){info=cpn_info.day_hash[id]}else if(mode=='type'){info=cpn_info.type_hash[id]}else return;elem=_lb_fb_cpn_events_id_prefix+page_type+"_"+coupon_id+"_"+id;if(info.sort_col!=column){info.sort_direction=1;info.sort_col=column}else info.sort_direction=-1*info.sort_direction;scone_sort(elem,"manual",true)}
function _lb_fb_cpn_reduce_countdown(info){var time_to_start=(Date.parse(info.start_time.replace(/-/g,"/"))-getServerTimeNow().getTime())/1e3,handler=_lb_fb_cpn_hash[info.page_type+info.coupon_id];if(!info.countdown_enabled)return;if(time_to_start<handler.cfg.event_due_off_time&&time_to_start>0){var cur_min=Math.floor(time_to_start/60);if(cur_min>1){if(cur_min>60){var rem_mins=cur_min%60,rem_hours=Math.floor(cur_min/60);info.startup_mins=rem_mins;info.startup_hours=rem_hours}else{info.startup_mins=cur_min;info.startup_hours=0};var time_string=info.startup_mins+tmpl_xl("FB_COUNTDOWN_MIN"),cd_elem_id='lb_fb_event_'+info.page_type+'_'+info.coupon_id+'_'+info.ev_id+'_cd',cd_elem=document.getElementById(cd_elem_id);cd_elem.innerHTML=time_string;setTimeout(function(){_lb_fb_cpn_reduce_countdown(info)},60*1e3)}else info.countdown_enabled=false}}
function fb_hp_other_init(classes,types,cfg){var fb_hp_other=new fb_hp_other_mkts_object();for(var f in cfg)fb_hp_other.cfg[f]=cfg[f];_fb_hp_other_store_templates();fb_hp_other.class_hash={};fb_hp_other.type_hash={};scone_create(_fb_hp_other_area,{},_fb_hp_other_cmp_classes,null);for(var i=0;i<classes.length;i++)if(!fb_hp_other.class_hash[classes[i].ev_class_id])_fb_hp_other_got_CLASS(classes[i],fb_hp_other);for(var i=0;i<types.length;i++)if(!fb_hp_other.type_hash[types[i].ev_type_id])_fb_hp_other_got_TYPE(types[i],fb_hp_other)};var _fb_hp_other_area="fb_other_markets",_fb_hp_other_markets_prefix="fb_hp_other_mkt_",_fb_hp_other_markets_class_prefix="fb_hp_other_class_",_fb_hp_other_markets_types_prefix="fb_hp_other_types_",_fb_hp_other_markets_type_prefix="fb_hp_other_type_"
function _fb_hp_other_store_templates(){var tmp=[];tmp.push('	<div id="fb_hp_other_class_<%ev_class_id%>" class="fb_day_type_wrapper">\n');tmp.push('		<div class="fb_hdr"><h2><%name%></h2></div>\n');tmp.push('		<div class="other_market_list clear"><table><tbody id="fb_hp_other_types_<%ev_class_id%>"></tbody></table></div>\n');tmp.push('	</div>\n');tmpl_store("fb_hp_other_class",tmp.join(""));var tmp=[];tmp.push('	<tr id="fb_hp_other_type_<%ev_type_id%>">\n');tmp.push('		<td><%IF coupon_url!=""%><a href="<%coupon_url%>"><%markets_name%></a><%ELSE%>&nbsp;<%END%></td>\n');tmp.push('		<td><%IF ev_oc_grp_url!=""%><a href="<%ev_oc_grp_url%>"><%outrights_name%></a><%ELSE%>&nbsp;<%END%></td>\n');tmp.push('	</tr>\n');tmpl_store("fb_hp_other_type",tmp.join(""))}
function fb_hp_other_mkts_object(){this.cfg={lang:"en",name_truncate_threshold:50};return}
function _fb_hp_other_got_CLASS(data,handler){var info=handler.class_hash[data.ev_class_id],is_new_item=!info,orig_bettable;if(is_new_item){info=data;handler.class_hash[data.ev_class_id]=info;info.child_hash={}}else{orig_bettable=info.bettable;for(var f in data)info[f]=data[f]};info.name=info.names[handler.cfg.lang];info.full_name=info.name;info.name=trunc_string(info.name,handler.cfg.name_truncate_threshold,'...');var scitem_id=_fb_hp_other_markets_class_prefix+info.ev_class_id,pscone_id=_fb_hp_other_area;if(!scone_exists(pscone_id))return;var html=tmpl_play("fb_hp_other_class",info);scone_add_item(pscone_id,scitem_id,html,info);var cscone_id=_fb_hp_other_markets_types_prefix+info.ev_class_id;scone_create(cscone_id,{},_fb_hp_other_cmp_types,null)}
function _fb_hp_other_got_TYPE(data,handler){var info=handler.type_hash[data.ev_type_id],is_new_item=!info,orig_bettable;if(is_new_item){info=data;handler.type_hash[data.ev_type_id]=info;info.child_hash={}}else{orig_bettable=info.bettable;for(var f in data)info[f]=data[f]};info.name=info.names[handler.cfg.lang];info.full_name=info.name;info.name=trunc_string(info.name,handler.cfg.name_truncate_threshold,'...');info.markets_name=info.other_mkts_names[handler.cfg.lang];info.full_markets_name=info.markets_name;info.markets_name=trunc_string(info.markets_name,handler.cfg.name_truncate_threshold,'...');info.outrights_name=info.other_mkts_outrights[handler.cfg.lang];info.full_outrights_name=info.outrights_name;info.outrights_name=trunc_string(info.outrights_name,handler.cfg.name_truncate_threshold,'...');if(!info.coupon_url)info.coupon_url="";if(!info.ev_oc_grp_url)info.ev_oc_grp_url="";var scitem_id=_fb_hp_other_markets_type_prefix+info.ev_type_id,pscone_id=_fb_hp_other_markets_types_prefix+info.ev_class_id;if(!scone_exists(pscone_id))return;var html=tmpl_play("fb_hp_other_type",info);scone_add_item(pscone_id,scitem_id,html,info)}
function _fb_hp_other_cmp_classes(cmpMode,evA,evB){var d=evA.disporder-evB.disporder;if(d<0){return-1}else if(d==0){return 0}else return 1}
function _fb_hp_other_cmp_types(cmpMode,evA,evB){var d=evA.disporder-evB.disporder;if(d<0){return-1}else if(d==0){return 0}else return 1};var _fb_hp_other_area
function fb_hp_other_nav_ls_init(data,parent_scone_name,item_type,cfg){_fb_hp_other_area=parent_scone_name;var fb_hp_other=new fb_hp_other_nav_object();for(var f in cfg)fb_hp_other.cfg[f]=cfg[f];_fb_hp_other_nav_store_templates();fb_hp_other.data_hash={};if(item_type=="market"){if(scone_exists(_fb_hp_other_area))scone_delete(_fb_hp_other_area);scone_create(_fb_hp_other_area,{},_fb_hp_other_cmp_markets,null)}else scone_create(_fb_hp_other_area,{},_fb_hp_other_cmp,null);for(var i=0;i<data.length;i++)if(item_type=="competition"){if(!fb_hp_other.data_hash[data[i].id])_fb_hp_other_got_COMP(data[i],fb_hp_other)}else if(item_type=="market"){if(!fb_hp_other.data_hash[data[i].ev_type_id])_fb_hp_other_got_MARKET(data[i],fb_hp_other)}else if(item_type=="coupon"){if(!fb_hp_other.data_hash[data[i].coupon_id])_fb_hp_other_got_COUPON(data[i],fb_hp_other)}else if(item_type=="funcoupon")if(!fb_hp_other.data_hash[data[i].coupon_id])_fb_hp_other_got_FUNCOUPON(data[i],fb_hp_other)};var _fb_hp_other_types_prefix="fb_hp_other_type_",_fb_hp_other_markets_prefix="fb_hp_other_market_",_fb_hp_other_coupons_prefix="fb_hp_other_coupon_"
function _fb_hp_other_nav_store_templates(){var tmp=[];tmp.push('	<div id="fb_hp_other_type_<%ev_type_id%>" class="general live_matches" style="display:">\n');tmp.push('		<%IF full_name != name%>');tmp.push('			<span class="tooltip"><%full_name%></span>\n');tmp.push('		<%END%>');tmp.push('		<%name%>\n');tmp.push('		<div class="matches_outrights">\n');tmp.push('			<%IF coupon_url!=""%><a href="<%coupon_url%>"><span class="tooltip"><%XL FOOTBALL_MATCHES_TOOLTIP%></span><%XL FOOTBALL_MATCHES%></a><%END%>\n');tmp.push('			<%IF coupon_url!="" && ev_oc_grp_url!="" %> | <%END%>');tmp.push('			<%IF ev_oc_grp_url!=""%><a href="<%ev_oc_grp_url%>"><span class="tooltip"><%XL FOOTBALL_OUTRIGHT_TOOLTIP%></span><%XL FOOTBALL_OUTRIGHT%></a><%END%>\n');tmp.push('		</div>\n');tmp.push('	</div>\n');tmpl_store("fb_hp_other_type",tmp.join(""));var tmp=[];tmp.push('	<div id="fb_hp_other_market_<%id%>" class="general" style="display:">\n');tmp.push('			<a href="<%cpn_url%>">\n');tmp.push('				<%IF full_name != name%>');tmp.push('					<span class="tooltip"><%full_name%></span>\n');tmp.push('				<%END%>');tmp.push('				<%name%>\n');tmp.push('			</a>\n');tmp.push('	</div>\n');tmpl_store("fb_hp_other_market",tmp.join(""));var tmp=[];tmp.push('	<div id="fb_hp_other_coupon_<%coupon_id%>" class="general" style="display:">\n');tmp.push('			<a href="<%url%>">\n');tmp.push('				<%IF full_name != coupon_name%>');tmp.push('					<span class="tooltip"><%full_name%></span>\n');tmp.push('				<%END%>');tmp.push('				<%coupon_name%>\n');tmp.push('			</a>\n');tmp.push('	</div>\n');tmpl_store("fb_hp_other_coupon",tmp.join(""))}
function fb_hp_other_nav_object(){this.cfg={lang:"en",name_truncate_threshold:50,url:""};return}
function _fb_hp_other_got_COMP(data,handler){var info=handler.data_hash[data.ev_type_id],is_new_item=!info,orig_bettable;if(is_new_item){info=data;handler.data_hash[data.ev_type_id]=info;info.child_hash={}}else{orig_bettable=info.bettable;for(var f in data)info[f]=data[f]};info.name=info.names[handler.cfg.lang];info.full_name=info.name;info.name=trunc_string(info.name,handler.cfg.name_truncate_threshold,'...');if(!info.coupon_url)info.coupon_url="";if(!info.ev_oc_grp_url)info.ev_oc_grp_url="";var scitem_id=_fb_hp_other_types_prefix+info.ev_type_id,pscone_id=_fb_hp_other_area;if(!scone_exists(pscone_id))return;var html=tmpl_play("fb_hp_other_type",info);scone_add_item(pscone_id,scitem_id,html,info)}
function _fb_hp_other_got_MARKET(data,handler){var info=handler.data_hash[data.id],is_new_item=!info,orig_bettable;if(is_new_item){info=data;handler.data_hash[data.id]=info;info.child_hash={}}else{orig_bettable=info.bettable;for(var f in data)info[f]=data[f]};info.full_name=info.name;info.name=trunc_string(info.name,handler.cfg.name_truncate_threshold,'...');if(handler.cfg.url.search(/\?/)==-1){info.cpn_url=handler.cfg.url+'?ev_oc_grp_ids='}else info.cpn_url=handler.cfg.url+'&ev_oc_grp_ids=';for(var i=0;i<info.grp_ids.length;i++){if(i!=0)info.cpn_url=info.cpn_url+',';info.cpn_url=info.cpn_url+info.grp_ids[i]};var scitem_id=_fb_hp_other_markets_prefix+info.id,pscone_id=_fb_hp_other_area;if(!scone_exists(pscone_id))return;var html=tmpl_play("fb_hp_other_market",info);scone_add_item(pscone_id,scitem_id,html,info)}
function _fb_hp_other_got_COUPON(data,handler){var info=handler.data_hash[data.coupon_id],is_new_item=!info,orig_bettable;if(is_new_item){info=data;handler.data_hash[data.coupon_id]=info;info.child_hash={}}else{orig_bettable=info.bettable;for(var f in data)info[f]=data[f]};info.full_name=info.coupon_name;info.coupon_name=trunc_string(info.coupon_name,handler.cfg.name_truncate_threshold,'...');if(!info.url)info.url="";var scitem_id=_fb_hp_other_coupons_prefix+info.coupon_id,pscone_id=_fb_hp_other_area;if(!scone_exists(pscone_id))return;var html=tmpl_play("fb_hp_other_coupon",info);scone_add_item(pscone_id,scitem_id,html,info)}
function _fb_hp_other_got_FUNCOUPON(data,handler){var info=handler.data_hash[data.coupon_id],is_new_item=!info,orig_bettable;if(is_new_item){info=data;handler.data_hash[data.coupon_id]=info;info.child_hash={}}else{orig_bettable=info.bettable;for(var f in data)info[f]=data[f]};info.full_name=info.coupon_name;info.coupon_name=trunc_string(info.coupon_name,handler.cfg.name_truncate_threshold,'...');if(!info.url)info.url="";var scitem_id=_fb_hp_other_coupons_prefix+info.coupon_id,pscone_id=_fb_hp_other_area;if(!scone_exists(pscone_id))return;var html=tmpl_play("fb_hp_other_funcoupon",info);scone_add_item(pscone_id,scitem_id,html,info)}
function _fb_hp_other_cmp_markets(cmpMode,evA,evB){var d=evA.grp_order-evB.grp_order;if(d<0){return-1}else if(d==0){var dd=(evA.full_name<=evB.full_name?-1:1);return dd}else return 1}
function _fb_hp_other_cmp(cmpMode,evA,evB){var d=evA.disporder-evB.disporder;if(d<0){return-1}else if(d==0){var dd=(evA.full_name<=evB.full_name?-1:1);return dd}else return 1}
function fb_hp_nav_init(nav_id,tab_id,groups,evocgroups,cfg){if(nav_id=='')return;var lb_fb_nav_tab=_lb_fb_nav_tab_hash[tab_id+"_"+nav_id];if(!lb_fb_nav_tab){lb_fb_nav_tab=new lb_fb_nav_tab_object();lb_fb_nav_tab.tab_id=tab_id;lb_fb_nav_tab.nav_id=nav_id;for(var f in cfg)lb_fb_nav_tab.cfg[f]=cfg[f];_fb_nav_tab_store_templates();_lb_fb_nav_tab_hash[tab_id+"_"+nav_id]=lb_fb_nav_tab;lb_fb_nav_tab.grp_hash={};lb_fb_nav_tab.mkt_hash={}};var tab_el_id=_fb_nav_tab_prefix+tab_id+"_nav_"+nav_id+"_container";scone_create(tab_el_id,{},_fb_nav_tab_cmp_groups,null);for(var i=0;i<groups.length;i++)if(!lb_fb_nav_tab.grp_hash[groups[i].ev_mkt_grp_id])_fb_nav_tab_got_GROUP(groups[i],lb_fb_nav_tab);for(var i=0;i<evocgroups.length;i++)if(!lb_fb_nav_tab.mkt_hash[evocgroups[i].ev_mkt_grp_id+"_"+evocgroups[i].ev_oc_grp_id])_fb_nav_tab_got_EVOCGROUP(evocgroups[i],lb_fb_nav_tab);for(var i=0;i<groups.length;i++)_fb_nav_tab_add_clear_div(groups[i],lb_fb_nav_tab)};var _fb_nav_tab_prefix="fb_tab_",_fb_nav_tab_group_prefix="fb_nav_tab_group_",_fb_nav_tab_evocgroups_prefix="fb_nav_tab_evocgroups_",_fb_nav_tab_evocgroup_prefix="fb_nav_tab_evocgroup_",_lb_fb_nav_tab_hash={}
function _fb_nav_tab_store_templates(){var tmp=[];tmp.push('	<div class="item" id="fb_nav_tab_group_<%tab_id%>_<%nav_id%>_<%ev_mkt_grp_id%>">\n');tmp.push('		<div class="itemHeader"><a onclick="lb_nav_tab_toggle_collapse(this,\'<%tab_id%>\',\'<%nav_id%>\',\'<%ev_mkt_grp_id%>\')" href="javascript:void(0)" class="<%IF expanded%>on<%ELSE%>off<%END%>"><%name%>&nbsp;<span id = "fb_nav_tab_mkt_count_<%tab_id%>_<%nav_id%>_<%ev_mkt_grp_id%>">(0)</span></a></div>\n');tmp.push('		<div <%IF !expanded%>style="display: none;"<%END%> class="itemContent" id="fb_nav_tab_evocgroups_<%tab_id%>_<%nav_id%>_<%ev_mkt_grp_id%>"></div>\n');tmp.push('	</div>\n');tmpl_store("fb_hp_nav_tab_group",tmp.join(""));var tmp=[];tmp.push('	<div class="cell even" id="fb_nav_tab_evocgroup_<%tab_id%>_<%nav_id%>_<%ev_mkt_grp_id%>_<%ev_oc_grp_id%>">\n');tmp.push('		<div class="market"><a href="<%dd_url%>"><%name%></a></div>\n');tmp.push('	</div>\n');tmpl_store("fb_nav_tab_evocgroup",tmp.join(""))}
function lb_nav_tab_toggle_collapse(elem,tab_id,nav_id,ev_mkt_grp_id){var data_elem=document.getElementById("fb_nav_tab_evocgroups_"+tab_id+"_"+nav_id+"_"+ev_mkt_grp_id);if(elem.className=="on"){elem.className="off";data_elem.style.display="none"}else{elem.className="on";data_elem.style.display=""}}
function lb_fb_nav_tab_object(){this.cfg={lang:"en",name_truncate_threshold:50};return}
function _fb_nav_tab_got_GROUP(data,handler){var info=handler.grp_hash[data.ev_mkt_grp_id],is_new_item=!info;if(is_new_item){info=data;handler.grp_hash[data.ev_mkt_grp_id]=info;info.child_hash={};info.evocgrp_num=0}else for(var f in data)info[f]=data[f];info.tab_id=handler.tab_id;info.nav_id=handler.nav_id;info.name=info.names[handler.cfg.lang];info.full_name=info.name;info.name=trunc_string(info.name,handler.cfg.name_truncate_threshold,'...');var scitem_id=_fb_nav_tab_group_prefix+info.tab_id+"_"+info.nav_id+"_"+info.ev_mkt_grp_id,pscone_id=_fb_nav_tab_prefix+info.tab_id+"_nav_"+info.nav_id+"_container";if(!scone_exists(pscone_id))return;var html=tmpl_play("fb_hp_nav_tab_group",info);scone_add_item(pscone_id,scitem_id,html,info);var cscone_id=_fb_nav_tab_evocgroups_prefix+info.tab_id+"_"+info.nav_id+"_"+info.ev_mkt_grp_id;scone_create(cscone_id,{},_fb_nav_tab_cmp_evocgroups,null)}
function _fb_nav_tab_got_EVOCGROUP(data,handler){var info=handler.mkt_hash[data.ev_mkt_grp_id+"_"+data.ev_oc_grp_id],is_new_item=!info,parent_info=handler.grp_hash[data.ev_mkt_grp_id];if(is_new_item){info=data;handler.mkt_hash[data.ev_mkt_grp_id+"_"+data.ev_oc_grp_id]=info;info.child_hash={}}else for(var f in data)info[f]=data[f];info.tab_id=handler.tab_id;info.nav_id=handler.nav_id;info.name=info.names[handler.cfg.lang];info.full_name=info.name;info.name=trunc_string(info.name,handler.cfg.name_truncate_threshold,'...');var scitem_id=_fb_nav_tab_evocgroup_prefix+info.tab_id+"_"+info.nav_id+"_"+info.ev_mkt_grp_id+"_"+info.ev_oc_grp_id,pscone_id=_fb_nav_tab_evocgroups_prefix+info.tab_id+"_"+info.nav_id+"_"+info.ev_mkt_grp_id;if(!scone_exists(pscone_id))return;var html=tmpl_play("fb_nav_tab_evocgroup",info);scone_add_item(pscone_id,scitem_id,html,info);parent_info.evocgrp_num=parent_info.evocgrp_num+1;_fb_nav_tab_update_evocgrp_count(parent_info)}
function _fb_nav_tab_add_clear_div(data,handler){var elem_id=document.getElementById(_fb_nav_tab_evocgroups_prefix+handler.tab_id+"_"+handler.nav_id+"_"+data.ev_mkt_grp_id),div_el=document.createElement("div");div_el.setAttribute('class','clear');elem_id.appendChild(div_el)}
function _fb_nav_tab_update_evocgrp_count(handler){var span_el=document.getElementById("fb_nav_tab_mkt_count_"+handler.tab_id+"_"+handler.nav_id+"_"+handler.ev_mkt_grp_id);span_el.innerHTML="("+handler.evocgrp_num+")"}
function _fb_nav_tab_cmp_groups(cmpMode,evA,evB){var d=evA.disporder-evB.disporder;if(d<0){return-1}else if(d==0){return 0}else return 1}
function _fb_nav_tab_cmp_evocgroups(cmpMode,evA,evB){var d=evA.disporder-evB.disporder;if(d<0){return-1}else if(d==0){return 0}else return 1};var req=null
function lb_fin_init(event,evmkts,selcns,init_msg_id,cfg){if(_lb_fin_first_time){_lb_fin_store_templates();var html=tmpl_play("lb_fin_header_top",{}),el=document.getElementById(_lb_fin_header_id);el.innerHTML=html};_lb_fin_event=null;_lb_evt_evmkt_hash={};_lb_evt_selcn_hash={};_lb_fin_prev_level="";_lb_fin_ev_id=event.ev_id;_lb_fin_last_msg_id=init_msg_id;_lb_fin_time_diff=0;if(evmkts.length>0)_lb_fin_time_diff=evmkts[0].timestamp-Math.round(new Date().getTime()/1e3);for(var f in cfg)_lb_fin_cfg[f]=cfg[f];if(scone_exists(_lb_fin_selcns_id))scone_delete(_lb_fin_selcns_id);_lb_fin_got_EVENT(event);for(var i=0;i<evmkts.length;i++)_lb_fin_got_EVMKT(evmkts[i]);for(var i=0;i<selcns.length;i++)_lb_fin_got_SELCN(selcns[i],true);_lb_fin_reload_check();var channels=[],padded_ev_id=ps_connect_lpad_id(_lb_fin_ev_id);channels.push("sEVENT"+padded_ev_id);for(var ev_mkt_id in _lb_evt_evmkt_hash){var padded_ev_mkt_id=ps_connect_lpad_id(ev_mkt_id);channels.push("sEVMKT"+padded_ev_mkt_id);channels.push("SEVMKT"+padded_ev_mkt_id)};ps_connect_register("lb_fin",_lb_fin_got_msg,channels,_lb_fin_last_msg_id);_lb_fin_first_time=false;return};var _lb_fin_header_id="lb_fin_header_holder",_lb_fin_selcns_id="lb_fin_selcns_holder",_lb_fin_header_bottom_inner_id="lb_fin_header_bottom_inner_holder",_lb_fin_header_top_id="lb_fin_header_top",_lb_fin_header_bottom_id="lb_fin_header_bottom",_lb_fin_selcn_id_prefix="selcn_",_lb_fin_price_class_name="odd",_lb_fin_selcn_highlight_id_prefix="lb_fin_price_con_",_lb_fin_price_str_id_prefix="lb_fin_price_str_",_lb_fin_level_class_name="level",_lb_fin_level_con_id_prefix="lb_fin_level_con_",_lb_evt_stake_id_prefix="lb_evt_stake_",_lb_evt_fb_stake_id_prefix="lb_evt_fb_stake_",_lb_fin_highlight_timers={}
function lb_fin_object(){return};lb_fin_object.prototype.getConfig=function(){return _lb_fin_cfg};lb_fin_object.prototype.getHash=function(identifier){var ret="";switch(identifier){case"HL_TIMERS":if(_lb_fin_highlight_timers)ret=_lb_fin_highlight_timers;break;default:ret=""};return ret};lb_fin_object.prototype.getHashId=function(identifier,id){var ret="";switch(identifier){case"HL_TIMERS":if(_lb_fin_highlight_timers&&_lb_fin_highlight_timers[id])ret=_lb_fin_highlight_timers[id];break;default:ret=""};return ret};lb_fin_object.prototype.getMiscInfo=function(identifier){var ret="";switch(identifier){case"PRICE_CLASS_NAME":if(_lb_fin_price_class_name)ret=_lb_fin_price_class_name;break;case"LEVEL_CLASS_NAME":if(_lb_fin_level_class_name)ret=_lb_fin_level_class_name;break;default:ret=""};return ret};lb_fin_object.prototype.getIdPrefix=function(identifier){var ret="";switch(identifier){case"SELCN_HL":if(_lb_fin_selcn_highlight_id_prefix)ret=_lb_fin_selcn_highlight_id_prefix;break;case"LEVEL_CONTAINER":if(_lb_fin_level_con_id_prefix)ret=_lb_fin_level_con_id_prefix;break;default:ret=""};return ret};lb_fin_object.prototype.gotPushData=function(identifier,data){switch(identifier){case"PRICE":_lb_fin_got_PRICE(data);break;case"SELCN":_lb_fin_got_SELCN(data,false);break;case"MHCAP":_lb_fin_got_MHCAP(data);break;case"EVMKT":_lb_fin_got_EVMKT(data);break;case"EVENT":_lb_fin_got_EVENT(data);break;default:};return};var lb_fin_obj=new lb_fin_object(),lb_fin_cmp_objects=new function(){}();lb_fin_cmp_objects=new push_hash_cmp_objects()
function _lb_fin_store_templates(){var tmp=[];tmp.push('	<div id="lb_fin_header_top">');tmp.push('		<!-- lb_fin_header_top_inner will go here -->\n');tmp.push('	</div>\n');tmp.push('	<div id="lb_fin_header_bottom">');tmp.push('		<!-- lb_fin_header_bottom will go here -->\n');tmp.push('	</div>\n');tmpl_store("lb_fin_header_top",tmp.join(""));var tmp=[];tmp.push('		<div class="hdMkLvls">\n');tmp.push('			<h3><%XL BIR_FINANCIALS_BETTING_TITLE%></h3>\n');tmp.push('			<p style="float:left;width:300px"><%name%> </p><p style="float:right;width:150px;text-align:right;margin-right:15px"><span id="opening_time"></span></p>\n');tmp.push('			<div class="clear"></div>\n');tmp.push('		</div>\n');tmp.push('		<div id="marketLevels">\n');tmp.push('			<div class="left" style="width:222px; height: 70px">\n');tmp.push('				<div class="title">Opening Level</div>\n');tmp.push('				<div class="value"><span id="opening_level"></span></div>\n');tmp.push('			</div>\n');tmp.push('			<div class="left" style="width:202px; height: 70px">\n');tmp.push('				<div class="title"><span id="time_remaining_label"></span></div>\n');tmp.push('				<div class="value"><span id="count_down"></span></div>\n');tmp.push('			</div>\n');tmp.push('			<div class="left" style="width:206px; height: 70px;">\n');tmp.push('				<div class="title">Current Level</div>\n');tmp.push('				<div class="value"><span id="current_level"></span><img id="level_indicator" src="/img/sb/betlive/home/mkLevelsFlat.png" alt="" style="position: relative; top: 2px; left: 3px" /></div>\n');tmp.push('			</div>\n');tmp.push('			<div class="clear"></div>\n');tmp.push('		</div>\n');tmp.push('		<div class="opts">\n');tmp.push('			<p id="FastBetInput" class="right" <%IF fast_bet_status == "HIDDEN"%>style="display:none"<%END%> >\n');tmp.push('				<a title="<%XL BIR_FINANCIALS_FAST_BET_HELP%>" href="javascript:void(0)"><img src="<%_lb_evt_cfg.img_url%>/sb/betlive/home/qmark.png" alt="<%XL BIR_FINANCIALS_FAST_BET_HELP%>" style="position: relative; top: 3px" /></a> <strong><%XL BIR_FINANCIALS_FAST_BET%>:</strong> \n');tmp.push('				<input type="radio" class="radio" name="FastBet" value="Y" onchange="update_bir_prefs(this)" <%IF fast_bet_status == "DISABLED"%>disabled<%END%> /> <%XL BIR_PREF_YES%> &nbsp; <input type="radio" class="radio" name="FastBet" value="N" onchange="update_bir_prefs(this)" <%IF fast_bet_status == "DISABLED"%>disabled<%END%> /> <%XL BIR_PREF_NO%>\n');tmp.push('			</p>\n');tmp.push('			<div class="clear"></div>\n');tmp.push('		</div>\n');tmpl_store("lb_fin_header_top_inner",tmp.join(""));var tmp=[];tmp.push('	<div id="ifCnt" class="groupWrapperIf">\n');tmp.push('		<div class="ifItem">\n');tmp.push('			<div class="itemHeader" id="lb_fin_header_bottom_inner_holder">\n');tmp.push('				<!-- lb_fin_header_bottom_inner will go here -->\n');tmp.push('			</div>\n');tmp.push('			<div class="itemContent">\n');tmp.push('				<table summary="">\n');tmp.push('					<tbody id="lb_fin_selcns_holder">\n');tmp.push('						<!-- lb_fin_selcn will go here -->\n');tmp.push('					</tbody>\n');tmp.push('				</table>\n');tmp.push('			</div>\n');tmp.push('		</div>\n');tmp.push('	</div>\n');tmpl_store("lb_fin_header_bottom",tmp.join(""));var tmp=[];tmp.push('	<a href="javascript:void(0)" class="closeEl">Close</a>\n');tmp.push('	<div class="favourite"><a href="javascript:void(0)" class="addFav" title="<%XL FAVOURITES%>" onclick="lb_fav_add_new(<%ev_id%>, \'E\')"><%XL FAVOURITE%></a></div>\n');tmp.push('	<%IF (blurb != "")%>\n');tmp.push('	<div class="left" style="width:200px; font-size: 12px; text-indent: 30px">\n');tmp.push('		<%blurb%>\n');tmp.push('	</div>\n');tmp.push('	<%END%>\n');tmp.push('	<div class="right b" style="<%IF fast_bet_status == "ON" || fast_bet_status == "DISABLED" %>display:none;<%END%>width:94px; font-size: 11px; text-indent: 11px">\n');tmp.push('		<%XL BIR_FINANCIALS_BET_NOW%>\n');tmp.push('	</div>\n');tmp.push('	<div class="right fb" style="<%IF fast_bet_status == "HIDDEN" || fast_bet_status == "OFF" %>display:none;<%END%>width:123px; font-size: 11px; text-indent: 11px">\n');tmp.push('		<%XL BIR_FINANCIALS_BET_NOW%>\n');tmp.push('	</div>\n');tmp.push('	<div class="right fbd" style="<%IF fast_bet_status == "HIDDEN" || fast_bet_status == "OFF" || fast_bet_status == "ON" %>display:none;<%END%>width:123px; font-size: 11px; text-indent: 11px">\n');tmp.push('	<%XL BIR_FINANCIALS_BET_NOW%>\n');tmp.push('	</div>\n');tmp.push('	<div class="right b" style="<%IF fast_bet_status == "ON" || fast_bet_status == "DISABLED" %>display:none;<%END%>width:78px; font-size: 11px; text-align: center">\n');tmp.push('		<%XL BIR_FINANCIALS_QUICK_BET%>\n');tmp.push('	</div>\n');tmp.push('	<div class="right" style="width:50px; font-size: 11px; text-align: center">\n');tmp.push('		<%XL BIR_FINANCIALS_ODDS%>\n');tmp.push('	</div>\n');tmp.push('	<div class="right" style="width:85px; font-size: 11px; text-align: center">\n');tmp.push('		<%XL BIR_FINANCIALS_LEVEL%>\n');tmp.push('	</div>\n');tmp.push('	<div class="left" style="width:250px; font-size: 11px; text-align: left;margin-left:10px">\n');tmp.push('		<%name%> <%market_info%>\n');tmp.push('	</div>\n');tmp.push('	<div class="clear"></div>\n');tmpl_store("lb_fin_header_bottom_inner",tmp.join(""));var tmp=[];tmp.push('	<tr id="selcn_<%ev_oc_id%>">\n');tmp.push('		<%IF bettable%>\n');tmp.push('		<td>\n');tmp.push('			<div class="title"><%name%></div>\n');tmp.push('				<div class="quickBet b" <%IF fast_bet_status == "ON" || fast_bet_status == "DISABLED" %>style="display:none"<%END%>>\n');tmp.push('					<table summary="">\n');tmp.push('						<tr>\n');tmp.push('							<%LOOP qb_idx _lb_fin_cfg.quickbet_amounts.length%>\n');tmp.push('							<td><a href="javascript:void(0)" onclick="lb_fin_add_bet(<%ev_oc_id%>,<%_lb_fin_cfg.quickbet_amounts[qb_idx]%>)" title="<%_lb_fin_cfg.quickbet_amounts[qb_idx]%>"><%_lb_fin_cfg.quickbet_amounts[qb_idx]%>&nbsp;</a></td>\n');tmp.push('							<%END%>\n');tmp.push('						</tr>\n');tmp.push('					</table>\n');tmp.push('				</div>\n');tmp.push('			</div>\n');tmp.push('			<div id="lb_fin_price_con_<%ev_oc_id%>" class="odd"><a id="lb_fin_price_str_<%ev_oc_id%>" href="javascript:void(0)" onclick="lb_fin_add_bet(<%ev_oc_id%>)" title=""><%price_str%></a></div>\n');tmp.push('			<div id="lb_fin_level_con_<%ev_oc_id%>" class="level"><%hcap_value%></div>\n');tmp.push('		</td>\n');tmp.push('		<td class="Bet b" <%IF fast_bet_status == "ON" || fast_bet_status == "DISABLED" %>style="display:none"<%END%>>\n');tmp.push('			<div>\n');tmp.push('				<input id="lb_evt_stake_<%ev_oc_id%>" class="amount" type="text" onkeypress="if (event.keyCode==13) {lb_fin_add_bet(<%ev_oc_id%>)}" onchange="BS_stake_changed(this.id, false)" name="bet" value="" /><a href="javascript:void(0)" onclick="lb_fin_add_bet(<%ev_oc_id%>)" title="<%XL BIR_FINANCIALS_BET_NOW_HOVER%>"><%XL BIR_FINANCIALS_BET_NOW%></a>\n');tmp.push('			</div>\n');tmp.push('		</td>\n');tmp.push('		<td class="fBet fb" <%IF fast_bet_status != "ON"%>style="display:none"<%END%>>\n');tmp.push('			<div>\n');tmp.push('				<input id="lb_evt_fb_stake_<%ev_oc_id%>" class="amount" type="text" onkeypress="if (event.keyCode==13) {lb_fin_add_bet(<%ev_oc_id%>,\'\',true)}" onchange="BS_stake_changed(this.id, false)" value="">');tmp.push('				<a href="javascript:void(0)" onclick="lb_fin_add_bet(<%ev_oc_id%>,\'\',true)" title="<%XL BIR_FINANCIALS_FAST_BET%>"><%XL BIR_FINANCIALS_FAST_BET%></a>\n');tmp.push('			</div>\n');tmp.push('		</td>\n');tmp.push('		<td class="fBetDisable fbd" <%IF fast_bet_status != "DISABLED"%>style="display:none"<%END%>>\n');tmp.push('			<div>\n');tmp.push('				<input class="amount" type="text" value="">\n');tmp.push('				<a href="javascript:void(0)" title="<%XL BIR_FINANCIALS_FAST_BET%>"><%XL BIR_FINANCIALS_FAST_BET%></a>\n');tmp.push('			</div>\n');tmp.push('		</td>\n');tmp.push('		<%ELSE%>\n');tmp.push('		<td class="level-suspended" colspan="4"><%XL SUSPENDED%></td>\n');tmp.push('		<%END%>\n');tmp.push('	</tr>\n');tmpl_store("lb_fin_selcn",tmp.join(""));return};var _lb_fin_cfg={lang:"en",price_str_type:"ODDS",price_str_type_ah:"DECIMAL",price_str_type_hl:"DECIMAL",price_str_sep:"-",quickbet_amounts:[10,25,50],highlight_duration:4e3,reload_url:"",hl_class_decrease:"_d",hl_class_increase:"_i",hl_class_same:""},_lb_fin_first_time=true,_lb_fin_ev_id,_lb_fin_event,_lb_evt_evmkt_hash,_lb_evt_selcn_hash,_lb_fin_prev_level
function _lb_fin_reload_check(){var do_reload=!_lb_fin_anything_to_bet_on()&&!_lb_fin_event.last_mkts_of_day;if(do_reload){if(document.PollingAjaxHelper.getTimeout("_lb_fin_reload_check")!=null)return;var delay=Math.round(3e3+Math.random()*2e3);document.PollingAjaxHelper.setTimeout("_lb_fin_reload_check",_lb_fin_reload,delay);document.getElementById('market-loading').style.display='block';document.getElementById('market-loading-hdr').style.display='block';document.getElementById('ifCnt').style.display='none';var event_mkts_iframe=document.getElementById('event-markets-iframe');if(event_mkts_iframe)event_mkts_iframe.style.display='none';document.getElementById('event-markets-disclaimer').style.display='none'}else{try{document.PollingAjaxHelper.clearTimeout("_lb_fin_reload_check")}catch(junk){};document.getElementById('market-loading').style.display='none';document.getElementById('market-loading-hdr').style.display='none';document.getElementById('ifCnt').style.display='block';var event_mkts_iframe=document.getElementById('event-markets-iframe');if(event_mkts_iframe)event_mkts_iframe.style.display='block';document.getElementById('event-markets-disclaimer').style.display='block'};return}
function _lb_fin_reload(){if(_lb_fin_cfg.reload_url=="")return;ps_connect_deregister("lb_fin");document.PollingAjaxHelper.clearTimeout("_lb_fin_reload_check");var clientdata={id:'financials_js',retries:3};lb_fin_make_ajax_get_request(_lb_fin_cfg.reload_url,clientdata,lb_fin_got_ajax_content)}
function lb_fin_make_ajax_get_request(url,clientdata,callback){if(document.PollingAjaxHelper.checkSemaphore()){document.PollingAjaxHelper.setTimeout("lb_fin_make_ajax_get_request",function(){lb_fin_make_ajax_get_request(url,clientdata,callback)},300);return};document.PollingAjaxHelper.aquireSemaphore();req=null;if(window.XMLHttpRequest){req=new XMLHttpRequest()}else if(window.ActiveXObject)req=new ActiveXObject('Microsoft.XMLHTTP');if(req){req.onreadystatechange=function(){if(req.readyState!=4)return;var reqStatus;try{reqStatus=req.status}catch(e){reqStatus=''};if(reqStatus!=200){document.PollingAjaxHelper.releaseSemaphore();callback(url,clientdata,false,'HTTP')}else{document.PollingAjaxHelper.releaseSemaphore();callback(url,clientdata,true,req.responseText)}};try{req.open('GET',url,true);req.send(null)}catch(e){document.PollingAjaxHelper.releaseSemaphore();callback(url,clientdata,false,'UNSUPPORTED')}}else{document.PollingAjaxHelper.releaseSemaphore();callback(url,clientdata,false,'UNSUPPORTED')}}
function lb_fin_got_ajax_content(url,clientdata,ok,response){var holder_el=document.getElementById(clientdata.id);if(ok){var parts=lb_fin_parse_script_tags(response);if(holder_el)holder_el.innerHTML=parts[0];if(parts[1].length)try{lb_fin_global_eval(parts[1])}catch(e){ok=false}};if(!ok)if(clientdata.retries>0){clientdata.retries--;retry=function(){lb_fin_make_ajax_get_request(url,clientdata,lb_fin_got_ajax_content)};document.PollingAjaxHelper.setTimeout("lb_fin_got_ajax_content",retry,2e3)}else alert('Sorry, unable to retrieve latest financial data. Please refresh page.')}
function lb_fin_parse_script_tags(str){var html='',js='',i=0,state='HTML',script_re=new RegExp('<(/?)script([^>]*)>','gi');while((mtch=script_re.exec(str))!=null){mS=mtch.index;if(state=='HTML'){html+=str.substring(i,mS)}else js+=str.substring(i,mS)+';\n';var closer=mtch[1],attrs=mtch[2];if(closer=='/'){state='HTML'}else if(attrs.charAt(attrs.length-1)!='/'&&attrs.indexOf('src=')==-1)state='JS';i=script_re.lastIndex};if(state=='HTML'){html+=str.substring(i)}else js+=str.substring(i);return[html,js]};var lb_fin_global_eval=function(src){if(window.execScript){window.execScript(src);return};var fn=function(){window.eval.call(window,src)};fn()}
function _lb_fin_anything_to_bet_on(){for(var key in _lb_evt_selcn_hash){var info=_lb_evt_selcn_hash[key];if(info.visible&&info.bettable)return true};return false}
function _lb_fin_got_msg(msg){bir_got_msg(lb_fin_obj,msg);return}
function _lb_fin_repaint_header(){if(!document.getElementById(_lb_fin_header_bottom_inner_id)){var html=tmpl_play("lb_fin_header_bottom",_lb_fin_event),el=document.getElementById(_lb_fin_header_bottom_id);el.innerHTML=html;LHSDraggable()};var orig_current_level=document.getElementById('current_level');if(orig_current_level)orig_current_level=orig_current_level.innerHTML;var orig_opening_level=document.getElementById('opening_level');if(orig_opening_level)orig_opening_level=orig_opening_level.innerHTML;var orig_opening_time=document.getElementById('opening_time');if(orig_opening_time)orig_opening_time=orig_opening_time.innerHTML;var orig_time_remaining=document.getElementById('time_remaining_label');if(orig_time_remaining)orig_time_remaining=orig_time_remaining.innerHTML;var orig_count_down=document.getElementById('count_down');if(orig_count_down)orig_count_down=orig_count_down.innerHTML;var html_top_inner=tmpl_play("lb_fin_header_top_inner",_lb_fin_event),el=document.getElementById(_lb_fin_header_top_id);el.innerHTML=html_top_inner;var html_bottom_inner=tmpl_play("lb_fin_header_bottom_inner",_lb_fin_event),el=document.getElementById(_lb_fin_header_bottom_inner_id);el.innerHTML=html_bottom_inner;if(orig_current_level)document.getElementById('current_level').innerHTML=orig_current_level;if(orig_opening_level)document.getElementById('opening_level').innerHTML=orig_opening_level;if(orig_opening_time)document.getElementById('opening_time').innerHTML=orig_opening_time;if(orig_time_remaining)document.getElementById('time_remaining_label').innerHTML=orig_time_remaining;if(orig_count_down)document.getElementById('count_down').innerHTML=orig_count_down;if(!scone_exists(_lb_fin_selcns_id))scone_create(_lb_fin_selcns_id,{},lb_fin_cmp_objects.cmpSelcns,null);return}
function _lb_fin_upd_current_level(level){document.getElementById('current_level').innerHTML=level;var indicator;if(_lb_fin_prev_level==""){indicator=betlive.event.financial_indicator_no_move}else if(level>_lb_fin_prev_level){indicator=betlive.event.financial_indicator_green}else if(level<_lb_fin_prev_level){indicator=betlive.event.financial_indicator_red}else indicator=betlive.event.financial_indicator_no_move;document.getElementById('level_indicator').src=indicator;_lb_fin_prev_level=level;return}
function _lb_fin_upd_times(market){if(market.opening_level!=""){document.getElementById('opening_level').innerHTML=market.opening_level}else document.getElementById('opening_level').innerHTML="";if(market.opening_time!=""){document.getElementById('opening_time').innerHTML=betlive.event.opening_time_label+": "+market.opening_time}else document.getElementById('opening_time').innerHTML="";if(market.status=="S"){document.getElementById('time_remaining_label').innerHTML=betlive.event.until_close_label;timer=market.close_time-market.timestamp;_warningMessage=betlive.event.about_to_close_message}else{document.getElementById('time_remaining_label').innerHTML=betlive.event.until_susp_label;timer=market.suspend_time-market.timestamp;_warningMessage=betlive.event.about_to_susp_message};if(timer<0)timer=0;if(_countDowncontainer==0){ActivateCountDown("count_down",timer)}else{_finalCountDownValue=parseInt(new Date().getTime()/1e3)+timer;_currentSeconds=timer}}
function _lb_fin_got_EVENT(data){if(data.ev_id!=_lb_fin_ev_id)return;var info=_lb_fin_event,is_new_item=!info,orig_bettable;if(is_new_item){info=data;info.market_info='';_lb_fin_event=info}else{orig_bettable=info.bettable;for(var f in data)info[f]=data[f]};info.name=info.names[_lb_fin_cfg.lang];info.start_time_xl=info.start_time_xls[_lb_fin_cfg.lang];info.bettable=(info.status=="A");info.visible=(info.displayed=="Y");_lb_fin_repaint_header();if(info.follow_hcap_mkt==-1)_lb_fin_upd_current_level(info.score_away);if(!is_new_item&&orig_bettable!=info.bettable)for(var ev_mkt_id in _lb_evt_evmkt_hash)_lb_fin_got_EVMKT({ev_mkt_id:ev_mkt_id});return}
function _lb_fin_got_EVMKT(data){var parent_info=_lb_fin_event,info=_lb_evt_evmkt_hash[data.ev_mkt_id],is_new_item=!info,orig_displayed,orig_bettable,orig_hcap_values;if(is_new_item){info=data;_lb_evt_evmkt_hash[data.ev_mkt_id]=info;info.child_hash={}}else{orig_displayed=info.displayed;orig_bettable=info.bettable;orig_hcap_values=info.hcap_values;info.timestamp=Math.round(new Date().getTime()/1e3)+_lb_fin_time_diff;for(var f in data)info[f]=data[f]};if(info.bet_in_run!='Y')info.displayed='N';info.bettable=(info.status=="A")&&parent_info.bettable;info.visible=(info.displayed=="Y")&&parent_info.visible;if(parent_info.follow_hcap_mkt==info.ev_mkt_id||parent_info.follow_hcap_mkt==-1){var need_hdr_repaint=false;if(info.market_info!=parent_info.market_info){parent_info.market_info=info.market_info;need_hdr_repaint=true};if(need_hdr_repaint)_lb_fin_repaint_header();if(parent_info.follow_hcap_mkt!=-1&&info.hcap_values["H"]!=undefined){var current_level=_bir_extract_hcap(info.hcap_values["H"]);_lb_fin_upd_current_level(current_level)};_lb_fin_upd_times(info)};if(!is_new_item&&(orig_bettable!=info.bettable||orig_displayed!=info.displayed||_lb_fin_diff_objs_brief(orig_hcap_values,info.hcap_values)))for(var ev_oc_id in info.child_hash)_lb_fin_got_SELCN({ev_oc_id:ev_oc_id,ev_mkt_id:info.ev_mkt_id});return}
function _lb_fin_got_MHCAP(data){var parent_info=_lb_fin_event,info=_lb_evt_evmkt_hash[data.ev_mkt_id];if(!parent_info||!info)return;for(var f in data)info[f]=data[f];if(parent_info.follow_hcap_mkt==info.ev_mkt_id||parent_info.follow_hcap_mkt==-1)if(parent_info.follow_hcap_mkt!=-1&&info.hcap_values["H"]!=undefined){var current_level=_bir_extract_hcap(info.hcap_values["H"]);_lb_fin_upd_current_level(current_level)};for(var ev_oc_id in info.child_hash){seln_info=_lb_evt_selcn_hash[ev_oc_id];var orig_hcap_value=seln_info.hcap_value;if(seln_info.fb_result&&info.hcap_values)seln_info.hcap_value=info.hcap_values[seln_info.fb_result];push_highlight_level_change(lb_fin_obj,ev_oc_id,orig_hcap_value,seln_info.hcap_value);var level_container=lb_fin_obj.getIdPrefix("LEVEL_CONTAINER"),level_id=level_container+ev_oc_id,el=document.getElementById(level_id);if(!el)continue;el.innerHTML=seln_info.hcap_value};return}
function _lb_fin_got_SELCN(data,first_build){var parent_info=_lb_evt_evmkt_hash[data.ev_mkt_id];if(!parent_info)return;parent_info.child_hash[data.ev_oc_id]=true;var info=_lb_evt_selcn_hash[data.ev_oc_id],is_new_item=!info,orig_lp_num,orig_lp_den,orig_hcap_value;if(is_new_item){info=data;_lb_evt_selcn_hash[data.ev_oc_id]=info}else{orig_lp_num=info.lp_num;orig_lp_den=info.lp_den;orig_hcap_value=info.hcap_value;for(var f in data)info[f]=data[f]};info.name=info.names[_lb_fin_cfg.lang];if(info.fb_result&&parent_info.hcap_values)info.hcap_value=parent_info.hcap_values[info.fb_result];info.bettable=(info.status=="A")&&parent_info.bettable;info.visible=(info.displayed=="Y")&&parent_info.visible;var scitem_id=_lb_fin_selcn_id_prefix+data.ev_oc_id,pscone_id=_lb_fin_selcns_id;if(!scone_exists(pscone_id))return;info.price_str=get_price_str(lb_fin_obj,info.lp_num,info.lp_den,parent_info.lp_avail,parent_info.mkt_sort);var html=tmpl_play("lb_fin_selcn",info),sort_info={disporder:info.disporder,lp_num:info.lp_num,lp_den:info.lp_den,ev_oc_id:info.ev_oc_id},was_visible=scone_item_exists(scitem_id),saved_stake=["",""];if(was_visible){var el1=document.getElementById(_lb_evt_stake_id_prefix+info.ev_oc_id);if(el1)saved_stake[0]=el1.value;var el2=document.getElementById(_lb_evt_fb_stake_id_prefix+info.ev_oc_id);if(el2)saved_stake[1]=el2.value};if(!was_visible&&info.visible){scone_add_item(pscone_id,scitem_id,html,sort_info)}else if(was_visible&&info.visible){scone_replace_item(scitem_id,html,sort_info,false)}else if(was_visible&&!info.visible)scone_remove_item(scitem_id);if(info.visible&&(saved_stake[0]!=""||saved_stake[1]!="")){var el1=document.getElementById(_lb_evt_stake_id_prefix+info.ev_oc_id);if(el1)el1.value=saved_stake[0];var el2=document.getElementById(_lb_evt_fb_stake_id_prefix+info.ev_oc_id);if(el2)el2.value=saved_stake[1]};if(!is_new_item&&info.visible){push_highlight_price_change(lb_fin_obj,info.ev_oc_id,info.lp_num,info.lp_den,orig_lp_num,orig_lp_den);push_highlight_level_change(lb_fin_obj,info.ev_oc_id,orig_hcap_value,info.hcap_value)};if(!first_build&&(!info.visible||!info.bettable))_lb_fin_reload_check();return}
function _lb_fin_got_PRICE(data){var info=_lb_evt_selcn_hash[data.ev_oc_id];if(!info)return;var parent_info=_lb_evt_evmkt_hash[info.ev_mkt_id];if(!parent_info)return;var orig_lp_num=info.lp_num,orig_lp_den=info.lp_den;for(var f in data)info[f]=data[f];var scitem_id=_lb_fin_selcn_id_prefix+data.ev_oc_id;if(!scone_item_exists(scitem_id))return;var sort_info={disporder:info.disporder,lp_num:info.lp_num,lp_den:info.lp_den,ev_oc_id:info.ev_oc_id};scone_set_item_info(scitem_id,sort_info);var price_id=_lb_fin_price_str_id_prefix+info.ev_oc_id,price_el=document.getElementById(price_id);if(!price_el)return;info.price_str=get_price_str(lb_fin_obj,info.lp_num,info.lp_den,parent_info.lp_avail,parent_info.mkt_sort);price_el.innerHTML=info.price_str;push_highlight_price_change(lb_fin_obj,info.ev_oc_id,info.lp_num,info.lp_den,orig_lp_num,orig_lp_den);return}
function lb_fin_add_bet(ev_oc_id,stake,fast_bet){var fb=typeof fast_bet==='boolean'&&fast_bet;if(!stake){var el='';if(fb){el=document.getElementById(_lb_evt_fb_stake_id_prefix+ev_oc_id)}else el=document.getElementById(_lb_evt_stake_id_prefix+ev_oc_id);if(el)stake=el.value;if(fb){el.value="";if(isNaN(stake)||isNaN(parseFloat(stake)))if(get_pref('BETSLIP_STYLE')=="Detached"){try{popped_out_betslip.BS_display_error(betslipbody.msg.BS_FASTBET_STAKE_INVALID_TITLE,betslipbody.msg.BS_FASTBET_STAKE_INVALID_TXT);popped_out_betslip.focus()}catch(e){BS_pop_out("DisplayError=FASTBET_STAKE_INVALID")};return}else{BS_display_error(betslipbody.msg.BS_FASTBET_STAKE_INVALID_TITLE,betslipbody.msg.BS_FASTBET_STAKE_INVALID_TXT,'BS_close_betslip()');BS_open_betslip();return}}};var selcn=_lb_evt_selcn_hash[ev_oc_id],evmkt=_lb_evt_evmkt_hash[selcn.ev_mkt_id];BS_set_leg("selections",ev_oc_id);BS_set_leg("price_type","L");BS_set_leg("stake",stake);BS_set_leg("lp_num",selcn.lp_num);BS_set_leg("lp_den",selcn.lp_den);BS_set_leg("hcap_value",evmkt.raw_hcap);BS_set_leg("bir_index",evmkt.bir_index);BS_set_leg("market_tags","");BS_go_bet(fb);return}
function _lb_fin_diff_objs_brief(a,b){for(var f in a)if(b[f]==undefined)return true;for(var f in b)if(a[f]==undefined)return true;for(var f in a){if(b[f]==undefined)continue;var va=a[f],vb=b[f];if(typeof va!=typeof vb){return true}else if(typeof va=="object"){if(_lb_fin_diff_objs_brief(va,vb))return true}else if(va!=vb)return true};return false}
function lb_ic_init(events,evmkts,init_msg_id,cfg){if(!_lb_ic_first_time)return;_lb_ic_store_templates();_lb_fin_ic_last_msg_id=init_msg_id;for(var f_ic in cfg)_lb_fin_ic_cfg[f_ic]=cfg[f_ic];_lb_ic_events=events;_lb_ic_evmkts=evmkts;for(i=0;i<_lb_ic_events.length;i++){_lb_ic_evmkts[i].hcap_formatted=_bir_extract_hcap(_lb_ic_evmkts[i].hcap_values["H"]);_lb_ic_evmkts[i].hcap_change=_lb_ic_update_hcap_change(_lb_ic_evmkts[i].raw_hcap,_lb_ic_evmkts[i].opening_level);_lb_ic_evmkts[i].hcap_change_percentage=_lb_ic_update_hcap_change_percentage(_lb_ic_evmkts[i].raw_hcap,_lb_ic_evmkts[i].opening_level);_lb_ic_evmkts[i].dir_change=0;_lb_ic_events[i].updating=false;_lb_ic_evmkts[i].ev_mkt_id=_lb_ic_evmkts[i].mkt_id;_lb_ic_evmkts[i].hcap_value=_lb_ic_evmkts[i].raw_hcap};for(var i=0;i<_lb_ic_events.length;i++)_lb_ic_got_EVENT(_lb_ic_events[i]);for(var i=0;i<_lb_ic_evmkts.length;i++)_lb_ic_got_EVMKT(_lb_ic_evmkts[i]);var channels=[];for(var i=0;i<_lb_ic_events.length;i++){var padded_ev_id=ps_connect_lpad_id(_lb_ic_events[i].ev_id),padded_mkt_id=ps_connect_lpad_id(_lb_ic_evmkts[i].mkt_id);channels.push("sEVENT"+padded_ev_id);channels.push("sEVMKT"+padded_mkt_id);channels.push("SEVMKT"+padded_mkt_id)};ps_connect_register("lb_ic",_lb_ic_got_msg,channels,_lb_fin_ic_last_msg_id);_lb_ic_first_time=false;return};var _lb_fin_ic_cfg={lang:"en",reload_url:"",hilight_base_class:"",highlight_duration:4e3,bir_financials_url:""},_lb_ic_first_time=true,_lb_ic_events,_lb_ic_evmkts,_lb_ic_timers={},_lb_ic_carousel=null
function lb_ic_object(){return};lb_ic_object.prototype.gotPushData=function(identifier,data){switch(identifier){case"PRICE":break;case"SELCN":break;case"MHCAP":_lb_ic_got_MHCAP(data);break;case"EVMKT":_lb_ic_got_EVMKT(data);break;case"EVENT":_lb_ic_got_EVENT(data);break;default:};return};var lb_ic_obj=new lb_ic_object()
function _lb_ic_store_templates(){tmpl_store("lb_fin_ic_content",'	<div id="ic_ev_<%_lb_ic_events[ic_idx].ev_id%>" class="<%IF _lb_ic_evmkts[ic_idx].dir_change == 1%>up<%ELSE IF _lb_ic_evmkts[ic_idx].dir_change == -1%>down<%END%>">\n		<h3>\n			<a href="<%_lb_fin_ic_cfg["bir_financials_url"]%>&ev_type_id=<%_lb_ic_events[ic_idx].ev_type_id%>" title="">\n				<%_lb_ic_events[ic_idx].names[_lb_fin_ic_cfg["lang"]]%>				&nbsp;				<span id="ic_ev_hcap_<%_lb_ic_events[ic_idx].ev_id%>" class="fin_ic_hcap_display"><%_lb_ic_evmkts[ic_idx].hcap_formatted%></span>			</a>\n		</h3>\n		<%IF _lb_ic_events[ic_idx].updating == true%>		<span>Updating...</span>		<%ELSE%>		<span class="diff">\n			<%_lb_ic_evmkts[ic_idx].hcap_change_symbol%>			&nbsp;			<%_lb_ic_evmkts[ic_idx].hcap_change%>\n			<span>\n				&nbsp;\n			</span>\n			<%_lb_ic_evmkts[ic_idx].hcap_change_percentage%>&#37;\n		</span>\n		<%END%>	</div>\n');return}
function _lb_ic_got_msg(msg){bir_got_msg(lb_ic_obj,msg);return}
function _lb_ic_got_EVENT(data){is_valid_ev=false;for(i=0;i<_lb_ic_events.length;i++)if(data.ev_id==_lb_ic_events[i].ev_id){is_valid_ev=true;arr_id=i;break};if(!is_valid_ev)return;require_refresh=false;if(data.status!=_lb_ic_events[arr_id].status&&data.status!='A'){_lb_ic_events[i].updating=true;require_refresh=true};if(data.displayed!=_lb_ic_events[arr_id].displayed&&data.status!='Y'){_lb_ic_events[i].updating=true;require_refresh=true};if(!require_refresh)return;if(_lb_ic_first_time)return;_lb_ic_repaint();return}
function _lb_ic_got_EVMKT(data){is_valid_mkt=false;for(var i=0;i<_lb_ic_evmkts.length;i++)if(data.ev_mkt_id==_lb_ic_evmkts[i].mkt_id){is_valid_mkt=true;arr_id=i;break};if(!is_valid_mkt)return;require_refresh=false;if(data.hcap_makeup!=_lb_ic_evmkts[arr_id].hcap_makeup)require_refresh=true;if(data.status!=_lb_ic_evmkts[arr_id].status){_lb_ic_events[arr_id].updating=true;require_refresh=true};if(data.displayed!=_lb_ic_evmkts[arr_id].displayed){_lb_ic_events[arr_id].updating=true;require_refresh=true};if(!require_refresh)return;if(_lb_ic_first_time)return;_lb_ic_repaint();return}
function _lb_ic_got_MHCAP(data){is_valid_mkt=false;for(var i=0;i<_lb_ic_evmkts.length;i++)if(data.ev_mkt_id==_lb_ic_evmkts[i].mkt_id){is_valid_mkt=true;arr_id=i;break};if(!is_valid_mkt)return;hcap_val=_bir_extract_hcap(data.hcap_values["H"]);require_refresh=false;dir=0;raw_hcap=_bir_extract_hcap(_lb_ic_evmkts[arr_id].raw_hcap);if(hcap_val!=raw_hcap){if(hcap_val>raw_hcap){dir=1}else if(hcap_val<raw_hcap)dir=-1;_lb_ic_evmkts[arr_id].dir_change=dir;_lb_ic_evmkts[arr_id].hcap_formatted=hcap_val;_lb_ic_evmkts[arr_id].hcap_change=_lb_ic_update_hcap_change(hcap_val,_lb_ic_evmkts[arr_id].opening_level);_lb_ic_evmkts[arr_id].hcap_change_percentage=_lb_ic_update_hcap_change_percentage(hcap_val,_lb_ic_evmkts[arr_id].opening_level);_lb_ic_evmkts[arr_id].raw_hcap=data.hcap_values["H"];require_refresh=true};if(dir!=0)_lb_ic_highlight('ic_ev_hcap_'+_lb_ic_evmkts[arr_id].ev_id,_lb_fin_ic_cfg.hilight_base_class,dir);_lb_ic_repaint()}
function lb_ic_repaint(carousel,state){_lb_ic_carousel=carousel;_lb_ic_repaint()}
function _lb_ic_repaint(){var i;for(i=0;i<_lb_ic_events.length;i++){var data={ic_idx:i},html_ic=tmpl_play("lb_fin_ic_content",data);_lb_ic_carousel.add(i+1,html_ic)};_lb_ic_carousel.size(_lb_ic_events.length);return}
function _lb_ic_update_hcap_change(hcap,opening_hcap){if(typeof hcap=='undefined'||hcap==''){return'?.??'}else if(typeof opening_hcap=='undefined'||opening_hcap=='')return'?.??';return OT_round((hcap-opening_hcap),2)}
function _lb_ic_update_hcap_change_percentage(hcap,opening_hcap){if(typeof hcap=='undefined'||hcap==''){return'?.??'}else if(typeof opening_hcap=='undefined'||opening_hcap=='')return'?.??';if(typeof opening_hcap=='undefined'||opening_hcap==''||opening_hcap==0.00)return'100.00';hcap_percentage=OT_round((((hcap/opening_hcap)*100)-100),2);return hcap_percentage}
function _lb_ic_highlight(id,base_class,dir){var el=document.getElementById(id);if(!el)return;if(typeof _lb_ic_timers[id]!='undefined'&&_lb_ic_timers[id]!=-1){if(dir!=0)window.clearTimeout(_lb_ic_timers[id]);_lb_ic_timers[id]=-1};if(dir>0){el.className=(base_class+'_i')}else if(dir<0){el.className=(base_class+'_d')}else{el.className=base_class;return};hilight_command=("_lb_ic_highlight('"+id+"', '"+base_class+"', 0);");_lb_ic_timers[id]=window.setTimeout(hilight_command,_lb_fin_ic_cfg.highlight_duration)}
function lb_hp_init(call_type,classes,types,events,markets,selcns,server_time_year,server_time_month,server_time_day,server_time_hour,server_time_min,server_time_sec,init_msg_id,cfg){_lb_hp_last_msg_id=init_msg_id;for(var f in cfg)_lb_hp_cfg[f]=cfg[f];var channels=[];if(call_type=="html"){_lb_hp_store_templates();_lb_hp_class_hash={};_lb_hp_type_hash={};_lb_hp_event_hash={};_lb_hp_evmkt_hash={};_lb_hp_selcn_hash={};var first_build=true;scone_create(_lb_hp_class_area_id,{},lb_hp_cmp_objects.cmpClasses,null);initPeriodClocks(server_time_year,server_time_month,server_time_day,server_time_hour,server_time_min,server_time_sec,_lb_hp_cfg.lang)}else{push_hash_prune_drilldown(lb_hp_obj,"CLASS","EVOC","CLASS",classes);push_hash_prune_drilldown(lb_hp_obj,"CLASS","EVOC","TYPE",types);var first_build=false};for(var i=0;i<classes.length;i++)_lb_hp_got_CLASS(classes[i],first_build,i);for(var i=0;i<types.length;i++)_lb_hp_got_TYPE(types[i],first_build,i);for(var i=0;i<events.length;i++){if(call_type=="html"||(!_lb_hp_event_hash[events[i].ev_id])){_lb_hp_got_EVENT(events[i],first_build)}else if(call_type=="js"&&_lb_hp_event_hash[events[i].ev_id]){var event_copy=_lb_hp_event_hash[events[i].ev_id],changed=false;if(event_copy.num_mkts!=events[i].num_mkts){event_copy.num_mkts=events[i].num_mkts;changed=true};if(event_copy.disporder!=events[i].disporder){event_copy.disporder=events[i].disporder;changed=true};if(changed)_lb_hp_got_EVENT(event_copy,first_build)};if(!_lb_hp_channels["EVENT"+events[i].ev_id]){channels.push("sEVENT"+ps_connect_lpad_id(events[i].ev_id));_lb_hp_channels["EVENT"+events[i].ev_id]=true}};for(var i=0;i<markets.length;i++){if(call_type=="html"||(!_lb_hp_evmkt_hash[markets[i].ev_mkt_id]))_lb_hp_got_EVMKT(markets[i]);if(!_lb_hp_channels["MARKET"+markets[i].ev_mkt_id]){channels.push("sEVMKT"+ps_connect_lpad_id(markets[i].ev_mkt_id));channels.push("SEVMKT"+ps_connect_lpad_id(markets[i].ev_mkt_id));_lb_hp_channels["MARKET"+markets[i].ev_mkt_id]=true}};for(var i=0;i<selcns.length;i++)if(call_type=="html"||(!_lb_hp_selcn_hash[selcns[i].ev_oc_id]))_lb_hp_got_SELCN(selcns[i]);if(channels.length>0){ps_connect_register("lb_hp"+hp_idx,_lb_hp_got_msg,channels,init_msg_id);hp_idx++};var hp_area_elem=document.getElementById(_lb_hp_class_area_id),no_data_elem=document.getElementById(_lb_hp_no_data_area_id),odd_key=document.getElementById(_lb_odd_key);if(classes.length==0){hp_area_elem.style.display="none";no_data_elem.style.display="";odd_key.style.display="none"}else{hp_area_elem.style.display="";no_data_elem.style.display="none";odd_key.style.display=""};if(call_type=="html"){lb_hp_schedule_reload()}else show_hide_couch_evts();_lb_hp_calc_ev_counts();return};var hp_idx=0,_lb_hp_class_area_id="ifCnt",_lb_odd_key="lb_odd_key",_lb_hp_no_data_area_id="no_bir_hp_data",_lb_hp_class_id_prefix="lb_hp_class_",_lb_hp_types_id_prefix="lb_hp_types_",_lb_hp_type_id_prefix="lb_hp_type_",_lb_hp_events_div_id_prefix="lb_hp_events_div_",_lb_hp_events_table_id_prefix="lb_hp_events_table_",_lb_hp_event_id_prefix="lb_hp_event_",_lb_hp_event_clock_id_prefix="lb_hp_clock_",_lb_hp_markets_id_prefix="lb_hp_markets_",_lb_hp_market_id_prefix="lb_hp_market_",_lb_hp_selcns_id_prefix="lb_hp_selcns_",_lb_hp_selcn_id_prefix="lb_hp_selcn_",_lb_hp_selcn_link_id_prefix="lb_hp_selcn_link_",_lb_hp_price_class_name="odd",_lb_hp_new_item_id_prefix="new_item_",_lb_hp_class_ordering={},_lb_hp_type_ordering={},_lb_hp_highlight_timers={},_lb_hp_channels={},_lb_hp_ev_count={},total_ev_count_for_flash=0,_lb_hp_last_tab_level="",_lb_hp_last_tab_id=""
function lb_hp_object(){return};lb_hp_object.prototype.getConfig=function(){return _lb_hp_cfg};lb_hp_object.prototype.getHash=function(identifier){var ret="";switch(identifier){case"CLASS":if(_lb_hp_class_hash)ret=_lb_hp_class_hash;break;case"TYPE":if(_lb_hp_type_hash)ret=_lb_hp_type_hash;break;case"EVENT":if(_lb_hp_event_hash)ret=_lb_hp_event_hash;break;case"EVMKT":if(_lb_hp_evmkt_hash)ret=_lb_hp_evmkt_hash;break;case"EVOC":if(_lb_hp_selcn_hash)ret=_lb_hp_selcn_hash;break;case"HL_TIMERS":if(_lb_hp_highlight_timers)ret=_lb_hp_highlight_timers;break;case"EV_COUNT":if(_lb_hp_ev_count)ret=_lb_hp_ev_count;break;default:ret=""};return ret};lb_hp_object.prototype.getHashId=function(identifier,id){var ret="";switch(identifier){case"CLASS":if(_lb_hp_class_hash&&_lb_hp_class_hash[id])ret=_lb_hp_class_hash[id];break;case"TYPE":if(_lb_hp_type_hash&&_lb_hp_type_hash[id])ret=_lb_hp_type_hash[id];break;case"EVENT":if(_lb_hp_event_hash&&_lb_hp_event_hash[id])ret=_lb_hp_event_hash[id];break;case"EVMKT":if(_lb_hp_evmkt_hash&&_lb_hp_evmkt_hash[id])ret=_lb_hp_evmkt_hash[id];break;case"EVOC":if(_lb_hp_selcn_hash&&_lb_hp_selcn_hash[id])ret=_lb_hp_selcn_hash[id];break;case"HL_TIMERS":if(_lb_hp_highlight_timers&&_lb_hp_highlight_timers[id])ret=_lb_hp_highlight_timers[id];break;case"EV_COUNT":if(_lb_hp_ev_count&&_lb_hp_ev_count[id])ret=_lb_hp_ev_count[id];break;default:ret=""};return ret};lb_hp_object.prototype.getMiscInfo=function(identifier){var ret="";switch(identifier){case"PRICE_CLASS_NAME":if(_lb_hp_price_class_name)ret=_lb_hp_price_class_name;break;default:ret=""};return ret};lb_hp_object.prototype.getIdPrefix=function(identifier){var ret="";switch(identifier){case"CLASS":if(_lb_hp_class_id_prefix)ret=_lb_hp_class_id_prefix;break;case"TYPE":if(_lb_hp_type_id_prefix)ret=_lb_hp_type_id_prefix;break;case"EVENT":if(_lb_hp_event_id_prefix)ret=_lb_hp_event_id_prefix;break;case"EVMKT":if(_lb_hp_market_id_prefix)ret=_lb_hp_market_id_prefix;break;case"EVOC":if(_lb_hp_selcn_id_prefix)ret=_lb_hp_selcn_id_prefix;break;case"NEW_ITEM":if(_lb_hp_new_item_id_prefix)ret=_lb_hp_new_item_id_prefix;break;case"SELCN_HL":if(_lb_hp_selcn_id_prefix)ret=_lb_hp_selcn_id_prefix;break;default:ret=""};return ret};lb_hp_object.prototype.deleteFromHash=function(identifier,id){switch(identifier){case"CLASS":if(_lb_hp_class_hash)delete _lb_hp_class_hash[id];break;case"TYPE":if(_lb_hp_type_hash)delete _lb_hp_type_hash[id];break;case"EVENT":if(_lb_hp_event_hash)delete _lb_hp_event_hash[id];break;case"EVMKT":if(_lb_hp_evmkt_hash)delete _lb_hp_evmkt_hash[id];break;case"EVOC":if(_lb_hp_selcn_hash)delete _lb_hp_selcn_hash[id];break;default:};return};lb_hp_object.prototype.gotPushData=function(identifier,data){switch(identifier){case"PRICE":_lb_hp_got_PRICE(data);break;case"SELCN":_lb_hp_got_SELCN(data);break;case"MHCAP":_lb_hp_got_MHCAP(data);break;case"EVMKT":_lb_hp_got_EVMKT(data);break;case"EVENT":_lb_hp_got_EVENT(data,false);break;default:};return};var lb_hp_obj=new lb_hp_object(),lb_hp_cmp_objects=new function(){}();lb_hp_cmp_objects=new push_hash_cmp_objects();lb_hp_cmp_objects.cmpSelcns=function(cmpMode,selcnA,selcnB){var d=selcnB.disporder-selcnA.disporder;if(d)return d;return selcnB.ev_oc_id-selcnA.ev_oc_id};lb_hp_cmp_objects.cmpEvents=function(cmpMode,evA,evB){var t=evA.start_time_disp_order-evB.start_time_disp_order;if(t)return t;var d=evA.disporder-evB.disporder;if(d)return d;return evA.ev_id-evB.ev_id}
function _lb_hp_store_templates(){var tmp=[];tmp.push('<div class="ifItem" id="lb_hp_class_<%ev_class_id%>" <%IF hidden%>style="display:none"<%END%>>\n');tmp.push('	<div class="itemHeader toogexHd">\n');tmp.push('		<a href="javascript:void(0)" class="closeEl <%IF collapsed %>off<%END%>" title="<%XL BIR_LIVE_BETTING_TOGGLE_EXPAND%>"><%XL BIR_LIVE_BETTING_TOGGLE_CLOSE%></a>\n');tmp.push('		<h4 class="left <%style_name%>" title="<%name_full%>">\n');tmp.push('			<%name%>\n');tmp.push('		</h4>\n');tmp.push('		<div class="icon <%style_name%>"></div>');tmp.push('		<p class="live-now"></p>\n');tmp.push('		<div class="clear"></div>\n');tmp.push('	</div>\n');tmp.push('	<div class="itemContent toogex ui-sortable" id="lb_hp_types_<%ev_class_id%>" <%IF collapsed %>style="display:none"<%END%>>\n');tmp.push('	</div>\n');tmp.push('</div>\n');tmpl_store("lb_hp_class",tmp.join(""));var tmp=[];tmp.push('<div class="subItem" id="lb_hp_type_<%ev_type_id%>" <%IF hidden%>style="display:none"<%END%>>\n');tmp.push('	<div class="subItemHeader">\n');tmp.push('		<a href="javascript:void(0)" class="closeEl" title="<%XL BIR_LIVE_BETTING_TOGGLE_EXPAND%>"><%XL BIR_LIVE_BETTING_TOGGLE_CLOSE%></a>\n');tmp.push('		<div class="left" title="<%name_full%>">\n');tmp.push('			<%name%>\n');tmp.push('		</div>\n');tmp.push('		<%LOOP h_idx headers.length%>');tmp.push('		<div class="right" style="width:<%headers[h_idx].header_width%>px; font-size: 11px; text-align: left"><%headers[h_idx].header_name%></div>\n');tmp.push('		<%END%>');tmp.push('	</div>\n');tmp.push('	<div class="subItemContent" id="lb_hp_events_div_<%ev_type_id%>" <%IF collapsed %>style="display:none"<%END%>>\n');tmp.push('		<table summary="">\n');tmp.push('			<tbody id="lb_hp_events_table_<%ev_type_id%>">\n');tmp.push('			</tbody>\n');tmp.push('		</table>\n');tmp.push('	</div>\n');tmp.push('</div>\n');tmpl_store("lb_hp_type",tmp.join(""));var tmp=[];tmp.push('<tr id="lb_hp_event_<%ev_id%>" <%IF hidden%>style="display:none"<%END%>>\n');tmp.push('	<td>\n');tmp.push('		<div class="eventName">\n');tmp.push('		<%IF ev_mkt_id != -1%>\n');tmp.push('			<a href="javascript:void(0)" class="addFav" title="<%XL BIR_LIVE_BETTING_ADD_TO_FAVE%>" onclick="lb_fav_add_new(<%ev_mkt_id%>, \'M\')">&nbsp;</a>\n');tmp.push('		<%END%>\n');tmp.push('		<a href="<%_lb_hp_cfg.event_url%><%ev_id%>" title="<%name_full%>"><strong><%name%></strong></a>\n');tmp.push('		</div>\n');tmp.push('		<%IF new_item %>\n');tmp.push('			<span class="new left" id="new_item_EVENT_<%ev_id%>"><%XL BIR_LIVE_BETTING_NEW%></span>\n');tmp.push('		<%END%>\n');tmp.push('		<%IF ev_stream_available == 1%>\n');tmp.push('			<div class="liveStream"><a title="<%XL BIR_LIVE_BETTING_WATCH_LIVE%>" href="#"/>&nbsp;</a></div>\n');tmp.push('		<%END%>\n');tmp.push('		<%IF stations_xl_list != ""%>\n');tmp.push('			<a class="liveTV" title="Live on <%stations_xl_list%>" href="#"/></a>\n');tmp.push('		<%END%>\n');tmp.push('		<%IF num_mkts > 0%>\n');tmp.push('			<div class="numMarkets"<%ev_id%>" title=""><a href="<%_lb_hp_cfg.event_url%><%ev_id%>" title="<%XL BIR_LIVE_BETTING_MORE_MARKETS%>">+<%num_mkts%></a></div>\n');tmp.push('		<%ELSE%>\n');tmp.push('			<div class="noMarkets" title="">0</div>\n');tmp.push('		<%END%>\n');tmp.push('		<div id="lb_hp_markets_<%ev_id%>"></div>\n');tmp.push('		<%IF period_id != "" && show_bir_clocks == "Y"%><div class="time" id="lb_hp_clock_<%ev_id%>"></div><%END%>\n');tmp.push('		<div class="score">\n');tmp.push('			<%IF hide_score == "N"%>\n');tmp.push('				<%IF score_home.length != 0%>\n');tmp.push('					<%score_home%>\n');tmp.push('				<%END%>\n');tmp.push('				<%IF score_home.length != 0 && score_away.length != 0%>\n');tmp.push('					- \n');tmp.push('				<%END%>\n');tmp.push('				<%IF score_away.length != 0%>\n');tmp.push('					<%score_away%>\n');tmp.push('				<%END%>\n');tmp.push('			<%END%>\n');tmp.push('		</div>\n');tmp.push('		<%IF venue !=""%>\n');tmp.push('			<div id="venue"><a class="venueIcon" title="Neutral Venue: <%venue%>">&nbsp;</a></div>\n');tmp.push('		<%END%>\n');tmp.push('	</td>\n');tmp.push('</tr>\n');tmpl_store("lb_hp_event",tmp.join(""));var tmp=[];tmp.push('<div id="lb_hp_market_<%ev_mkt_id%>">\n');tmp.push(' <div <%IF !bettable && lb_page !="CASHOUT_HP"%>style="display:none"<%END%> id="lb_hp_selcns_<%ev_mkt_id%>"></div>\n');tmp.push(' <div <%IF !bettable && lb_page !="CASHOUT_HP"%><div class="suspended"><%XL BIR_LIVE_BETTING_SUSPENDED%></div><%END%>\n');tmp.push('</div>\n');tmpl_store("lb_hp_market",tmp.join(""));var tmp=[];tmp.push('<%IF displayed == "Y"%>\n');tmp.push('	<div <%IF bettable%>class="odd"<%ELSE%>class="oddsuspended"<%END%> id="lb_hp_selcn_<%ev_oc_id%>"><a href="javascript:void(0)" id="lb_hp_selcn_link_<%ev_oc_id%>" <%IF bettable%>onclick="lb_hp_add_bet(<%ev_oc_id%>)"<%END%>><%price_str%></a></div>\n');tmp.push('<%ELSE%>\n');tmp.push('	<div class="odd" id="lb_hp_selcn_<%ev_oc_id%>"></div>\n');tmp.push('<%END%>\n');tmpl_store("lb_hp_selcn",tmp.join(""))};var _lb_hp_cfg={lang:"en",col_widths:[[86],[86,53],[80,53,53]],price_str_type:"ODDS",price_str_type_ah:"DECIMAL",price_str_type_hl:"DECIMAL",price_str_sep:"-",reload_url:"",reload_period:9e4,highlight_duration:4e3,event_url:"",ev_collapse_threshold:10,name_truncate_threshold:28,hl_class_decrease:"_d",hl_class_increase:"_i",hl_class_same:"",geo_stream_allowed:"N"}
function _lb_hp_got_msg(msg){bir_got_msg(lb_hp_obj,msg);return}
function _lb_hp_got_CLASS(data,first_build,position){var info=_lb_hp_class_hash[data.ev_class_id],is_new_item=!info,orig_bettable;if(is_new_item){info=data;_lb_hp_class_hash[data.ev_class_id]=info;info.child_hash={};info.normal_disporder=position+0.5;if(!first_build){info.new_item=true;push_schedule_unhighlight_new_item(lb_hp_obj,"CLASS",data.ev_class_id);$j("#toogle_live_events_wrap").html('<a href="javascript:void(0)" title="'+bir_collapse_all+'" class="expand">'+bir_collapse_all+'</a> | '+bir_expand_all)}else info.new_item=false;info.collapsed=false}else{orig_bettable=info.bettable;for(var f in data)info[f]=data[f]};var cust_class_disporder=_lb_hp_class_ordering[data.ev_class_id];if(cust_class_disporder)info.normal_disporder=cust_class_disporder;info.name_full=info.names[_lb_hp_cfg.lang];info.name=info.name_full;if(bir_top_displayed_type=="CLASS"&&bir_top_displayed_id!=data.ev_class_id){info.hidden=true}else if(bir_top_displayed_type=="TYPE"){info.hidden=true;for(var ev_type_id in info.child_hash)if(bir_top_displayed_id==ev_type_id){info.hidden=false;break}}else info.hidden=false;info.bettable=(info.status=="A");var scitem_id=_lb_hp_class_id_prefix+data.ev_class_id,pscone_id=_lb_hp_class_area_id;if(!scone_exists(pscone_id))return;var html=tmpl_play("lb_hp_class",info),sort_info={disporder:info.normal_disporder,ev_class_id:info.ev_class_id},was_visible=scone_item_exists(scitem_id),now_visible=(info.displayed=="Y");if(!was_visible&&now_visible){scone_add_item(pscone_id,scitem_id,html,sort_info);var cscone_id=_lb_hp_types_id_prefix+data.ev_class_id;scone_create(cscone_id,{},lb_hp_cmp_objects.cmpTypes,null)}else if(was_visible&&now_visible){_lb_hp_replace_class(scitem_id,info,sort_info)}else if(was_visible&&!now_visible)scone_remove_item(scitem_id);if(now_visible&&(!was_visible||orig_bettable!=info.bettable))for(var ev_type_id in info.child_hash)_lb_hp_got_TYPE({ev_type_id:ev_type_id,ev_class_id:info.ev_class_id});if(info.new_item==true)info.new_item=false}
function _lb_hp_replace_class(scitem_id,info,sort_info){class_item=$j("#"+scitem_id);if(info.hidden){class_item.hide()}else class_item.show();if(info.collapsed){class_item.find("div.itemHeader a.closeEl").removeClass("off on").addClass("off");class_item.children("div.itemContent").hide()}else{class_item.find("div.itemHeader a.closeEl").removeClass("off on").addClass("on");class_item.children("div.itemContent").show()};class_title=class_item.find("div.itemHeader h4");class_title.removeClass().addClass("left "+info.style_name);class_title.attr("title",info.name_full);class_title.html(info.name);scone_set_item_info(scitem_id,sort_info,true)}
function _lb_hp_got_TYPE(data,first_build,position){var parent_info=_lb_hp_class_hash[data.ev_class_id];if(!parent_info)return;parent_info.child_hash[data.ev_type_id]=true;var info=_lb_hp_type_hash[data.ev_type_id],is_new_item=!info,orig_bettable;if(is_new_item){info=data;_lb_hp_type_hash[data.ev_type_id]=info;info.child_hash={};info.normal_disporder=position+0.5;if(!first_build){info.new_item=true;push_schedule_unhighlight_new_item(lb_hp_obj,"TYPE",data.ev_type_id)}else info.new_item=false;info.collapsed=false}else{orig_bettable=info.bettable;for(var f in data)info[f]=data[f]};var cust_type_disporder=_lb_hp_type_ordering[data.ev_type_id];if(cust_type_disporder)info.normal_disporder=cust_type_disporder;info.name_full=info.names[_lb_hp_cfg.lang];info.name=info.name_full;info.headers=[];var class_headers=parent_info.headers[_lb_hp_cfg.lang],widths=_lb_hp_cfg.col_widths[class_headers.length-1];for(var h=0;h<class_headers.length;h++){var header_obj={};header_obj.header_name=class_headers[h];header_obj.header_width=widths[h];info.headers[h]=header_obj};if(bir_top_displayed_type=="TYPE"&&bir_top_displayed_id!=data.ev_type_id){info.hidden=true}else if(bir_top_displayed_type=="CLASS"&&bir_top_displayed_id!=data.ev_class_id){info.hidden=true}else info.hidden=false;info.bettable=(info.status=="A")&&parent_info.bettable;var scitem_id=_lb_hp_type_id_prefix+info.ev_type_id,pscone_id=_lb_hp_types_id_prefix+info.ev_class_id;if(!scone_exists(pscone_id))return;var html=tmpl_play("lb_hp_type",info),sort_info={disporder:info.normal_disporder,ev_type_id:info.ev_type_id},was_visible=scone_item_exists(scitem_id),now_visible=(info.displayed=="Y");if(!was_visible&&now_visible){scone_add_item(pscone_id,scitem_id,html,sort_info);var cscone_id=_lb_hp_events_table_id_prefix+data.ev_type_id;scone_create(cscone_id,{},lb_hp_cmp_objects.cmpEvents,null)}else if(was_visible&&now_visible){scone_replace_item(scitem_id,html,sort_info,true)}else if(was_visible&&!now_visible)scone_remove_item(scitem_id);if(now_visible&&(!was_visible||orig_bettable!=info.bettable))for(var ev_id in info.child_hash)_lb_hp_got_EVENT({ev_id:ev_id,ev_type_id:info.ev_type_id});if(info.new_item==true)info.new_item=false}
function _lb_hp_got_EVENT(data,first_build){var info=_lb_hp_event_hash[data.ev_id],is_new_item=!info,orig_bettable;if(is_new_item){var parent_info=_lb_hp_type_hash[data.ev_type_id]}else var parent_info=_lb_hp_type_hash[info.ev_type_id];if(!parent_info)return;parent_info.child_hash[data.ev_id]=true;var class_info=_lb_hp_class_hash[parent_info.ev_class_id];if(is_new_item){info=data;_lb_hp_event_hash[data.ev_id]=info;info.child_hash={};addClockEvent(data.ev_id,class_info.periods,_lb_hp_event_clock_id_prefix)}else{orig_bettable=info.bettable;for(var f in data)info[f]=data[f]};info.name_full=info.names[_lb_hp_cfg.lang];info.name=trunc_string(info.name_full,_lb_hp_cfg.name_truncate_threshold,'...');info.venue=info.venues[_lb_hp_cfg.lang];info.stations_xl=info.stations.xl[_lb_hp_cfg.lang];info.stations_xl_list=info.stations_xl.join(',');info.start_time_xl=info.start_time_xls[_lb_hp_cfg.lang];info.bettable=(info.status=="A")&&parent_info.bettable;info.start_time_disp_order=time_in_milliseconds(info.start_time);info.hidden=false;if(_lb_hp_cfg.geo_stream_allowed=="N")info.ev_stream_available=false;var scitem_id=_lb_hp_event_id_prefix+info.ev_id,pscone_id=_lb_hp_events_table_id_prefix+info.ev_type_id;if(!scone_exists(pscone_id))return;var was_visible=scone_item_exists(scitem_id),now_visible=(info.displayed=="Y");if(!first_build&&!was_visible&&now_visible){info.new_item=true;push_schedule_unhighlight_new_item(lb_hp_obj,"EVENT",data.ev_id)}else info.new_item=false;var html=tmpl_play("lb_hp_event",info),sort_info={disporder:info.disporder,ev_id:info.ev_id,start_time_disp_order:info.start_time_disp_order},class_elem_name=_lb_hp_class_id_prefix+parent_info.ev_class_id,class_sort_info=scone_get_item_info(class_elem_name),type_elem_name=_lb_hp_type_id_prefix+info.ev_type_id,type_sort_info=scone_get_item_info(type_elem_name);if(!was_visible&&now_visible){scone_add_item(pscone_id,scitem_id,html,sort_info);var cscone_id=_lb_hp_markets_id_prefix+data.ev_id;scone_create(cscone_id,{},null,null);_lb_hp_calc_ev_counts();if(push_get_ev_counts(lb_hp_obj,"TYPE",info.ev_type_id)==1&&!first_build){if(bir_top_displayed_type=="TYPE"&&bir_top_displayed_id!=info.ev_type_id){parent_info.hidden=true}else parent_info.hidden=false;var type_html=tmpl_play("lb_hp_type",parent_info);scone_replace_item(type_elem_name,type_html,type_sort_info,true);if(bir_top_displayed_type=="CLASS"&&bir_top_displayed_id!=parent_info.ev_class_id){class_info.hidden=true}else class_info.hidden=false;_lb_hp_replace_class(class_elem_name,class_info,class_sort_info);var hp_area_elem=document.getElementById(_lb_hp_class_area_id),no_data_elem=document.getElementById(_lb_hp_no_data_area_id),odd_key=document.getElementById(_lb_odd_key);hp_area_elem.style.display="";no_data_elem.style.display="none";odd_key.style.display=""};if(push_get_ev_counts(lb_hp_obj,"CLASS",parent_info.ev_class_id)>=_lb_hp_cfg.ev_collapse_threshold){class_info.collapsed=true;_lb_hp_replace_class(class_elem_name,class_info,class_sort_info)}}else if(was_visible&&now_visible){scone_replace_item(scitem_id,html,sort_info,true);_lb_hp_calc_ev_counts()}else if(was_visible&&!now_visible){scone_remove_item(scitem_id);_lb_hp_calc_ev_counts();if(push_get_ev_counts(lb_hp_obj,"TYPE",info.ev_type_id)==0){parent_info.hidden=true;var type_html=tmpl_play("lb_hp_type",parent_info);scone_replace_item(type_elem_name,type_html,type_sort_info,true)};if(push_get_ev_counts(lb_hp_obj,"CLASS",parent_info.ev_class_id)==0){class_info.hidden=true;_lb_hp_replace_class(class_elem_name,class_info,class_sort_info)};if(push_get_ev_counts(lb_hp_obj,"ALL","")==0){var hp_area_elem=document.getElementById(_lb_hp_class_area_id),no_data_elem=document.getElementById(_lb_hp_no_data_area_id),odd_key=document.getElementById(_lb_odd_key);hp_area_elem.style.display="none";no_data_elem.style.display="";odd_key.style.display="none"}};var num_events=_lb_hp_ev_count["CLASS"+info.ev_class_id];if(num_events>_lb_hp_cfg.max_events_per_class&&_lb_hp_cfg.lb_page=="CASHOUT_HP"){var last_id=document.getElementById(pscone_id).lastChild.id;scone_remove_item(last_id);_lb_hp_calc_ev_counts();if(push_get_ev_counts(lb_hp_obj,"TYPE",info.ev_type_id)==0){parent_info.hidden=true;var type_html=tmpl_play("lb_hp_type",parent_info);scone_replace_item(type_elem_name,type_html,type_sort_info,true)}};updatePeriodClock(info);if(now_visible&&(!was_visible||orig_bettable!=info.bettable))for(var ev_mkt_id in info.child_hash)_lb_hp_got_EVMKT({ev_mkt_id:ev_mkt_id,ev_id:info.ev_id});if(info.new_item==true)info.new_item=false}
function _lb_hp_got_EVMKT(data){var parent_info=_lb_hp_event_hash[data.ev_id];if(!parent_info)return;parent_info.child_hash[data.ev_mkt_id]=true;var info=_lb_hp_evmkt_hash[data.ev_mkt_id],is_new_item=!info,orig_displayed,orig_disporder,orig_name,orig_bettable,orig_hcap_values;if(is_new_item){info=data;_lb_hp_evmkt_hash[data.ev_mkt_id]=info;info.child_hash={}}else{orig_displayed=info.displayed;orig_disporder=info.disporder;orig_name=info.name;orig_bettable=info.bettable;orig_hcap_values=info.hcap_values;for(var f in data)info[f]=data[f]};info.name=info.names[_lb_hp_cfg.lang];if(info.bet_in_run!='Y')info.displayed='N';info.bettable=(info.status=="A")&&parent_info.bettable;var scitem_id=_lb_hp_market_id_prefix+info.ev_mkt_id,pscone_id=_lb_hp_markets_id_prefix+info.ev_id;info.lb_page=_lb_hp_cfg.lb_page;if(!scone_exists(pscone_id))return;var html=tmpl_play("lb_hp_market",info),was_visible=scone_item_exists(scitem_id),now_visible=(info.displayed=="Y");if(!was_visible&&now_visible){scone_add_item(pscone_id,scitem_id,html,null);var cscone_id=_lb_hp_selcns_id_prefix+data.ev_mkt_id;scone_create(cscone_id,{},lb_hp_cmp_objects.cmpSelcns,null)}else if(was_visible&&now_visible){scone_replace_item(scitem_id,html,null,true)}else if(was_visible&&!now_visible)scone_remove_item(scitem_id);if(now_visible&&(!was_visible||orig_bettable!=info.bettable))for(var ev_oc_id in info.child_hash)_lb_hp_got_SELCN({ev_oc_id:ev_oc_id,ev_mkt_id:info.ev_mkt_id})}
function _lb_hp_got_MHCAP(data){var parent_info=_lb_hp_event_hash[data.ev_id],info=_lb_hp_evmkt_hash[data.ev_mkt_id];if(!parent_info||!info)return;for(var f in data)info[f]=data[f];for(var ev_oc_id in info.child_hash)_lb_hp_got_SELCN({ev_oc_id:ev_oc_id,ev_mkt_id:info.ev_mkt_id});return}
function _lb_hp_got_SELCN(data){var parent_info=_lb_hp_evmkt_hash[data.ev_mkt_id];if(!parent_info)return;parent_info.child_hash[data.ev_oc_id]=true;var info=_lb_hp_selcn_hash[data.ev_oc_id],is_new_item=!info,orig_lp_num,orig_lp_den,orig_hcap_values;if(is_new_item){info=data;_lb_hp_selcn_hash[data.ev_oc_id]=info}else{orig_lp_num=info.lp_num;orig_lp_den=info.lp_den;orig_hcap_values=info.hcap_values;for(var f in data)info[f]=data[f]};info.lb_page=_lb_hp_cfg.lb_page;info.name=info.names[_lb_hp_cfg.lang];if(info.fb_result&&parent_info.hcap_values)info.hcap_value=parent_info.hcap_values[info.fb_result];info.bettable=(info.status=="A")&&parent_info.bettable;var scitem_id=_lb_hp_selcn_id_prefix+data.ev_oc_id,pscone_id=_lb_hp_selcns_id_prefix+parent_info.ev_mkt_id;if(!scone_exists(pscone_id))return;info.price_str=get_price_str(lb_hp_obj,info.lp_num,info.lp_den,parent_info.lp_avail,parent_info.mkt_sort);var html=tmpl_play("lb_hp_selcn",info),sort_info={disporder:info.disporder,lp_num:info.lp_num,lp_den:info.lp_den,ev_oc_id:info.ev_oc_id},was_visible=scone_item_exists(scitem_id),now_visible=(info.displayed=="Y");if(!was_visible){scone_add_item(pscone_id,scitem_id,html,sort_info)}else if(was_visible)scone_replace_item(scitem_id,html,sort_info,true);if(!is_new_item&&now_visible)push_highlight_price_change(lb_hp_obj,info.ev_oc_id,info.lp_num,info.lp_den,orig_lp_num,orig_lp_den)}
function _lb_hp_got_PRICE(data){var info=_lb_hp_selcn_hash[data.ev_oc_id];if(!info)return;var parent_info=_lb_hp_evmkt_hash[info.ev_mkt_id];if(!parent_info)return;var orig_lp_num=info.lp_num,orig_lp_den=info.lp_den;for(var f in data)info[f]=data[f];var scitem_id=_lb_hp_selcn_id_prefix+data.ev_oc_id;if(!scone_item_exists(scitem_id))return;var sort_info={disporder:info.disporder,lp_num:info.lp_num,lp_den:info.lp_den,ev_oc_id:info.ev_oc_id};scone_set_item_info(scitem_id,sort_info);var price_id=_lb_hp_selcn_link_id_prefix+info.ev_oc_id,price_el=document.getElementById(price_id);if(!price_el)return;info.price_str=get_price_str(lb_hp_obj,info.lp_num,info.lp_den,parent_info.lp_avail,parent_info.mkt_sort);price_el.innerHTML=info.price_str;push_highlight_price_change(lb_hp_obj,info.ev_oc_id,info.lp_num,info.lp_den,orig_lp_num,orig_lp_den);return}
function _lb_hp_calc_ev_counts(){_lb_hp_ev_count={};var class_info=null,total_ev_count=0,class_ev_count=0,type_ev_count=0;for(var ev_class_id in _lb_hp_class_hash){class_ev_count=0;class_otc_ev_count=0;var class_info=_lb_hp_class_hash[ev_class_id];for(var ev_type_id in class_info.child_hash)if(scone_exists(_lb_hp_events_table_id_prefix+ev_type_id)){var ev_elem_ids=scone_get_items(_lb_hp_events_table_id_prefix+ev_type_id);type_ev_count=ev_elem_ids.length;class_ev_count+=type_ev_count;total_ev_count+=type_ev_count;_lb_hp_ev_count["TYPE"+ev_type_id]=type_ev_count};_lb_hp_ev_count["CLASS"+ev_class_id]=class_ev_count};_lb_hp_ev_count.ALL=total_ev_count;total_ev_count_for_flash=total_ev_count}
function get_ev_count_for_flash(){return total_ev_count_for_flash}
function get_lang_for_flash(){return _lb_hp_cfg.lang}
function lb_hp_add_bet(ev_oc_id){bir_add_bet(lb_hp_obj,ev_oc_id,'LB_HP');return}
function lb_hp_upd_class_type_orders(){_lb_hp_class_ordering={};_lb_hp_type_ordering={};var class_container=document.getElementById(_lb_hp_class_area_id),type_container=null,c_disporder=0,t_disporder=0;for(var c=0;c<class_container.childNodes.length;c++){var class_name=class_container.childNodes[c].id,class_matches=class_name.match(_lb_hp_class_id_prefix+"*");if(class_matches){c_disporder++;var class_id=class_name.substring(_lb_hp_class_id_prefix.length,class_name.length),class_elem_name=_lb_hp_class_id_prefix+class_id,class_sort_info={disporder:c_disporder,ev_class_id:class_id};scone_set_item_info(class_elem_name,class_sort_info,true);_lb_hp_class_ordering[class_id]=c_disporder;type_container=document.getElementById(_lb_hp_types_id_prefix+class_id);t_disporder=0;for(var t=0;t<type_container.childNodes.length;t++){var type_name=type_container.childNodes[t].id,type_matches=type_name.match(_lb_hp_type_id_prefix+"*");if(type_matches){t_disporder++;var type_id=type_name.substring(_lb_hp_type_id_prefix.length,type_name.length),type_elem_name=_lb_hp_type_id_prefix+type_id,type_sort_info={disporder:t_disporder,ev_type_id:type_id};scone_set_item_info(type_elem_name,type_sort_info,true);_lb_hp_type_ordering[type_id]=t_disporder}}}}}
function lb_hp_schedule_reload(){document.PollingAjaxHelper.setInterval("lb_hp_schedule_reload",_lb_hp_reload,_lb_hp_cfg.reload_period)}
function _lb_hp_reload(){if(_lb_hp_cfg.reload_url=="")return;var clientdata={id:'homepage_js'},url=_lb_hp_cfg.reload_url+"&hash="+_lb_hp_cfg.reload_hash;_lb_hp_make_ajax_get_request(url,clientdata,_lb_hp_got_ajax_content)}
function _lb_hp_make_ajax_get_request(url,clientdata,callback){if(document.PollingAjaxHelper.checkSemaphore()){document.PollingAjaxHelper.setTimeout("_lb_hp_make_ajax_get_request",function(){_lb_hp_make_ajax_get_request(url,clientdata,callback)},300);return};document.PollingAjaxHelper.aquireSemaphore();var req=null;if(window.XMLHttpRequest){req=new XMLHttpRequest()}else if(window.ActiveXObject)req=new ActiveXObject('Microsoft.XMLHTTP');if(req){req.onreadystatechange=function(){if(req.readyState!=4)return;var reqStatus;try{reqStatus=req.status}catch(e){reqStatus=''};if(reqStatus!=200){document.PollingAjaxHelper.releaseSemaphore();callback(url,clientdata,false,'HTTP')}else{document.PollingAjaxHelper.releaseSemaphore();callback(url,clientdata,true,req.responseText)}};try{req.open('GET',url,true);req.send(null)}catch(e){document.PollingAjaxHelper.releaseSemaphore();callback(url,clientdata,false,'UNSUPPORTED')}}else{document.PollingAjaxHelper.releaseSemaphore();callback(url,clientdata,false,'UNSUPPORTED')}}
function _lb_hp_got_ajax_content(url,clientdata,ok,response){var holder_el=document.getElementById(clientdata.id);if(ok){if(response=="")return;var parts=_lb_hp_parse_script_tags(response);if(holder_el)holder_el.innerHTML=parts[0];if(parts[1].length)try{_lb_hp_global_eval(parts[1])}catch(e){ok=false}}}
function _lb_hp_parse_script_tags(str){var html='',js='',i=0,state='HTML',script_re=new RegExp('<(/?)script([^>]*)>','gi');while((mtch=script_re.exec(str))!=null){mS=mtch.index;if(state=='HTML'){html+=str.substring(i,mS)}else js+=str.substring(i,mS)+';\n';var closer=mtch[1],attrs=mtch[2];if(closer=='/'){state='HTML'}else if(attrs.charAt(attrs.length-1)!='/'&&attrs.indexOf('src=')==-1)state='JS';i=script_re.lastIndex};if(state=='HTML'){html+=str.substring(i)}else js+=str.substring(i);return[html,js]}
function lb_hp_collapse_expand(type,elem_id,collapsed){var id,info;if(type=="ALL"){for(var class_id in _lb_hp_class_hash){info=_lb_hp_class_hash[class_id];info.collapsed=collapsed}}else if(type=="CLASS"){id=elem_id.substring(_lb_hp_types_id_prefix.length,elem_id.length);info=_lb_hp_class_hash[id];info.collapsed=collapsed}else if(type=="TYPE"){id=elem_id.substring(_lb_hp_events_div_id_prefix.length,elem_id.length);info=_lb_hp_type_hash[id];info.collapsed=collapsed}}
function lb_hp_filter_page(type,id){_lb_hp_last_tab_level=type;_lb_hp_last_tab_id=id;lb_top_build_tabs(type,id);var otc_cbox=document.getElementById("couchTvChans");if(typeof otc_cbox=='undefined'||otc_cbox==null){var otc_filter=false}else var otc_filter=otc_cbox.checked;var otc_pref=get_pref('BIR_ON_THE_COUCH');if(otc_pref!=null){otc_pref=otc_pref.split('*')}else otc_pref="";var otc_events_hidden=0,otc_types_hidden=0,types_class_id="";if(type=="TYPE"){var type_info=_lb_hp_type_hash[id];if(type_info){var types_class_id=type_info.ev_class_id}else types_class_id=id}else types_class_id=id;if(!scone_exists(_lb_hp_class_area_id))return;var class_scones=scone_get_items(_lb_hp_class_area_id);_lb_hp_calc_ev_counts();for(var c=0;c<class_scones.length;c++){var class_elem_name=class_scones[c],class_id=class_elem_name.substring(_lb_hp_class_id_prefix.length,class_elem_name.length),c_sort_info=scone_get_item_info(class_elem_name),class_info=_lb_hp_class_hash[class_id];if(!class_info)continue;if(!scone_exists(_lb_hp_types_id_prefix+class_id))continue;var type_scones=scone_get_items(_lb_hp_types_id_prefix+class_id);otc_types_hidden=0;for(var t=0;t<type_scones.length;t++){var type_elem_name=type_scones[t],type_id=type_elem_name.substring(_lb_hp_type_id_prefix.length,type_elem_name.length),event_container_name=_lb_hp_events_table_id_prefix+type_id,t_sort_info=scone_get_item_info(type_elem_name),ev_count=push_get_ev_counts(lb_hp_obj,"TYPE",type_id),type_info=_lb_hp_type_hash[type_id];if(!type_info)continue;if(!scone_exists(_lb_hp_events_table_id_prefix+type_id))continue;var ev_scones=scone_get_items(_lb_hp_events_table_id_prefix+type_id);otc_events_hidden=0;for(var e=0;e<ev_scones.length;e++){var event_elem_name=ev_scones[e],ev_id=event_elem_name.substring(_lb_hp_event_id_prefix.length,event_elem_name.length),e_sort_info=scone_get_item_info(event_elem_name),ev_info=_lb_hp_event_hash[ev_id];if(!ev_info)continue;if(otc_filter){ev_info.hidden=true;for(var x=0;x<otc_pref.length;x++){var pref_chan=otc_pref[x],break_out=false;for(var s=0;s<ev_info.stations.codes.length;s++)if(pref_chan==ev_info.stations.codes[s]){ev_info.hidden=false;break_out=true;break};if(break_out)break};if(ev_info.hidden==true)otc_events_hidden++}else ev_info.hidden=false;var html=tmpl_play("lb_hp_event",ev_info);scone_replace_item(event_elem_name,html,e_sort_info,true)};if(otc_events_hidden==ev_scones.length){type_info.hidden=true;otc_types_hidden++}else if(type==""){if(ev_count>0){type_info.hidden=false}else type_info.hidden=true}else if(type=="TYPE"&&type_id==id){if(ev_count>0){type_info.hidden=false}else type_info.hidden=true}else if(type=="TYPE"&&type_id!=id){type_info.hidden=true}else if(type=="CLASS"&&types_class_id==id){if(ev_count>0){type_info.hidden=false}else type_info.hidden=true}else if(type=="CLASS"&&types_class_id!=id)type_info.hidden=true;var html=tmpl_play("lb_hp_type",type_info);scone_replace_item(type_elem_name,html,t_sort_info,true)};if(otc_types_hidden==type_scones.length){class_info.hidden=true}else if(type==""){class_info.hidden=false;if(push_get_ev_counts(lb_hp_obj,"CLASS",class_info.ev_class_id)>_lb_hp_cfg.ev_collapse_threshold){class_info.collapsed=true}else class_info.collapsed=false}else if(type=="CLASS"&&class_id==id){class_info.hidden=false;class_info.collapsed=false}else if(type=="CLASS"&&class_id!=id){class_info.hidden=true}else if(type=="TYPE"&&class_id!=types_class_id){class_info.hidden=true}else if(type=="TYPE"&&class_id==types_class_id){class_info.hidden=false;class_info.collapsed=false};_lb_hp_replace_class(class_elem_name,class_info,c_sort_info)};setEventCounts()};var _lb_hp_global_eval=function(src){if(window.execScript){window.execScript(src);return};var fn=function(){window.eval.call(window,src)};fn()}
function show_hide_couch_evts(){lb_hp_filter_page(_lb_hp_last_tab_level,_lb_hp_last_tab_id);var otc_cbox=document.getElementById("couchTvChans"),channels=get_pref('BIR_ON_THE_COUCH'),no_channels_selected=document.getElementById('on-the-couch-no-events');if(channels==null&&otc_cbox.checked==true){no_channels_selected.style.display='block'}else if(channels==null&&otc_cbox.checked==false)no_channels_selected.style.display='';if(channels!=null){var class_info=null,total_ev_count=get_ev_count_for_flash(),class_ev_count=0,hidden_ev_count=1;for(var ev_class_id in _lb_hp_class_hash){var class_info=_lb_hp_class_hash[ev_class_id];for(var ev_type_id in class_info.child_hash){var ev_name=_lb_hp_type_id_prefix+ev_type_id,curr=document.getElementById(ev_name);if(document.getElementById(ev_name).style.display=='none')hidden_ev_count++}};if(total_ev_count==hidden_ev_count&&otc_cbox.checked==true){no_channels_selected.style.display='none'}else if(total_ev_count>hidden_ev_count&&otc_cbox.checked==true){no_channels_selected.style.display='none'}else if(total_ev_count<hidden_ev_count&&otc_cbox.checked==true){no_channels_selected.style.display='block'}else if(otc_cbox.checked==false)no_channels_selected.style.display='none'}}
function update_and_apply(inputName){var otc_cbox=document.getElementById("couchTvChans");if(inputName=='apply_button'){otc_cbox.checked=true;update_chan_pref();otc_cbox.style.display=""}else{otc_cbox.style.display="none";update_chan_pref()}};var couch_station_codes=""
function selectDeselect(action){var couchVal="";if(action=='select'){for(var i in couch_station_codes){elm=document.getElementById(couch_station_codes[i]);if(typeof elm!='undefined'&&elm!=null)elm.checked=true}}else for(var i in couch_station_codes){elm=document.getElementById(couch_station_codes[i]);if(typeof elm!='undefined'&&elm!=null)elm.checked=false}}
function check_chans(){var channels=get_pref('BIR_ON_THE_COUCH');if(typeof channels=='undefined'||channels==null)return;var chanArray=channels.split("*");for(var x=0;x<chanArray.length;x++){elm=document.getElementById(chanArray[x]);if(typeof elm!='undefined'&&elm!=null)elm.checked=true}}
function update_chan_pref(){var couchVal="";for(var i in couch_station_codes){elm=document.getElementById(couch_station_codes[i]);if(typeof elm!='undefined'&&elm!=null)couchVal+=(elm.checked?couch_station_codes[i]+"*":'')};if(couchVal.charAt(couchVal.length-1)=='*')couchVal=couchVal.slice(0,couchVal.length-1);set_pref('BIR_ON_THE_COUCH',couchVal);var url='##TP_BIR_CGI_URL##?action=go_update_chan_prefs';$j.ajax({url:url,type:'GET',success:function(transport){document.getElementById('tv-channels-pop').style.display='none'}});show_hide_couch_evts()};var lb_main_events_present=true
function lb_me_init(call_type,events,markets,selcns,server_time_year,server_time_month,server_time_day,server_time_hour,server_time_min,server_time_sec,date,init_msg_id,cfg){var channels=[];_lb_me_last_msg_id=init_msg_id;for(var f in cfg)_lb_me_cfg[f]=cfg[f];if(call_type=="http"){_lb_me_store_templates();_lb_me_event_hash={};_lb_me_evmkt_hash={};_lb_me_selcn_hash={};scone_create(_lb_me_events_id_prefix,{},lb_me_cmp_objects.cmpEvents,null);lb_me_schedule_reload();var first_build=true;initPeriodClocks(server_time_year,server_time_month,server_time_day,server_time_hour,server_time_min,server_time_sec,_lb_me_cfg.lang)}else{push_hash_prune_drilldown(lb_me_obj,"EVENT","EVOC","EVENT",events);push_hash_prune_drilldown(lb_me_obj,"EVENT","EVOC","EVMKT",markets);push_hash_prune_drilldown(lb_me_obj,"EVENT","EVOC","EVOC",selcns);var first_build=false};_lb_me_server_date=date;_lb_me_system_date=new Date().getTime();for(var i=0;i<events.length;i++){_lb_me_got_EVENT(events[i],first_build,false);if(!_lb_me_channels["EVENT"+events[i].ev_id]){channels.push("sEVENT"+ps_connect_lpad_id(events[i].ev_id));_lb_me_channels["EVENT"+events[i].ev_id]=true}};for(var i=0;i<markets.length;i++){if(call_type=="http"||(!_lb_me_evmkt_hash[markets[i].ev_mkt_id]))_lb_me_got_EVMKT(markets[i],first_build,false);if(!_lb_me_channels["MARKET"+markets[i].ev_mkt_id]){channels.push("sEVMKT"+ps_connect_lpad_id(markets[i].ev_mkt_id));channels.push("SEVMKT"+ps_connect_lpad_id(markets[i].ev_mkt_id));_lb_me_channels["MARKET"+markets[i].ev_mkt_id]=true}};for(var i=0;i<selcns.length;i++)if(call_type=="http"||(!_lb_me_selcn_hash[selcns[i].ev_oc_id]))_lb_me_got_SELCN(selcns[i],false);if(channels.length>0){ps_connect_register("lb_me"+me_idx,_lb_me_got_msg,channels,init_msg_id);me_idx++};var me_area_elem=document.getElementById(_lb_me_events_id_prefix),no_data_elem=document.getElementById(_lb_me_no_data_area_id),ev_ids=scone_get_items(_lb_me_events_id_prefix);if(ev_ids.length<2&&ev_ids.length>0){document.getElementById('lb_me_nav').style.visibility="hidden";me_area_elem.style.display="";no_data_elem.style.display="none";if(call_type!="http")loadProgressBar()}else if(ev_ids.length==0){document.getElementById('lb_me_nav').style.visibility="hidden";me_area_elem.style.display="none";no_data_elem.style.display=""}else{document.getElementById('lb_me_nav').style.visibility="visible";document.getElementById(_lb_me_event_id_prefix+events[1].ev_id).style.display="none";document.getElementById(_lb_me_event_id_prefix+events[0].ev_id).style.display="block";_lb_me_eventA=events[0].ev_id;_lb_me_eventB=events[1].ev_id;rotateEventL();me_area_elem.style.display="";no_data_elem.style.display="none"};return};var _lb_me_no_data_area_id="no_bir_me_data",_lb_me_events_id_prefix="lb_me_events",_lb_me_event_id_prefix="lb_me_event_",_lb_me_evmkts_id_prefix="lb_me_evmkts_",_lb_me_evmkt_id_prefix="lb_me_evmkt_",_lb_me_selcns_id_prefix="lb_me_selcns_",_lb_me_selcn_id_prefix="lb_me_selcn_",_lb_me_event_clock_id_prefix="lb_me_clock_",_lb_me_price_id_prefix="lb_me_price_",_lb_me_event_hash={},_lb_me_evmkt_hash={},_lb_me_selcn_hash={},_lb_me_eventA="",_lb_me_eventB=""
function lb_me_object(){return};lb_me_object.prototype.getConfig=function(){return _lb_me_cfg};lb_me_object.prototype.getHash=function(identifier){var ret="";switch(identifier){case"EVENT":if(_lb_me_event_hash)ret=_lb_me_event_hash;break;case"EVMKT":if(_lb_me_evmkt_hash)ret=_lb_me_evmkt_hash;break;case"EVOC":if(_lb_me_selcn_hash)ret=_lb_me_selcn_hash;break;default:ret=""};return ret};lb_me_object.prototype.getHashId=function(identifier,id){var ret="";switch(identifier){case"EVENT":if(_lb_me_event_hash&&_lb_me_event_hash[id])ret=_lb_me_event_hash[id];break;case"EVMKT":if(_lb_me_evmkt_hash&&_lb_me_evmkt_hash[id])ret=_lb_me_evmkt_hash[id];break;case"EVOC":if(_lb_me_selcn_hash&&_lb_me_selcn_hash[id])ret=_lb_me_selcn_hash[id];break;default:ret=""};return ret};lb_me_object.prototype.getIdPrefix=function(identifier){var ret="";switch(identifier){case"EVENT":if(_lb_me_event_id_prefix)ret=_lb_me_event_id_prefix;break;case"EVMKT":if(_lb_me_market_id_prefix)ret=_lb_me_market_id_prefix;break;case"EVOC":if(_lb_me_selcn_id_prefix)ret=_lb_me_selcn_id_prefix;break;default:ret=""};return ret};lb_me_object.prototype.deleteFromHash=function(identifier,id){switch(identifier){case"EVENT":if(_lb_me_event_hash)delete _lb_me_event_hash[id];break;case"EVMKT":if(_lb_me_evmkt_hash)delete _lb_me_evmkt_hash[id];break;case"EVOC":if(_lb_me_selcn_hash)delete _lb_me_selcn_hash[id];break;default:};return};lb_me_object.prototype.gotPushData=function(identifier,data){switch(identifier){case"PRICE":_lb_me_got_PRICE(data);break;case"SELCN":_lb_me_got_SELCN(data,true);break;case"MHCAP":_lb_me_got_MHCAP(data);break;case"EVMKT":_lb_me_got_EVMKT(data,false,true);break;case"EVENT":_lb_me_got_EVENT(data,false,true);break;default:};return};var lb_me_obj=new lb_me_object(),lb_me_cmp_objects=new function(){}();lb_me_cmp_objects=new push_hash_cmp_objects();lb_me_cmp_objects.cmpEvents=function(cmpMode,evA,evB){var d=evA.disporder-evB.disporder;if(d<0){return-1}else if(d==0){return 0}else return 1};var _lb_me_channels={},me_idx=0,mev_num=0
function _lb_me_store_templates(){var tmp=[];tmp.push('	<div id="lb_me_event_<%ev_id%>">\n');tmp.push('		<div class="event" style="background: url(<%img_url%>/<%ev_image%>) no-repeat" <%IF ev_has_bet_in_run == "N" || !in_past%>onclick="lb_go_mevt_no_bir(<%ev_id%>,<%ev_type%>)"<%ELSE%>onclick="lb_go_mevt_bir(<%ev_id%>,<%ev_type%>)"<%END%>>\n');tmp.push('			<%IF in_past%>\n');tmp.push('			<div class="infoNow_<%lang%>" style="height: 40px">\n');tmp.push('				<div class="name-evt"><span style="display: none"><%IF score_home != "" && score_away != ""%> <%score_home%> - <%score_away%><%END%></span>\n<a style="float:left" href="javascript:void(0)" <%IF ev_has_bet_in_run == "N"%>onclick="lb_go_mevt_no_bir(<%ev_id%>,<%ev_type%>)"<%ELSE%>onclick="lb_go_mevt_bir(<%ev_id%>,<%ev_type%>)"<%END%>><strong><%name%></strong></a><%IF venue !=""%><span title="<%venue%>" class="venueIcon left" style="float:left; clear:right">&nbsp;</span><%END%></div>\n');tmp.push('				<%IF ev_type=="FB" && period_id!="" && show_bir_clocks == "Y"%><div class="time" id="lb_me_clock_<%ev_id%>"></div><%ELSE%><div class="time" ><%time%></div><%END%>\n');tmp.push('				<div class="type-evt" style="display: none"><span class="left"><%class_name%><%IF score_home != "" && score_away != ""%> <%score_home%> - <%score_away%><%END%></span>\n</div>\n');tmp.push('				<div class="betnow"><a href="javascript:void(0)" <%IF ev_has_bet_in_run == "N"%>onclick="lb_go_mevt_no_bir(<%ev_id%>,<%ev_type%>)"<%ELSE%>onclick="lb_go_mevt_bir(<%ev_id%>,<%ev_type%>)"<%END%>>Bet Now</a></div>\n');tmp.push('			<%ELSE%>\n');tmp.push('			<div class="infoCU_<%lang%>">\n');tmp.push('				<div class="name-evt"><a href="javascript:void(0)" onclick="lb_go_mevt_no_bir(<%ev_id%>,<%ev_type%>)"><%name%></a></div>\n');tmp.push('				<div class="time"><%time%></div>\n');tmp.push('				<div class="type-evt"><span style="display: none"><%class_name%> <%start_time%></span>Current betting trends</div>\n');tmp.push('				<div class="betnow"><a href="javascript:void(0)" onclick="lb_go_mevt_no_bir(<%ev_id%>,<%ev_type%>)">Bet Now</a></div>\n');tmp.push('			<%END%>\n');tmp.push('			</div>\n');tmp.push('		</div>\n');tmp.push('		<div id="lb_me_evmkts_<%ev_id%>"></div>\n');tmp.push('	</div>\n');tmpl_store("lb_me_event",tmp.join(""));var tmp=[];tmp.push('	<div id="lb_me_evmkt_<%ev_mkt_id%>">\n');tmp.push('		<div class="pop" onclick="" >\n');tmp.push('			<h3 style="display: none"><%bet_pop%></h3>\n');tmp.push('			<div id="lb_me_selcns_<%ev_mkt_id%>"></div>\n');tmp.push('		</div>\n');tmp.push('	</div>\n');tmpl_store("lb_me_evmkt",tmp.join(""));var tmp=[];tmp.push('	<div class="item" id="lb_me_selcn_<%ev_oc_id%>">\n');tmp.push('		<div class="greybar"><div class="bluebar progressBar" id="bar_<%ev_oc_id%>"></div></div><p class="percentageValue" id="lb_me_perc_<%ev_oc_id%>"><%b_perc%>\%</p><p style="width:115px"><a class="popName" title="<%comp_name%>" <%IF bettable%>onclick="lb_me_add_bet(<%ev_oc_id%>)"<%END%>><%name%></a></p><div <%IF bettable%>class="odd right"<%ELSE%>class="suspended right"<%END%>><a title="Click to add to Betslip" id="lb_me_price_<%ev_oc_id%>" <%IF bettable%>onclick="lb_me_add_bet(<%ev_oc_id%>)"<%END%>><%price_str%></a></div>\n');tmp.push('		<div class="clear"></div>\n');tmp.push('	</div>\n');tmpl_store("lb_me_selcn",tmp.join(""))};var _lb_me_cfg={lang:"en",bet_threshold:0,name_truncate_threshold:8,price_str_type:"ODDS",price_str_type_ah:"DECIMAL",price_str_type_hl:"DECIMAL",price_str_sep:"-"},_lb_me_server_date="",_lb_me_system_date=0
function _lb_me_got_msg(msg){bir_got_msg(lb_me_obj,msg);return}
function _lb_me_got_EVENT(data,first_build,push_msg){var info=_lb_me_event_hash[data.ev_id],is_new_item=!info,orig_bettable;if(is_new_item){if(push_msg)return;info=data;_lb_me_event_hash[data.ev_id]=info;info.child_hash={};addClockEvent(data.ev_id,data.periods,_lb_me_event_clock_id_prefix);info.lang=_lb_me_cfg.lang}else{orig_bettable=info.bettable;for(var f in data)info[f]=data[f]};info.name=info.names[_lb_me_cfg.lang];info.name=trunc_string(info.name,_lb_me_cfg.name_truncate_threshold,'...');info.start_time_xl=info.start_time_xls[_lb_me_cfg.lang];info.bettable=(info.status=="A");info.img_url=_lb_me_cfg.image_url;info.ev_type="\'"+info.ev_class_type+"\'";var susp_time_ms=0,start_time=time_in_milliseconds(info.start_time);if(info.suspend_at!="")susp_time_ms=time_in_milliseconds(info.suspend_at);var cur_time=time_in_milliseconds(_lb_me_server_date)+((new Date().getTime())-_lb_me_system_date),start_time_dif=cur_time-start_time,susp_time_dif=cur_time-susp_time_ms;if(info.ev_has_bet_in_run=="N"&&info.displayed=="Y")if(info.is_off=="Y"){info.displayed="N"}else if(info.is_off=="_"&&start_time_dif>0){info.displayed="N"}else if(info.is_off=="N"&&susp_time_dif>0)info.displayed="N";if(start_time_dif>0){info.in_past=1}else info.in_past=0;info.time=_lb_me_calculate_time_to_start(cur_time,start_time);var scitem_id=_lb_me_event_id_prefix+info.ev_id,pscone_id=_lb_me_events_id_prefix,html=tmpl_play("lb_me_event",info),sort_info={disporder:info.disporder,ev_id:info.ev_id},me_area_elem=document.getElementById(_lb_me_events_id_prefix),no_data_elem=document.getElementById(_lb_me_no_data_area_id),was_visible=scone_item_exists(scitem_id),now_visible=(info.displayed=="Y");if(!was_visible&&now_visible){scone_add_item(pscone_id,scitem_id,html,sort_info);var cscone_id=_lb_me_evmkts_id_prefix+data.ev_id;scone_create(cscone_id,{},lb_me_cmp_objects.cmpEvMkts,null);me_area_elem.style.display="";no_data_elem.style.display="none"}else if(was_visible&&now_visible){scone_replace_item(scitem_id,html,sort_info,true)}else if(was_visible&&!now_visible){scone_remove_item(scitem_id);var ev_ids=scone_get_items(_lb_me_events_id_prefix);if(ev_ids.length==0){me_area_elem.style.display="none";no_data_elem.style.display="";document.getElementById('lb_me_nav').style.visibility="hidden"}else if(ev_ids.length==1)document.getElementById('lb_me_nav').style.visibility="hidden"};updatePeriodClock(info);if(now_visible)for(var ev_mkt_id in info.child_hash)_lb_me_got_EVMKT({ev_mkt_id:ev_mkt_id,ev_id:info.ev_id},first_build,false);if(push_msg){var ev_ids=scone_get_items(_lb_me_events_id_prefix);if(ev_ids.length<2){document.getElementById('lb_me_nav').style.visibility="hidden";if(ev_ids.length==1)document.getElementById(ev_ids[0]).style.display="block"}else{document.getElementById('lb_me_nav').style.visibility="visible";_lb_me_eventA=ev_ids[0].substring(_lb_me_event_id_prefix.length,ev_ids[0].length);_lb_me_eventB=ev_ids[1].substring(_lb_me_event_id_prefix.length,ev_ids[1].length);if(_lb_me_event_hash[_lb_me_eventB].disporder<_lb_me_event_hash[_lb_me_eventA].disporder){var temp;temp=_lb_me_eventB;_lb_me_eventB=_lb_me_eventA;_lb_me_eventA=temp;document.getElementById(ev_ids[1]).style.display="block";document.getElementById(ev_ids[0]).style.display="none"}else{document.getElementById(ev_ids[0]).style.display="block";document.getElementById(ev_ids[1]).style.display="none"};rotateEventL()}}}
function _lb_me_got_EVMKT(data,first_build,push_msg){var parent_info=_lb_me_event_hash[data.ev_id];if(!parent_info)return;parent_info.child_hash[data.ev_mkt_id]=true;var info=_lb_me_evmkt_hash[data.ev_mkt_id],is_new_item=!info,orig_displayed,orig_disporder,orig_name,orig_bettable,orig_hcap_values;if(is_new_item){info=data;_lb_me_evmkt_hash[data.ev_mkt_id]=info;info.child_hash={}}else{orig_displayed=info.displayed;orig_disporder=info.disporder;orig_name=info.name;orig_bettable=info.bettable;orig_hcap_values=info.hcap_values;for(var f in data)info[f]=data[f]};info.bet_pop=_lb_me_bet_popularity;info.is_new=(is_new_item&&!first_build)||(!is_new_item&&orig_displayed!=info.displayed&&info.displayed=="Y");info.name=info.names[_lb_me_cfg.lang];info.bettable=false;if((info.status=="A")&&(parent_info.status=="A"))info.bettable=true;if(info.blurb==undefined)info.blurb="";var scitem_id=_lb_me_evmkt_id_prefix+data.ev_mkt_id,pscone_id=_lb_me_evmkts_id_prefix+parent_info.ev_id,html=tmpl_play("lb_me_evmkt",info),sort_info={disporder:info.disporder,ev_mkt_id:info.ev_mkt_id},was_visible=scone_item_exists(scitem_id),now_visible=(info.displayed=="Y");if(parent_info.status=="S")now_visible=false;if(info.tot_bets>=_lb_me_cfg.bet_threshold)if(!was_visible&&now_visible){scone_add_item(pscone_id,scitem_id,html,sort_info);var cscone_id=_lb_me_selcns_id_prefix+data.ev_mkt_id;scone_create(cscone_id,{},lb_me_cmp_objects.cmpSelcns,null)}else if(was_visible&&now_visible){scone_replace_item(scitem_id,html,sort_info,true)}else if(was_visible&&!now_visible)scone_remove_item(scitem_id);if(now_visible&&(!was_visible||orig_bettable!=info.bettable||parent_info.status=="A")){for(var ev_oc_id in info.child_hash)_lb_me_got_SELCN({ev_oc_id:ev_oc_id,ev_mkt_id:info.ev_mkt_id},false);if(push_msg)loadProgressBar()}}
function _lb_me_got_SELCN(data,push_msg){var parent_info=_lb_me_evmkt_hash[data.ev_mkt_id];if(!parent_info)return;parent_info.child_hash[data.ev_oc_id]=true;parent_parent_info=_lb_me_event_hash[parent_info.ev_id];var info=_lb_me_selcn_hash[data.ev_oc_id],is_new_item=!info,orig_lp_num,orig_lp_den;if(is_new_item){info=data;_lb_me_selcn_hash[data.ev_oc_id]=info}else{orig_lp_num=info.lp_num;orig_lp_den=info.lp_den;orig_hcap_values=info.hcap_values;for(var f in data)info[f]=data[f]};var b_perc=Math.round(100*info.bets/parent_info.tot_bets);info.b_perc=parseInt(b_perc);info.name=info.names[_lb_me_cfg.lang];info.comp_name=info.name;info.name=trunc_string(info.name,_lb_me_cfg.name_truncate_threshold,'...');if(info.fb_result&&parent_info.hcap_values)info.hcap_value=parent_info.hcap_values[info.fb_result];info.bettable=(info.status=="A")&&parent_info.bettable;info.price_str=get_price_str(lb_me_obj,info.lp_num,info.lp_den,parent_info.lp_avail,parent_info.mkt_sort);var scitem_id=_lb_me_selcn_id_prefix+info.ev_oc_id,pscone_id=_lb_me_selcns_id_prefix+parent_info.ev_mkt_id;if(!scone_exists(pscone_id))return;var html=tmpl_play("lb_me_selcn",info),sort_info={disporder:info.disporder,lp_num:info.lp_num,lp_den:info.lp_den,ev_oc_id:info.ev_oc_id},was_visible=scone_item_exists(scitem_id),now_visible=(info.displayed=="Y");if(parent_parent_info.status=="S")now_visible=false;if(!was_visible&&now_visible){scone_add_item(pscone_id,scitem_id,html,sort_info)}else if(was_visible&&now_visible){scone_replace_item(scitem_id,html,sort_info,true)}else if(was_visible&&!now_visible)scone_remove_item(scitem_id);if(push_msg)loadProgressBar()}
function _lb_me_got_PRICE(data){var info=_lb_me_selcn_hash[data.ev_oc_id];if(!info)return;var parent_info=_lb_me_evmkt_hash[info.ev_mkt_id];if(!parent_info)return;var orig_lp_num=info.lp_num,orig_lp_den=info.lp_den;for(var f in data)info[f]=data[f];var scitem_id=_lb_me_selcn_id_prefix+data.ev_oc_id;if(!scone_item_exists(scitem_id))return;var sort_info={disporder:info.disporder,lp_num:info.lp_num,lp_den:info.lp_den,ev_oc_id:info.ev_oc_id};scone_set_item_info(scitem_id,sort_info);var price_id=_lb_me_price_id_prefix+info.ev_oc_id,price_el=document.getElementById(price_id);if(!price_el)return;info.price_str=get_price_str(lb_me_obj,info.lp_num,info.lp_den,parent_info.lp_avail,parent_info.mkt_sort);price_el.innerHTML=info.price_str;return}
function _lb_me_got_MHCAP(data){var parent_info=_lb_me_event_hash[data.ev_id],info=_lb_me_evmkt_hash[data.ev_mkt_id];if(!parent_info||!info)return;for(var f in data)info[f]=data[f];for(var ev_oc_id in info.child_hash)_lb_me_got_SELCN({ev_oc_id:ev_oc_id,ev_mkt_id:info.ev_mkt_id},false);return}
function _lb_me_reload(){if(_lb_me_cfg.reload_url=="")return;var clientdata={id:'main_event_js'},url=_lb_me_cfg.reload_url+"&hash="+_lb_me_cfg.reload_hash;_lb_me_make_ajax_get_request(url,clientdata,_lb_me_got_ajax_content)}
function lb_me_schedule_reload(){document.PollingAjaxHelper.setInterval("lb_me_schedule_reload",_lb_me_reload,_lb_me_cfg.reload_period)}
function _lb_me_make_ajax_get_request(url,clientdata,callback){if(document.PollingAjaxHelper.checkSemaphore()){document.PollingAjaxHelper.setTimeout("_lb_me_make_ajax_get_request",function(){_lb_me_make_ajax_get_request(url,clientdata,callback)},300);return};document.PollingAjaxHelper.aquireSemaphore();var req=null;if(window.XMLHttpRequest){req=new XMLHttpRequest()}else if(window.ActiveXObject)req=new ActiveXObject('Microsoft.XMLHTTP');if(req){req.onreadystatechange=function(){if(req.readyState!=4)return;var reqStatus;try{reqStatus=req.status}catch(e){reqStatus=''};if(reqStatus!=200){document.PollingAjaxHelper.releaseSemaphore();callback(url,clientdata,false,'HTTP')}else{document.PollingAjaxHelper.releaseSemaphore();callback(url,clientdata,true,req.responseText)}};try{req.open('GET',url,true);req.send(null)}catch(e){document.PollingAjaxHelper.releaseSemaphore();callback(url,clientdata,false,'UNSUPPORTED')}}else{document.PollingAjaxHelper.releaseSemaphore();callback(url,clientdata,false,'UNSUPPORTED')}}
function _lb_me_got_ajax_content(url,clientdata,ok,response){var holder_el=document.getElementById(clientdata.id);if(ok){if(response=="")return;var parts=_lb_me_parse_script_tags(response);if(holder_el)holder_el.innerHTML=parts[0];if(parts[1].length)try{_lb_me_global_eval(parts[1])}catch(e){ok=false}}}
function _lb_me_parse_script_tags(str){var html='',js='',i=0,state='HTML',script_re=new RegExp('<(/?)script([^>]*)>','gi');while((mtch=script_re.exec(str))!=null){mS=mtch.index;if(state=='HTML'){html+=str.substring(i,mS)}else js+=str.substring(i,mS)+';\n';var closer=mtch[1],attrs=mtch[2];if(closer=='/'){state='HTML'}else if(attrs.charAt(attrs.length-1)!='/'&&attrs.indexOf('src=')==-1)state='JS';i=script_re.lastIndex};if(state=='HTML'){html+=str.substring(i)}else js+=str.substring(i);return[html,js]};var _lb_me_global_eval=function(src){if(window.execScript){window.execScript(src);return};var fn=function(){window.eval.call(window,src)};fn()}
function _lb_me_time_in_days_hours_mins(time){var days,hours,minutes,ret_time="";time=parseInt(time/(1e3*60));days=parseInt(time/(60*24));minutes=parseInt(time%60);hours=parseInt((time/60)%24);if(days!=0)ret_time=days+" "+_lb_me_days+" ";if(hours!=0||days!=0)ret_time=ret_time+hours+" "+_lb_me_hours+" : ";ret_time=ret_time+minutes+" "+_lb_me_mins;return ret_time}
function _lb_me_calculate_time_to_start(cur_time,start_time){var t_dif=start_time-cur_time,ret_time="";if(t_dif>0){ret_time=_lb_me_starts+" "+_lb_me_time_in_days_hours_mins(t_dif)}else{t_dif=-t_dif;ret_time=_lb_me_started+" "+_lb_me_time_in_days_hours_mins(t_dif)+" "+_lb_me_ago};return ret_time};var loadProgressBar=function(e){var _lb_me_perc_mark_array={};for(var f in _lb_me_selcn_hash){var int_info=_lb_me_selcn_hash[f];if(!_lb_me_perc_mark_array[int_info.ev_mkt_id]){_lb_me_update_percentages(int_info.ev_mkt_id);_lb_me_perc_mark_array[int_info.ev_mkt_id]=true};var percent=parseInt($j('#bar_'+f).parent().parent().find("p.percentageValue").text());if(percent<=3){$j('#bar_'+f).width(percent*1.35)}else if(percent>3&&percent<=97){$j('#bar_'+f).width(3*1.35).css("border-right","1px solid #fff").animate({width:(percent*1.35)},2e3)}else if(percent>96){var xtra=percent,xtraName=$j('#bar_'+f);$j('#bar_'+f).width(3*1.35);$j('#bar_'+f).css("border-right","1px solid #fff");$j('#bar_'+f).width(3*1.35).css("border-right","1px solid #fff").animate({width:(96*1.35)},1800,"linear",function(){xtraName.css("border-right","none").animate({width:(xtra*2.54)},200)})}}}
function _lb_me_update_percentages(ev_mkt_id){if(!scone_exists(_lb_me_selcns_id_prefix+ev_mkt_id))return;var sel_ids=scone_get_items(_lb_me_selcns_id_prefix+ev_mkt_id);if(sel_ids.length!=3)return;var perc_obj,sel_id,perc=0;for(var i=0;i<sel_ids.length;i++){perc_obj=null;sel_id=sel_ids[i].substring(_lb_me_selcn_id_prefix.length,sel_ids[i].length);perc_obj=document.getElementById("lb_me_perc_"+sel_id);if(perc_obj==null)return;perc+=parseInt(perc_obj.innerHTML)};if(perc==99){var new_perc=parseInt(perc_obj.innerHTML);new_perc++;perc_obj.innerHTML=new_perc+"\%"}else if(perc==101){var new_perc=parseInt(perc_obj.innerHTML);new_perc--;perc_obj.innerHTML=new_perc+"\%"}};var rotateEventL=function(){$j('div.evtRot p').text(_lb_me_1_of_2);$j('div.evtRot .btnL a').removeClass('on').addClass('off');$j('div.evtRot .btnR a').removeClass('off').addClass('on');document.getElementById(_lb_me_event_id_prefix+_lb_me_eventB).style.display="none";document.getElementById(_lb_me_event_id_prefix+_lb_me_eventA).style.display="block";loadProgressBar();return false},rotateEventR=function(){$j('div.evtRot p').text(_lb_me_2_of_2);$j('div.evtRot .btnL a').removeClass('off').addClass('on');$j('div.evtRot .btnR a').removeClass('on').addClass('off');document.getElementById(_lb_me_event_id_prefix+_lb_me_eventA).style.display="none";document.getElementById(_lb_me_event_id_prefix+_lb_me_eventB).style.display="block";loadProgressBar();return false}
function lb_me_add_bet(ev_oc_id){bir_add_bet(lb_me_obj,ev_oc_id,"LB_ME");return}
function lb_go_mevt_no_bir(ev_id,ev_class_type){if(ev_class_type=="HR"||ev_class_type=="GR"){self.location.href=tld_racing+'?action=go_racing&ev_id='+ev_id}else if(ev_class_type=="FB"){self.location.href=tld_football+'?action=go_fb_event&ev_id='+ev_id}else if(ev_class_type=="FN"){self.location.href=lb_go_mevt_no_bir_cgi_url+'?action=show_event_by_markets&chosen_ev_id='+ev_id}else self.location.href=lb_go_mevt_no_bir_cgi_url+'?action=show_event_by_markets&chosen_ev_id='+ev_id}
function lb_go_mevt_bir(ev_id,ev_class_type){if(ev_class_type=="HR"||ev_class_type=="GR"){self.location.href=lb_go_mevt_bir_cgi_url+'?action=go_betlive_event&ev_id='+ev_id}else if(ev_class_type=="FB"){self.location.href=lb_go_mevt_bir_cgi_url+'?action=go_betlive_event&ev_id='+ev_id}else if(ev_class_type=="FN"){self.location.href=lb_go_mevt_bir_cgi_url+'?action=go_betlive_event_financials_home&ev_id='+ev_id}else self.location.href=lb_go_mevt_bir_cgi_url+'?action=go_betlive_event&ev_id='+ev_id};var _lb_vp_common_cfg={}
function lb_vp_init_reload(reload_js_url,reload_flash_url,reload_period){_lb_vp_common_cfg.reload_js_url=reload_js_url;_lb_vp_common_cfg.reload_flash_url=reload_flash_url;_lb_vp_common_cfg.reload_period=reload_period;_lb_vp_schedule_reload()}
function _lb_vp_schedule_reload(){document.PollingAjaxHelper.setInterval("_lb_vp_schedule_reload",_lb_vp_reload_js,_lb_vp_common_cfg.reload_period)}
function _lb_vp_reload_js(){if(_lb_vp_common_cfg.reload_js_url=="")return;var clientdata={id:"video_player_js"},url=_lb_vp_common_cfg.reload_js_url+"&cust_live_hash="+_lb_vp_live_cfg.reload_hash+"&cust_upcoming_hash="+_lb_vp_upcoming_cfg.reload_hash;_lb_vp_make_ajax_get_request(url,clientdata,_lb_vp_got_ajax_content)}
function lb_vp_reload_flash(ev_id,invoker){lb_vp_load_flash(ev_id,0,invoker)}
function lb_vp_load_flash(ev_id,start_video,invoker){if(_lb_vp_common_cfg.reload_flash_url=="")return;var clientdata={id:"video_player_flash"},url;if(typeof invoker=="undefined"){url=_lb_vp_common_cfg.reload_flash_url+"&ev_id="+ev_id+"&start_video="+start_video}else url=_lb_vp_common_cfg.reload_flash_url+"&ev_id="+ev_id+"&start_video="+start_video+"&button="+invoker;_lb_vp_make_ajax_get_request(url,clientdata,_lb_vp_got_ajax_content);var frm=document.fmLogin;if(frm.ev_id)frm.ev_id.value=ev_id}
function _lb_vp_make_ajax_get_request(url,clientdata,callback){if(document.PollingAjaxHelper.checkSemaphore()){document.PollingAjaxHelper.setTimeout("_lb_vp_make_ajax_get_request",function(){_lb_vp_make_ajax_get_request(url,clientdata,callback)},300);return};document.PollingAjaxHelper.aquireSemaphore();var req=null;if(window.XMLHttpRequest){req=new XMLHttpRequest()}else if(window.ActiveXObject)req=new ActiveXObject('Microsoft.XMLHTTP');if(req){req.onreadystatechange=function(){if(req.readyState!=4)return;var reqStatus;try{reqStatus=req.status}catch(e){reqStatus=''};if(reqStatus!=200){document.PollingAjaxHelper.releaseSemaphore();callback(url,clientdata,false,'HTTP')}else{document.PollingAjaxHelper.releaseSemaphore();callback(url,clientdata,true,req.responseText)}};try{req.open('GET',url,true);req.send(null)}catch(e){document.PollingAjaxHelper.releaseSemaphore();callback(url,clientdata,false,'UNSUPPORTED')}}else{document.PollingAjaxHelper.releaseSemaphore();callback(url,clientdata,false,'UNSUPPORTED')}}
function _lb_vp_got_ajax_content(url,clientdata,ok,response){var holder_el=document.getElementById(clientdata.id);if(ok){if(response=="")return;var parts=_lb_vp_parse_script_tags(response);if(holder_el)holder_el.innerHTML=parts[0];if(parts[1].length)try{_lb_vp_global_eval(parts[1])}catch(e){ok=false}}}
function _lb_vp_parse_script_tags(str){var html='',js='',i=0,state='HTML',script_re=new RegExp('<(/?)script([^>]*)>','gi');while((mtch=script_re.exec(str))!=null){mS=mtch.index;if(state=='HTML'){html+=str.substring(i,mS)}else js+=str.substring(i,mS)+';\n';var closer=mtch[1],attrs=mtch[2];if(closer=='/'){state='HTML'}else if(attrs.charAt(attrs.length-1)!='/'&&attrs.indexOf('src=')==-1)state='JS';i=script_re.lastIndex};if(state=='HTML'){html+=str.substring(i)}else js+=str.substring(i);return[html,js]};var _lb_vp_global_eval=function(src){if(window.execScript){window.execScript(src);return};var fn=function(){window.eval.call(window,src)};fn()}
function lb_vp_live_init(call_type,events,markets,selcns,server_time_year,server_time_month,server_time_day,server_time_hour,server_time_min,server_time_sec,init_msg_id,cfg){for(var f in cfg)_lb_vp_live_cfg[f]=cfg[f];_lb_vp_live_last_msg_id=init_msg_id;var live_channels=[];if(call_type=="html"){_lb_vp_live_store_templates();_lb_vp_live_event_hash={};_lb_vp_live_evmkt_hash={};_lb_vp_live_selcn_hash={};var first_build=true;scone_create(_lb_vp_live_events_area_id,{},lb_vp_live_cmp_objects.cmpEvents,null)}else var first_build=false;for(var i=0;i<events.length;i++){if(call_type=="html"||(!_lb_vp_live_event_hash[events[i].ev_id]))_lb_vp_live_got_EVENT(events[i],first_build);if(!_lb_vp_live_channels["EVENT"+events[i].ev_id]){live_channels.push("sEVENT"+ps_connect_lpad_id(events[i].ev_id));_lb_vp_live_channels["EVENT"+events[i].ev_id]=true};if(!_lb_vp_live_channels["SCORE"+events[i].ev_id]){live_channels.push("sBRSCR"+ps_connect_lpad_id(events[i].ev_id));_lb_vp_live_channels["BRSCR"+events[i].ev_id]=true}};for(var i=0;i<markets.length;i++){if(call_type=="html"||(!_lb_vp_live_evmkt_hash[markets[i].ev_mkt_id]))_lb_vp_live_got_EVMKT(markets[i]);if(!_lb_vp_live_channels["MARKET"+markets[i].ev_mkt_id]){live_channels.push("sEVMKT"+ps_connect_lpad_id(markets[i].ev_mkt_id));live_channels.push("SEVMKT"+ps_connect_lpad_id(markets[i].ev_mkt_id));_lb_vp_live_channels["MARKET"+markets[i].ev_mkt_id]=true}};for(var i=0;i<selcns.length;i++)if(call_type=="html"||(!_lb_vp_live_selcn_hash[selcns[i].ev_oc_id]))_lb_vp_live_got_SELCN(selcns[i]);var data_elem=document.getElementById(_lb_vp_live_events_area_id),no_data_elem=document.getElementById(_lb_vp_live_data_area_id);if(call_type=="html")if(events.length==0){data_elem.style.display="none";no_data_elem.style.display="";var tab_count=document.getElementById(_lb_vp_live_tab_count);tab_count.innerHTML=VP.xl_live_tab;tab_count.title=VP.xl_live_tab}else{data_elem.style.display="";no_data_elem.style.display="none"};if(live_channels.length>0){ps_connect_register("lb_vp_live"+_vp_live_idx,_lb_vp_live_got_msg,live_channels,init_msg_id);_vp_live_idx++};if(call_type!="html");};var _vp_live_idx=0,_vp_live_betslip=null;_lb_vp_live_ev_count={};var _lb_vp_live_tab_count="live_count",_lb_vp_live_events_area_id="lb_vp_live",_lb_vp_live_data_area_id="lb_vp_live_no_data",_lb_vp_live_event_id_prefix="lb_vp_live_event_",_lb_vp_live_event_header_id_prefix="lb_vp_live_event_header_",_lb_vp_live_markets_id_prefix="lb_vp_live_markets_",_lb_vp_live_market_id_prefix="lb_vp_live_market_",_lb_vp_live_selcns_id_prefix="lb_vp_live_selcns_",_lb_vp_live_selcn_id_prefix="lb_vp_live_selcn_",_lb_vp_live_selcn_highlight_id_prefix="lb_vp_live_selcn_hl_",_lb_vp_live_selcn_link_id_prefix="lb_vp_live_selcn_link_",_lb_vp_live_level_con_id_prefix="lb_vp_live_hcap_level_con_",_lb_vp_live_level_class_name="level",_lb_vp_live_price_class_name="odd",_lb_vp_live_highlight_timers={},_lb_vp_live_channels={}
function lb_vp_live_object(){return};lb_vp_live_object.prototype.getConfig=function(){return _lb_vp_live_cfg};lb_vp_live_object.prototype.getHash=function(identifier){var ret="";switch(identifier){case"EVENT":if(_lb_vp_live_event_hash)ret=_lb_vp_live_event_hash;break;case"EVMKT":if(_lb_vp_live_evmkt_hash)ret=_lb_vp_live_evmkt_hash;break;case"EVOC":if(_lb_vp_live_selcn_hash)ret=_lb_vp_live_selcn_hash;break;case"EV_COUNT":if(_lb_vp_live_ev_count)ret=_lb_vp_live_ev_count;break;case"HL_TIMERS":if(_lb_vp_live_highlight_timers)ret=_lb_vp_live_highlight_timers;break;default:ret=""};return ret};lb_vp_live_object.prototype.getHashId=function(identifier,id){var ret="";switch(identifier){case"EVENT":if(_lb_vp_live_event_hash&&_lb_vp_live_event_hash[id])ret=_lb_vp_live_event_hash[id];break;case"EVMKT":if(_lb_vp_live_evmkt_hash&&_lb_vp_live_evmkt_hash[id])ret=_lb_vp_live_evmkt_hash[id];break;case"EVOC":if(_lb_vp_live_selcn_hash&&_lb_vp_live_selcn_hash[id])ret=_lb_vp_live_selcn_hash[id];break;case"HL_TIMERS":if(_lb_vp_live_highlight_timers&&_lb_vp_live_highlight_timers[id])ret=_lb_vp_live_highlight_timers[id];break;case"EV_COUNT":if(_lb_vp_live_ev_count&&_lb_vp_live_ev_count[id])ret=_lb_vp_live_ev_count[id];break;default:ret=""};return ret};lb_vp_live_object.prototype.getMiscInfo=function(identifier){var ret="";switch(identifier){case"PRICE_CLASS_NAME":if(_lb_vp_live_price_class_name)ret=_lb_vp_live_price_class_name;break;case"LEVEL_CLASS_NAME":if(_lb_vp_live_level_class_name)ret=_lb_vp_live_level_class_name;break;default:ret=""};return ret};lb_vp_live_object.prototype.getIdPrefix=function(identifier){var ret="";switch(identifier){case"EVENT":if(_lb_vp_live_event_id_prefix)ret=_lb_vp_live_event_id_prefix;break;case"EVMKT":if(_lb_vp_live_market_id_prefix)ret=_lb_vp_live_market_id_prefix;break;case"EVOC":if(_lb_vp_live_selcn_id_prefix)ret=_lb_vp_live_selcn_id_prefix;break;case"NEW_ITEM":if(_lb_vp_live_new_item_id_prefix)ret=_lb_vp_live_new_item_id_prefix;break;case"SELCN_HL":if(_lb_vp_live_selcn_highlight_id_prefix)ret=_lb_vp_live_selcn_highlight_id_prefix;break;case"LEVEL_CONTAINER":if(_lb_vp_live_level_con_id_prefix)ret=_lb_vp_live_level_con_id_prefix;break;default:ret=""};return ret};lb_vp_live_object.prototype.gotPushData=function(identifier,data){switch(identifier){case"PRICE":_lb_vp_live_got_PRICE(data);break;case"SELCN":_lb_vp_live_got_SELCN(data);break;case"MHCAP":_lb_vp_live_got_MHCAP(data);break;case"EVMKT":_lb_vp_live_got_EVMKT(data);break;case"EVENT":_lb_vp_live_got_EVENT(data,false);break;case"BRSCR":_lb_vp_live_got_SCORE(data);break;default:};return};var lb_vp_live_obj=new lb_vp_live_object(),lb_vp_live_cmp_objects=new function(){}();lb_vp_live_cmp_objects=new push_hash_cmp_objects();lb_vp_live_cmp_objects.cmpEvents=function(cmpMode,evA,evB){var t=evA.start_time_disp_order-evB.start_time_disp_order;if(t)return t;var d=evA.disporder-evB.disporder;if(d)return d;return evA.ev_id-evB.ev_id}
function _lb_vp_live_store_templates(){tmpl_store("lb_vp_live_event",'	<div id="lb_vp_live_event_<%ev_id%>" <%IF hidden%>style="display:none"<%END%>>\n		<div id="lb_vp_live_event_header_<%ev_id%>" class="<%IF playing%>itemHeader pause<%ELSE%>itemHeader play<%END%>">\n			<a href="javascript:void(0)" title="<%IF playing%><%XL BIR_VIDEO_PAUSE%><%ELSE%><%XL BIR_VIDEO_PLAY%><%END%>">\n				<div class="icon <%class_style_name%>" title="<%class_name_full%>"><%name%></div>\n		</a></div>\n            <div class="market">\n                     <%market_name%>\n		</div>\n		<div id="lb_vp_live_markets_<%ev_id%>"" class="itemContent">\n		</div>\n	</div>\n');tmpl_store("lb_vp_live_market",'	<div id="lb_vp_live_market_<%ev_mkt_id%>" <%IF hidden%>style="display:none"<%END%>>\n		<div  id="lb_vp_live_selcns_<%ev_mkt_id%>"></div>\n	</div>\n');tmpl_store("lb_vp_live_selcn",'	<div id="lb_vp_live_selcn_<%ev_oc_id%>" class="selection" <%IF hidden%>style="display:none"<%END%>>\n		<p class="label"><%name%>&nbsp;<%IF hcap_value%><div id="lb_vp_live_hcap_level_con_<%ev_oc_id%>" class="level hcapValue"><%hcap_value%></div><%END%></p>\n		<div id="lb_vp_live_selcn_hl_<%ev_oc_id%>" <%IF bettable%>class="odd"<%ELSE%>class="oddsuspended"<%END%>>\n			<a id="lb_vp_live_selcn_link_<%ev_oc_id%>" <%IF bettable%>title="<%XL BIR_VIDEO_ADD_TO_BETSLIP%>" href="javascript:void(0)" onclick="lb_vp_live_place_bet(<%ev_oc_id%>)"<%END%>>\n				<%price_str%>\n			</a>\n		</div>\n		<div class="clear"></div>\n	</div>\n')};var _lb_vp_live_cfg={lang:"en",price_str_type:"ODDS",price_str_type_ah:"DECIMAL",price_str_type_hl:"DECIMAL",price_str_sep:"-",event_url:"",hl_class_decrease:"_d",hl_class_increase:"_i",hl_class_same:"",highlight_duration:4e3}
function _lb_vp_live_got_msg(msg){bir_got_msg(lb_vp_live_obj,msg);return}
function _lb_vp_live_got_EVENT(data,first_build){var info=_lb_vp_live_event_hash[data.ev_id],is_new_item=!info,orig_bettable;if(is_new_item){info=data;info.market_name="";_lb_vp_live_event_hash[data.ev_id]=info;info.child_hash={}}else{orig_bettable=info.bettable;for(var f in data)info[f]=data[f]};info.name_full=info.names[_lb_vp_live_cfg.lang];info.class_name_full=info.class_names[_lb_vp_live_cfg.lang];info.venue=info.venues[_lb_vp_live_cfg.lang];info.start_time_disp_order=time_in_milliseconds(info.start_time);info.start_time_xl=info.start_time_xls[_lb_vp_live_cfg.lang];info.start_time=info.start_time.substring(11,16);info.bettable=info.status=="A";info.name=trunc_string(info.name_full,_lb_vp_live_cfg.name_truncate_threshold,'...');info.class_name=trunc_string(info.class_name_full,_lb_vp_live_cfg.name_truncate_threshold,'...');info.hidden=false;if(lb_vp_ev_id==info.ev_id){info.playing=true}else info.playing=false;var scitem_id=_lb_vp_live_event_id_prefix+info.ev_id,pscone_id=_lb_vp_live_events_area_id;if(!scone_exists(pscone_id))return;var was_visible=scone_item_exists(scitem_id),now_visible=(info.displayed=="Y"),html=tmpl_play("lb_vp_live_event",info),sort_info={disporder:info.disporder,ev_id:info.ev_id,start_time_disp_order:info.start_time_disp_order};if(!was_visible&&now_visible){scone_add_item(pscone_id,scitem_id,html,sort_info);var cscone_id=_lb_vp_live_markets_id_prefix+info.ev_id;scone_create(cscone_id,{},lb_vp_live_cmp_objects.cmpEvMkts,null);_lb_vp_live_calc_ev_counts()}else if(was_visible&&now_visible){scone_replace_item(scitem_id,html,sort_info,true)}else if(was_visible&&!now_visible){scone_remove_item(scitem_id);_lb_vp_live_calc_ev_counts()};if(now_visible&&(!was_visible||orig_bettable!=info.bettable))for(var ev_mkt_id in info.child_hash)_lb_vp_live_got_EVMKT({ev_mkt_id:ev_mkt_id,ev_id:info.ev_id})}
function _lb_vp_live_got_SCORE(data){var info=_lb_vp_live_event_hash[data.ev_id];if(!info)return;for(var f in data)info[f]=data[f];_lb_vp_live_got_EVENT({ev_id:info.ev_id,day_id:info.day_id});return}
function _lb_vp_live_got_EVMKT(data){var parent_info=_lb_vp_live_event_hash[data.ev_id];if(!parent_info)return;parent_info.child_hash[data.ev_mkt_id]=true;var info=_lb_vp_live_evmkt_hash[data.ev_mkt_id],is_new_item=!info,orig_displayed,orig_disporder,orig_name,orig_bettable,orig_hcap_values;if(is_new_item){info=data;_lb_vp_live_evmkt_hash[data.ev_mkt_id]=info;info.child_hash={}}else{orig_displayed=info.displayed;orig_disporder=info.disporder;orig_name=info.name;orig_bettable=info.bettable;orig_hcap_values=info.hcap_values;for(var f in data)info[f]=data[f]};info.name_full=info.names[_lb_vp_live_cfg.lang];info.name=trunc_string(info.name_full,_lb_vp_live_cfg.name_truncate_threshold,'...');info.hidden=true;if(info.bet_in_run!='Y')info.displayed='N';info.bettable=(info.status=="A")&&parent_info.bettable;var scitem_id=_lb_vp_live_market_id_prefix+info.ev_mkt_id,pscone_id=_lb_vp_live_markets_id_prefix+info.ev_id;if(!scone_exists(pscone_id))return;var html=tmpl_play("lb_vp_live_market",info),was_visible=scone_item_exists(scitem_id),now_visible=(info.displayed=="Y");if(!was_visible&&now_visible){scone_add_item(pscone_id,scitem_id,html,null);var cscone_id=_lb_vp_live_selcns_id_prefix+data.ev_mkt_id;scone_create(cscone_id,{},lb_vp_live_cmp_objects.cmpSelcns,null)}else if(was_visible&&now_visible){scone_replace_item(scitem_id,html,null,true)}else if(was_visible&&!now_visible)scone_remove_item(scitem_id);var market_found=_lb_vp_live_show_top_market(info.ev_id),ev_info=_lb_vp_live_event_hash[info.ev_id],ev_elem_name=_lb_vp_live_event_id_prefix+info.ev_id,ev_sort_info=scone_get_item_info(ev_elem_name);if(market_found==1){ev_info.hidden=false}else ev_info.hidden=true;var ev_html=tmpl_play("lb_vp_live_event",ev_info);scone_replace_item(ev_elem_name,ev_html,ev_sort_info,true);_lb_vp_live_calc_ev_counts();if(now_visible&&(!was_visible||orig_bettable!=info.bettable))for(var ev_oc_id in info.child_hash)_lb_vp_live_got_SELCN({ev_oc_id:ev_oc_id,ev_mkt_id:info.ev_mkt_id})}
function _lb_vp_live_got_MHCAP(data){var parent_info=_lb_vp_live_event_hash[data.ev_id],info=_lb_vp_live_evmkt_hash[data.ev_mkt_id];if(!parent_info||!info)return;for(var f in data)info[f]=data[f];for(var ev_oc_id in info.child_hash)_lb_vp_live_got_SELCN({ev_oc_id:ev_oc_id,ev_mkt_id:info.ev_mkt_id});return}
function _lb_vp_live_got_SELCN(data){var parent_info=_lb_vp_live_evmkt_hash[data.ev_mkt_id];if(!parent_info)return;parent_info.child_hash[data.ev_oc_id]=true;var info=_lb_vp_live_selcn_hash[data.ev_oc_id],is_new_item=!info,orig_lp_num,orig_lp_den,orig_hcap_values;if(is_new_item){info=data;info.ev_id=parent_info.ev_id;_lb_vp_live_selcn_hash[data.ev_oc_id]=info}else{orig_lp_num=info.lp_num;orig_lp_den=info.lp_den;orig_hcap_value=info.hcap_value;for(var f in data)info[f]=data[f]};info.name_full=info.names[_lb_vp_live_cfg.lang];info.name=trunc_string(info.name_full,_lb_vp_live_cfg.name_truncate_threshold,'...');info.has_hcap=false;info.hcap_value="";if(parent_info.hcap_values&&info.fb_result)if(parent_info.hcap_values[info.fb_result]){info.hcap_value=parent_info.hcap_values[info.fb_result];info.has_hcap=true};info.bettable=(info.status=="A")&&parent_info.bettable;info.hidden=true;var scitem_id=_lb_vp_live_selcn_id_prefix+data.ev_oc_id,pscone_id=_lb_vp_live_selcns_id_prefix+parent_info.ev_mkt_id;if(!scone_exists(pscone_id))return;info.price_str=get_price_str(lb_vp_live_obj,info.lp_num,info.lp_den,parent_info.lp_avail,parent_info.mkt_sort);var html=tmpl_play("lb_vp_live_selcn",info),sort_info={disporder:info.disporder,lp_num:info.lp_num,lp_den:info.lp_den,ev_oc_id:info.ev_oc_id},was_visible=scone_item_exists(scitem_id),now_visible=(info.displayed=="Y");if(!was_visible&&now_visible){scone_add_item(pscone_id,scitem_id,html,sort_info)}else if(was_visible&&now_visible){scone_replace_item(scitem_id,html,sort_info,true)}else if(was_visible&&!now_visible)scone_remove_item(scitem_id);var market_found=_lb_vp_live_show_top_market(info.ev_id),ev_info=_lb_vp_live_event_hash[info.ev_id],ev_elem_name=_lb_vp_live_event_id_prefix+info.ev_id,ev_sort_info=scone_get_item_info(ev_elem_name);if(market_found==1){ev_info.hidden=false}else ev_info.hidden=true;var ev_html=tmpl_play("lb_vp_live_event",ev_info);scone_replace_item(ev_elem_name,ev_html,ev_sort_info,true);_lb_vp_live_calc_ev_counts();if(!is_new_item&&now_visible){push_highlight_price_change(lb_vp_live_obj,info.ev_oc_id,info.lp_num,info.lp_den,orig_lp_num,orig_lp_den);push_highlight_level_change(lb_vp_live_obj,info.ev_oc_id,orig_hcap_value,info.hcap_value)}}
function _lb_vp_live_got_PRICE(data){var info=_lb_vp_live_selcn_hash[data.ev_oc_id];if(!info)return;var parent_info=_lb_vp_live_evmkt_hash[info.ev_mkt_id];if(!parent_info)return;var orig_lp_num=info.lp_num,orig_lp_den=info.lp_den;for(var f in data)info[f]=data[f];var scitem_id=_lb_vp_live_selcn_id_prefix+data.ev_oc_id;if(!scone_item_exists(scitem_id))return;var sort_info={disporder:info.disporder,lp_num:info.lp_num,lp_den:info.lp_den,ev_oc_id:info.ev_oc_id};scone_set_item_info(scitem_id,sort_info);var price_id=_lb_vp_live_selcn_link_id_prefix+info.ev_oc_id,price_el=document.getElementById(price_id);if(!price_el)return;info.price_str=get_price_str(lb_vp_live_obj,info.lp_num,info.lp_den,parent_info.lp_avail,parent_info.mkt_sort);price_el.innerHTML=info.price_str;_lb_vp_live_show_top_selcns(info.ev_mkt_id);push_highlight_price_change(lb_vp_live_obj,info.ev_oc_id,info.lp_num,info.lp_den,orig_lp_num,orig_lp_den);return}
function _lb_vp_live_calc_ev_counts(){var total_ev_count=0;if(scone_exists(_lb_vp_live_events_area_id)){var evs=scone_get_items(_lb_vp_live_events_area_id);for(var e=0;e<evs.length;e++)if(document.getElementById(evs[e]).style.display=="")total_ev_count++};_lb_vp_live_ev_count.ALL=total_ev_count;var tab_count=document.getElementById(_lb_vp_live_tab_count),data_elem=document.getElementById(_lb_vp_live_events_area_id),no_data_elem=document.getElementById(_lb_vp_live_data_area_id);if(total_ev_count==0){data_elem.style.display="none";no_data_elem.style.display="";tab_count.innerHTML=VP.xl_live_tab;tab_count.title=VP.xl_live_tab}else{data_elem.style.display="";no_data_elem.style.display="none";tab_count.innerHTML=VP.xl_live_tab+"("+total_ev_count+")";tab_count.title=VP.xl_live_tab+"("+total_ev_count+")"}}
function _lb_vp_live_show_top_market(ev_id){var market_container=document.getElementById(_lb_vp_live_markets_id_prefix+ev_id),markets_found=0,market_name_found="";for(var m=0;m<market_container.childNodes.length;m++){var market_name=market_container.childNodes[m].id,market_matches=market_name.match(_lb_vp_live_market_id_prefix+"*");if(market_matches){var ev_mkt_id=market_name.substring(_lb_vp_live_market_id_prefix.length,market_name.length),sort_info=scone_get_item_info(market_name),info=_lb_vp_live_evmkt_hash[ev_mkt_id],selcn_count=_lb_vp_live_show_top_selcns(info.ev_mkt_id);if(markets_found<1&&selcn_count!=0){info.hidden=false;markets_found++;market_name_found=info.names[_lb_vp_live_cfg.lang]}else info.hidden=true;var html=tmpl_play("lb_vp_live_market",info);scone_replace_item(market_name,html,sort_info,true)}};var ev_info=_lb_vp_live_event_hash[ev_id];if(ev_info&&ev_info.market_name!=market_name_found){ev_info.market_name=market_name_found;var ev_name=_lb_vp_live_event_id_prefix+info.ev_id,ev_sort_info=scone_get_item_info(ev_name),html=tmpl_play("lb_vp_live_event",ev_info);scone_replace_item(ev_name,html,ev_sort_info,true)};return markets_found}
function _lb_vp_live_show_top_selcns(ev_mkt_id){var selection_container=document.getElementById(_lb_vp_live_selcns_id_prefix+ev_mkt_id),selcns_found=0;for(var s=0;s<selection_container.childNodes.length;s++){var selcn_name=selection_container.childNodes[s].id,selcn_matches=selcn_name.match(_lb_vp_live_selcn_id_prefix+"*");if(selcn_matches){var ev_oc_id=selcn_name.substring(_lb_vp_live_selcn_id_prefix.length,selcn_name.length),sort_info=scone_get_item_info(selcn_name),info=_lb_vp_live_selcn_hash[ev_oc_id];if(selcns_found<3){info.hidden=false}else info.hidden=true;var html=tmpl_play("lb_vp_live_selcn",info);scone_replace_item(selcn_name,html,sort_info,true);selcns_found++}};return selcns_found}
function lb_vp_live_play_video(event_elem_name){var ev_id=event_elem_name.substring(_lb_vp_live_event_id_prefix.length,event_elem_name.length);lb_vp_reload_flash(ev_id,invoker)}
function lb_vp_live_set_play_header(ev_id){var header=document.getElementById(_lb_vp_live_event_header_id_prefix+ev_id);if(header)header.className="itemHeader pause"}
function lb_vp_live_place_bet(ev_oc_id){if(BS_is_on_receipt()){BS_clear_receipt_cookie();BS_clear_seln_cookie()};var selcn=_lb_vp_live_selcn_hash[ev_oc_id],evmkt=_lb_vp_live_evmkt_hash[selcn.ev_mkt_id],ev=_lb_vp_live_event_hash[evmkt.ev_id],lp_num=selcn.lp_num,lp_den=selcn.lp_den,hcap_value=evmkt.raw_hcap,bir_index=evmkt.bir_index,stream_provider=ev.stream_provider,url=_lb_vp_live_cfg.bet_url;url=url+"&ev_oc_id="+ev_oc_id;if(lp_num!=""&&lp_den!="")url=url+"&lp_num="+lp_num+"&lp_den="+lp_den;if(hcap_value!="")url=url+"&hcap_value="+hcap_value;if(bir_index!="")url=url+"&bir_index="+bir_index;if(stream_provider!="")url=url+"&bet_origin=WL_"+stream_provider;_vp_live_betslip=window.open(url,"betslip","width=392,height=365,resizable,scrollbars=yes");_vp_live_betslip.focus();return}
function lb_vp_upcoming_init(call_type,events,server_time_year,server_time_month,server_time_day,server_time_hour,server_time_min,server_time_sec,init_msg_id,cfg){for(var f in cfg)_lb_vp_upcoming_cfg[f]=cfg[f];_lb_vp_upcoming_last_msg_id=init_msg_id;var live_channels=[];if(call_type=="html"){_lb_vp_upcoming_store_templates();_lb_vp_upcoming_day_hash={};_lb_vp_upcoming_event_hash={};var first_build=true;scone_create(_lb_vp_upcoming_area_id,{},lb_vp_upcoming_cmp_objects.cmpDays,null)}else var first_build=false;for(var i=0;i<events.length;i++){if(call_type=="html"||(!_lb_vp_upcoming_day_hash[events[i].day_id]))_lb_vp_upcoming_got_DAY(events[i],first_build);if(call_type=="html"||(!_lb_vp_upcoming_event_hash[events[i].ev_id]))_lb_vp_upcoming_got_EVENT(events[i],first_build);if(!_lb_vp_upcoming_channels["EVENT"+events[i].ev_id]){live_channels.push("sEVENT"+ps_connect_lpad_id(events[i].ev_id));_lb_vp_upcoming_channels["EVENT"+events[i].ev_id]=true};if(!_lb_vp_upcoming_channels["SCORE"+events[i].ev_id]){live_channels.push("sBRSCR"+ps_connect_lpad_id(events[i].ev_id));_lb_vp_upcoming_channels["BRSCR"+events[i].ev_id]=true}};if(call_type=="html"){var data_elem=document.getElementById(_lb_vp_upcoming_area_id),no_data_elem=document.getElementById(_lb_vp_upcoming_data_area_id);if(events.length==0){data_elem.style.display="none";no_data_elem.style.display="";var tab_count=document.getElementById(_lb_vp_upcoming_tab_count);tab_count.innerHTML=VP.xl_upcoming_tab;tab_count.title=VP.xl_upcoming_tab}else{data_elem.style.display="";no_data_elem.style.display="none"}};if(live_channels.length>0){ps_connect_register("lb_vp_upcoming"+_vp_upcoming_idx,_lb_vp_upcoming_got_msg,live_channels,init_msg_id);_vp_upcoming_idx++};if(call_type!="html");};var _vp_upcoming_idx=0;_lb_vp_upcoming_ev_count={};var _vp_upcoming_event_page=null,_lb_vp_upcoming_tab_count="upcoming_count",_lb_vp_upcoming_area_id="lb_vp_upcoming",_lb_vp_upcoming_data_area_id="lb_vp_upcoming_no_data",_lb_vp_upcoming_day_id_prefix="lb_vp_upcoming_day_",_lb_vp_upcoming_events_id_prefix="lb_vp_upcoming_events_",_lb_vp_upcoming_event_id_prefix="lb_vp_upcoming_event_",_lb_vp_upcoming_score_id_prefix="lb_vp_upcoming_score_",_lb_vp_upcoming_highlight_timers={},_lb_vp_upcoming_channels={}
function lb_vp_upcoming_object(){return};lb_vp_upcoming_object.prototype.getConfig=function(){return _lb_vp_upcoming_cfg};lb_vp_upcoming_object.prototype.getHash=function(identifier){var ret="";switch(identifier){case"DAY":if(_lb_vp_upcoming_day_hash)ret=_lb_vp_upcoming_day_hash;break;case"EVENT":if(_lb_vp_upcoming_event_hash)ret=_lb_vp_upcoming_event_hash;break;case"EV_COUNT":if(_lb_vp_upcoming_ev_count)ret=_lb_vp_upcoming_ev_count;break;default:ret=""};return ret};lb_vp_upcoming_object.prototype.getHashId=function(identifier,id){var ret="";switch(identifier){case"DAY":if(_lb_vp_upcoming_day_hash)ret=_lb_vp_upcoming_day_hash;break;case"EVENT":if(_lb_vp_upcoming_event_hash&&_lb_vp_upcoming_event_hash[id])ret=_lb_vp_upcoming_event_hash[id];break;case"EV_COUNT":if(_lb_vp_upcoming_ev_count&&_lb_vp_upcoming_ev_count[id])ret=_lb_vp_upcoming_ev_count[id];break;default:ret=""};return ret};lb_vp_upcoming_object.prototype.getIdPrefix=function(identifier){var ret="";switch(identifier){case"EVENT":if(_lb_vp_upcoming_event_id_prefix)ret=_lb_vp_upcoming_event_id_prefix;break;default:ret=""};return ret};lb_vp_upcoming_object.prototype.gotPushData=function(identifier,data){switch(identifier){case"EVENT":_lb_vp_upcoming_got_EVENT(data,false);break;case"BRSCR":_lb_vp_upcoming_got_SCORE(data);break;default:};return};var lb_vp_upcoming_obj=new lb_vp_upcoming_object(),lb_vp_upcoming_cmp_objects=new function(){}();lb_vp_upcoming_cmp_objects=new push_hash_cmp_objects();lb_vp_upcoming_cmp_objects.cmpEvents=function(cmpMode,evA,evB){var t=evA.start_time_disp_order-evB.start_time_disp_order;if(t)return t;var d=evA.disporder-evB.disporder;if(d)return d;return evA.ev_id-evB.ev_id};lb_vp_upcoming_cmp_objects.cmpDays=function(cmpMode,evA,evB){var t=evA.day_id-evB.day_id;return t}
function _lb_vp_upcoming_store_templates(){tmpl_store("lb_vp_upcoming_day",'	<div id="lb_vp_upcoming_day_<%day_id%>" <%IF hidden%>style="display:none"<%END%>>\n		<div class="itemHeader">\n			<p><%day_name%></p>\n		</div>\n		<div class="itemContent" id="lb_vp_upcoming_events_<%day_id%>">\n		</div>\n	</div>\n');tmpl_store("lb_vp_upcoming_event",'	<div id="lb_vp_upcoming_event_<%ev_id%>" class="day">\n		<span class="icon <%class_style_name%>" title="<%class_name_full%>">&nbsp;</span>\n		<p class="time"><%start_time%></p>\n		<p class="event"><a href="javascript:void(0)" onclick="_lb_vp_upcoming_go_ev(<%ev_id%>)" title="<%name_full%>"><%name%></a></p>\n		<div class="score">\n			<%IF score_home_br.length != 0%>\n				<%score_home_br%>\n			<%END%>\n			<%IF score_home_br.length != 0 && score_away_br.length != 0%>\n				&nbsp; - &nbsp; \n			<%END%>\n			<%IF score_away_br.length != 0%>\n				<%score_away_br%>\n			<%END%>\n		</div>\n            <div class="venue"><%venue%></div>\n	</div>\n')};var _lb_vp_upcoming_cfg={lang:"en",event_url:"",name_truncate_threshold:28}
function _lb_vp_upcoming_got_msg(msg){bir_got_msg(lb_vp_upcoming_obj,msg);return}
function _lb_vp_upcoming_got_DAY(data,first_build){var info=_lb_vp_upcoming_day_hash[data.day_id],is_new_item=!info;if(is_new_item){info={};info.child_hash={};info.day_id=data.day_id;info.day_name=data.start_day_xls[_lb_vp_upcoming_cfg.lang];info.hidden=false;_lb_vp_upcoming_day_hash[data.day_id]=info};var scitem_id=_lb_vp_upcoming_day_id_prefix+data.day_id,pscone_id=_lb_vp_upcoming_area_id;if(!scone_exists(pscone_id))return;var html=tmpl_play("lb_vp_upcoming_day",info),sort_info={day_id:info.day_id},was_visible=scone_item_exists(scitem_id);if(!was_visible){scone_add_item(pscone_id,scitem_id,html,sort_info);var cscone_id=_lb_vp_upcoming_events_id_prefix+info.day_id;scone_create(cscone_id,{},lb_vp_upcoming_cmp_objects.cmpEvents,null)}else scone_replace_item(scitem_id,html,sort_info,true)}
function _lb_vp_upcoming_got_EVENT(data,first_build){var info=_lb_vp_upcoming_event_hash[data.ev_id],is_new_item=!info,orig_bettable;if(is_new_item){var parent_info=_lb_vp_upcoming_day_hash[data.day_id]}else var parent_info=_lb_vp_upcoming_day_hash[info.day_id];if(!parent_info)return;parent_info.child_hash[data.ev_id]=true;if(is_new_item){info=data;_lb_vp_upcoming_event_hash[data.ev_id]=info;info.child_hash={}}else{orig_bettable=info.bettable;for(var f in data)info[f]=data[f]};info.name_full=info.names[_lb_vp_upcoming_cfg.lang];info.class_name_full=info.class_names[_lb_vp_upcoming_cfg.lang];info.venue=info.venues[_lb_vp_upcoming_cfg.lang];info.start_time_xl=info.start_time_xls[_lb_vp_upcoming_cfg.lang];info.start_time=info.start_time.substring(11,16);info.bettable=info.status=="A";info.start_time_disp_order=time_in_milliseconds(info.start_time);info.name=trunc_string(info.name_full,_lb_vp_upcoming_cfg.name_truncate_threshold,'...');info.class_name=trunc_string(info.class_name_full,_lb_vp_upcoming_cfg.name_truncate_threshold,'...');var scitem_id=_lb_vp_upcoming_event_id_prefix+info.ev_id,pscone_id=_lb_vp_upcoming_events_id_prefix+info.day_id;if(!scone_exists(pscone_id))return;var was_visible=scone_item_exists(scitem_id),now_visible=(info.displayed=="Y"),html=tmpl_play("lb_vp_upcoming_event",info),sort_info={disporder:info.disporder,ev_id:info.ev_id,start_time_disp_order:info.start_time_disp_order},day_elem_name=_lb_vp_upcoming_day_id_prefix+parent_info.day_id,day_sort_info=scone_get_item_info(day_elem_name);if(!was_visible&&now_visible){scone_add_item(pscone_id,scitem_id,html,sort_info);_lb_vp_upcoming_calc_ev_counts();if(push_get_ev_counts(lb_vp_upcoming_obj,"DAY",info.day_id)==1&&!first_build){parent_info.hidden=false;var day_html=tmpl_play("lb_vp_upcoming_day",parent_info);scone_replace_item(day_elem_name,day_html,day_sort_info,true)}}else if(was_visible&&now_visible){scone_replace_item(scitem_id,html,sort_info,true)}else if(was_visible&&!now_visible){scone_remove_item(scitem_id);_lb_vp_upcoming_calc_ev_counts();if(push_get_ev_counts(lb_vp_upcoming_obj,"DAY",info.day_id)==0){parent_info.hidden=true;var day_html=tmpl_play("lb_vp_upcoming_day",parent_info);scone_replace_item(day_elem_name,day_html,day_sort_info,true)}}}
function _lb_vp_upcoming_got_SCORE(data){var info=_lb_vp_upcoming_event_hash[data.ev_id];if(!info)return;for(var f in data)info[f]=data[f];_lb_vp_upcoming_got_EVENT({ev_id:info.ev_id,day_id:info.day_id});return}
function _lb_vp_upcoming_calc_ev_counts(){_lb_vp_upcoming_ev_count={};var total_ev_count=0,day_ev_count=0;for(var day_id in _lb_vp_upcoming_day_hash)if(scone_exists(_lb_vp_upcoming_events_id_prefix+day_id)){day_ev_count=scone_get_items(_lb_vp_upcoming_events_id_prefix+day_id).length;total_ev_count+=day_ev_count;_lb_vp_upcoming_ev_count["DAY"+day_id]=day_ev_count};_lb_vp_upcoming_ev_count.ALL=total_ev_count;var tab_count=document.getElementById(_lb_vp_upcoming_tab_count),data_elem=document.getElementById(_lb_vp_upcoming_area_id),no_data_elem=document.getElementById(_lb_vp_upcoming_data_area_id);if(total_ev_count==0){data_elem.style.display="none";no_data_elem.style.display="";tab_count.innerHTML=VP.xl_upcoming_tab;tab_count.title=VP.xl_upcoming_tab}else{data_elem.style.display="";no_data_elem.style.display="none";tab_count.innerHTML=VP.xl_upcoming_tab+"("+total_ev_count+")";tab_count.title=VP.xl_upcoming_tab+"("+total_ev_count+")"}}
function _lb_vp_upcoming_go_ev(ev_id){if(window.opener){window.opener.location.href=_lb_vp_upcoming_cfg.event_url+ev_id}else{if(_vp_upcoming_event_page!=null){if(!_vp_upcoming_event_page.closed)_vp_upcoming_event_page.close();_vp_upcoming_event_page=null};_vp_upcoming_event_page=window.open(_lb_vp_upcoming_cfg.event_url+ev_id,"event","width=800,height=800,resizable,scrollbars=yes");_vp_upcoming_event_page.focus()};return}
function lb_fb_cpn_preview_init(tab_id,call_type,page_type,coupon,events,markets,selcns,server_time_year,server_time_month,server_time_day,server_time_hour,server_time_min,server_time_sec,init_msg_id,cfg){initPeriodClocks(server_time_year,server_time_month,server_time_day,server_time_hour,server_time_min,server_time_sec,cfg.lang);var lb_fb_cpn_preview=_lb_fb_cpn_preview_hash[page_type+coupon.coupon_id];if(!lb_fb_cpn_preview){lb_fb_cpn_preview=new lb_fb_cpn_preview_object();lb_fb_cpn_preview.page_type=page_type;_lb_fb_cpn_preview_hash[page_type+coupon.coupon_id]=lb_fb_cpn_preview;_lb_fb_cpn_preview_tab_hash[tab_id]=page_type+coupon.coupon_id};for(var f in cfg)lb_fb_cpn_preview.cfg[f]=cfg[f];lb_fb_cpn_preview.last_msg_id=init_msg_id;var live_channels=[];if(!_lb_fb_cpn_preview_templates_prepared){_lb_fb_cpn_preview_store_templates();_lb_fb_cpn_preview_templates_prepared=true};if(call_type=="html"){lb_fb_cpn_preview.coupon=null;lb_fb_cpn_preview.day_hash={};lb_fb_cpn_preview.type_hash={};lb_fb_cpn_preview.event_hash={};lb_fb_cpn_preview.evmkt_hash={};lb_fb_cpn_preview.selcn_hash={};lb_fb_cpn_preview.channels={};lb_fb_cpn_preview.ev_count={};lb_fb_cpn_preview.selcn_count={};lb_fb_cpn_preview.score_hash={};if(scone_exists(_lb_fb_cpn_preview_coupon_area_prefix+lb_fb_cpn_preview.page_type))scone_delete(_lb_fb_cpn_preview_coupon_area_prefix+lb_fb_cpn_preview.page_type);scone_create(_lb_fb_cpn_preview_coupon_area_prefix+lb_fb_cpn_preview.page_type,{},null,null)};var rebuild_parents=false;if(call_type=="html")_lb_fb_cpn_preview_got_COUPON(coupon,lb_fb_cpn_preview,rebuild_parents);if(events.length<=cfg.coupon_preview_limit){var num_displayed_limit=events.length;lb_fb_cpn_preview.num_trimmed=0}else{var num_displayed_limit=cfg.coupon_preview_limit;lb_fb_cpn_preview.num_trimmed=events.length-cfg.coupon_preview_limit};lb_fb_cpn_preview.prune_event_list={};for(var i=0;i<num_displayed_limit;i++){if(events[i].is_off=="Y")addClockEvent(events[i].ev_id,clockn_js,"fb_cpn_lb_clock_"+page_type+"_"+coupon.coupon_id);lb_fb_cpn_preview.prune_event_list[events[i].ev_id]=true;if(call_type=="html"||call_type=="refresh"||!lb_fb_cpn_preview.day_hash[events[i].day_id])_lb_fb_cpn_preview_got_DAY(events[i],lb_fb_cpn_preview,rebuild_parents);if(call_type=="html"||call_type=="refresh"||(!lb_fb_cpn_preview.event_hash[events[i].ev_id])){if(call_type=="js"&&page_type=="fb_hp_live_tab"){var ev_rebuild_parents=true}else var ev_rebuild_parents=false;_lb_fb_cpn_preview_got_EVENT(events[i],lb_fb_cpn_preview,ev_rebuild_parents)}else if(call_type=="js"&&lb_fb_cpn_preview.event_hash[events[i].ev_id]){var event_copy=lb_fb_cpn_preview.event_hash[events[i].ev_id];if(event_copy.more_bets!=events[i].more_bets){event_copy.more_bets=events[i].more_bets;_lb_fb_cpn_preview_got_EVENT(event_copy,lb_fb_cpn_preview,false)}};if(!lb_fb_cpn_preview.channels["EVENT"+events[i].ev_id]){live_channels.push("sEVENT"+ps_connect_lpad_id(events[i].ev_id));lb_fb_cpn_preview.channels["EVENT"+events[i].ev_id]=true};if(events[i].is_off=="Y"&&!lb_fb_cpn_preview.channels["BRSCR"+events[i].ev_id]){live_channels.push("sBRSCR"+ps_connect_lpad_id(events[i].ev_id));lb_fb_cpn_preview.channels["BRSCR"+events[i].ev_id]=true}};for(var i=0;i<markets.length;i++){if(call_type=="html"||call_type=="refresh"||(!lb_fb_cpn_preview.evmkt_hash[markets[i].ev_mkt_id]))_lb_fb_cpn_preview_got_EVMKT(markets[i],lb_fb_cpn_preview,false,rebuild_parents);if(!lb_fb_cpn_preview.channels["MARKET"+markets[i].ev_mkt_id]){live_channels.push("sEVMKT"+ps_connect_lpad_id(markets[i].ev_mkt_id));live_channels.push("SEVMKT"+ps_connect_lpad_id(markets[i].ev_mkt_id));lb_fb_cpn_preview.channels["MARKET"+markets[i].ev_mkt_id]=true}};for(var i=0;i<selcns.length;i++)if(call_type=="html"||call_type=="refresh"||(!lb_fb_cpn_preview.selcn_hash[selcns[i].ev_oc_id]))_lb_fb_cpn_preview_got_SELCN(selcns[i],lb_fb_cpn_preview,rebuild_parents);if(coupon.pushed&&live_channels.length>0){var gotPushDataClosure=function(msg){return lb_fb_cpn_preview.gotPushData(msg)};ps_connect_register("lb_fb_cpn_preview_"+page_type+_lb_fb_cpn_preview_idx,gotPushDataClosure,live_channels,init_msg_id);_lb_fb_cpn_preview_idx++};if(call_type=="html"&&coupon.reload_url!=""&&coupon.pushed)_lb_fb_cpn_preview_schedule_reload(page_type,coupon.coupon_id,lb_fb_cpn_preview.cfg.reload_period);if(call_type=="js")_lb_fb_cpn_preview_prune_events(lb_fb_cpn_preview,lb_fb_cpn_preview.prune_event_list);_lb_fb_cpn_preview_calc_ev_counts(lb_fb_cpn_preview)};var _lb_fb_cpn_preview_templates_prepared=false,_lb_fb_cpn_preview_idx=0,_lb_fb_cpn_preview_coupon_area_prefix="lb_fb_coupon_area_",_lb_fb_cpn_preview_coupon_area_no_selns_prefix="lb_fb_coupon_area_no_selns_",_lb_fb_cpn_preview_coupon_id_prefix="lb_fb_coupon_",_lb_fb_cpn_preview_show_all_id_prefix="lb_fb_show_all_",_lb_fb_cpn_preview_coupon_static_col_count=5,_lb_fb_cpn_preview_coupon_dyn_col_width=227,_lb_fb_cpn_preview_name_col_width=160,_lb_fb_cpn_preview_coupon_fat_col_pad=36,_lb_fb_cpn_preview_coupon_no_link_name_col_pad=40,_lb_fb_cpn_preview_coupon_no_link_dyn_col_pad=43,_lb_fb_cpn_preview_coupon_col_id_prefix="lb_fb_coupon_col_",_lb_fb_cpn_preview_days_id_prefix="lb_fb_daytype_",_lb_fb_cpn_preview_day_id_prefix="lb_fb_day_",_lb_fb_cpn_preview_types_id_prefix="lb_fb_daytype_",_lb_fb_cpn_preview_type_id_prefix="lb_fb_type_",_lb_fb_cpn_preview_events_id_prefix="lb_fb_events_",_lb_fb_cpn_preview_event_id_prefix="lb_fb_event_",_lb_fb_cpn_preview_selcn_holder_id_prefix="lb_fb_selcn_holder_",_lb_fb_cpn_preview_selcn_id_prefix="lb_fb_selcn_",_lb_fb_cpn_preview_selcn_link_id_prefix="lb_fb_selcn_link_",_lb_fb_cpn_preview_selcn_base_class="odd",_lb_fb_cpn_preview_hash={},_lb_fb_cpn_preview_tab_hash={},_lb_fb_cpn_preview_hl_timers={},cpn_reload_timer=-1
function lb_fb_cpn_preview_object(){this.gotPushData=function(msg){var data={};switch(msg.subject_level){case"sPRICE":eval("data = "+msg.data+";");data.ev_oc_id=msg.subject_id;_lb_fb_cpn_preview_got_PRICE(data,this,true);break;case"sSELCN":eval("data = "+msg.data+";");data.ev_oc_id=msg.subject_id;_lb_fb_cpn_preview_got_SELCN(data,this,true);break;case"sMHCAP":eval("data = "+msg.data+";");data.ev_mkt_id=msg.subject_id;_lb_fb_cpn_preview_got_MHCAP(data,this,true);break;case"sEVMKT":eval("data = "+msg.data+";");data.ev_mkt_id=msg.subject_id;_lb_fb_cpn_preview_got_EVMKT(data,this,false,true,"date");break;case"sEVENT":eval("data = "+msg.data+";");data.ev_id=msg.subject_id;_lb_fb_cpn_preview_got_EVENT(data,this,true,"date");break;case"sBRSCR":eval("data = "+msg.data+";");data.ev_id=msg.subject_id;_lb_fb_cpn_preview_got_SCORE(data,this);break;default:};tooltip_init();return};this.cfg={lang:"en",price_str_type:"ODDS",price_str_type_ah:"DECIMAL",price_str_type_hl:"DECIMAL",price_str_sep:"-",event_url:"",hl_class_decrease:"_d",hl_class_increase:"_i",hl_class_same:"",highlight_duration:4e3};return};var lb_fb_cpn_preview_cmp_objects=new function(){}();lb_fb_cpn_preview_cmp_objects=new push_hash_cmp_objects();lb_fb_cpn_preview_cmp_objects.cmpEvents=function(cmp_mode,evA,evB){var handler=_lb_fb_cpn_preview_hash[evA.page_type+evA.coupon_id],d=evA.disporder-evB.disporder;if(d)return d;var t=evA.start_time_disp_order-evB.start_time_disp_order;if(t)return t;var td=evA.ev_type_disporder-evB.ev_type_disporder;if(td)return td;var n=(evA.name_full<=evB.name_full?-1:1);if(n)return n};lb_fb_cpn_preview_cmp_objects.cmpDays=function(cmp_mode,evA,evB){var t=evA.day_id-evB.day_id;return t};lb_fb_cpn_preview_cmp_objects.cmpTypes=function(cmp_mode,evA,evB){var t=evA.ev_type_disporder-evB.ev_type_disporder;if(t==0)t=(evA.ev_type_name<=evB.ev_type_name?-1:1);return t}
function _lb_fb_cpn_preview_store_templates(){var tmp=[];tmp.push('	<div id="lb_fb_coupon_<%page_type%>_<%coupon_id%>">\n');tmp.push('		<div id="lb_fb_daytype_<%page_type%>_<%coupon_id%>">\n');tmp.push('		</div>\n');tmp.push('	</div>\n');tmpl_store("lb_fb_cpn_preview_coupon",tmp.join(""));var tmp=[];tmp.push('	<div class="fb_day_type_wrapper" <%IF hidden%>style="display:none;"<%END%> id="lb_fb_day_<%page_type%>_<%coupon_id%>_<%day_id%>">\n');tmp.push('		<div class="fb_hdr">\n');tmp.push('			<h2><%day_name%> <span class="normal">- <%date_name%></span></h2>\n');tmp.push('			<ul class="list_header_odds <%IF coupon_sort == "SB"%>wider-list<%END%>">\n');tmp.push('			<%LOOP c_idx col_names.length%>');tmp.push('				<li><%col_names[c_idx]%></li>\n');tmp.push('			<%END%>');tmp.push('			</ul>\n');tmp.push('		</div>\n');tmp.push('		<div id="lb_fb_events_<%page_type%>_<%coupon_id%>_<%day_id%>"></div>\n');tmp.push('	</div>\n');tmpl_store("lb_fb_cpn_preview_day",tmp.join(""));var tmp=[];tmp.push('	<div class="fb_day_type_wrapper" <%IF hidden%>style="display:none;"<%END%> id="lb_fb_type_<%page_type%>_<%coupon_id%>_<%ev_type_id%>">\n');tmp.push('		<div class="fb_hdr">\n');tmp.push('			<h2><%ev_type_name%></h2>\n');tmp.push('			<ul class="list_header_odds <%IF coupon_sort == "SB"%>wider-list<%END%>">\n');tmp.push('			<%LOOP c_idx col_names.length%>');tmp.push('				<li><%col_names[c_idx]%></li>\n');tmp.push('			<%END%>');tmp.push('			</ul>\n');tmp.push('		</div>\n');tmp.push('		<div id="lb_fb_events_<%page_type%>_<%coupon_id%>_<%ev_type_id%>"></div>\n');tmp.push('	</div>\n');tmpl_store("lb_fb_cpn_preview_type",tmp.join(""));var tmp=[];tmp.push('	<div id="lb_fb_event_<%page_type%>_<%coupon_id%>_<%ev_id%>"  class="pp_fb_event <%IF is_off == "Y" %>live<%END%>" <%IF hidden%>style="display:none;"<%END%> >\n');tmp.push('		<%IF is_off == "Y" %>');tmp.push('			<%IF score_away == "" && score_away_br == "" && score_home == "" && score_home_br == "" %>');tmp.push('				<div class="live_now"><a href="<%url%>"><%XL FB_LIVE_NOW%></a></div>\n');tmp.push('			<%ELSE%>');tmp.push('				<div class="live_now clock"><a href="<%url%>">\n');tmp.push('					<span class="scoreline" id="lb_fb_event_<%page_type%>_<%coupon_id%>_<%ev_id%>_scoretext" style="display:none;"><%XL FB_GOAL_TEXT%></span>\n');tmp.push('					<span class="scoreline" id="lb_fb_event_<%page_type%>_<%coupon_id%>_<%ev_id%>_scoreline"><%score_home%> - <%score_away%></span>\n');tmp.push('					<span class="time" id="fb_cpn_lb_clock_<%page_type%>_<%coupon_id%>_time_<%ev_id%>"></span>\n');tmp.push('					<span class="period" id="fb_cpn_lb_clock_<%page_type%>_<%coupon_id%>_period_<%ev_id%>"></span>\n');tmp.push('					</a></div>\n');tmp.push('			<%END%>');tmp.push('		<%ELSE%>');tmp.push('			<div class="fb_event_time">\n');tmp.push('				<p><%start_time_str%></p>\n');tmp.push('			</div>\n');tmp.push('		<%END%>');tmp.push('		<div class="fb_event_name"><p><a href="<%url%>"><%name%>');tmp.push('			<%IF disp_TT_name_full == 0%>');tmp.push('				<span class="tooltip"><%name_full%></span>');tmp.push('			<%END%>');tmp.push('		</a></p></div>\n');tmp.push('		<div class="fb_tools">\n');tmp.push('			<%IF has_mbs == 0%>');tmp.push('				<%IF has_stations%>');tmp.push('					<a class="fbc_tv">\n');tmp.push('						<span class="tooltip"><%FB_TT_LIVEON%>\n');tmp.push('							<%LOOP tv_idx tv_icons.length%>');tmp.push('								<img src="<%tv_image_url%>/<%tv_icons[tv_idx]%>">\n');tmp.push('							<%END%>\n');tmp.push('						</span>\n');tmp.push('					</a>\n');tmp.push('				<%END%>\n');tmp.push('				<%IF ev_stream_available%>');tmp.push('					<a class="fb_streaming"><span class="tooltip"><%XL STREAMING_VIDEO_AVAIL%></span></a>\n');tmp.push('				<%END%>\n');tmp.push('			<%ELSE%>');tmp.push('				<a class="fb_money-back-special">\n');tmp.push('					<span class="tooltip">\n');tmp.push('						<%XL MBS%>\n');tmp.push('						<%IF has_stations%>');tmp.push('							<br/><%FB_TT_LIVEON%>');tmp.push('							<%LOOP tv_idx tv_icons.length%>');tmp.push('								<img src="<%tv_image_url%>/<%tv_icons[tv_idx]%>">');tmp.push('							<%END%>\n');tmp.push('						<%END%>\n');tmp.push('						<%IF  ev_stream_available%>');tmp.push('							<br/><%XL STREAMING_VIDEO_AVAIL%>\n');tmp.push('						<%END%>\n');tmp.push('					</span>\n');tmp.push('				</a>\n');tmp.push('			<%END%>\n');tmp.push('		</div>\n');tmp.push('		<div class="fb_odds item">\n');tmp.push('			<%LOOP c_idx col_keys.length%>');tmp.push('			<div id="lb_fb_selcn_holder_<%page_type%>_<%coupon_id%>_<%ev_id%>_<%col_keys[c_idx]%>"></div>\n');tmp.push('			<%END%>');tmp.push('		</div>\n');tmp.push('		<div class="fb_more_event_bets">\n');tmp.push('			<%IF more_bets > 0 && coupon_sort != "SB"%>');tmp.push('				<a href="<%url%>">\n');tmp.push('					');tmp.push('					+<%more_bets%> <br/><span class="text"><%XL MORE_BETS%></span>\n');tmp.push('				</a>\n');tmp.push('			<%END%>');tmp.push('		</div>\n');tmp.push('	</div>\n');tmpl_store("lb_fb_cpn_preview_event",tmp.join(""));var tmp=[];tmp.push('	<span <%IF bettable%>class="odds_selection<%IF coupon_sort == "SB"%>_yesno<%END%> <%IF coupon_sort == "SH"%>handicap<%END%> odd"<%ELSE%>class="oddsuspended"<%END%> id="lb_fb_selcn_<%page_type%>_<%coupon_id%>_<%ev_oc_id%>">\n');tmp.push('		<%IF displayed == "Y"%>');tmp.push('			<a href="javascript:void(0)" <%IF bettable%>onclick="lb_fb_cpn_preview_add_bet(<%ev_oc_id%>, \'<%page_type%>\', \'<%coupon_id%>\')"<%END%> id="lb_fb_selcn_link_<%page_type%>_<%coupon_id%>_<%ev_oc_id%>" class="lower_accord_event_bet">\n');tmp.push('				<%IF bettable%>');tmp.push('					<%IF hcap_value%>');tmp.push('						<span class="handicap-figure"><%hcap_value%></span><br/><%price_str%>\n');tmp.push('					<%ELSE%>');tmp.push('						<%price_str%>\n');tmp.push('					<%END%>');tmp.push('				<%END%>');tmp.push('			</a>\n');tmp.push('		<%ELSE%>');tmp.push('			<a href="javascript:void(0)" id="lb_fb_selcn_link_<%page_type%>_<%coupon_id%>_<%ev_oc_id%>"></a>\n');tmp.push('		<%END%>');tmp.push('	</span>\n');tmpl_store("lb_fb_cpn_preview_selcn",tmp.join(""));var tmp=[]}
function _lb_fb_cpn_preview_got_COUPON(data,handler,rebuild_parents){var info=handler.coupon,is_new_item=!info;if(is_new_item){info=data;handler.coupon=info;info.child_hash={};info.page_type=handler.page_type;info.col_count=info.col_keys.length+_lb_fb_cpn_preview_coupon_static_col_count;info.name_col_width=_lb_fb_cpn_preview_name_col_width;info.dyn_col_width=_lb_fb_cpn_preview_coupon_dyn_col_width;if(info.coupon_sort=="SC"||info.coupon_sort=="SB"){info.name_col_width+=_lb_fb_cpn_preview_coupon_no_link_name_col_pad;info.dyn_col_width+=_lb_fb_cpn_preview_coupon_no_link_dyn_col_pad;info.col_count-=2};if(info.col_keys.length>3||(info.col_keys.length==3&&info.has_hcaps)){info.name_col_width-=_lb_fb_cpn_preview_coupon_fat_col_pad;info.dyn_col_width+=_lb_fb_cpn_preview_coupon_fat_col_pad};info.col_widths=[];var col_width=Math.round(info.dyn_col_width/info.col_keys.length);for(var c=0;c<info.col_keys.length;c++)info.col_widths[c]=col_width;info.col_widths[info.col_widths.length-1]+=(info.dyn_col_width-info.col_keys.length*col_width)}else for(var f in data)info[f]=data[f];var scitem_id=_lb_fb_cpn_preview_coupon_id_prefix+handler.page_type+"_"+info.coupon_id,pscone_id=_lb_fb_cpn_preview_coupon_area_prefix+handler.page_type;if(!scone_exists(pscone_id))return;var was_visible=scone_item_exists(scitem_id),html=tmpl_play("lb_fb_cpn_preview_coupon",info);if(!was_visible){scone_add_item(pscone_id,scitem_id,html,null);var cscone_id=_lb_fb_cpn_preview_days_id_prefix+handler.page_type+"_"+info.coupon_id;scone_create(cscone_id,{},lb_fb_cpn_preview_cmp_objects.cmpDays,null)}else scone_replace_item(scitem_id,html,null,true)}
function _lb_fb_cpn_preview_got_DAY(data,handler,rebuild_parents){var info=handler.day_hash[data.day_id],is_new_item=!info;if(is_new_item){info={};info.child_hash={};info.day_id=data.day_id;info.page_type=handler.page_type;info.coupon_id=handler.coupon.coupon_id;info.day_name=data.start_day_xls;info.date_name=data.start_date_xls;info.col_count=handler.coupon.col_count;info.col_widths=handler.coupon.col_widths;info.col_names=handler.coupon.col_names;info.coupon_sort=handler.coupon.coupon_sort;info.name_col_width=handler.coupon.name_col_width;info.hidden=false;handler.day_hash[data.day_id]=info};var scitem_id=_lb_fb_cpn_preview_day_id_prefix+handler.page_type+"_"+info.coupon_id+"_"+info.day_id,pscone_id=_lb_fb_cpn_preview_days_id_prefix+handler.page_type+"_"+info.coupon_id;if(!scone_exists(pscone_id))return;var html=tmpl_play("lb_fb_cpn_preview_day",info),sort_info={day_id:info.day_id,page_type:handler.page_type,coupon_id:info.coupon_id},was_visible=scone_item_exists(scitem_id);if(!was_visible){scone_add_item(pscone_id,scitem_id,html,sort_info);var cscone_id=_lb_fb_cpn_preview_events_id_prefix+handler.page_type+"_"+info.coupon_id+"_"+info.day_id;scone_create(cscone_id,{},lb_fb_cpn_preview_cmp_objects.cmpEvents,null)}else scone_replace_item(scitem_id,html,sort_info,true)}
function _lb_fb_cpn_preview_got_EVENT(data,handler,rebuild_parents){var info=handler.event_hash[data.ev_id],is_new_item=!info,orig_bettable,goal=false;if(is_new_item){var parent_info=handler.day_hash[data.day_id]}else var parent_info=handler.day_hash[info.day_id];if(!parent_info)return;parent_info.child_hash[data.ev_id]=true;if(is_new_item){info=data;info.page_type=handler.page_type;info.coupon_id=handler.coupon.coupon_id;info.col_keys=handler.coupon.col_keys;info.coupon_sort=handler.coupon.coupon_sort;info.shown_selections_count=0;info.hidden=false;info.col_hash={};info.child_hash={};info.goal_score_highlight=handler.cfg.goal_score_highlight;handler.event_hash[data.ev_id]=info}else{orig_bettable=info.bettable;if(typeof info.score_home!=='undefined'&&typeof info.score_away!=='undefined'&&typeof data.score_home!=='undefined'&&typeof data.score_away!=='undefined')goal=(info.score_home!=data.score_home)||(info.score_away!=data.score_away)&&(data.score_away!=0||data.score_home!=0);for(var f in data)info[f]=data[f]};var current_time=new Date(),diff=current_time-page_load_time,current_server_time=new Date();current_server_time.setTime(server_clock_timejs.getTime()+diff);info.has_mbs=_lb_fb_cpn_chk_mbs(info.special_type,info.start_time,info.suspended_at,info.is_off,current_server_time);info.name_full=info.names[handler.cfg.lang];info.start_time_disp_order=time_in_milliseconds(info.start_time);info.start_time_xl=info.start_time_xls;info.start_time_str=info.start_time.substring(11,16);info.bettable=info.status=="A";info.name=trunc_string(info.name_full,handler.cfg.name_truncate_threshold,'...');info.disp_TT_name_full=(info.name==info.name_full);info.FB_TT_LIVEON=handler.cfg.FB_TT_LIVEON;if(info.tv_icon!=""){info.tv_icon_url=fb_data['img_'+info.tv_icon];info.tv_icon_txt=fb_data['xl_'+info.tv_icon]};if(info.station_icons==""){info.has_stations=false}else{info.has_stations=true;var tv_icons=info.station_icons;info.tv_icons=tv_icons.split(" ");info.tv_image_url=handler.cfg.tv_image_url};if(info.is_off=="Y"){info.url=handler.cfg.event_url+info.ev_id;info.bir_hp_url=""}else info.bir_hp_url=handler.cfg.bir_hp_url;var scitem_id=_lb_fb_cpn_preview_event_id_prefix+handler.page_type+"_"+info.coupon_id+"_"+info.ev_id,pscone_id=_lb_fb_cpn_preview_events_id_prefix+handler.page_type+"_"+info.coupon_id+"_"+info.day_id;if(!scone_exists(pscone_id))return;var was_visible=scone_item_exists(scitem_id),now_visible=(info.displayed=="Y"),html=tmpl_play("lb_fb_cpn_preview_event",info),sort_info={disporder:info.disporder,ev_type_disporder:info.ev_type_disporder,ev_id:info.ev_id,name_full:info.name_full,start_time_disp_order:info.start_time_disp_order,page_type:handler.page_type,coupon_id:info.coupon_id},day_elem_name=_lb_fb_cpn_preview_day_id_prefix+handler.page_type+"_"+info.coupon_id+"_"+info.day_id,day_sort_info=scone_get_item_info(day_elem_name);if(!was_visible&&now_visible){scone_add_item(pscone_id,scitem_id,html,sort_info);for(var c=0;c<info.col_keys.length;c++){var cscone_id=_lb_fb_cpn_preview_selcn_holder_id_prefix+handler.page_type+"_"+info.coupon_id+"_"+info.ev_id+"_"+info.col_keys[c];scone_create(cscone_id,{},null,null)};if(rebuild_parents){_lb_fb_cpn_preview_calc_ev_counts(handler);if(_lb_fb_cpn_preview_get_ev_counts(handler,"DAY",info.day_id)==1){parent_info.hidden=false;var day_html=tmpl_play("lb_fb_cpn_preview_day",parent_info);scone_replace_item(day_elem_name,day_html,day_sort_info,true)}}}else if(was_visible&&now_visible){scone_replace_item(scitem_id,html,sort_info,true)}else if(was_visible&&!now_visible){scone_remove_item(scitem_id);if(rebuild_parents){_lb_fb_cpn_preview_calc_ev_counts(handler);if(_lb_fb_cpn_preview_get_ev_counts(handler,"DAY",info.day_id)==0){parent_info.hidden=true;var day_html=tmpl_play("lb_fb_cpn_preview_day",parent_info);scone_replace_item(day_elem_name,day_html,day_sort_info,true)}}};if(now_visible&&(!was_visible||orig_bettable!=info.bettable)){var force_propogate=false;if(!was_visible)force_propogate=true;for(var ev_mkt_id in info.child_hash)_lb_fb_cpn_preview_got_EVMKT({ev_mkt_id:ev_mkt_id,ev_id:info.ev_id},handler,force_propogate,rebuild_parents)};if(info.is_off=="Y"){addClockEvent(info.ev_id,clockn_js,"fb_cpn_lb_clock_"+info.page_type+"_"+info.coupon_id);updatePeriodClock(info)};if(goal)_lb_fb_cpn_preview_highlight_goal(info)}
function _lb_fb_cpn_preview_highlight_goal(info){var scoreline_elem_id='lb_fb_event_'+info.page_type+'_'+info.coupon_id+'_'+info.ev_id+'_scoreline',scoreline_elem=document.getElementById(scoreline_elem_id),scoretext_elem_id='lb_fb_event_'+info.page_type+'_'+info.coupon_id+'_'+info.ev_id+'_scoretext',scoretext_elem=document.getElementById(scoretext_elem_id),score_highlight_elem_id='lb_fb_event_'+info.page_type+'_'+info.coupon_id+'_'+info.ev_id,score_highlight_elem=document.getElementById(score_highlight_elem_id);$j(score_highlight_elem).find('a').addClass('score_change');setTimeout(function(){$j(score_highlight_elem).find('a').removeClass('score_change')},info.goal_score_highlight*1e3);scoreline_elem.style.display='none';scoretext_elem.style.display='inline';setTimeout(function(){scoreline_elem.style.display='inline';scoretext_elem.style.display='none'},info.goal_text_disp_time*1e3)}
function _lb_fb_cpn_preview_got_SCORE(data,handler){var info=handler.event_hash[data.ev_id];if(!info){info=data}else for(var f in data)info[f]=data[f];if(info.is_off=="Y")_lb_fb_cpn_preview_got_EVENT({ev_id:info.ev_id,day_id:info.day_id},handler,false,"date")}
function _lb_fb_cpn_preview_got_EVMKT(data,handler,force_propogate,rebuild_parents){var parent_info=handler.event_hash[data.ev_id];if(!parent_info)return;parent_info.child_hash[data.ev_mkt_id]=true;var info=handler.evmkt_hash[data.ev_mkt_id],is_new_item=!info,orig_displayed,orig_bettable,orig_hcap_values;if(is_new_item){info=data;info.page_type=handler.page_type;info.coupon_id=handler.coupon.coupon_id;info.child_hash={};handler.evmkt_hash[data.ev_mkt_id]=info}else{orig_displayed=info.displayed;orig_bettable=info.bettable;orig_hcap_values=info.hcap_values;for(var f in data)info[f]=data[f]};info.bettable=(info.status=="A")&&parent_info.bettable;if(rebuild_parents)if(orig_displayed&&orig_displayed!=info.displayed){var ev_elem_name=_lb_fb_cpn_preview_event_id_prefix+handler.page_type+"_"+info.coupon_id+"_"+info.ev_id,ev_sort_info=scone_get_item_info(ev_elem_name),day_info=handler.day_hash[parent_info.day_id],day_elem_name=_lb_fb_cpn_preview_day_id_prefix+handler.page_type+"_"+info.coupon_id+"_"+parent_info.day_id,day_sort_info=scone_get_item_info(day_elem_name),type_info=handler.type_hash[parent_info.ev_type_id],type_elem_name=_lb_fb_cpn_preview_type_id_prefix+handler.page_type+"_"+info.coupon_id+"_"+parent_info.ev_type_id,type_sort_info=scone_get_item_info(type_elem_name);if(scone_item_exists(ev_elem_name)){_lb_fb_cpn_preview_calc_selcn_counts(handler);var ev_selcn_count=_lb_fb_cpn_preview_get_selcn_counts(handler,info.ev_id);if(orig_displayed=="Y"){parent_info.hidden=true;var ev_html=tmpl_play("lb_fb_cpn_preview_event",parent_info);scone_replace_item(ev_elem_name,ev_html,ev_sort_info,true)}else if(orig_displayed=="N"&&ev_selcn_count>0){parent_info.hidden=false;var ev_html=tmpl_play("lb_fb_cpn_preview_event",parent_info);scone_replace_item(ev_elem_name,ev_html,ev_sort_info,true)}};_lb_fb_cpn_preview_calc_ev_counts(handler);if(_lb_fb_cpn_preview_get_ev_counts(handler,"DAY",parent_info.day_id)==0){day_info.hidden=true}else day_info.hidden=false;var day_html=tmpl_play("lb_fb_cpn_preview_day",day_info);scone_replace_item(day_elem_name,day_html,day_sort_info,true)};if(orig_displayed!=info.displayed||orig_bettable!=info.bettable||_lb_fb_cpn_preview_diff_objs_brief(orig_hcap_values,info.hcap_values)||force_propogate)for(var ev_oc_id in info.child_hash)_lb_fb_cpn_preview_got_SELCN({ev_oc_id:ev_oc_id,ev_mkt_id:info.ev_mkt_id},handler,rebuild_parents)}
function _lb_fb_cpn_preview_got_MHCAP(data,handler,rebuild_parents){var parent_info=handler.event_hash[data.ev_id],info=handler.evmkt_hash[data.ev_mkt_id];if(!parent_info||!info)return;for(var f in data)info[f]=data[f];for(var ev_oc_id in info.child_hash)_lb_fb_cpn_preview_got_SELCN({ev_oc_id:ev_oc_id,ev_mkt_id:info.ev_mkt_id},handler,rebuild_parents);return}
function _lb_fb_cpn_preview_got_SELCN(data,handler,rebuild_parents){var parent_info=handler.evmkt_hash[data.ev_mkt_id];if(!parent_info)return;parent_info.child_hash[data.ev_oc_id]=true;var info=handler.selcn_hash[data.ev_oc_id],is_new_item=!info,orig_lp_num,orig_lp_den,orig_hcap_value;if(is_new_item){info=data;info.page_type=handler.page_type;info.mode=handler.mode;info.coupon_id=handler.coupon.coupon_id;info.coupon_sort=handler.coupon.coupon_sort;info.ev_id=parent_info.ev_id;handler.selcn_hash[data.ev_oc_id]=info}else{orig_lp_num=info.lp_num;orig_lp_den=info.lp_den;orig_hcap_value=info.hcap_value;for(var f in data)info[f]=data[f]};info.name_full=info.names[handler.cfg.lang];info.name=trunc_string(info.name_full,handler.cfg.name_truncate_threshold,'...');info.has_hcap=false;info.hcap_value="";if(parent_info.hcap_values&&info.fb_result)if(parent_info.hcap_values[info.fb_result]){var rounded_hcap=parent_info.hcap_values[info.fb_result];rounded_hcap=rounded_hcap.replace(/\(/g,"");rounded_hcap=rounded_hcap.replace(/\)/g,"");var is_fraction=(rounded_hcap%1);if(is_fraction==0)rounded_hcap=Math.round(rounded_hcap);if(rounded_hcap>0)rounded_hcap="+"+rounded_hcap;rounded_hcap='('+rounded_hcap+')';info.hcap_value=rounded_hcap;info.has_hcap=true};info.bettable=(info.status=="A")&&parent_info.bettable;var event_info=handler.event_hash[info.ev_id];if(info.fb_result)event_info.col_hash[info.fb_result]=info.ev_oc_id;var scitem_id=_lb_fb_cpn_preview_selcn_id_prefix+handler.page_type+"_"+info.coupon_id+"_"+info.ev_oc_id,pscone_id=_lb_fb_cpn_preview_selcn_holder_id_prefix+handler.page_type+"_"+info.coupon_id+"_"+info.ev_id+"_"+info.fb_result;if(!scone_exists(pscone_id))return;info.price_str=_lb_fb_cpn_preview_get_price_str(handler,info.lp_num,info.lp_den,parent_info.lp_avail,parent_info.mkt_sort);var html=tmpl_play("lb_fb_cpn_preview_selcn",info),was_visible=scone_item_exists(scitem_id),now_visible=(info.displayed=="Y")&&(parent_info.displayed=="Y");if(!was_visible){scone_add_item(pscone_id,scitem_id,html,null)}else scone_replace_item(scitem_id,html,null,true);if(rebuild_parents){var ev_elem_name=_lb_fb_cpn_preview_event_id_prefix+handler.page_type+"_"+info.coupon_id+"_"+event_info.ev_id,ev_sort_info=scone_get_item_info(ev_elem_name),day_info=handler.day_hash[event_info.day_id],day_elem_name=_lb_fb_cpn_preview_day_id_prefix+handler.page_type+"_"+info.coupon_id+"_"+event_info.day_id,day_sort_info=scone_get_item_info(day_elem_name);if(scone_item_exists(ev_elem_name)){_lb_fb_cpn_preview_calc_selcn_counts(handler);var ev_selcn_count=_lb_fb_cpn_preview_get_selcn_counts(handler,event_info.ev_id);if(ev_selcn_count==0){event_info.hidden=true;var ev_html=tmpl_play("lb_fb_cpn_preview_event",event_info);scone_replace_item(ev_elem_name,ev_html,ev_sort_info,true)}else if(parent_info.displayed=="Y"){event_info.hidden=false;var ev_html=tmpl_play("lb_fb_cpn_preview_event",event_info);scone_replace_item(ev_elem_name,ev_html,ev_sort_info,true)}};_lb_fb_cpn_preview_calc_ev_counts(handler);if(_lb_fb_cpn_preview_get_ev_counts(handler,"DAY",event_info.day_id)==0){day_info.hidden=true}else day_info.hidden=false;var day_html=tmpl_play("lb_fb_cpn_preview_day",day_info);scone_replace_item(day_elem_name,day_html,day_sort_info,true)};if(!is_new_item&&now_visible&&info.bettable)_lb_fb_cpn_preview_highlight_price_change(handler,info.ev_oc_id,info.lp_num,info.lp_den,orig_lp_num,orig_lp_den)}
function _lb_fb_cpn_preview_got_PRICE(data,handler,rebuild_parents){var info=handler.selcn_hash[data.ev_oc_id];if(!info)return;var parent_info=handler.evmkt_hash[info.ev_mkt_id];if(!parent_info)return;var orig_lp_num=info.lp_num,orig_lp_den=info.lp_den;for(var f in data)info[f]=data[f];var price_id=_lb_fb_cpn_preview_selcn_link_id_prefix+handler.page_type+"_"+info.coupon_id+"_"+info.ev_oc_id,price_el=document.getElementById(price_id);if(!price_el)return;if(info.displayed!="Y")return;if(info.status!="A")return;info.price_str=_lb_fb_cpn_preview_get_price_str(handler,info.lp_num,info.lp_den,parent_info.lp_avail,parent_info.mkt_sort);price_el.innerHTML=info.price_str;if(info.bettable)_lb_fb_cpn_preview_highlight_price_change(handler,info.ev_oc_id,info.lp_num,info.lp_den,orig_lp_num,orig_lp_den);return}
function _lb_fb_cpn_preview_get_price_str(handler,lp_num,lp_den,lp_avail,mkt_sort){if(typeof lp_avail=="undefined")lp_avail="Y";if(typeof mkt_sort=="undefined")mkt_sort="--";var price_str_type=handler.cfg.price_str_type;if(mkt_sort=="AH"&&handler.cfg.price_str_type_ah!="")price_str_type=handler.cfg.price_str_type_ah;if(mkt_sort=="HL"&&handler.cfg.price_str_type_hl!="")price_str_type=handler.cfg.price_str_type_hl;if(lp_avail=="N")return"SP";if(lp_num==""&&lp_den=="")return"-";var price_str;if(price_str_type=="DECIMAL"){var dps=(lp_den>100)?3:2,dp=1.0+(lp_num/lp_den),scaled_dp=""+Math.round(dp*Math.pow(10,dps)-0.5),int_part=scaled_dp.substr(0,scaled_dp.length-dps),frac_part=scaled_dp.substr(scaled_dp.length-dps),price_str=int_part+"."+frac_part}else{if(lp_den=="")lp_den=1;if(lp_num==lp_den){price_str="evens"}else price_str=lp_num+handler.cfg.price_str_sep+lp_den};return price_str}
function _lb_fb_cpn_preview_highlight_price_change(handler,ev_oc_id,lp_num,lp_den,old_lp_num,old_lp_den){if(isNaN(lp_num)||isNaN(old_lp_num))return;var d=lp_num*old_lp_den-lp_den*old_lp_num;if(d==0)return;var price_id=_lb_fb_cpn_preview_selcn_id_prefix+handler.page_type+"_"+handler.coupon.coupon_id+"_"+ev_oc_id;_lb_fb_cpn_preview_highlight(handler,price_id,_lb_fb_cpn_preview_selcn_base_class,d);return}
function _lb_fb_cpn_preview_highlight(handler,id,base_class,dir){var el=document.getElementById(id);if(!el)return;var highlight_class="";if(dir<0){highlight_class=base_class+handler.cfg.hl_class_decrease}else if(dir>0){highlight_class=base_class+handler.cfg.hl_class_increase}else highlight_class=base_class+handler.cfg.hl_class_same;var classes=el.className.split(" "),found=false;for(var i=0;i<classes.length;i++)if(classes[i]==base_class+handler.cfg.hl_class_same||classes[i]==base_class+handler.cfg.hl_class_increase||classes[i]==base_class+handler.cfg.hl_class_decrease){classes[i]=highlight_class;found=true;break};if(!found)classes.push(highlight_class);el.className=classes.join(" ");if(_lb_fb_cpn_preview_hl_timers[id]!=null){window.clearTimeout(_lb_fb_cpn_preview_hl_timers[id]);delete _lb_fb_cpn_preview_hl_timers[id]};var self=this;if(dir!=0)_lb_fb_cpn_preview_hl_timers[id]=window.setTimeout(function(){self._lb_fb_cpn_preview_highlight(handler,id,base_class,0)},handler.cfg.highlight_duration);return}
function lb_fb_cpn_preview_add_bet(ev_oc_id,page_type,coupon_id){var handler=_lb_fb_cpn_preview_hash[page_type+coupon_id],selcn=handler.selcn_hash[ev_oc_id];if(selcn.bettable){var evmkt=handler.evmkt_hash[selcn.ev_mkt_id];BS_set_leg("selections",ev_oc_id);BS_set_leg("price_type","L");BS_set_leg("lp_num",selcn.lp_num);BS_set_leg("lp_den",selcn.lp_den);BS_set_leg("hcap_value",evmkt.raw_hcap);BS_set_leg("bir_index",evmkt.bir_index);BS_set_leg("market_tags","");BS_set_leg('bet_origin',page_type.toUpperCase());BS_go_bet()};return}
function _lb_fb_cpn_preview_calc_ev_counts(handler){handler.ev_count={};var total_ev_count=0,handler_hash=handler.day_hash,mode_name="DAY";for(var hash_id in handler_hash){var hash_ev_count=0,hash_elem_name=_lb_fb_cpn_preview_events_id_prefix+handler.page_type+"_"+handler.coupon.coupon_id+"_"+hash_id;if(scone_exists(hash_elem_name)){var evs=scone_get_items(hash_elem_name);for(var e=0;e<evs.length;e++)if(document.getElementById(evs[e]).style.display=="")hash_ev_count++;total_ev_count+=hash_ev_count;handler.ev_count[mode_name+hash_id]=hash_ev_count}};handler.ev_count["ALL"]=total_ev_count;var view_more_str;if(handler.num_trimmed>0){view_more_str=tmpl_ml_printf('FB_HOME_LOWER_VIEW_MORE',handler.num_trimmed)}else view_more_str=tmpl_xl('FB_HOME_LOWER_NO_MORE');jQuery(function(){if(total_ev_count>0){jQuery('#view_more_button_'+handler.page_type).text(view_more_str);jQuery('#view_more_button_'+handler.page_type).show()}else jQuery('#view_more_button_'+handler.page_type).hide()});if(total_ev_count==0){document.getElementById(_lb_fb_cpn_preview_coupon_area_no_selns_prefix+handler.page_type).style.display="";document.getElementById(_lb_fb_cpn_preview_coupon_area_prefix+handler.page_type).style.display="none"}else{document.getElementById(_lb_fb_cpn_preview_coupon_area_no_selns_prefix+handler.page_type).style.display="none";document.getElementById(_lb_fb_cpn_preview_coupon_area_prefix+handler.page_type).style.display=""}}
function _lb_fb_cpn_preview_get_ev_counts(handler,level,id){var count=handler.ev_count[level+id];if(count){return count}else return 0}
function _lb_fb_cpn_preview_calc_selcn_counts(handler){handler.selcn_count={};for(var ev_oc_id in handler.selcn_hash){var selcn_info=handler.selcn_hash[ev_oc_id];if(selcn_info){var ev_id=selcn_info.ev_id;if(!handler.selcn_count[ev_id])handler.selcn_count[ev_id]=0;if(selcn_info.displayed=="Y")handler.selcn_count[ev_id]=handler.selcn_count[ev_id]+1}}}
function _lb_fb_cpn_preview_get_selcn_counts(handler,ev_id){var count=handler.selcn_count[ev_id];if(count){return count}else return 0}
function _lb_fb_cpn_preview_cmp_ev_mb_arrays(arr1,arr2){if(arr1.length!=arr2.length)return false;for(var x=0;x<arr1.length;x++)if(arr1[x].name!=arr2[x].name||arr1[x].url!=arr2[x].url)return false;return true}
function _lb_fb_cpn_preview_diff_objs_brief(a,b){for(var f in a)if(b[f]==undefined)return true;for(var f in b)if(a[f]==undefined)return true;for(var f in a){if(b[f]==undefined)continue;var va=a[f],vb=b[f];if(typeof va!=typeof vb){return true}else if(typeof va=="object"){if(_lb_fb_cpn_preview_diff_objs_brief(va,vb))return true}else if(va!=vb)return true};return false}
function lb_fb_cpn_preview_schedule_reload(tab_id){var handler=_lb_fb_cpn_preview_hash[_lb_fb_cpn_preview_tab_hash[tab_id]];if(handler){_lb_fb_cpn_preview_schedule_reload(handler.page_type,handler.coupon.coupon_id,handler.cfg.reload_period)}else document.PollingAjaxHelper.clearInterval("_lb_fb_cpn_preview_schedule_reload")}
function _lb_fb_cpn_preview_schedule_reload(page_type,coupon_id,reload_period){document.PollingAjaxHelper.clearInterval("_lb_fb_cpn_preview_schedule_reload");document.PollingAjaxHelper.setInterval("_lb_fb_cpn_preview_schedule_reload",function(){lb_fb_cpn_preview_reload(page_type,coupon_id)},reload_period)}
function lb_fb_cpn_preview_refresh(){var handler=_lb_fb_cpn_preview_hash[_lb_fb_cpn_preview_tab_hash[current_tab]];if(handler)lb_fb_cpn_preview_reload(handler.page_type,handler.coupon.coupon_id,0,1)}
function lb_fb_cpn_preview_reload(page_type,coupon_id,show_all,refresh){var handler=_lb_fb_cpn_preview_hash[page_type+coupon_id];if(show_all){var show_all=1}else var show_all=0;if(refresh){var play_type="refresh";if(handler.coupon.showing_all)show_all=1}else var play_type="js";var clientdata={id:'lb_fb_coupon_area_'+page_type+'_js'},url=handler.coupon.reload_url+"&cust_hash="+handler.cfg.reload_hash+"&page_type="+page_type+"&coupon_id="+coupon_id+"&play_type="+play_type+"&show_all="+show_all+"&preview=1";_lb_fb_cpn_preview_make_ajax_get_request(url,clientdata,_lb_fb_cpn_preview_got_ajax_content)}
function _lb_fb_cpn_preview_make_ajax_get_request(url,clientdata,callback){if(document.PollingAjaxHelper.checkSemaphore()){document.PollingAjaxHelper.setTimeout("_lb_fb_cpn_preview_make_ajax_get_request"+clientdata.id,function(){_lb_fb_cpn_preview_got_ajax_content(url,clientdata,callback)},300);return};document.PollingAjaxHelper.aquireSemaphore();var req=null;if(window.XMLHttpRequest){req=new XMLHttpRequest()}else if(window.ActiveXObject)req=new ActiveXObject('Microsoft.XMLHTTP');if(req){req.onreadystatechange=function(){if(req.readyState!=4)return;var reqStatus;try{reqStatus=req.status}catch(e){reqStatus=''};if(reqStatus!=200){document.PollingAjaxHelper.releaseSemaphore();callback(url,clientdata,false,'HTTP')}else{document.PollingAjaxHelper.releaseSemaphore();callback(url,clientdata,true,req.responseText)}};try{req.open('GET',url,true);req.send(null)}catch(e){document.PollingAjaxHelper.releaseSemaphore();callback(url,clientdata,false,'UNSUPPORTED')}}else{document.PollingAjaxHelper.releaseSemaphore();callback(url,clientdata,false,'UNSUPPORTED')}}
function _lb_fb_cpn_preview_got_ajax_content(url,clientdata,ok,response){var holder_el=document.getElementById(clientdata.id);if(ok){if(response==""||response==null)return;var parts=_lb_fb_cpn_preview_parse_script_tags(response);if(holder_el)holder_el.innerHTML=parts[0];if(parts[1].length)try{_lb_fb_cpn_preview_global_eval(parts[1])}catch(e){ok=false}}}
function _lb_fb_cpn_preview_parse_script_tags(str){var html='',js='',i=0,state='HTML',script_re=new RegExp('<(/?)script([^>]*)>','gi');while((mtch=script_re.exec(str))!=null){mS=mtch.index;if(state=='HTML'){html+=str.substring(i,mS)}else js+=str.substring(i,mS)+';\n';var closer=mtch[1],attrs=mtch[2];if(closer=='/'){state='HTML'}else if(attrs.charAt(attrs.length-1)!='/'&&attrs.indexOf('src=')==-1)state='JS';i=script_re.lastIndex};if(state=='HTML'){html+=str.substring(i)}else js+=str.substring(i);return[html,js]};var _lb_fb_cpn_preview_global_eval=function(src){if(window.execScript){window.execScript(src);return};var fn=function(){window.eval.call(window,src)};fn()}
function _lb_fb_cpn_preview_prune_events(handler,prune_events){var ev_hash=handler.event_hash;for(ev_id in ev_hash){var ev_exists=prune_events[ev_id];if(!ev_exists)_lb_fb_cpn_preview_remove_EVENT(handler,ev_id)}}
function _lb_fb_cpn_preview_remove_EVENT(handler,ev_id){var scitem_id="",info=handler.event_hash[ev_id],parent_info=handler.day_hash[info.day_id];scitem_id=_lb_fb_cpn_preview_event_id_prefix+handler.page_type+"_"+info.coupon_id+"_"+info.ev_id;scone_remove_item(scitem_id);for(var ev_mkt_id in info.child_hash)if(handler.evmkt_hash[ev_mkt_id]){for(var ev_oc_id in handler.evmkt_hash[ev_mkt_id].child_hash)if(handler.selcn_hash[ev_oc_id])delete handler.selcn_hash[ev_oc_id];delete handler.evmkt_hash[ev_mkt_id]};delete handler.event_hash[ev_id];delete parent_info.child_hash[ev_id];delete handler.selcn_count[ev_id];if(handler.score_hash[ev_id])delete handler.score_hash[ev_id]}
function me_init(call_type,events,markets,selcns,server_time_year,server_time_month,server_time_day,server_time_hour,server_time_min,server_time_sec,date,init_msg_id,cfg){var channels=[];if(_me_loaded==1)return;_me_loaded=1;_me_last_msg_id=init_msg_id;for(var f in cfg)_me_cfg[f]=cfg[f];if(call_type=="http"){_me_store_templates();_me_event_hash={};_me_evmkt_hash={};_me_selcn_hash={};scone_create(_me_events_id_prefix,{},_me_cmp_events,null);var first_build=true;initPeriodClocks(server_time_year,server_time_month,server_time_day,server_time_hour,server_time_min,server_time_sec,_me_cfg.lang)}else{_me_remove_EVENTS(events);_me_remove_EVMKTS(markets);_me_remove_SELCNS(selcns);var first_build=false};_me_server_date=date;_me_system_date=new Date().getTime();if(events.length>0){_me_got_EVENT(events[0],first_build);_me_ev_id=events[0].ev_id;if(!_me_channels["EVENT"+events[0].ev_id]){channels.push("sEVENT"+ps_connect_lpad_id(events[0].ev_id));_me_channels["EVENT"+events[0].ev_id]=true}};for(var i=0;i<markets.length;i++)if(!_me_evmkt_hash[markets[i].ev_mkt_id]&&markets[i].ev_id==_me_ev_id){_me_got_EVMKT(markets[i],first_build);_me_mkt_id=markets[i].ev_mkt_id;if(!_me_channels["MARKET"+markets[i].ev_mkt_id]){channels.push("sEVMKT"+ps_connect_lpad_id(markets[i].ev_mkt_id));channels.push("SEVMKT"+ps_connect_lpad_id(markets[i].ev_mkt_id));_me_channels["MARKET"+markets[i].ev_mkt_id]=true}};for(var i=0;i<selcns.length;i++)if((!_me_selcn_hash[selcns[i].ev_oc_id])&&selcns[i].ev_mkt_id==_me_mkt_id)_me_got_SELCN(selcns[i],first_build);if(channels.length>0){ps_connect_register("me"+me_idx,_me_got_msg,channels,init_msg_id);me_idx++};var me_area_elem=document.getElementById(_me_events_id_prefix),no_data_elem=document.getElementById(_me_no_data_area_id),ev_ids=scone_get_items(_me_events_id_prefix);if(ev_ids.length==0){me_area_elem.style.display="none";no_data_elem.style.display=""}else{me_area_elem.style.display="";no_data_elem.style.display="none"};if(_me_mkt_id!=""&&_me_evmkt_hash[_me_mkt_id].tot_bets!=-1)_me_update_percentages(_me_mkt_id);return};var _me_no_data_area_id="no_me_data",_me_events_id_prefix="me_events",_me_event_id_prefix="me_event_",_me_evmkts_id_prefix="me_evmkts_",_me_evmkt_id_prefix="me_evmkt_",_me_selcns_id_prefix="me_selcns_",_me_selcn_id_prefix="me_selcn_",_me_event_clock_id_prefix="me_clock_",_me_price_id_prefix="me_price_",_me_event_hash={},_me_evmkt_hash={},_me_selcn_hash={},_me_ev_id="",_me_mkt_id="",_me_channels={},me_idx=0,_me_loaded=0
function _me_store_templates(){var tmp=[];tmp.push('	<div class="me_event" id="me_event_<%ev_id%>">\n');tmp.push('		<div class="label" <%IF ev_has_bet_in_run == "N" || !in_past%>onclick="me_go_mevt_no_bir(<%ev_id%>,<%ev_type%>)"<%ELSE%>onclick="me_go_mevt_bir(<%ev_id%>,<%ev_type%>)"<%END%>><strong><%class_name%></strong> - <a href="javascript:void(0)"><%name%></a>');tmp.push('		<div class="score_and_time"><%IF in_past%><%IF score_home != "" && score_away != ""%> <%score_home%> - <%score_away%><%END%> <%IF ev_type=="FB" && period_id!="" && show_bir_clocks == "Y"%><div class="time" id="me_clock_<%ev_id%>"></div><%ELSE%><div class="time"><%time%></div><%END%><%ELSE%><div class="time"><%time%></div><%END%></div>\n');tmp.push('		</div>');tmp.push('		<%IF !bettable%><div class="hp_main_event_suspended"><%XL HP_MAIN_EVENT_SUSPENDED%></div><%END%>\n');tmp.push('		<div id="me_evmkts_<%ev_id%>"></div>\n');tmp.push('	</div>\n');tmpl_store("me_event",tmp.join(""));var tmp=[];tmp.push('	<div class="me_evmkt" id="me_evmkt_<%ev_mkt_id%>">\n');tmp.push('		<div <%IF !parent_bettable%>style="display:none"<%END%> id="me_selcns_<%ev_mkt_id%>"></div>\n');tmp.push('	</div>\n');tmpl_store("me_evmkt",tmp.join(""));var tmp=[];tmp.push('	<div class="me_selcn" id="me_selcn_<%ev_oc_id%>">\n');tmp.push('		<div class="left">\n');tmp.push('			<div class="greyBar">\n');tmp.push('				<div class="blueBar" style="width: <%b_perc%>\%" id="bar_<%ev_oc_id%>">\n');tmp.push('				</div>\n');tmp.push('			</div>\n');tmp.push('		</div>\n');tmp.push('		<div class="left"><div id="perc_<%ev_oc_id%>" class="left percent"><%b_perc%>\% </div><div class="left team"><a href="javascript:void(0)" <%IF bettable%>onclick="me_add_bet(<%ev_oc_id%>)"<%END%>><strong><%name%></strong></a></div></div>\n');tmp.push('		<div <%IF bettable%>class="odd right"<%ELSE%>class="odd suspended right"<%END%>><a <%IF bettable%>title="Click to add to Betslip"<%END%> id="me_price_<%ev_oc_id%>" <%IF bettable%>onclick="me_add_bet(<%ev_oc_id%>)"<%END%>><%price_str%></a></div>\n');tmp.push('	</div>\n');tmpl_store("me_selcn",tmp.join(""))};var _me_cfg={lang:"en",bet_threshold:1,name_truncate_threshold:8,price_str_type:"ODDS",price_str_type_ah:"DECIMAL",price_str_type_hl:"DECIMAL",price_str_sep:"-"},_me_server_date="",_me_system_date=0
function _me_got_msg(msg){var data={};if(msg.subject_level=="sPRICE"){eval("data = "+msg.data+";");data.ev_oc_id=msg.subject_id;_me_got_PRICE(data)}else if(msg.subject_level=="sSELCN"){eval("data = "+msg.data+";");data.ev_oc_id=msg.subject_id;_me_got_SELCN(data,false)}else if(msg.subject_level=="sEVMKT"){eval("data = "+msg.data+";");data.ev_mkt_id=msg.subject_id;_me_got_EVMKT(data,false)}else if(msg.subject_level=="sMHCAP"){eval("data = "+msg.data+";");data.ev_mkt_id=msg.subject_id;_me_got_MHCAP(data)}else if(msg.subject_level=="sEVENT"){eval("data = "+msg.data+";");data.ev_id=msg.subject_id;_me_got_EVENT(data,false)};return}
function _me_got_EVENT(data,first_build){var info=_me_event_hash[data.ev_id],is_new_item=!info,orig_bettable;if(is_new_item){info=data;_me_event_hash[data.ev_id]=info;info.child_hash={};addClockEvent(data.ev_id,data.periods,_me_event_clock_id_prefix)}else{orig_bettable=info.bettable;for(var f in data)info[f]=data[f]};info.name=info.names[_me_cfg.lang];info.start_time_xl=info.start_time_xls[_me_cfg.lang];info.bettable=(info.status=="A");info.img_url=_me_cfg.image_url;info.ev_type="\'"+info.ev_class_type+"\'";var susp_time_ms=0,start_time=time_in_milliseconds(info.start_time);if(info.suspend_at!="")susp_time_ms=time_in_milliseconds(info.suspend_at);var cur_time=time_in_milliseconds(_me_server_date)+((new Date().getTime())-_me_system_date),start_time_dif=cur_time-start_time,susp_time_dif=cur_time-susp_time_ms;if(info.ev_has_bet_in_run=="N"&&info.displayed=="Y")if(info.is_off=="Y"){info.displayed="N"}else if(info.is_off=="_"&&start_time_dif>0){info.displayed="N"}else if(info.is_off=="N"&&susp_time_dif>0)info.displayed="N";if(start_time_dif>0){info.in_past=1}else info.in_past=0;info.time=_me_calculate_time_to_start(cur_time,start_time);var scitem_id=_me_event_id_prefix+info.ev_id,pscone_id=_me_events_id_prefix,html=tmpl_play("me_event",info),sort_info={disporder:info.disporder,ev_id:info.ev_id},me_area_elem=document.getElementById(_me_events_id_prefix),no_data_elem=document.getElementById(_me_no_data_area_id),was_visible=scone_item_exists(scitem_id),now_visible=false;if(info.displayed=="Y")now_visible=true;if(!was_visible&&now_visible){scone_add_item(pscone_id,scitem_id,html,sort_info);var cscone_id=_me_evmkts_id_prefix+data.ev_id;scone_create(cscone_id,{},_me_cmp_evmkts,null);me_area_elem.style.display="";no_data_elem.style.display="none"}else if(was_visible&&now_visible){scone_replace_item(scitem_id,html,sort_info,true)}else if(was_visible&&!now_visible){scone_remove_item(scitem_id);var ev_ids=scone_get_items(_me_events_id_prefix);if(ev_ids.length==0){me_area_elem.style.display="none";no_data_elem.style.display=""}};if(now_visible&&(!was_visible||orig_bettable!=info.bettable))for(var ev_mkt_id in info.child_hash)_me_got_EVMKT({ev_mkt_id:ev_mkt_id,ev_id:info.ev_id},first_build)}
function _me_got_EVMKT(data,first_build){var parent_info=_me_event_hash[data.ev_id];if(!parent_info)return;parent_info.child_hash[data.ev_mkt_id]=true;var info=_me_evmkt_hash[data.ev_mkt_id],is_new_item=!info,orig_displayed,orig_disporder,orig_name,orig_bettable,orig_hcap_values;if(is_new_item){info=data;_me_evmkt_hash[data.ev_mkt_id]=info;info.child_hash={}}else{orig_displayed=info.displayed;orig_disporder=info.disporder;orig_name=info.name;orig_bettable=info.bettable;orig_hcap_values=info.hcap_values;for(var f in data)info[f]=data[f]};info.is_new=(is_new_item&&!first_build)||(!is_new_item&&orig_displayed!=info.displayed&&info.displayed=="Y");info.name=info.names[_me_cfg.lang];info.bettable=(info.status=="A")&&parent_info.bettable;info.parent_bettable=parent_info.bettable;if(info.blurb==undefined)info.blurb="";var scitem_id=_me_evmkt_id_prefix+data.ev_mkt_id,pscone_id=_me_evmkts_id_prefix+parent_info.ev_id,html=tmpl_play("me_evmkt",info),sort_info={disporder:info.disporder,ev_mkt_id:info.ev_mkt_id},was_visible=scone_item_exists(scitem_id),now_visible=false;if(info.displayed=="Y")now_visible=true;if(info.tot_bets>=_me_cfg.bet_threshold)if(!was_visible&&now_visible){scone_add_item(pscone_id,scitem_id,html,sort_info);var cscone_id=_me_selcns_id_prefix+data.ev_mkt_id;scone_create(cscone_id,{},_me_cmp_evmkts,null)}else if(was_visible&&now_visible){scone_replace_item(scitem_id,html,sort_info,true)}else if(was_visible&&!now_visible)scone_remove_item(scitem_id);if(now_visible&&(!was_visible||orig_bettable!=info.bettable))for(var ev_oc_id in info.child_hash)_me_got_SELCN({ev_oc_id:ev_oc_id,ev_mkt_id:info.ev_mkt_id},first_build)}
function _me_got_SELCN(data,first_build){var parent_info=_me_evmkt_hash[data.ev_mkt_id],parent_parent_info=_me_event_hash[parent_info.ev_id];if(!parent_info)return;parent_info.child_hash[data.ev_oc_id]=true;var info=_me_selcn_hash[data.ev_oc_id],is_new_item=!info,orig_lp_num,orig_lp_den;if(is_new_item){info=data;_me_selcn_hash[data.ev_oc_id]=info}else{orig_lp_num=info.lp_num;orig_lp_den=info.lp_den;orig_hcap_values=info.hcap_values;for(var f in data)info[f]=data[f]};var b_perc=Math.round(100*info.bets/parent_info.tot_bets);info.b_perc=parseInt(b_perc);info.name=info.names[_me_cfg.lang];info.name=trunc_string(info.name,_me_cfg.name_truncate_threshold,'...');if(info.fb_result&&parent_info.hcap_values)info.hcap_value=parent_info.hcap_values[info.fb_result];info.bettable=(info.status=="A")&&parent_info.bettable;info.price_str=me_get_price_str(info.lp_num,info.lp_den,parent_info.lp_avail,parent_info.mkt_sort);var scitem_id=_me_selcn_id_prefix+info.ev_oc_id,pscone_id=_me_selcns_id_prefix+parent_info.ev_mkt_id;if(!scone_exists(pscone_id))return;var html=tmpl_play("me_selcn",info),sort_info={disporder:info.disporder,lp_num:info.lp_num,lp_den:info.lp_den,ev_oc_id:info.ev_oc_id},was_visible=scone_item_exists(scitem_id),now_visible=(info.displayed=="Y");if(parent_parent_info.displayed=="N")now_visible==false;if(!was_visible&&now_visible){scone_add_item(pscone_id,scitem_id,html,sort_info)}else if(was_visible&&now_visible){scone_replace_item(scitem_id,html,sort_info,true)}else if(was_visible&&!now_visible)scone_remove_item(scitem_id)}
function _me_got_PRICE(data){var info=_me_selcn_hash[data.ev_oc_id];if(!info)return;var parent_info=_me_evmkt_hash[info.ev_mkt_id];if(!parent_info)return;var orig_lp_num=info.lp_num,orig_lp_den=info.lp_den;for(var f in data)info[f]=data[f];var scitem_id=_me_selcn_id_prefix+data.ev_oc_id;if(!scone_item_exists(scitem_id))return;var sort_info={disporder:info.disporder,lp_num:info.lp_num,lp_den:info.lp_den,ev_oc_id:info.ev_oc_id};scone_set_item_info(scitem_id,sort_info);var price_id=_me_price_id_prefix+info.ev_oc_id,price_el=document.getElementById(price_id);if(!price_el)return;info.price_str=me_get_price_str(info.lp_num,info.lp_den,parent_info.lp_avail,parent_info.mkt_sort);price_el.innerHTML=info.price_str;return}
function _me_got_MHCAP(data){var parent_info=_me_event_hash[data.ev_id],info=_me_evmkt_hash[data.ev_mkt_id];if(!parent_info||!info)return;for(var f in data)info[f]=data[f];for(var ev_oc_id in info.child_hash)_me_got_SELCN({ev_oc_id:ev_oc_id,ev_mkt_id:info.ev_mkt_id});return}
function _me_cmp_events(cmpMode,evA,evB){var d=evA.disporder-evB.disporder;if(d<0){return-1}else if(d==0){return 0}else return 1}
function _me_cmp_evmkts(cmpMode,mktA,mktB){var d=mktA.disporder-mktB.disporder;if(d)return d;return mktA.ev_mkt_id-mktB.ev_mkt_id}
function _me_remove_EVENTS(events){var found=false,scitem_id="";for(var ev_id in _me_event_hash){found=false;for(var i=0;i<events.length;i++)if(events[i].ev_id==ev_id)found=true;if(!found){scitem_id=_me_event_id_prefix+ev_id;scone_remove_item(scitem_id);if(_me_event_hash[ev_id]){for(var ev_mkt_id in _me_event_hash[ev_id].child_hash)if(_me_evmkt_hash[ev_mkt_id]){for(var ev_oc_id in _me_evmkt_hash[ev_mkt_id].child_hash)if(_me_selcn_hash[ev_oc_id])delete _me_selcn_hash[ev_oc_id];delete _me_evmkt_hash[ev_mkt_id]};delete _me_event_hash[ev_id]}}}}
function _me_remove_EVMKTS(markets){var found=false,scitem_id="";for(var ev_mkt_id in _me_evmkt_hash){found=false;for(var i=0;i<markets.length;i++)if(markets[i].ev_mkt_id==ev_mkt_id)found=true;if(!found){scitem_id=_me_evmkt_id_prefix+ev_mkt_id;scone_remove_item(scitem_id);if(_me_evmkt_hash[ev_mkt_id]){for(var ev_oc_id in _me_evmkt_hash[ev_mkt_id].child_hash)if(_me_selcn_hash[ev_oc_id])delete _me_selcn_hash[ev_oc_id];delete _me_evmkt_hash[ev_mkt_id]}}}}
function _me_remove_SELCNS(selcns){var found=false,scitem_id="";for(var ev_oc_id in _me_selcn_hash){found=false;for(var i=0;i<selcns.length;i++)if(selcns[i].ev_oc_id==ev_oc_id)found=true;if(!found){scitem_id=_me_selcn_id_prefix+ev_oc_id;scone_remove_item(scitem_id);if(_me_selcn_hash[ev_oc_id])delete _me_selcn_hash[ev_oc_id]}}}
function _time_in_days_hours_mins(time){var days,hours,minutes,ret_time="";time=parseInt(time/(1e3*60));days=parseInt(time/(60*24));minutes=parseInt(time%60);hours=parseInt((time/60)%24);if(days!=0)ret_time=days+" "+_me_days+" ";if(hours!=0||days!=0)ret_time=ret_time+hours+" "+_me_hours+" : ";ret_time=ret_time+minutes+" "+_me_mins;return ret_time}
function _me_calculate_time_to_start(cur_time,start_time){var t_dif=start_time-cur_time,ret_time="";if(t_dif>0){ret_time=_me_starts+" "+_time_in_days_hours_mins(t_dif)}else{t_dif=-t_dif;ret_time=_me_started+" "+_time_in_days_hours_mins(t_dif)+" "+_me_ago};return ret_time}
function me_get_price_str(lp_num,lp_den,lp_avail,mkt_sort){if(lp_avail==undefined)lp_avail="Y";if(mkt_sort==undefined)mkt_sort="--";var price_str_type=_me_cfg.price_str_type;if(mkt_sort=="AH"&&_me_cfg.price_str_type_ah!="")price_str_type=_me_cfg.price_str_type_ah;if(mkt_sort=="HL"&&_me_cfg.price_str_type_hl!="")price_str_type=_me_cfg.price_str_type_hl;if(lp_avail=="N")return"SP";if(lp_num==""&&lp_den=="")return"-";var price_str;if(price_str_type=="DECIMAL"){var dps=(lp_den>100)?3:2,dp=1.0+(lp_num/lp_den),scaled_dp=""+Math.round(dp*Math.pow(10,dps)-0.5),int_part=scaled_dp.substr(0,scaled_dp.length-dps),frac_part=scaled_dp.substr(scaled_dp.length-dps);if(int_part=="")int_part="";if(frac_part=="")frac_part="";var price_str=int_part+"."+frac_part}else{if(lp_den=="")lp_den=1;if(lp_num==lp_den){price_str="evens"}else price_str=lp_num+_me_cfg.price_str_sep+lp_den};return price_str}
function me_add_bet(ev_oc_id){var selcn=_me_selcn_hash[ev_oc_id],evmkt=_me_evmkt_hash[selcn.ev_mkt_id];BS_set_leg("selections",ev_oc_id);BS_set_leg("price_type","L");BS_set_leg("lp_num",selcn.lp_num);BS_set_leg("lp_den",selcn.lp_den);BS_set_leg("hcap_value",evmkt.raw_hcap);BS_set_leg("bir_index",evmkt.bir_index);BS_set_leg("market_tags","");BS_go_bet();return}
function _me_update_percentages(ev_mkt_id){var sel_ids=scone_get_items(_me_selcns_id_prefix+ev_mkt_id);if(sel_ids.length!=3)return;var perc_obj,sel_id,perc=0;for(var i=0;i<sel_ids.length;i++){perc_obj=null;sel_id=sel_ids[i].substring(_me_selcn_id_prefix.length,sel_ids[i].length);perc_obj=document.getElementById("perc_"+sel_id);if(perc_obj==null)return;perc+=parseInt(perc_obj.innerHTML)};if(perc==99){var new_perc=parseInt(perc_obj.innerHTML);new_perc++}else if(perc==101){var new_perc=parseInt(perc_obj.innerHTML);new_perc--}else return;var info=_me_selcn_hash[sel_id];info.b_perc=new_perc;var sort_info={disporder:info.disporder,lp_num:info.lp_num,lp_den:info.lp_den,ev_oc_id:info.ev_oc_id},html=tmpl_play("me_selcn",info),scitem_id=_me_selcn_id_prefix+info.ev_oc_id;scone_replace_item(scitem_id,html,sort_info,true)}
function me_go_mevt_no_bir(ev_id,ev_class_type){if(ev_class_type=="HR"||ev_class_type=="GR"){self.location.href=_me_url+'?action=go_racing&ev_id='+ev_id}else if(ev_class_type=="FB"){self.location.href=_me_url+'?action=go_fb_event&ev_id='+ev_id}else if(ev_class_type=="FN"){self.location.href=_me_url+'?action=show_event_by_markets&chosen_ev_id='+ev_id}else self.location.href=_me_url+'?action=show_event_by_markets&chosen_ev_id='+ev_id}
function me_go_mevt_bir(ev_id,ev_class_type){if(ev_class_type=="HR"||ev_class_type=="GR"){self.location.href=_me_url+'?action=go_betlive_event&ev_id='+ev_id}else if(ev_class_type=="FB"){self.location.href=_me_url+'?action=go_betlive_event&ev_id='+ev_id}else if(ev_class_type=="FN"){self.location.href=_me_url+'?action=go_betlive_event_financials_home&ev_id='+ev_id}else self.location.href=_me_url+'?action=go_betlive_event&ev_id='+ev_id};var betlive=new Object();betlive.calendar=new Object();betlive.coupon=new Object();betlive.coupon.bir_json_url='';betlive.coupon.coupon_mkts_poll_interval='10000';betlive.coupon.coupon_mkt_data={bir_market:[]};betlive.coupon.coupon_seln_hash=new Object();betlive.coupon.coupon_mkt_hash=new Object();betlive.event=new Object();betlive.event.bir_json_url='';betlive.event.custcom_url='';betlive.event.lang='en';betlive.event.until_susp_label="";betlive.event.until_close_label="";betlive.event.opening_level_label="";betlive.event.opening_time_label="";betlive.event.financial_indicator_red="";betlive.event.financial_indicator_green="";betlive.event.financial_indicator_no_move="";betlive.event.warn_threshold=5;betlive.event.about_to_susp_message="";betlive.event.about_to_close_message="";betlive.event.financial_ev_id="";betlive.event.financial_hcap_to_follow=-1;betlive.event.financial_js_url=""
function StringBuffer(){this.buffer=[]};StringBuffer.prototype.append=function append(string){this.buffer.push(string);return this};StringBuffer.prototype.toString=function toString(){return this.buffer.join("")}
function lb_update_coupon_mkts(updated_coupon_mkt_data){var mkt_idx=-1,seln_idx=-1,has_new_selection=false,updated_market='',updated_seln='',num_mkts=updated_coupon_mkt_data.bir_market.length,cpn_seln_hash=betlive.coupon.coupon_seln_hash,cpn_mkt_hash=betlive.coupon.coupon_mkt_hash;$j('td.sltcn-txt-coupon-odds_i').removeClass().addClass('ltcn-txt-coupon-odds');$j('td.sltcn-txt-coupon-odds_d').removeClass().addClass('sltcn-txt-coupon-odds');for(var i=0;i<num_mkts;i++){updated_market=updated_coupon_mkt_data.bir_market[i];mkt_idx=cpn_mkt_hash[updated_market.id];if(mkt_idx>=0){var mkt_id=updated_market.id,num_selns=updated_market.selection.length;for(var j=0;j<num_selns;j++){updated_seln=updated_market.selection[j];seln_idx=cpn_seln_hash[updated_seln.id];if(seln_idx>=0){var seln_id=updated_seln.id,old_lp_num=betlive.coupon.coupon_mkt_data.bir_market[i].selection[j].lp_num,old_lp_den=betlive.coupon.coupon_mkt_data.bir_market[i].selection[j].lp_den,tmp_a=old_lp_num*updated_seln.lp_den,tmp_b=old_lp_den*updated_seln.lp_lp_num;if(tmp_a>tmp_b){document.getElementById('td_border_odds_'+seln_id).className='sltcn-txt-coupon-odds_i'}else if(tmp_b>tmp_a){document.getElementById('td_border_odds_'+seln_id).className='sltcn-txt-coupon-odds_d'}else document.getElementById('td_border_odds_'+seln_id).className='sltcn-txt-coupon-odds';var price_str=format_price(updated_seln.lp_num,updated_seln.lp_den);document.getElementById('a_price_'+seln_id).innerHTML=price_str;document.getElementById('s_price_'+seln_id).innerHTML=price_str;if(updated_seln.status=='S'||updated_market.status=='S'){document.getElementById('a_price_'+seln_id).style.display='none';document.getElementById('s_price_'+seln_id).style.display=''}else{document.getElementById('a_price_'+seln_id).style.display='';document.getElementById('s_price_'+seln_id).style.display='none'};if(updated_seln.hcap_value!=''&&document.getElementById('hcap_'+seln_id)!=null)document.getElementById('hcap_'+seln_id).innerHTML=updated_seln.hcap_value}else has_new_selection=true};betlive.coupon.coupon_mkt_data.bir_market[mkt_idx]=updated_market;if(has_new_selection)for(var s_index=0,s_len=updated_market.selection.length;s_index<s_len;++s_index){updated_seln=updated_market.selection[s_index];cpn_seln_hash[updated_seln.id]=s_index}}else{betlive.coupon.coupon_mkt_data.bir_market.push(updated_market);cpn_mkt_hash[updated_market.id]=betlive.coupon.coupon_mkt_data.bir_market.length-1;for(var s_index=0,s_len=updated_market.selection.length;s_index<s_len;++s_index){updated_seln=updated_market.selection[s_index];cpn_seln_hash[updated_seln.id]=s_index}}}}
function lb_auto_coupon_mkts_poll(){var poll_interval=betlive.coupon.coupon_mkts_poll_interval*betlive_poll_factor;if(poll_interval>betlive_min_poll_interval)document.PollingAjaxHelper.setInterval("lb_auto_coupon_mkts_poll",lb_coupon_mkts_poll_server,poll_interval)}
function lb_coupon_mkts_poll_server(){var url=betlive.coupon.bir_json_url+'?action=bir_markets&mkt_ids=',num_mkts=betlive.coupon.coupon_mkt_data.bir_market.length;if(num_mkts>0){url=url+betlive.coupon.coupon_mkt_data.bir_market[0].id;var hash_req_param='&hash='+betlive.coupon.coupon_mkt_data.bir_market[0].hash;for(var i=1;i<num_mkts;i++){url=url+'|'+betlive.coupon.coupon_mkt_data.bir_market[i].id;hash_req_param=hash_req_param+'|'+betlive.coupon.coupon_mkt_data.bir_market[i].hash}}else return;url=url+hash_req_param;$j.ajax({url:url,dataType:'text',type:'GET',success:function(text){var data={};if(text!="")eval('data='+text+';');lb_update_coupon_mkts(data)}})}
function switchTab(tabNo){var menuItems=document.getElementById('tab-list').getElementsByTagName('li');for(i=0;i<menuItems.length;i++)if(i==tabNo){menuItems[i].className='active'}else if(menuItems[i].className=='active')menuItems[i].className='';for(var id=0;id<betlive.calendar.num_tabs;id++)if(id==tabNo){document.getElementById("tab".concat(id)).style.display='block'}else document.getElementById("tab".concat(id)).style.display='none'}
function getSelectedTab(){var tabNo=-1,menu=document.getElementById('tab-list');if(!menu)return tabNo;var menuItems=menu.getElementsByTagName('li');for(var i=0;i<menuItems.length;i++)if(menuItems[i].className=='media-schedule-tab-white'){tabNo=i;break};return tabNo}
function getTabAvail(tabNo){var menu=document.getElementById('tab-list');if(!menu)return false;var menuItems=menu.getElementsByTagName('li'),items=menuItems[tabNo].getElementsByTagName("font");if(items.length>0){return false}else return true}
function mediaCentreToggle(name){var toggleOptions=new Array('video','updates'),displayVal='',classNameVal='',option='';$j.each(toggleOptions,function(item){option=toggleOptions[item];if(option==name){$j('#media-'+option).show();$j('#icon-'+option).removeClass().addClass('off')}else{$j('#media-'+option).hide();$j('#icon-'+option).removeClass().addClass('on')}})}
function mediaCentrePopBack(){var main_win_name='ppmain',opener_window=window.opener,opener_name;try{opener_name=opener_window.name}catch(e){opener_name='unknown'};var opener_closed;if(!opener_window){opener_closed=true}else opener_closed=opener_window.closed;if(opener_closed);else if(opener_name!=main_win_name);else{opener_window.parent.document.getElementById('menu3').style.display="block";opener_window.parent.betlive.mediacenter.popout.opener=false;window.close()}}
function refreshMyBets(url){$j('#myBets').load(url)};var _countDowncontainerId="",_countDowncontainer="",_currentSeconds=0,_warningMessage="",_warningMessageVisible=0,_pageRefresh=0,_finalCountDownValue=null
function ActivateCountDown(strContainerID,initialValue){_countDowncontainerId=strContainerID;_finalCountDownValue=parseInt(new Date().getTime()/1e3)+initialValue;SetCountdownText(initialValue);window.setTimeout("CountDownTick()",500)}
function CountDownTick(){var seconds=parseInt(_finalCountDownValue-(new Date().getTime()/1e3));SetCountdownText(seconds);window.setTimeout("CountDownTick()",500)}
function SetCountdownText(seconds){_countDowncontainer=document.getElementById(_countDowncontainerId);if(seconds<0)seconds=0;_currentSeconds=seconds;var minutes=parseInt(seconds/60);seconds=(seconds%60);var hours=parseInt(minutes/60);minutes=(minutes%60);if(_currentSeconds<=betlive.event.warn_threshold){strText=_warningMessage;if(_warningMessageVisible){_countDowncontainer.style.visibility='hidden';_warningMessageVisible=0}else{_countDowncontainer.style.visibility='visible';_warningMessageVisible=1}}else{_countDowncontainer.style.visibility='visible';strText=AddZero(hours)+":"+AddZero(minutes)+":"+AddZero(seconds)};_countDowncontainer.innerHTML=strText}
function AddZero(num){return((num>=0)&&(num<10))?"0"+num:num+""}
function switchEventsView(currentTab){for(j=0;j<betlive.calendar.num_tabs;j++)updateCalPage(j)}
function updateCalPage(currentTab){var currentTabRef=document.getElementById("tab_"+currentTab+"_table1"),currentTabRefStream=document.getElementById("tab_"+currentTab+"_table2");if(currentTabRef==null||currentTabRefStream==null)return;var events=currentTabRef.getElementsByTagName('tr'),eventsStream=currentTabRefStream.getElementsByTagName('tr'),filter=document.getElementById("cal_sports_dropdown_0").value;if(filter=="ALL"){for(k=0;k<(events.length-1);k++)events[k].style.display="";events[events.length-1].style.display="none";if(eventsStream[0].id!="top_no_stream_"+currentTab)for(l=0;l<(eventsStream.length-1);l++)eventsStream[l].style.display="";eventsStream[eventsStream.length-1].style.display="none"}else{counter=0;for(k=1;k<(events.length-1);k++)if(events[k].id.substr(events[k].id.indexOf("_")+1)==filter||(events[k].id.substr(0,3)=="tab"&&filter=="CL25")){events[k].style.display="";counter++}else events[k].style.display="none";if(counter==0){events[events.length-1].style.display=""}else events[events.length-1].style.display="none";if(eventsStream[0].id!="top_no_stream_"+currentTab){counterStream=0;for(l=1;l<(eventsStream.length-1);l++)if(eventsStream[l].id.substr(eventsStream[l].id.indexOf("_")+1).split("_")[0]==filter){eventsStream[l].style.display="";counterStream++}else eventsStream[l].style.display="none";if(counterStream==0){eventsStream[eventsStream.length-1].style.display=""}else eventsStream[eventsStream.length-1].style.display="none"}}}
function switchLiveStreamDisplay(currentTab){for(j=0;j<betlive.calendar.num_tabs;j++){table_all=document.getElementById("tab_"+j+"_table1");table_streaming=document.getElementById("tab_"+j+"_table2");if(table_all!=null&&table_streaming!=null)if(table_all.style.display!="none"){table_all.style.display="none";table_streaming.style.display=""}else{table_all.style.display="";table_streaming.style.display="none"}}}
function close_othr_mkt(m){document.getElementById('othr_mkts_for_'+m).style.display='none';othr_mkts_hidden=1}
function show_hide_othr_mkts(){var _display;if(othr_mkts_hidden==1){_display='block';othr_mkts_hidden=0}else{_display='none';othr_mkts_hidden=1};for(i=0;i<mkt_ids.length;i++)document.getElementById('othr_mkts_for_'+mkt_ids[i]).style.display=_display}
function getCustId(){var cp=readCookie("cust_prefs").substring(4);cp=cp.substring(0,(cp.length-4));return cp}
function update_bir_prefs(pref){var pref_name=pref.name.toUpperCase();if(pref_name=="FASTBET")pref_name="FAST_BET";set_pref(pref_name,pref.value);$j.ajax({url:bir_settings_cgi_url,type:'GET'})};var sbData={},sb_idx=0,_sb_ls_event_hash={},_sb_ls_evmkt_hash={},_sb_ls_selcn_hash={},_sb_ls_channels={},_sb_ls_cfg={},_sb_ls_has_live_sbet=false,_sb_ls_has_bir_sbet=false,_sb_ls_has_vsc_sbet=false,clock_init=false
function sbet_ls_init(sbets,events,evmkts,selns,selns_cs,selns_sc,init_msg_id,is_lb_ajax,cfg){var live_channels=[];if(!clock_init){eval("initPeriodClocks("+server_clock_time+",cfg.lang)");clock_init=true};if(is_lb_ajax!=1){sbData={};_sb_ls_has_live_sbet=false;_sb_ls_has_bir_sbet=false;_sb_ls_has_vsc_sbet=false;for(var f in cfg)_sb_ls_cfg[f]=cfg[f];sbData.superbets=[];for(var i=0;i<sbets.length;i++){tmpl_store("sbet_blurb_"+i,unescapeHTML(sbets[i].blurb));sbData.superbets[i]=sbets[i];sbData.superbets[i].selections=[];sbData.superbets[i].events=[];sbData.superbets[i].selections_sc=[];sbData.superbets[i].selections_cs=[];if(sbets[i].type=="L"){_sb_ls_has_live_sbet=true;if(sbets[i].data_source=="B"){_sb_ls_has_bir_sbet=true}else if(sbets[i].data_source=="S")_sb_ls_has_vsc_sbet=true;if(sbets[i].ev_list!=""){var ev_ids=sbets[i].ev_list.split(",");for(var j=0;j<ev_ids.length;j++){sbData.superbets[i].events[j]={};sbData.superbets[i].events[j].ev_id=ev_ids[j]}}}else if(sbets[i].type=="O"){if(sbets[i].fs_ev_oc_list!=""){var fs_ev_oc_ids=sbets[i].fs_ev_oc_list.split(",");for(var j=0;j<fs_ev_oc_ids.length;j++){sbData.superbets[i].selections_sc[j]={};sbData.superbets[i].selections_sc[j].oc_id=fs_ev_oc_ids[j]}};if(sbets[i].cs_ev_oc_list!=""){var cs_ev_oc_ids=sbets[i].cs_ev_oc_list.split(",");for(var j=0;j<cs_ev_oc_ids.length;j++){sbData.superbets[i].selections_cs[j]={};sbData.superbets[i].selections_cs[j].oc_id=cs_ev_oc_ids[j]}};sbData.superbets[i].sc_cs_data.ev_desc_long=sbData.superbets[i].sc_cs_data.ev_desc;sbData.superbets[i].sc_cs_data.ev_desc=trunc_string(sbData.superbets[i].sc_cs_data.ev_desc,_sb_ls_cfg.cs_ev_trunc_length,"...")}else{if(sbets[i].ev_oc_list!=""){var ev_oc_ids=sbets[i].ev_oc_list.split(",");for(var j=0;j<ev_oc_ids.length;j++){sbData.superbets[i].selections[j]={};sbData.superbets[i].selections[j].ev_oc_id=ev_oc_ids[j]}};if(sbets[i].type=="C"){sbData.superbets[i].sc_cs_data.ev_desc_long=sbData.superbets[i].sc_cs_data.ev_desc;sbData.superbets[i].sc_cs_data.ev_desc=trunc_string(sbData.superbets[i].sc_cs_data.ev_desc,_sb_ls_cfg.cs_ev_trunc_length,"...")}}};for(var i=0;i<selns.length;i++)_sb_ls_got_SELN(selns[i],true);for(var i=0;i<evmkts.length;i++)_sb_ls_got_EVMKT(evmkts[i],true);for(var i=0;i<selns_sc.length;i++)_sb_ls_got_scorecast_selns(selns_sc[i]);for(var i=0;i<selns_cs.length;i++)_sb_ls_got_correct_score_selns(selns_cs[i])}else{for(var i=0;i<sbData.superbets.length;i++)if(sbData.superbets[i].type=="L"&&sbData.superbets[i].data_source==cfg.data_source)for(var j=0;j<events.length;j++){sbData.superbets[i].events[j]={};sbData.superbets[i].events[j].ev_id=events[j].ev_id};eval("_sb_ls_cfg.ev_curr_hash_"+cfg.data_source+" = cfg.ev_curr_hash_"+cfg.data_source)};for(var i=0;i<events.length;i++)if(events[i].sbet_type!="C"&&events[i].sbet_type!="O"){_sb_ls_got_EVENT(events[i],true);if(!_sb_ls_channels["EVENT"+events[i].ev_id]){live_channels.push("sEVENT"+ps_connect_lpad_id(events[i].ev_id));live_channels.push("SEVENT"+ps_connect_lpad_id(events[i].ev_id));_sb_ls_channels["EVENT"+events[i].ev_id]=true};if(!_sb_ls_channels["SCORE"+events[i].ev_id]&&events[i].bet_radar_match){live_channels.push("sBRSCR"+ps_connect_lpad_id(events[i].ev_id));_sb_ls_channels["BRSCR"+events[i].ev_id]=true}};_do_placeholder_substitution(sbData);for(var i=0;i<events.length;i++)if(events[i].sbet_type=="L"&&events[i].has_clock==1){for(var j in _sb_ls_event_hash[events[i].ev_id].ev_location)addClockEventSuperbet(events[i].ev_id,events[i].clockn_js,events[i]);updatePeriodClock(events[i])};if(live_channels.length>0&&cfg.use_sbet_enhancements==1){ps_connect_register("sb_ls"+sb_idx,_sb_ls_got_msg,live_channels,init_msg_id);sb_idx++};if(cfg.use_sbet_enhancements==1)document.PollingAjaxHelper.setInterval("sbet_ls_init",_sb_lb_prep_sbets_AJAX_request,cfg.ajax_wait_time)}
function _sb_ls_got_msg(msg){var data={};if(msg.subject_level=="sPRICE"){eval("data = "+msg.data+";");data.ev_oc_id=msg.subject_id;_sb_ls_got_PRICE(data)}else if(msg.subject_level=="sSELCN"){eval("data = "+msg.data+";");data.ev_oc_id=msg.subject_id;_sb_ls_got_SELN(data,false)}else if(msg.subject_level=="sEVMKT"){eval("data = "+msg.data+";");data.ev_mkt_id=msg.subject_id;_sb_ls_got_EVMKT(data,false)}else if(msg.subject_level=="sEVENT"){eval("data = "+msg.data+";");data.ev_id=msg.subject_id;_sb_ls_got_EVENT(data,false)}else if(msg.subject_level=="sBRSCR"){eval("data = "+msg.data+";");data.ev_id=msg.subject_id;_sb_ls_got_SCORE(data)};_do_placeholder_substitution(sbData);return}
function _do_placeholder_substitution(data){for(var i=0;i<data.superbets.length;i++)if(data.superbets[i].blurb!="")try{data.superbets[i].blurb=tmpl_play("sbet_blurb_"+i,data.superbets[i])}catch(e){}}
function _sb_ls_got_scorecast_selns(data){for(var i=0;i<sbData.superbets.length;i++){var sbet_info=sbData.superbets[i];for(var j=0;j<sbet_info.selections_sc.length;j++)if(data.oc_id==sbet_info.selections_sc[j].oc_id){sbet_info.selections_sc[j].oc_idx=data.oc_idx;sbet_info.selections_sc[j].name_long=data.name;sbet_info.selections_sc[j].name=trunc_string(data.name,_sb_ls_cfg.sc_trunc_length,"...")}}}
function _sb_ls_got_correct_score_selns(data){for(var i=0;i<sbData.superbets.length;i++){var sbet_info=sbData.superbets[i];for(var j=0;j<sbet_info.selections_cs.length;j++)if(data.oc_id==sbet_info.selections_cs[j].oc_id){sbet_info.selections_cs[j].oc_idx=data.oc_idx;sbet_info.selections_cs[j].cs_home=data.cs_home;sbet_info.selections_cs[j].cs_away=data.cs_away}}}
function _sb_ls_got_EVENT(data,first_build){var info=_sb_ls_event_hash[data.ev_id],is_new_item=!info;if(is_new_item){info=data;info.child_hash={};info.sbet_hash={};_sb_ls_event_hash[data.ev_id]=info}else for(var f in data)info[f]=data[f];for(var i=0;i<sbData.superbets.length;i++){var sbet_info=sbData.superbets[i];for(var j=0;j<sbet_info.events.length;j++)if(info.ev_id==sbet_info.events[j].ev_id){if(first_build||is_new_item){sbData.superbets[i].events[j]=data;sbData.superbets[i].events[j].elapsed_time=0;if(!_sb_ls_event_hash[data.ev_id].ev_location)_sb_ls_event_hash[data.ev_id].ev_location=[];_sb_ls_event_hash[data.ev_id].ev_location=[]};if(data.displayed=="N"){sbet_info.events.splice(j,1);turnOff(data.ev_id)}else{sbet_info.events[j].ev_name=data.names[_sb_ls_cfg.lang];sbet_info.events[j].ev_name_short=trunc_string(data.names[_sb_ls_cfg.lang],_sb_ls_cfg.lb_trunc_length,"...");sbet_info.events[j].status=data.status;sbet_info.events[j].displayed=data.displayed;sbet_info.events[j].period_id=data.period_id;sbet_info.events[j].curr_period_start_time=data.curr_period_start_time;sbet_info.events[j].score_home=data.score_home;sbet_info.events[j].score_away=data.score_away}}};for(var ev_mkt_id in info.child_hash){mkt_info=_sb_ls_evmkt_hash[ev_mkt_id];if(mkt_info)for(var ev_oc_id in mkt_info.child_hash){seln_info=_sb_ls_selcn_hash[ev_oc_id];for(var i=0;i<sbData.superbets.length;i++){var sbet_info=sbData.superbets[i];for(var j=0;j<sbet_info.selections.length;j++)if(ev_oc_id==sbet_info.selections[j].ev_oc_id){sbet_info.selections[j].ev_displayed=data.displayed;sbet_info.selections[j].ev_status=data.status}}}}}
function _sb_ls_got_EVMKT(data,first_build){var parent_info=_sb_ls_event_hash[data.ev_id];if(!parent_info){_sb_ls_event_hash[data.ev_id]={};parent_info=_sb_ls_event_hash[data.ev_id];parent_info.child_hash=[]};parent_info.child_hash[data.ev_mkt_id]=true;var info=_sb_ls_evmkt_hash[data.ev_mkt_id],is_new_item=!info;if(is_new_item){info=data;info.child_hash={};_sb_ls_evmkt_hash[data.ev_mkt_id]=info}else for(var f in data)info[f]=data[f];for(var ev_oc_id in info.child_hash){seln_info=_sb_ls_selcn_hash[ev_oc_id];for(var i=0;i<sbData.superbets.length;i++){var sbet_info=sbData.superbets[i];for(var j=0;j<sbet_info.selections.length;j++)if(ev_oc_id==sbet_info.selections[j].ev_oc_id){sbet_info.selections[j].mkt_status=data.status;sbet_info.selections[j].mkt_displayed=data.displayed;sbet_info.selections[j].mkt_bir_index=data.bir_index;sbet_info.selections[j].mkt_name=data.names[_sb_ls_cfg.lang];sbet_info.selections[j].oc_price_str=_sb_ls_get_price_str(_sb_ls_cfg,sbet_info.selections[j].lp_num,sbet_info.selections[j].lp_den,data.mkt_sort);sbet_info.selections[j].oc_hcap_str=data.hcap_values[sbData.superbets[i].selections[j].fb_result];if(typeof oc_hcap_str=='undefined')sbet_info.selections[j].oc_hcap_str="";sbet_info.selections[j].oc_level=sbet_info.selections[j].oc_hcap_str}}}}
function _sb_ls_got_SELN(data,first_build){var parent_info=_sb_ls_evmkt_hash[data.ev_mkt_id];if(!parent_info){_sb_ls_evmkt_hash[data.ev_mkt_id]={};parent_info=_sb_ls_evmkt_hash[data.ev_mkt_id];parent_info.child_hash=[]};parent_info.child_hash[data.ev_oc_id]=true;var info=_sb_ls_selcn_hash[data.ev_oc_id],is_new_item=!info;if(is_new_item){info=data;_sb_ls_selcn_hash[data.ev_oc_id]=info;_sb_ls_selcn_hash[data.ev_oc_id].seln_location=[]}else for(var f in data)info[f]=data[f];for(var i=0;i<sbData.superbets.length;i++){var sbet_info=sbData.superbets[i];for(var j=0;j<sbet_info.selections.length;j++)if(data.ev_oc_id==sbet_info.selections[j].ev_oc_id){if(first_build)sbData.superbets[i].selections[j]=data;sbData.superbets[i].selections[j].oc_level=sbData.superbets[i].selections[j].oc_hcap_str;sbet_info.selections[j].oc_name=data.names[_sb_ls_cfg.lang];sbet_info.selections[j].oc_name_short=trunc_string(data.names[_sb_ls_cfg.lang],_sb_ls_cfg.seln_trunc_length,"...");sbet_info.selections[j].status=data.status;sbet_info.selections[j].displayed=data.displayed;sbet_info.selections[j].disporder=data.disporder;sbet_info.selections[j].oc_id=data.ev_oc_id;sbet_info.selections[j].oc_price_str=_sb_ls_get_price_str(_sb_ls_cfg,data.lp_num,data.lp_den,sbet_info.selections[j].mkt_sort)}}}
function _sb_ls_got_PRICE(data){var info=_sb_ls_selcn_hash[data.ev_oc_id];if(!info)return;for(var f in data)info[f]=data[f];for(var i=0;i<sbData.superbets.length;i++){var sbet_info=sbData.superbets[i];for(var j=0;j<sbet_info.selections.length;j++)if(data.ev_oc_id==sbet_info.selections[j].ev_oc_id)sbet_info.selections[j].oc_price_str=_sb_ls_get_price_str(_sb_ls_cfg,data.lp_num,data.lp_den,sbet_info.selections[j].mkt_sort)};_do_placeholder_substitution(sbData)}
function _sb_ls_got_SCORE(data){var info=_sb_ls_event_hash[data.ev_id];if(!info)retrun;for(var f in data)info[f]=data[f];for(var i in info.sbet_hash){var sbet_info=sbData.superbets[i];for(var j=0;j<sbet_info.events.length;j++)if(data.ev_id==sbet_info.events[j].ev_id){sbet_info.events[j].score_away_br=data.score_away_br;sbet_info.events[j].score_home_br=data.score_home_br}}}
function _sb_lb_prep_sbets_AJAX_request(){var clientdata={},url=_sb_ls_cfg.cgi_url+"?action=sb_lb_get_superbets&camp_id="+_sb_ls_cfg.camp_id+"&sb_curr_hash="+_sb_ls_cfg.sb_curr_hash;_sb_ls_make_AJAX_get_request(url,clientdata,_sb_ls_got_first_AJAX_response)}
function _sb_ls_got_first_AJAX_response(url,clientdata,ok,response){if(!ok)return;if(response==""){if(_sb_ls_has_live_sbet){if(_sb_ls_has_bir_sbet&&_sb_ls_has_vsc_sbet){_sb_lb_prep_events_AJAX_request("B","S")}else if(_sb_ls_has_bir_sbet){_sb_lb_prep_events_AJAX_request("B","")}else if(_sb_ls_has_vsc_sbet){_sb_lb_prep_events_AJAX_request("S","")}else return}else return}else{var parts=_sb_ls_parse_script_tags(response);if(parts[1].length)try{_sb_ls_global_eval(parts[1])}catch(e){ok=false}}}
function _sb_lb_prep_events_AJAX_request(sb_data_source,clientdata){var hash=eval("_sb_ls_cfg.ev_curr_hash_"+sb_data_source),url=_sb_ls_cfg.cgi_url+"?action=sb_lb_get_events&sb_data_source="+sb_data_source+"&ev_curr_hash="+hash;_sb_ls_make_AJAX_get_request(url,clientdata,_sb_ls_got_events_AJAX_response)}
function _sb_ls_got_events_AJAX_response(url,clientdata,ok,response){if(!ok)return;if(response!=""){var parts=_sb_ls_parse_script_tags(response);if(parts[1].length)try{_sb_ls_global_eval(parts[1])}catch(e){ok=false}};if(clientdata==""||typeof clientdata=="undefined"){return}else _sb_lb_prep_events_AJAX_request(clientdata,"")}
function _sb_ls_get_price_str(cfg,lp_num,lp_den,lp_avail,mkt_sort){if(typeof lp_avail=="undefined")lp_avail="Y";if(typeof mkt_sort=="undefined")mkt_sort="--";var price_str_type=cfg.price_str_type;if(mkt_sort=="AH"&&cfg.price_str_type_ah!="")price_str_type=cfg.price_str_type_ah;if(mkt_sort=="HL"&&cfg.price_str_type_hl!="")price_str_type=cfg.price_str_type_hl;if(lp_avail=="N")return"SP";if(lp_num==""&&lp_den=="")return"-";var price_str;if(price_str_type=="DECIMAL"){var dps=(lp_den>100)?3:2,dp=1.0+(lp_num/lp_den),scaled_dp=""+Math.round(dp*Math.pow(10,dps)-0.5),int_part=scaled_dp.substr(0,scaled_dp.length-dps),frac_part=scaled_dp.substr(scaled_dp.length-dps);if(int_part=="")int_part="";if(frac_part=="")frac_part="";var price_str=int_part+"."+frac_part}else{if(lp_den=="")lp_den=1;if(lp_num==lp_den){price_str="evens"}else price_str=lp_num+cfg.price_str_sep+lp_den};return price_str}
function _sb_ls_make_AJAX_get_request(url,clientdata,callback){var req=null;if(window.XMLHttpRequest){req=new XMLHttpRequest()}else if(window.ActiveXObject)req=new ActiveXObject('Microsoft.XMLHTTP');if(req){req.onreadystatechange=function(){if(req.readyState!=4)return;var reqStatus;try{reqStatus=req.status}catch(e){reqStatus=''};if(reqStatus!=200){callback(url,clientdata,false,'HTTP')}else callback(url,clientdata,true,req.responseText)};try{req.open('GET',url,true);req.send(null)}catch(e){callback(url,clientdata,false,'UNSUPPORTED')}}else callback(url,clientdata,false,'UNSUPPORTED')}
function _sb_ls_parse_script_tags(str){var html='',js='',i=0,state='HTML',script_re=new RegExp('<(/?)script([^>]*)>','gi');while((mtch=script_re.exec(str))!=null){mS=mtch.index;if(state=='HTML'){html+=str.substring(i,mS)}else js+=str.substring(i,mS)+';\n';var closer=mtch[1],attrs=mtch[2];if(closer=='/'){state='HTML'}else if(attrs.charAt(attrs.length-1)!='/'&&attrs.indexOf('src=')==-1)state='JS';i=script_re.lastIndex};if(state=='HTML'){html+=str.substring(i)}else js+=str.substring(i);return[html,js]};var _sb_ls_global_eval=function(src){if(window.execScript){window.execScript(src);return};var fn=function(){window.eval.call(window,src)};fn()}
function getSuperbetData(){return sbData}
function resizeSuperbet(newHeight){var br=document.getElementById('superbetSwf');br.height=newHeight;br.className='superbetSwfSingle'}
function sb_place_bet(ev_oc_id,price_type,lp_num,lp_den,bet_origin){BS_set_leg('price_type',price_type);BS_set_leg('lp_num',lp_num);BS_set_leg('lp_den',lp_den);BS_set_leg('selections',ev_oc_id);BS_set_leg('bet_origin',bet_origin);BS_go_bet()}
function sb_place_bet_scorecast(fs_idx,cs_idx,sbet_num,bet_origin){var odds_lookup=sbData.superbets[sbet_num].sc_cs_data.sc_odds;eval("price_map = {"+odds_lookup+"}");var lp_num=price_map["p"+fs_idx+"_"+cs_idx];for(var j=0;j<sbData.superbets[sbet_num].selections_sc.length;j++)if(sbData.superbets[sbet_num].selections_sc[j].oc_idx==fs_idx)var fs_ev_oc_id=sbData.superbets[sbet_num].selections_sc[j].oc_id;for(var k=0;k<sbData.superbets[sbet_num].selections_cs.length;k++)if(sbData.superbets[sbet_num].selections_cs[k].oc_idx==cs_idx)var cs_ev_oc_id=sbData.superbets[sbet_num].selections_cs[k].oc_id;BS_set_leg('leg_sort','SC');BS_set_leg('price_type','L');BS_set_leg('lp_num',lp_num);BS_set_leg('lp_den',1);BS_set_leg('selections',fs_ev_oc_id+'c'+cs_ev_oc_id);BS_set_leg('bet_origin',bet_origin);BS_go_bet()}