function hp_lb_init(call_type,events,markets,selcns,init_msg_id,cfg){var channels=[];_hp_lb_last_msg_id=init_msg_id;for(var f in cfg)_hp_lb_cfg[f]=cfg[f];if(call_type=="html"){_hp_lb_store_templates();_hp_lb_event_hash={};_hp_lb_evmkt_hash={};_hp_lb_selcn_hash={};scone_create(_hp_lb_events_prefix,{},_hp_lb_cmp_events,null);var first_build=true}else var first_build=false;if(_hp_lb_idx>_hp_lb_cfg.reset_count)_hp_lb_reset();_hp_lb_prune_event_list={};for(var i=0;i<events.length;i++){_hp_lb_prune_event_list[events[i].ev_id]=true;if(call_type=="html"||(!_hp_lb_event_hash[events[i].ev_id])){_hp_lb_ok_ev_count++;_hp_lb_got_EVENT(events[i],false)}else if(call_type=="js"&&_hp_lb_event_hash[events[i].ev_id]){var changed=false;if(_hp_lb_event_hash[events[i].ev_id].ev_disporder!=events[i].ev_disporder)changed=true;if(changed)_hp_lb_got_EVENT({ev_id:events[i].ev_id,ev_disporder:events[i].ev_disporder},false)};if(!_hp_lb_channels["EVENT"+events[i].ev_id]){channels.push("sEVENT"+ps_connect_lpad_id(events[i].ev_id));_hp_lb_channels["EVENT"+events[i].ev_id]=true}};for(var i=0;i<markets.length;i++){if(call_type=="html"||(!_hp_lb_evmkt_hash[markets[i].ev_mkt_id]))_hp_lb_got_EVMKT(markets[i]);if(!_hp_lb_channels["MARKET"+markets[i].ev_mkt_id]){channels.push("sEVMKT"+ps_connect_lpad_id(markets[i].ev_mkt_id));channels.push("SEVMKT"+ps_connect_lpad_id(markets[i].ev_mkt_id));_hp_lb_channels["MARKET"+markets[i].ev_mkt_id]=true}};for(var i=0;i<selcns.length;i++)if(call_type=="html"||(!_hp_lb_selcn_hash[selcns[i].ev_oc_id]))_hp_lb_got_SELCN(selcns[i]);if(call_type=="js"){_hp_lb_prune_events(_hp_lb_prune_event_list);_hp_lb_reintroduce_events()};_hp_lb_show_top_events(first_build);if(channels.length>0){ps_connect_register("hp_lb"+_hp_lb_idx,_hp_lb_got_msg,channels,init_msg_id);_hp_lb_idx++};if(call_type=="html")_hp_lb_schedule_reload();return};var _hp_lb_events_prefix="hp_lb_events",_hp_lb_event_id_prefix="hp_lb_event_",_hp_lb_evmkts_id_prefix="hp_lb_evmkts_",_hp_lb_evmkt_id_prefix="hp_lb_evmkt_",_hp_lb_selcns_id_prefix="hp_lb_selcns_",_hp_lb_selcn_id_prefix="hp_lb_selcn_",_hp_lb_price_id_prefix="hp_lb_price_",_hp_lb_event_hash={},_hp_lb_evmkt_hash={},_hp_lb_selcn_hash={},_hp_lb_price_class_name="odd",_hp_lb_price_class_name_large="odd-large",_hp_lb_highlight_timers={},_hp_lb_channels={},_hp_lb_idx=0,_hp_lb_initial_events={},_hp_lb_ok_ev_count=0
function _hp_lb_store_templates(){tmpl_store("hp_lb_ev",'<tr id="hp_lb_event_<%ev_id%>" <%IF hidden%>style="display:none"<%END%>>\n	<td class="desc">\n		<table class="tab_livebetting">\n			<tr>\n				<td>\n					<%IF ev_type == "live"%>\n						<div class="time lb_tab_live"><%XL HOME_LB_TAB_LIVE%></div>\n					<%ELSE%>\n						<div class="time" ><%start_time%></div>\n					<%END%>\n				</td>\n				<td class="label">\n					<%IF ev_type == "upcoming"%>\n						<div class="left">\n							<a rel="nofollow" href="<%url%>">\n							<%IF category == "SOCCER"%>\n								<%type_name_full%>\n							<%ELSE%>\n								<%class_name_full%>\n							<%END%>\n							</a> / <%name_full%>\n						</div>\n					<%ELSE%>\n						<div class="left">\n							<a rel="nofollow" href="<%url%>">\n							<%IF category == "SOCCER"%>\n								<%type_name_full%>\n							<%ELSE%>\n								<%class_name_full%>\n							<%END%>\n							</a> / \n							<span>\n								<%IF score_home == ""%>\n									<%name_full%> [<%score_away%>]\n								<%ELSE%>\n									<%name_full%> [<%score_home%> - <%score_away%>]\n								<%END%>\n							</span>\n						</div>\n					<%END%>\n				</td>\n				<td class="lb_tv">\n					<%IF station_names.length > 0%>\n						<ul class="dd-tv"><li><img src="<%image_url%>/tv_on.gif" alt="" /><ul><li><%station_names%></li></ul></li></ul>\n					<%END%>\n				</td>\n				<td>\n					<%IF stream_avail == 1%>\n						<span class="streaming_video_icon" title="<%XL BIR_STREAM_VID_TITLE%>"></span>\n					<%END%>\n				</td>\n				<td class="lb_odds" id="hp_lb_evmkts_<%ev_id%>"></td>\n			</tr>\n		</table>\n	</td>\n</tr>\n');tmpl_store("hp_lb_evmkt",'<div id="hp_lb_evmkt_<%ev_mkt_id%>">\n		<div <%IF !bettable%>style="display:none"<%END%> id="hp_lb_selcns_<%ev_mkt_id%>"></div>\n		<%IF !bettable%><div class="mkt-suspended"><%XL HP_LIVE_BETTING_SUSPENDED%></div><%END%>\n</div>\n');tmpl_store("hp_lb_selcn",'<%IF displayed == "Y"%>\n<div class="<%IF mkt_sort == "HH"%>odd-large<%ELSE%>odd<%END%> right nohref<%IF !bettable%> suspended<%END%>" <%IF bettable%>onclick="hp_lb_add_bet(<%ev_oc_id%>)"<%END%> id="hp_lb_selcn_<%ev_oc_id%>"><a id="hp_lb_price_<%ev_oc_id%>"  href="javascript:void(0)"><%price_str%></a></div>\n<%ELSE%>\n	<div class="<%IF mkt_sort == "HH"%>odd-large<%ELSE%>odd<%END%> right nohref" id="hp_lb_selcn_<%ev_oc_id%>"></div>\n<%END%>\n')};var _hp_lb_cfg={lang:"en",bet_threshold:0,name_truncate_threshold:8,highlight_duration:4e3,price_str_type:"ODDS",price_str_type_ah:"DECIMAL",price_str_type_hl:"DECIMAL",price_str_sep:"-"}
function _hp_lb_got_msg(msg){var data={};if(msg.subject_level=="sPRICE"){eval("data = "+msg.data+";");data.ev_oc_id=msg.subject_id;_hp_lb_got_PRICE(data)}else if(msg.subject_level=="sSELCN"){eval("data = "+msg.data+";");data.ev_oc_id=msg.subject_id;_hp_lb_got_SELCN(data)}else if(msg.subject_level=="sEVMKT"){eval("data = "+msg.data+";");data.ev_mkt_id=msg.subject_id;_hp_lb_got_EVMKT(data)}else if(msg.subject_level=="sMHCAP"){eval("data = "+msg.data+";");data.ev_mkt_id=msg.subject_id;_hp_lb_got_MHCAP(data)}else if(msg.subject_level=="sEVENT"){eval("data = "+msg.data+";");data.ev_id=msg.subject_id;_hp_lb_got_EVENT(data,true)};return}
function _hp_lb_got_EVENT(data,from_push){var info=_hp_lb_event_hash[data.ev_id],is_new_item=!info,orig_bettable;if(is_new_item){if(from_push)return;info=data;info.child_hash={};_hp_lb_event_hash[data.ev_id]=info;info.hidden=true;info.valid=true;info.became_valid=false}else{orig_bettable=info.bettable;for(var f in data)info[f]=data[f]};info.name_full=info.names[_hp_lb_cfg.lang];info.class_name_full=info.class_names[_hp_lb_cfg.lang];info.type_name_full=info.type_names[_hp_lb_cfg.lang];info.start_time_xl=info.start_time_xls[_hp_lb_cfg.lang];info.start_time=info.start_time.substring(11,16);info.bettable=info.status=="A";info.image_url=_hp_lb_cfg.image_url;var scitem_id=_hp_lb_event_id_prefix+info.ev_id,pscone_id=_hp_lb_events_prefix;if(!scone_exists(pscone_id))return;var was_visible=scone_item_exists(scitem_id),now_visible=(info.displayed=="Y"&&info.valid),html=tmpl_play("hp_lb_ev",info),sort_info={disporder:info.ev_disporder,ev_id:info.ev_id};if(!was_visible&&now_visible){scone_add_item(pscone_id,scitem_id,html,sort_info);var cscone_id=_hp_lb_evmkts_id_prefix+info.ev_id;scone_create(cscone_id,{},null,null);if(from_push)_hp_lb_show_top_events(false)}else if(was_visible&&now_visible){scone_replace_item(scitem_id,html,sort_info,true)}else if(was_visible&&!now_visible){scone_remove_item(scitem_id);_hp_lb_show_top_events(false)};if(now_visible&&(!was_visible||orig_bettable!=info.bettable))for(var ev_mkt_id in info.child_hash)_hp_lb_got_EVMKT({ev_mkt_id:ev_mkt_id,ev_id:info.ev_id})}
function _hp_lb_got_EVMKT(data){var parent_info=_hp_lb_event_hash[data.ev_id];if(!parent_info)return;parent_info.child_hash[data.ev_mkt_id]=true;var info=_hp_lb_evmkt_hash[data.ev_mkt_id],is_new_item=!info,orig_displayed,orig_disporder,orig_name,orig_bettable,orig_hcap_values;if(is_new_item){info=data;_hp_lb_evmkt_hash[data.ev_mkt_id]=info;info.child_hash={}}else{orig_displayed=info.displayed;orig_disporder=info.disporder;orig_name=info.name;orig_bettable=info.bettable;orig_hcap_values=info.hcap_values;for(var f in data)info[f]=data[f]};if(info.bet_in_run!='Y')info.displayed="N";info.name=info.names[_hp_lb_cfg.lang];info.bettable=(info.status=="A")&&(parent_info.status=="A");if(info.blurb==undefined)info.blurb="";var scitem_id=_hp_lb_evmkt_id_prefix+data.ev_mkt_id,pscone_id=_hp_lb_evmkts_id_prefix+data.ev_id;if(!scone_exists(pscone_id))return;var html=tmpl_play("hp_lb_evmkt",info),sort_info={disporder:info.disporder,ev_mkt_id:info.ev_mkt_id},was_visible=scone_item_exists(scitem_id),now_visible=false;if(info.displayed=="Y")now_visible=true;if(!was_visible&&now_visible){scone_add_item(pscone_id,scitem_id,html,sort_info);var cscone_id=_hp_lb_selcns_id_prefix+data.ev_mkt_id;scone_create(cscone_id,{},_hp_lb_cmp_selcns,null)}else if(was_visible&&now_visible){scone_replace_item(scitem_id,html,sort_info,true)}else if(was_visible&&!now_visible)scone_remove_item(scitem_id);if(now_visible&&(!was_visible||orig_bettable!=info.bettable))for(var ev_oc_id in info.child_hash)_hp_lb_got_SELCN({ev_oc_id:ev_oc_id,ev_mkt_id:info.ev_mkt_id})}
function _hp_lb_got_SELCN(data){var parent_info=_hp_lb_evmkt_hash[data.ev_mkt_id];if(!parent_info)return;parent_info.child_hash[data.ev_oc_id]=true;var info=_hp_lb_selcn_hash[data.ev_oc_id],is_new_item=!info,orig_lp_num,orig_lp_den;if(is_new_item){info=data;_hp_lb_selcn_hash[data.ev_oc_id]=info}else{orig_lp_num=info.lp_num;orig_lp_den=info.lp_den;orig_hcap_values=info.hcap_values;for(var f in data)info[f]=data[f]};info.mkt_sort=parent_info.mkt_sort;info.name=info.names[_hp_lb_cfg.lang];info.name=trunc_string(info.name,_hp_lb_cfg.name_truncate_threshold,'...');if(info.fb_result&&parent_info.hcap_values)info.hcap_value=parent_info.hcap_values[info.fb_result];info.bettable=(info.status=="A")&&parent_info.bettable;info.price_str=hp_lb_get_price_str(info.lp_num,info.lp_den,parent_info.lp_avail,parent_info.mkt_sort);_hp_lb_showhide_market(parent_info.ev_mkt_id,info.lp_num,info.lp_den,orig_lp_num,orig_lp_den);var scitem_id=_hp_lb_selcn_id_prefix+info.ev_oc_id,pscone_id=_hp_lb_selcns_id_prefix+parent_info.ev_mkt_id;if(!scone_exists(pscone_id))return;var html=tmpl_play("hp_lb_selcn",info),sort_info={disporder:info.disporder,lp_num:info.lp_num,lp_den:info.lp_den,ev_oc_id:info.ev_oc_id},was_visible=scone_item_exists(scitem_id),now_visible=(info.displayed=="Y");if(!was_visible){scone_add_item(pscone_id,scitem_id,html,sort_info)}else if(was_visible)scone_replace_item(scitem_id,html,sort_info,true);if(!is_new_item&&now_visible)_hp_lb_highlight_price_change(info.ev_oc_id,orig_lp_num,orig_lp_den,info.lp_num,info.lp_den,parent_info.mkt_sort)}
function _hp_lb_got_PRICE(data){var info=_hp_lb_selcn_hash[data.ev_oc_id];if(!info)return;var parent_info=_hp_lb_evmkt_hash[info.ev_mkt_id];if(!parent_info)return;var orig_lp_num=info.lp_num,orig_lp_den=info.lp_den;for(var f in data)info[f]=data[f];_hp_lb_showhide_market(parent_info.ev_mkt_id,info.lp_num,info.lp_den,orig_lp_num,orig_lp_den);var scitem_id=_hp_lb_selcn_id_prefix+data.ev_oc_id;if(!scone_item_exists(scitem_id))return;var sort_info={disporder:info.disporder,lp_num:info.lp_num,lp_den:info.lp_den,ev_oc_id:info.ev_oc_id};scone_set_item_info(scitem_id,sort_info);var price_id=_hp_lb_price_id_prefix+info.ev_oc_id,price_el=document.getElementById(price_id);if(!price_el)return;info.price_str=hp_lb_get_price_str(info.lp_num,info.lp_den,parent_info.lp_avail,parent_info.mkt_sort);price_el.innerHTML=info.price_str;_hp_lb_highlight_price_change(info.ev_oc_id,info.lp_num,info.lp_den,orig_lp_num,orig_lp_den,parent_info.mkt_sort);return}
function _hp_lb_highlight_price_change(ev_oc_id,lp_num,lp_den,old_lp_num,old_lp_den,sort){if(isNaN(lp_num)||isNaN(old_lp_num))return;var d=lp_num*old_lp_den-lp_den*old_lp_num;if(d==0)return;var class_name="";if(sort=="HH"){class_name=_hp_lb_price_class_name_large}else class_name=_hp_lb_price_class_name;var price_id=_hp_lb_selcn_id_prefix+ev_oc_id;_hp_lb_highlight(price_id,class_name,d);return}
function _hp_lb_highlight(id,base_class,dir){var el=document.getElementById(id);if(!el)return;if(dir<0){highlight_class=base_class+"_d"}else if(dir>0){highlight_class=base_class+"_i"}else highlight_class=base_class+"";var classes=el.className.split(" "),found=false;for(var i=0;i<classes.length;i++)if(classes[i]==base_class+""||classes[i]==base_class+"_d"||classes[i]==base_class+"_i"){classes[i]=highlight_class;found=true;break};if(!found)classes.push(highlight_class);el.className=classes.join(" ");if(_hp_lb_highlight_timers[id]!=null){window.clearTimeout(_hp_lb_highlight_timers[id]);delete _hp_lb_highlight_timers[id]};if(dir!=0){var unhighlight_cmd="_hp_lb_highlight('"+id+"','"+base_class+"', 0)";_hp_lb_highlight_timers[id]=window.setTimeout(unhighlight_cmd,_hp_lb_cfg.highlight_duration)};return}
function _hp_lb_got_MHCAP(data){var info=_hp_lb_evmkt_hash[data.ev_mkt_id];if(!info)return;for(var f in data)info[f]=data[f];for(var ev_oc_id in info.child_hash)_hp_lb_got_SELCN({ev_oc_id:ev_oc_id,ev_mkt_id:info.ev_mkt_id});return}
function _hp_lb_cmp_selcns(cmpMode,selcnA,selcnB){var d=selcnB.disporder-selcnA.disporder;if(d)return d;return selcnB.ev_oc_id-selcnA.ev_oc_id}
function _hp_lb_cmp_events(cmpMode,eventA,eventB){var d=eventA.disporder-eventB.disporder;if(d)return d;return eventA.ev_id-eventB.ev_id}
function _hp_lb_show_top_events(first_build){var event_container=document.getElementById(_hp_lb_events_prefix),count=0;for(var m=0;m<event_container.childNodes.length;m++){var ev_name=event_container.childNodes[m].id,ev_matches=ev_name.match(_hp_lb_event_id_prefix+"*");if(ev_matches){var ev_id=ev_name.substring(_hp_lb_event_id_prefix.length,ev_name.length),sort_info=scone_get_item_info(ev_name),info=_hp_lb_event_hash[ev_id];if(count<_hp_lb_cfg.num_events){info.hidden=false;if(first_build)_hp_lb_initial_events[ev_id]=true}else info.hidden=true;var html=tmpl_play("hp_lb_ev",info);scone_replace_item(ev_name,html,sort_info,true);count++}}}
function _hp_lb_reintroduce_events(){for(var ev_id in _hp_lb_event_hash){var ev_info=_hp_lb_event_hash[ev_id];if(ev_info.became_valid){ev_info.valid=true;ev_info.became_valid=false;_hp_lb_ok_ev_count++;_hp_lb_got_EVENT({ev_id:ev_info.ev_id,valid:true,became_valid:false},false)}}}
function _hp_lb_check_price(ev_mkt_id){var mkt_info=_hp_lb_evmkt_hash[ev_mkt_id],ok=true,status_count=0,max_count=0;if(mkt_info.mkt_sort=="HH"){seln_count=2}else seln_count=3;for(var ev_oc_id in mkt_info.child_hash){var selcn_info=_hp_lb_selcn_hash[ev_oc_id];if(isNaN(_hp_lb_cfg.min_price_den)||isNaN(_hp_lb_cfg.min_price_num)){var mind=1}else var mind=selcn_info.lp_num*_hp_lb_cfg.min_price_den-selcn_info.lp_den*_hp_lb_cfg.min_price_num;if(mind<0){ok=false;break};if(isNaN(_hp_lb_cfg.max_price_den)||isNaN(_hp_lb_cfg.max_price_num)){var maxd=-1}else var maxd=selcn_info.lp_num*_hp_lb_cfg.max_price_den-selcn_info.lp_den*_hp_lb_cfg.max_price_num;if(selcn_info.status=="A"&&selcn_info.displayed=="Y"){status_count++;if(maxd>0)max_count++}};if(status_count<seln_count&&max_count>0)ok=false;return ok}
function _hp_lb_showhide_market(ev_mkt_id,lp_num,lp_den,old_lp_num,old_lp_den){if(isNaN(lp_num)||isNaN(old_lp_num))return;var d=lp_num*old_lp_den-lp_den*old_lp_num;if(d==0)return;var mkt_info=_hp_lb_evmkt_hash[ev_mkt_id],ev_info=_hp_lb_event_hash[mkt_info.ev_id],ok=_hp_lb_check_price(ev_mkt_id);if(ok&&ev_info.valid)return;if(ok&&!ev_info.valid){ev_info.became_valid=true;return};ev_info.became_valid=false;if(!ev_info.valid)return;if(_hp_lb_ok_ev_count<_hp_lb_cfg.num_events)return;ev_info.valid=false;_hp_lb_got_EVENT({ev_id:ev_info.ev_id,valid:false},true);_hp_lb_ok_ev_count--}
function _hp_lb_prune_events(prune_events){for(ev_id in _hp_lb_event_hash){var ev_exists=prune_events[ev_id];if(!ev_exists)_hp_lb_remove_EVENT(ev_id)}}
function _hp_lb_remove_EVENT(ev_id){var info=_hp_lb_event_hash[ev_id],scitem_id=_hp_lb_event_id_prefix+info.ev_id;scone_remove_item(scitem_id);for(var ev_mkt_id in info.child_hash)if(_hp_lb_evmkt_hash[ev_mkt_id]){for(var ev_oc_id in _hp_lb_evmkt_hash[ev_mkt_id].child_hash)if(_hp_lb_selcn_hash[ev_oc_id])delete _hp_lb_selcn_hash[ev_oc_id];delete _hp_lb_evmkt_hash[ev_mkt_id]};delete _hp_lb_event_hash[ev_id];_hp_lb_ok_ev_count--}
function _hp_lb_reset(){for(var i=0;i<_hp_lb_idx;i++)ps_connect_deregister("hp_lb"+i);var dummy={};_hp_lb_prune_events(dummy);_hp_lb_channels={};_hp_lb_idx=0}
function hp_lb_get_price_str(lp_num,lp_den,lp_avail,mkt_sort){if(lp_avail==undefined)lp_avail="Y";if(mkt_sort==undefined)mkt_sort="--";var price_str_type=_hp_lb_cfg.price_str_type;if(mkt_sort=="AH"&&_hp_lb_cfg.price_str_type_ah!="")price_str_type=_hp_lb_cfg.price_str_type_ah;if(mkt_sort=="HL"&&_hp_lb_cfg.price_str_type_hl!="")price_str_type=_hp_lb_cfg.price_str_type_hl;if(lp_avail=="N")return"SP";if(lp_num==""&&lp_den=="")return"-";var price_str;if(price_str_type=="DECIMAL"){var dps=(lp_den>100)?3:2,dp=1.0+(lp_num/lp_den),scaled_dp=""+Math.round(dp*Math.pow(10,dps)-0.5),int_part=scaled_dp.substr(0,scaled_dp.length-dps),frac_part=scaled_dp.substr(scaled_dp.length-dps);if(int_part=="")int_part="";if(frac_part=="")frac_part="";var price_str=int_part+"."+frac_part}else{if(lp_den=="")lp_den=1;if(lp_num==lp_den){price_str="evens"}else price_str=lp_num+_hp_lb_cfg.price_str_sep+lp_den};return price_str}
function hp_lb_add_bet(ev_oc_id){var selcn=_hp_lb_selcn_hash[ev_oc_id],evmkt=_hp_lb_evmkt_hash[selcn.ev_mkt_id],bet_origin="";if(_hp_lb_initial_events[evmkt.ev_id]){bet_origin="HP_LB_TAB"}else bet_origin="HP_LB_TAB_MINMAX";BS_set_leg("selections",ev_oc_id);BS_set_leg("price_type","L");BS_set_leg("lp_num",selcn.lp_num);BS_set_leg("lp_den",selcn.lp_den);BS_set_leg("hcap_value",evmkt.raw_hcap);BS_set_leg("bir_index",evmkt.bir_index);BS_set_leg("market_tags","");BS_set_leg("bet_origin",bet_origin);BS_go_bet();return}
function _hp_lb_schedule_reload(){setInterval('_hp_lb_reload_js()',_hp_lb_cfg.reload_period)}
function _hp_lb_reload_js(){if(_hp_lb_cfg.reload_js_url=="")return;var clientdata={id:"live_betting_js"},url=_hp_lb_cfg.reload_js_url+"&cust_hash="+_hp_lb_cfg.reload_hash;_hp_lb_make_ajax_get_request(url,clientdata,_hp_lb_got_ajax_content)}
function _hp_lb_make_ajax_get_request(url,clientdata,callback){if(document.PollingAjaxHelper.checkSemaphore())document.PollingAjaxHelper.setTimeout("_hp_lb_make_ajax_get_request",function(){_hp_lb_make_ajax_get_request(url,clientdata,callback)},300);document.PollingAjaxHelper.aquireSemaphore();var req=null;if(window.XMLHttpRequest){req=new XMLHttpRequest()}else if(window.ActiveXObject)req=new ActiveXObject('Microsoft.XMLHTTP');if(req){req.onreadystatechange=function(){if(req.readyState!=4)return;var reqStatus;try{reqStatus=req.status}catch(e){reqStatus=''};if(reqStatus!=200){document.PollingAjaxHelper.releaseSemaphore();callback(url,clientdata,false,'HTTP')}else{document.PollingAjaxHelper.releaseSemaphore();callback(url,clientdata,true,req.responseText)}};try{req.open('GET',url,true);req.send(null)}catch(e){document.PollingAjaxHelper.releaseSemaphore();callback(url,clientdata,false,'UNSUPPORTED')}}else{document.PollingAjaxHelper.releaseSemaphore();callback(url,clientdata,false,'UNSUPPORTED')}}
function _hp_lb_got_ajax_content(url,clientdata,ok,response){var holder_el=document.getElementById(clientdata.id);if(ok){if(response==""){_hp_lb_reintroduce_events();_hp_lb_show_top_events(false);return};var parts=_hp_lb_parse_script_tags(response);if(holder_el)holder_el.innerHTML=parts[0];if(parts[1].length)try{_hp_lb_global_eval(parts[1])}catch(e){ok=false}}}
function _hp_lb_parse_script_tags(str){var html='',js='',i=0,state='HTML',script_re=new RegExp('<(/?)script([^>]*)>','gi');while((mtch=script_re.exec(str))!=null){mS=mtch.index;if(state=='HTML'){html+=str.substring(i,mS)}else js+=str.substring(i,mS)+';\n';var closer=mtch[1],attrs=mtch[2];if(closer=='/'){state='HTML'}else if(attrs.charAt(attrs.length-1)!='/'&&attrs.indexOf('src=')==-1)state='JS';i=script_re.lastIndex};if(state=='HTML'){html+=str.substring(i)}else js+=str.substring(i);return[html,js]};var _hp_lb_global_eval=function(src){if(window.execScript){window.execScript(src);return};var fn=function(){window.eval.call(window,src)};fn()}